---
description: API詳細設計書を作成する処理に対して、docs/detailed-design/api配下のMarkdownファイルを対象とするルール
globs: docs/detailed-design/api/**/*.md
alwaysApply: false
---
# API詳細設計書作成ルール

## 概要
このルールは、バックエンドの詳細設計書を作成・管理するためのガイドラインを提供します。

## 詳細設計書の基本構造

### 1. ファイル配置
- 詳細設計書は `docs/detailed-design/api/` ディレクトリに配置する
- 各機能の詳細設計は個別のMarkdownファイルとして管理
- メインの一覧ファイルは `detailed-design-list.md` として作成

### 2. 詳細設計書の構成

#### 2.1 ドキュメント作成ルール
- 以下の内容を記載すること（記載名ようがない題目は、題目のみ記載すること）
  - タイトル
    - システム名とAPI名を明記すること
  - 概要
    - APIの目的と主要な処理内容を簡潔に記述（3-5行程度）
  - 入出力項目定義
    - APIで利用される項目を定義する。
    - 以下のテーブルヘッダー及びルールで記載する。
      | No | 項目（和名） | 項目（英名） | 種別 | データ型 | フォーマット | 最小桁数 | 最大桁数 | 必須 | デフォルト値 | 備考 |
      | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- |
      - No
        - 自動採番。1から昇順
      - 項目（和名）
        - APIで利用されるパラメータ名を日本語で記載。
        - 関連項目（同一の構造体・オブジェクト・リストの要素など）に属する場合は、上位項目の直下にインデント（`&nbsp;&nbsp;&nbsp;&nbsp;`）を入れて階層を明示すること。
      - 項目（英名）
        - APIで利用されるパラメータ名を英語で記載。
        - 関連項目（同一の構造体・オブジェクト・リストの要素など）に属する場合は、上位項目の直下にインデント（`&nbsp;&nbsp;&nbsp;&nbsp;`）を入れて階層を明示すること。
      - 種別
        - リクエストデータの場合、「入力」と記載。
        - レスポンスデータの場合、「出力」と記載。
      - データ型
        - 項目のデータ型を記載。
        - 以下を使用することを原則とする。
          | ドメイン | 説明 |
          | :--- | :--- |
          | string | 任意の文字列（全角・半角、日本語・英数字を含む） |
          | integer | 任意の数値（例：変数、数量など） |
          | boolean | 真偽を示す値（例0/1、true/false。ON/OFF） |
          | object | 複数のプロパティを持つ構造データ（例：JSON形式） |
          | array | 複数の値の集合（例：["A", "B", "C"]）
      - フォーマット
        - データの形式を記載する。不要なら空欄。
        - 任意の1文字を入力する場合は「*」を利用する。
        - 例：YYYY-MM-DD、メールアドレス、S***
      - 最小桁数
        - データの最小の桁数を記載する。不要なら空欄。
      - 最大桁数
        - データの最大の桁数を記載する。不要なら空欄。
      - 必須
        - 必須項目か記載する。
        - 必須項目である場合は「必須」、必須項目でない場合は「任意」
      - デフォルト値
        - パラメータが未入力・未取得時に設定されるデフォルト値。
        - デフォルト値が存在しない場合は、記載しない。
        - 例：`システム日付`、`0`
      - 備考
        - 特記事項を記載。
  - その他の項目定義
    - システム内部で利用される項目を定義する。
    - 以下のテーブルヘッダー及びルールで記載する。
      | No | 項目名 | ドメイン | 正常異常区分 | デフォルト値 | 備考 |
      | :----- | :----- | :----- | :----- | :----- | :----- |
      - No
        - 自動採番。1から昇順
      - 項目名
        - システム内部で利用される変数名や項目名。
        - 関連項目（同一の構造体・オブジェクト・リストの要素など）に属する場合は、上位項目の直下にインデント（`&nbsp;&nbsp;&nbsp;&nbsp;`）を入れて階層を明示すること
      - ドメイン
        - 項目のデータ型を記載。
        - 以下を使用することを原則とする。
          | ドメイン | 説明 |
          | :--- | :--- |
          | 文字 | 任意の文字列（全角・半角、日本語・英数字を含む） |
          | 整数 | 小数点を含まない数値（例：変数、数量など） |
          | 小数 | 小数点を含む数値（例：割合、面積など） |
          | フラグ | 真偽を示す値（例0/1、true/false。ON/OFF） |
          | 日付 | 年月日を表す値（例：2025/01/01） |
          | 時間 | 時・分・秒を表す値（例：14:30:00） |
          | 日時 | 日付と時間を組み合わせた値（例：2025/01/01/ 14:30:00） |
          | オブジェクト | 複数のプロパティを持つ構造データ（例：JSON形式） |
          | リスト | 複数の値の集合（例：["A", "B", "C"]）
          | ファイル | アップロード・ダウンロード対象のファイルデータ |
          | UUID | 一意の識別子（例：550e8400-e29b-41d4-a716-446655440000） |
      - 正常異常区分
        - 該当項目が主にどのシナリオで利用されるかを分類。
        - 以下の区分で記載する。
          | 区分 | 説明 |
          | :--- | :--- |
          | 正常系 | 通常の処理フローで使用 |
          | 異常系 | エラー処理や例外フローで使用 |
          | 共通 | 正常・異常両方で使用 |
      - デフォルト値
        - 初期に設定されるデフォルト値。
        - デフォルト値が存在しない場合は、記載しない。
        - 例：`システム日付`、`0`
      - 備考
        - 特記事項を記載。
  - イベント処理説明
    - イベント処理についての説明を記載。
    - 構成ルール
      - イベントごとに以下の順で記述する。
        ```markdawn
        #### 
        1. <処理ステップ名>
           - <対応する仕様書種別>に従い、<処理内容>を行う。
           - 【<仕様書種別> No.<番号>（<仕様書タイトル>）】

           - （※必要に応じて）補足処理や分岐処理も記述。
        ```
    - ステップルール
      - 処理番号と名称
        - 各イベントは番号付きステップで分けて記述（1.、2.、3....）
      - 処理内容の記述
        - 可能な限り「～に従い、～を行う」の形式で明示
        - 必ず該当仕様へのリンクを【】内に記述（不要の場合は、記載しない）
          例：【チェック仕様 No.1（単項目チェック）】
      - 分岐処理（エラー処理など）
        - ステップ内で必要に応じてインデントして記述
          - 例：
            ```markdown
            - エラー処理
              1. 編集仕様に従い、出力内容を編集し、処理を終了する。
                 【編集仕様 No.1（エラー出力）】
            ```
    - 命名・リンクルール
      | 要素 | 命名・記述ルール |
      | :--- | :--- |
      | 編集仕様 | 編集仕様 No.<番号>（<タイトル>） |
      | チェック仕様 | チェック仕様 No.<番号>（<タイトル>） |
      | テーブル更新仕様 | テーブル更新仕様 No.<番号>（<タイトル>） |
    - 補足ルール
      - 複数の仕様にまたがる場合は、各仕様へのリンクをそれぞれ記述。
      - ステップが複雑になる場合は、サブステップ（a.、b.など）や番号付き補足を使用して整理
  - 編集仕様
    - 入出力項目定義やその他の項目定義で定義した項目の編集内容を記載する。
    - 全体構成ルール
      - 以下の構成で記述する。
        ```markdown
        #### No.<連番>
        - 編集仕様名：<私用の日本語名称>
        - 関連する取得仕様名：<テーブル取得仕様 No.<番号>（取得仕様名）>
          | 項目名 | 編集内容 | 条件or前提 |
          | :--- | :--- | :--- |
          | <項目> | <内容> | <条件又は前提> |
        ```
    - 項目別記述ルール
      - 編集仕様No.
        - `No.`からはじめ、昇順で連番を付ける
      - 編集仕様名
        - 編集対象となる処理単位の日本語名を記述
      - 関連する取得仕様名
        - 編集仕様と関連する「テーブル取得仕様」のNo.と名称を対応付けて記述
        - 書式：`テーブル取得仕様 No.<番号>（<取得仕様名>）`
        - 関連する取得仕様が存在しない場合は、「-」と記述
    - 項目表のルール
      - 項目名
        - 編集対象の項目名を記載
        - 親子構造を明示するため、インデント（`&nbsp;&nbsp;&nbsp;&nbsp;`）を使って階層化
      - 編集内容
        - どのように編集するかを記載
        - 関連する取得仕様が存在し、その取得仕様の上を使用する場合は、以下のように記述して利用する。
          `<関連する取得仕様名>.<項目名>`
      - 条件or前提の記載ルール
        - 関連するフィルタ条件や結合条件などがある場合はここに記載
  - チェック仕様
    - 入出力項目定義やその他の項目定義で定義した項目等に対して、どのようなチェックを行い、エラーを出力するかを記載する。
    - 以下の構成で記述する
      ```markdown
      #### No.<連番>
      - チェック仕様：<チェックの名称>
      - 分類：<チェックの分類>
      - 取得元：<チェック対象の定義元（例：入出力項目定義）>
        | 項目名 | 区分 | チェック内容 | メッセージコード | メッセージ |
        | :--- | :--- | :--- | :--- | :--- |
        | <項目名> | <チェックの区分> | <エラー条件の記述> | <コード> | <エラーメッセージ> |
      ```
    - 項目別ルール
      - チェック仕様No.
        - `No.`から始めて昇順で付与
      - チェック仕様（名称）
        - チェックの目的を端的に表す名前を付ける
          例：`入力チェック`、`日付整合性チェック`
      - 分類
        - チェックの分類は、以下とする。
          | 分類 | 説明 |
          | :--- | :--- |
          | 単項目チェック | 項目単独で完結するチェック |
          | 相関項目チェック | 複数項目間の関係性を確認するチェック |
          | 特殊・システム系チェック | システムや外部リソースとの関係性を確認するチェック |
      - 取得元
        - チェック対象項目の定義場所を明記
    - チェック項目表の記述ルール
      - 項目名
        - チェック対象となる項目名
      - 区分
        - チェックの種別
        - 以下の区分を記載する
          | 分類 | 区分 | 説明 |
          | :--- | :--- | :--- |
          | 単項目チェック | 必須 | 入力値が未入力（NULLまたは空）出ないかをチェックする |
          | 単項目チェック | 桁数 | 入力値の文字数が指定の範囲内かをチェックする（最小・最大） |
          | 単項目チェック | 数値範囲 | 数値が指定範囲内に収まっているかをチェックする |
          | 単項目チェック | フォーマット | 特定の形式（正規表現など）に沿っているかをチェックする（例：メールアドレス、電話番号） |
          | 単項目チェック | 禁止文字 | 特定の文字（「,」「"」「'」など）が含まれていないかをチェックする |
          | 単項目チェック | 種別 | 入力値のデータ型が正しいかをチェックする（例：日付、整数、浮動小数など） |
          | 単項目チェック | 固定値 | 指定された定数またはコード値のみを受け入れるかをチェックする（例：選択肢） |
          | 相関項目チェック | 順序整合 | 日付・時間・数値などの前後関係をチェック（例：開始日≦終了日） |
          | 相関項目チェック | 一致 | 2項目の値が一致するかをチェックする（例：パスワードと確認用パスワード） |
          | 相関項目チェック | 排他 | 複数項目のうちいずれか一方のみが入力されているかをチェックする |
          | 相関項目チェック | 依存 | ある項目が入力されている場合、他の項目も必須になるチェック |
          | 相関項目チェック | 複合整合（特殊） | 組み合わせの整合性をチェック（例：ある選択肢と日付入力の組み合わせの制限） |
          | 特殊・システム系チェック | 重複チェック | 同一キーの値が既に存在しないか（主にDBチェック） |
          | 特殊・システム系チェック | 存在チェック | 入力された値がDB上に存在するか |
          | 特殊・システム系チェック | 排他制御 | 他ユーザーによる同時更新がないか（楽観ロック） |
          | 特殊・システム系チェック | 外部連携前チェック | 外部サービス連携前に必要な最低限の項目が揃っているか |
      - チェック内容
        - 条件付きの論知的なエラー判定文。明確な条件を書くこと
      - メッセージコード
        - エラーメッセージに対応する管理用コード
      - メッセージ
        - ユーザーに表示するエラー文。
        - プレースホルダを使用して汎用化、推奨。
  - テーブル取得仕様
    - DBからどのようなデータを取得するのかを記載する。
    - 以下の構成で記述する
      ```markdown
      #### No.<連番>
      - 取得仕様名：<取得仕様名>
      - テーブル名：<テーブル名>
        | 項目名 | 取得内容 | 補足 |
        | :--- | :--- | :--- |
        | <項目名> | <テーブル名>.<カラム名> | <補足> |
      - 関連する取得仕様
        - <関連する取得仕様>
      - 取得条件
        - <取得条件>
      - その他
        - <その他>
      ```
    - 項目別ルール
      - No.
        - 一意の連番。取得仕様単位で採番する
      - 取得仕様名
        - この取得仕様の名称
      - テーブル名
        - 取得対象となる主テーブル名
    - 項目表の記述ルール
      - 項目名
        - 出力結果で使用する項目名。
      - 取得内容
        - 実際のSQLにおける取得元（テーブル.カラム名）。
      - 補足
        - 特殊な変換処理、NULL対応、フォーマット変換などあれば記載。なければ空欄。
    - 関連情報の記述ルール
      - 関連する取得仕様
        - 連携する他の取得仕様があれば記載。なければ「なし」。
      - 取得条件
        - SQLのWHERE句に該当する条件。入力値や他の仕様との関係で定義される。なければ「なし」。
      - その他
        - 補足事項や注意点など。特に無ければ「なし」。
  - テーブル更新仕様
    - DBのどのデータを更新するのかを記載する。
    - 以下の構成で記述する
      ```markdown
      #### No.<連番>
      - 更新仕様名：<更新仕様名>
      - テーブル名：<テーブル名>
      - 種別：<種別>
        | 項目名 | 更新内容 | 補足 |
        | :--- | :--- | :--- |
        | <項目名> | <更新元の項目> | <補足> |
      - 関連する取得仕様
        - <関連する取得仕様>
      - 更新条件
        - <取得条件>
      - その他
        - <その他>
      ```
    - 項目別ルール
      - No.
        - 一意の連番。取得仕様単位で採番する
      - 取得仕様名
        - この更新仕様の目的を明示する名称
      - テーブル名
        - 更新対象となる主テーブル名
      - 種別
        - 操作の種類を明示（「登録」、「更新」、「削除」）
    - 項目表の記述ルール
      - 項目名
        - 更新対象の項目名。（テーブルのカラム名）
      - 更新内容
        - データの更新元（取得仕様などの参照元）
      - 補足
        - 特殊な条件や変換処理、対応関係の説明。なければ空欄。
    - 関連情報の記述ルール
      - 関連する取得仕様
        - 参照している取得仕様があれば記載。なければ「なし」。
      - 取得条件
        - SQLのWHERE句に該当する条件。主にキー項目に対して設定。なければ「なし」。
      - その他
        - 補足事項や注意点など。特に無ければ「なし」。
  - API利用仕様
    - API利用に関する内容を記載する。
    - 以下の構成で記述する。
      ```markdown
      #### No.<連番>
      - API仕様名：<API仕様名>
      - リクエスト
        | 項目名 | リクエスト内容 | 補足 |
        | :--- | :--- | :--- |
        | <項目名> | <リクエスト内容> | <補足> |
      - レスポンス
        | 項目名 | レスポンス内容 | 補足 |
        | :--- | :--- | :--- |
        | <項目名> | <レスポンス内容> | <補足> |
      - 関連する取得仕様
        - <関連する取得仕様>
      - その他
        - <その他>
      ```
    - 項目別ルール
      - No.
        - API私用の識別用連番。
      - API仕様名
        - 対象となるAPIの仕様名称。処理内容を簡潔に記述（例：ユーザー情報取得API）
      - リクエスト
        - APIに対して送信するパラメータの仕様。
        - 各項目の記述ルール
          - 項目名
            - 送信する項目の名称を記載。
          - リクエスト内容
            - 値の内容や参照元（例：入出力項目定義.氏名、固定値"1"など）。
          - 補足
            - バリデーション、形式、条件、備考などがあれば記載。なければ空欄。
      - レスポンス
        - APIの応答内容。
          - 項目名
            - 出力結果に使用する項目名を記載。
          - リクエスト内容
            - 値の内容を記載。
          - 補足
            - バリデーション、形式、条件、備考などがあれば記載。なければ空欄。
      - 関連する取得仕様
        - 参照している取得仕様があれば記載。なければ「なし」。
      - その他
        - 注意点や処理の補足など、特記事項があれば記載。なければ「なし」。
  - 補足説明
    - 全体を通しての補足など、特記事項があれば記載。
  - 変更履歴
    | 日付 | 変更内容 | 変更者 |
    | --- | --- | --- |
    | yyyy-mm-dd | 修正・追加内容を具体的に記載 | 開発者名 |

#### 2.2 サンプル
```markdown
# 顧客管理システム
# ユーザー情報登録

## 概要
本機能は、システムにユーザーの情報を登録するための機能です。
ユーザーのID、氏名、電話番号、所属グループ、権限、適用開始日、適用終了日の情報を登録することができます。
登録時には各種チェック（単項目、相関項目、ユーザー重複、グループ存在）を行います。

## 入出力項目定義
| No | 項目（和名） | 項目（英名） | 種別 | データ型 | フォーマット | 最小桁数 | 最大桁数 | 必須 | デフォルト値 | 備考 |
| :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- |
| 1 | ユーザーID | userId | 入力 | string | メールアドレス |  |  | 必須 |  | 変更するユーザーID（メールアドレス） |
| 2 | 氏名 | userName | 入力 | string |  | 1 | 20 | 必須 |  | 変更するユーザーの氏名 |
| 3 | 電話番号 | phoneNumber | 入力 | string | 電話番号 |  |  | 任意 | NULL | 変更するユーザーの電話番号 |
| 4 | グループID | groupID | 入力 | string | DP***** | 7 |  | 必須 |  | 変更するユーザーのグループID |
| 5 | 権限ID | authorityID | 入力 | string | AU***** | 7 |  | 必須 |  | 変更するユーザーの権限ID |
| 6 | 適用開始日 | enabledDate | 入力 | string | YYYY-MM-DD |  |  | 必須 |  | 変更するユーザーの適用開始日 |
| 7 | 適用終了日 | disabledDate | 入力 | string | YYYY-MM-DD |  |  | 必須 |  | 変更するユーザーの適用終了日 |
| 8 | ステータスコード | statusCode | 出力 | integer |  | 3 |  | 必須 | 200 | HTTPレスポンスのステータスコード |
| 9 | 結果コード | returnCode | 出力 | string |  | 6 |  | 必須 |  |  |
| 10 | 結果メッセージ | returnMessage | 出力 | string |  |  |  | 必須 |  |  |

## その他の項目定義
| No | 項目名 | ドメイン | 正常異常区分 | デフォルト値 | 備考 |
| :----- | :----- | :----- | :----- | :----- | :----- |
| 1 | 送信元メールアドレス | 文字 | 正常 |  | 登録ユーザーのパスワード発行時にメールを送信するための、メールアドレス。 |
| 2 | 仮パスワード | 文字 | 正常 |  | ランダムな12桁の文字列 |

## イベント処理説明

1. 単項目チェック
   - チェック仕様に従い、単項目チェックを行う。
   - 【チェック仕様 No.1（単項目チェック）】
     
     - エラー処理
       1. 編集仕様に従い、出力内容を編集し、処理を終了する。
          【編集仕様 No.1（単項目エラー出力）】

2. 相関項目チェック
   - チェック仕様に従い、相関項目チェックを行う。
   - 【チェック仕様 No.2（相関項目チェック）】

     - エラー処理
       1. 編集仕様に従い、出力内容を編集し、処理を終了する。
          【編集仕様 No.2（相関項目エラー出力）】

3. ユーザー重複チェック
   - チェック仕様に従い、ユーザー重複チェックを行う。
   - 【チェック仕様 No.3（ユーザー重複チェック）】

     - エラー処理
       1. 編集仕様に従い、出力内容を編集し、処理を終了する。
          【編集仕様 No.3（ユーザー重複エラー出力）】

4. グループ存在チェック
   - チェック仕様に従い、グループ存在チェックを行う。
   - 【チェック仕様 No.4（グループ存在チェック）】

     - エラー処理
       1. 編集仕様に従い、出力内容を編集し、処理を終了する。
          【編集仕様 No.4（グループ存在エラー出力）】

5. 権限存在チェック
   - チェック仕様に従い、権限チェックを行う。
   - 【チェック仕様 No.5（権限チェック）】

     - エラー処理
       1. 編集仕様に従い、出力内容を編集し、処理を終了する。
          【編集仕様 No.5（権限存在エラー出力）】

6. 仮パスワード生成
   - 編集仕様に従い、仮パスワード生成を行う。
   - 【編集仕様 No.6（仮パスワード生成）】

7. ユーザー情報登録
   - テーブル更新仕様に従い、ユーザー情報を登録する。
   - 【テーブル更新仕様 No.1（ユーザー情報更新）】

8. パスワードメール送信
   - 仮パスワードを、送信元メールアドレスからユーザーに対してメール送信をする。

9. 終了処理
   - 編集仕様に従い、出力情報を編集する。
   - 【編集仕様 No.7（正常処理）】

## 編集仕様

#### No.1
- 編集仕様名：単項目エラー出力
- 関連する取得仕様名：チェック仕様 No.1（単項目チェック）
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | ステータスコード | 400 |  |
  | 結果コード | 単項目チェック.メッセージコード |  |
  | 結果メッセージ | 単項目チェック.メッセージ |  |

#### No.2
- 編集仕様名：相関項目エラー出力
- 関連する取得仕様名：チェック仕様 No.2（相関項目チェック）
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | ステータスコード | 400 |  |
  | 結果コード | 単項目チェック.メッセージコード |  |
  | 結果メッセージ | 単項目チェック.メッセージ |  |

#### No.3
- 編集仕様名：ユーザー重複エラー出力
- 関連する取得仕様名：チェック仕様 No.3（ユーザー重複チェック）
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | ステータスコード | 400 |  |
  | 結果コード | 単項目チェック.メッセージコード |  |
  | 結果メッセージ | 単項目チェック.メッセージ |  |

#### No.4
- 編集仕様名：グループ存在エラー出力
- 関連する取得仕様名：チェック仕様 No.4（グループ存在チェック）
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | ステータスコード | 400 |  |
  | 結果コード | 単項目チェック.メッセージコード |  |
  | 結果メッセージ | 単項目チェック.メッセージ |  |

#### No.5
- 編集仕様名：権限存在エラー出力
- 関連する取得仕様名：チェック仕様 No.5（権限存在チェック）
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | ステータスコード | 400 |  |
  | 結果コード | 単項目チェック.メッセージコード |  |
  | 結果メッセージ | 単項目チェック.メッセージ |  |

#### No.6
- 編集仕様名：仮パスワード生成
- 関連する取得仕様名：-
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | 仮パスワード | 12桁の英数字及び記号 |  |

#### No.7
- 編集仕様名：正常処理
- 関連する取得仕様名：-
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | ステータスコード | 200 |  |
  | 結果コード | I00000 |  |
  | 結果メッセージ | 処理が完了しました。 |  |

## チェック仕様

#### No.1
- チェック仕様：単項目チェック
- 分類：単項目チェック
- 取得元：入出力項目定義
  | 項目名 | 区分 | チェック内容 | メッセージコード | メッセージ |
  | :--- | :--- | :--- | :--- | :--- |
  | ユーザーID | 必須 | ユーザーIDがNullの場合、エラー | E00001 | {0}は必須です。 |
  | ユーザーID | フォーマット | メールアドレスのフォーマットになっていない場合、エラー | E00012 | {0}の形式が異なります。 |
  | ユーザーID | 禁止文字 | ユーザーIDに「,」、「'」、「"」、「\n」、「\r\n」、「\t」が含まれている場合、エラー | E00026 | {0}は{1}を使用できません。 |
  | 氏名 | 必須 | 氏名がNullの場合、エラー | E00001 | {0}は必須です。 |
  | 氏名 | 桁数 | 氏名の桁数が0以下又は21文字以上の場合、エラー | E00006 | {0}は{1}以上{2}以下の文字で入力してください。 |
  | 氏名 | 禁止文字 | 氏名に「,」、「'」、「"」、「\n」、「\r\n」、「\t」が含まれている場合、エラー | E00026 | {0}は{1}を使用できません。 |
  | 電話番号 | フォーマット | 電話番号が存在し、電話番号のフォーマットになっていない場合、エラー | E00012 | {0}の形式が異なります。 |
  | グループID | 必須 | グループIDがNullの場合、エラー | E00001 | {0}は必須です。 |
  | グループID | フォーマット | グループIDのフォーマットが「DP*****」になっていない場合、エラー | E00012 | {0}の形式が異なります。 |
  | 権限ID | 必須 | 権限IDがNullの場合、エラー | E00001 | {0}は必須です。 |
  | 権限ID | フォーマット | 権限IDのフォーマットが「AU*****」になっていない場合、エラー | E00012 | {0}の形式が異なります。 |
  | 適用開始日 | 必須 | 適用開始日がNullの場合、エラー | E00001 | {0}は必須です。 |
  | 適用開始日 | フォーマット | 適用開始日のフォーマットが「YYYY-MM-DD」になっていない場合、エラー | E00012 | {0}の形式が異なります。 |
  | 適用終了日 | 必須 | 適用終了日がNullの場合、エラー | E00001 | {0}は必須です。 |
  | 適用終了日 | フォーマット | 適用終了日のフォーマットが「YYYY-MM-DD」になっていない場合、エラー | E00012 | {0}の形式が異なります。 |

#### No.2
- チェック仕様：相関項目チェック
- 分類：相関項目チェック
- 取得元：入出力項目定義
  | 項目名 | 区分 | チェック内容 | メッセージコード | メッセージ |
  | :--- | :--- | :--- | :--- | :--- |
  | 適用開始日 | 順序整合 | 「適用開始日 ≦ 適用終了日」を満たさない場合、エラー | E10002 | {0}が{1}より後の日付になっています。 |
  | 適用終了日 | 順序整合 | 「適用開始日 ≦ 適用終了日」を満たさない場合、エラー | E10002 | {0}が{1}より後の日付になっています。 |

#### No.3
- チェック仕様：ユーザー重複チェック
- 分類：特殊・システム系チェック
- 取得元：テーブル取得仕様 No.1（ユーザー件数取得）
  | 項目名 | 区分 | チェック内容 | メッセージコード | メッセージ |
  | :--- | :--- | :--- | :--- | :--- |
  | ユーザー件数取得.件数 | 重複チェック | 件数が1以上である場合、エラー | E10012 | 入力されたメールアドレスは既に登録されています。 |

#### No.4
- チェック仕様：グループ存在チェック
- 分類：特殊・システム系チェック
- 取得元：テーブル取得仕様 No.2（グループ件数取得）
  | 項目名 | 区分 | チェック内容 | メッセージコード | メッセージ |
  | :--- | :--- | :--- | :--- | :--- |
  | グループ件数取得.件数 | 存在チェック | 件数が0である場合、エラー | E10013 | 入力された{0}が存在しません。 |

#### No.5
- チェック仕様：権限存在チェック
- 分類：特殊・システム系チェック
- 取得元：テーブル取得仕様 No.3（権限件数取得）
  | 項目名 | 区分 | チェック内容 | メッセージコード | メッセージ |
  | :--- | :--- | :--- | :--- | :--- |
  | 権限件数取得.件数 | 存在チェック | 件数が0である場合、エラー | E10013 | 入力された{0}が存在しません。 |


## テーブル取得仕様

#### No.1
- 編集仕様名：ユーザー件数取得
- テーブル名：ユーザーマスタ
  | 項目名 | 取得内容 | 補足 |
  | :--- | :--- | :--- |
  | 件数 | ユーザーマスタ.件数 | ユーザーマスタから取得したユーザー情報の件数 |
- 関連する取得仕様
  - なし
- 取得条件
  - ユーザーマスタ.ユーザーID = ユーザーID
- その他
  - なし

#### No.2
- 編集仕様名：グループ件数取得
- テーブル名：グループマスタ
  | 項目名 | 取得内容 | 補足 |
  | :--- | :--- | :--- |
  | 件数 | グループマスタ.件数 | グループマスタから取得したグループ情報の件数 |
- 関連する取得仕様
  - なし
- 取得条件
  - グループマスタ.グループID = グループID
- その他
  - なし

#### No.3
- 編集仕様名：権限件数取得
- テーブル名：権限マスタ
  | 項目名 | 取得内容 | 補足 |
  | :--- | :--- | :--- |
  | 件数 | 権限マスタ.件数 | 権限マスタから取得した権限情報の件数 |
- 関連する取得仕様
  - なし
- 取得条件
  - 権限マスタ.権限ID = 権限ID
- その他
  - なし

## テーブル更新仕様

#### No.1
- 更新仕様名：ユーザー情報登録
- テーブル名：ユーザーマスタ
- 種別：登録
  | 項目名 | 更新内容 | 補足 |
  | :--- | :--- | :--- |
  | ユーザーID | 入出力項目定義.ユーザーID |  |
  | 氏名 | 入出力項目定義.氏名 |  |
  | 電話番号 | 入出力項目定義.電話番号 |  |
  | グループID | 入出力項目定義.グループID |  |
  | 権限ID | 入出力項目定義.権限ID |  |
  | パスワード | その他の項目定義.パスワード | 暗号化する |
  | 適用開始日 | 入出力項目定義.適用開始日 |  |
  | 適用終了日 | 入出力項目定義.適用終了日 |  |
- 関連する取得仕様
  - なし
- 更新条件
  - なし
- その他
  - なし

## API利用仕様

## 補足説明

## 変更履歴
| 日付 | 変更内容 | 変更者 |
| --- | --- | --- |
| 2024-03-20 | 初版作成 | dev_user01 |
```

### 3. 命名規則
- ファイル名はケバブケース（例：`user-registration.md`）
- 機能名は日本語と英語の併記を推奨

### 4. 更新ルール
1. 機能の追加・変更時は必ず一覧を更新
2. 変更履歴を記録
3. 関連する機能の参照も更新

### 5. レビュー基準
- 機能の定義が明確か
- 処理フローが適切に表現されているか
- セキュリティ要件が網羅されているか
- パフォーマンス要件が具体的か

- テスト項目が十分か