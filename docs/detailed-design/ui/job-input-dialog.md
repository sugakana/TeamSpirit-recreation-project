# TeamSpirit勤怠管理システム
# 工数実績入力画面

## 概要
本画面は、勤務表画面の工数列にある「+」アイコンを押下すると表示されるダイアログ形式の入力画面です。
自身にアサインされたタスク（ジョブ）に対して、1日の作業時間を入力・登録することができます。
作業時間はスライダーを操作して入力するか、テキストボックスに直接時間を手入力することができます。
手入力で時間を入力した場合、スライダーがその時間の位置まで自動的に連動して移動します。
入力した作業時間は合計時間にリアルタイムで反映され、実労働時間との差異を確認しながら入力できます。

## 画面レイアウト

### 参考画像

- 工数実績入力ダイアログ画面
  - （添付画像を参照）

## 画面項目定義

| No | 項目名 | 種別 | 入力タイプ | ドメイン | 最小桁数 | 最大桁数 | 表示文字数 | 表示形式 | 表示/非表示 | 活性/非活性 | 初期値 | 備考 |
| :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- |
| | <ヘッダー部分> | | | | | | | | | | | |
| 1 | タイトル | 出力 | | 文字 | | | | | 表示 | 活性 | 工数実績入力 | ダイアログのタイトル「工数実績入力」を表示 |
| 2 | 閉じるボタン | ボタン | | | | | | | 表示 | 活性 | | ダイアログを閉じる。「×」アイコン |
| 3 | 日付表示 | 出力 | | 文字 | | | | YYYY年MM月DD日X曜日 | 表示 | 活性 | | 対象日の日付を表示（例: 2025年12月9日火曜日） |
| 4 | 実労働時間ラベル | ラベル | | 文字 | | | | | 表示 | 活性 | 実労働時間 : | 実労働時間の項目ラベル |
| 5 | 実労働時間 | 出力 | | 時間 | | | 5 | H:MM | 表示 | 活性 | | 対象日の実労働時間を表示（例: 4:12）。実労働時間が確定していない場合は「（暫定）」が付与される |
| | <検索エリア> | | | | | | | | | | | |
| 6 | タスク列ヘッダー | ラベル | | 文字 | | | | | 表示 | 活性 | タスク | タスク列のヘッダーラベル |
| 7 | タスク検索ボタン | ボタン | | | | | | | 表示 | 活性 | | 虫眼鏡アイコン。タスク検索用（全件表示）ボタン |
| 8 | タスク検索テキスト | ラベル | | 文字 | | | | | 表示 | 活性 | (全件表示) | タスク検索ボタン横の説明テキスト |
| 9 | 作業時間・ボリューム列ヘッダー | ラベル | | 文字 | | | | | 表示 | 活性 | 作業時間・ボリューム | 作業時間・ボリューム列のヘッダーラベル |
| 10 | スケール目盛り | ラベル | | 文字 | | | | | 表示 | 活性 | 0 1 2 3 4 5 6 7 8 9 10 | 作業時間スライダーの目盛り表示（0〜10） |
| | <タスク一覧エリア> | | | | | | | | | | | |
| 11 | タスク一覧 | テーブル | | リスト | | | | | 表示 | 活性 | | アサイン済みタスクの一覧を表示 |
| 12 | &nbsp;&nbsp;&nbsp;&nbsp;タスク行 | テーブル行 | | オブジェクト | | | | | 表示 | 活性 | | 1つのタスクの入力行 |
| 13 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;行番号 | 出力 | | 整数 | | | | | 表示 | 活性 | | タスクの連番（1, 2, 3...） |
| 14 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;タスク名 | 出力 | | 文字 | | | 50 | | 表示 | 活性 | | タスク名を表示。ジョブコード + ジョブ名 + 予算コード等の情報を含む（例: ZXXXA2506B 人推_育成活動実施25152025-300／00X100 00X収益） |
| 15 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作業時間スライダー | 入力 | スライダー | 小数 | 0 | 10 | | | 表示 | 活性 | 0 | 作業時間を0〜10時間の範囲でスライダー操作で入力。0.25時間（15分）単位で入力可能 |
| 16 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作業時間入力 | 入力 | テキストボックス | 時間 | | 5 | 5 | H:MM | 表示 | 活性 | 0:00 | 作業時間を直接入力。入力するとスライダーが連動して移動する |
| 17 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;時計アイコン | ボタン | | | | | | | 表示 | 活性 | | 残り時間を自動入力するボタン。押下すると実労働時間から他のタスクの作業時間を引いた残り時間が自動で入力される |
| 18 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作業コードラベル | ラベル | | 文字 | | | | | 表示 | 活性 | 作業コード | 作業コード入力欄のラベル |
| 19 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作業コード | 入力 | テキストボックス | 文字 | | 50 | 20 | | 表示 | 活性 | | 作業コード（任意）を入力。作業の詳細分類に使用 |
| | <合計エリア> | | | | | | | | | | | |
| 20 | 合計ラベル | ラベル | | 文字 | | | | | 表示 | 活性 | 合計 | 合計時間の項目ラベル |
| 21 | 合計時間 | 出力 | | 時間 | | | 5 | H:MM | 表示 | 活性 | 0:00 | 全タスクの作業時間の合計を表示。入力するとリアルタイムで更新される |
| | <操作ボタンエリア> | | | | | | | | | | | |
| 22 | 登録ボタン | ボタン | | | | | | | 表示 | 活性 | | 入力内容を登録する。青色のボタン |
| 23 | キャンセルリンク | リンク | | | | | | | 表示 | 活性 | | 入力をキャンセルしてダイアログを閉じる |

## 入出力項目定義

| No | 項目名 | 種別 | 画面遷移 | ドメイン | 必須 | デフォルト値 | 備考 |
| :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- |
| 1 | 従業員ID | 入力 | 勤務表画面 | 文字 | 必須 | | ログイン中の従業員ID |
| 2 | 対象日付 | 入力 | 勤務表画面 | 日付 | 必須 | | 工数入力対象の日付（YYYY-MM-DD形式） |
| 3 | 実労働時間 | 入力 | 勤務表画面 | 小数 | 必須 | | 対象日の実労働時間（時間単位）。勤怠データから算出された値 |
| 4 | 実労働時間確定フラグ | 入力 | 勤務表画面 | フラグ | 必須 | FALSE | 実労働時間が確定済みかを示すフラグ。未確定の場合は（暫定）表示 |
| 5 | 更新完了フラグ | 出力 | 勤務表画面 | フラグ | 必須 | FALSE | 登録ボタン押下で更新が完了した場合にTRUE |

## その他の項目定義

| No | 項目名 | ドメイン | 正常異常区分 | デフォルト値 | 備考 |
| :----- | :----- | :----- | :----- | :----- | :----- |
| 1 | アサイン済みタスク一覧 | リスト | 正常 | | 対象従業員にアサインされているタスク一覧 |
| 2 | &nbsp;&nbsp;&nbsp;&nbsp;タスク情報 | オブジェクト | 正常 | | 1つのタスクの情報 |
| 3 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;タスクID | 文字 | 正常 | | JOB_ASSIGNMENT.JOB_ID |
| 4 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ジョブコード | 文字 | 正常 | | JOB_MASTER.JOB_CODE |
| 5 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ジョブ名 | 文字 | 正常 | | JOB_MASTER.JOB_NAME |
| 6 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;予算コード | 文字 | 正常 | | JOB_MASTER.BUDGET_CODE |
| 7 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;表示タスク名 | 文字 | 正常 | | 画面表示用に編集されたタスク名（ジョブコード + ジョブ名 + 予算コード等） |
| 8 | 工数実績一覧 | リスト | 正常 | | 対象日付の工数実績一覧 |
| 9 | &nbsp;&nbsp;&nbsp;&nbsp;工数実績情報 | オブジェクト | 正常 | | 1つの工数実績の情報 |
| 10 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;工数実績ID | 文字 | 正常 | | WORK_TIME_RECORD.RECORD_ID |
| 11 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;タスクID | 文字 | 正常 | | WORK_TIME_RECORD.JOB_ID |
| 12 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作業時間 | 小数 | 正常 | 0 | WORK_TIME_RECORD.WORK_HOURS（時間単位、0.25刻み） |
| 13 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作業コード | 文字 | 正常 | | WORK_TIME_RECORD.WORK_CODE |
| 14 | 入力データ一覧 | リスト | 正常 | | 画面上で入力された工数データの一時保持用 |
| 15 | &nbsp;&nbsp;&nbsp;&nbsp;入力データ | オブジェクト | 正常 | | 1つのタスクの入力データ |
| 16 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;タスクID | 文字 | 正常 | | 入力対象のタスクID |
| 17 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作業時間 | 小数 | 正常 | 0 | 入力された作業時間（時間単位） |
| 18 | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;作業コード | 文字 | 正常 | | 入力された作業コード |
| 19 | 合計作業時間 | 小数 | 正常 | 0 | 入力データ一覧の作業時間の合計 |
| 20 | 残り時間 | 小数 | 正常 | | 実労働時間 - 合計作業時間。時計アイコン押下時の自動入力に使用 |
| 21 | エラーメッセージ | 文字 | 異常 | | エラー時に表示するメッセージ |

## イベント処理説明

#### 名称：初期表示処理、英名：initializeDialog、処理タイミング：-

1. アサイン済みタスク取得
   - API利用仕様に従い、対象従業員にアサインされているタスク一覧を取得する。
   - 【API利用仕様 No.1（アサイン済みタスク取得API）】

2. 工数実績取得
   - API利用仕様に従い、対象日付の工数実績を取得する。
   - 【API利用仕様 No.2（工数実績取得API）】

3. 画面表示
   - 編集仕様に従い、画面を表示する。
   - 【編集仕様 No.1（初期画面表示）】

4. 合計時間算出
   - 編集仕様に従い、合計作業時間を算出して表示する。
   - 【編集仕様 No.2（合計時間算出）】

#### 名称：作業時間スライダー変更処理、英名：onSliderChange、処理タイミング：タスク一覧エリア.作業時間スライダー.変更

1. 作業時間入力欄更新
   - スライダーの値を作業時間入力欄にH:MM形式で反映する。
   - スライダーの値（0〜10）を時間に変換（例: 2.5 → 2:30）。

2. 入力データ更新
   - 入力データ一覧の該当タスクの作業時間を更新する。

3. 合計時間再算出
   - 編集仕様に従い、合計作業時間を再算出して表示する。
   - 【編集仕様 No.2（合計時間算出）】

#### 名称：作業時間入力変更処理、英名：onWorkTimeChange、処理タイミング：タスク一覧エリア.作業時間入力.変更

1. 入力チェック
   - チェック仕様に従い、入力値のフォーマットチェックを行う。
   - 【チェック仕様 No.1（作業時間フォーマットチェック）】
   
   - エラー処理
     1. 不正な値の場合、直前の値に戻す。

2. スライダー連動
   - 入力された時間をスライダーの位置に反映する。
   - 時間をスライダー値に変換（例: 2:30 → 2.5）。
   - 10時間を超える場合は、スライダーは最大位置（10）に設定する。

3. 入力データ更新
   - 入力データ一覧の該当タスクの作業時間を更新する。

4. 合計時間再算出
   - 編集仕様に従い、合計作業時間を再算出して表示する。
   - 【編集仕様 No.2（合計時間算出）】

#### 名称：時計アイコン押下処理、英名：onClockIconClick、処理タイミング：タスク一覧エリア.時計アイコン.押下

1. 残り時間算出
   - 編集仕様に従い、残り時間を算出する。
   - 【編集仕様 No.3（残り時間算出）】

2. 作業時間自動入力
   - 算出した残り時間を該当タスクの作業時間入力欄に設定する。
   - スライダーも連動して更新する。

3. 入力データ更新
   - 入力データ一覧の該当タスクの作業時間を更新する。

4. 合計時間再算出
   - 編集仕様に従い、合計作業時間を再算出して表示する。
   - 【編集仕様 No.2（合計時間算出）】

#### 名称：作業コード入力変更処理、英名：onWorkCodeChange、処理タイミング：タスク一覧エリア.作業コード.変更

1. 入力データ更新
   - 入力データ一覧の該当タスクの作業コードを更新する。

#### 名称：登録ボタン押下処理、英名：onRegisterClick、処理タイミング：操作ボタンエリア.登録ボタン.押下

1. 入力チェック
   - チェック仕様に従い、入力チェックを行う。
   - 【チェック仕様 No.2（工数実績入力チェック）】
   
   - エラー処理
     1. エラー内容を画面に表示させ、処理を終了する。

2. 工数実績登録
   - API利用仕様に従い、工数実績を登録する。
   - 【API利用仕様 No.3（工数実績登録API）】

3. 出力項目設定
   - 入出力項目定義.更新完了フラグをTRUEに設定する。

4. ダイアログ閉じる
   - ダイアログを閉じる。
   - 勤務表画面に戻り、工数列の表示が更新される。

#### 名称：キャンセルリンク押下処理、英名：onCancelClick、処理タイミング：操作ボタンエリア.キャンセルリンク.押下

1. ダイアログ閉じる
   - 入力内容を破棄してダイアログを閉じる。
   - 勤務表画面に戻る。

#### 名称：閉じるボタン押下処理、英名：onCloseButtonClick、処理タイミング：ヘッダー部分.閉じるボタン.押下

1. ダイアログ閉じる
   - 入力内容を破棄してダイアログを閉じる。
   - 勤務表画面に戻る。

#### 名称：タスク検索ボタン押下処理、英名：onSearchClick、処理タイミング：検索エリア.タスク検索ボタン.押下

1. タスク一覧表示
   - アサイン済みタスク一覧を全件表示する。
   - 既に全件表示されている場合は何もしない。

## 編集仕様

#### No.1
- 編集仕様名：初期画面表示
- 関連する取得仕様名：API利用仕様 No.1（アサイン済みタスク取得API）、API利用仕様 No.2（工数実績取得API）
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | タイトル | 「工数実績入力」 | |
  | 日付表示 | 入出力項目定義.対象日付をYYYY年MM月DD日X曜日形式で表示 | |
  | 実労働時間 | 入出力項目定義.実労働時間をH:MM形式で表示 | 入出力項目定義.実労働時間確定フラグがFALSEの場合は「（暫定）」を付与 |
  | タスク一覧 | アサイン済みタスク一覧をタスク行として表示 | |
  | &nbsp;&nbsp;&nbsp;&nbsp;行番号 | 1から連番で表示 | |
  | &nbsp;&nbsp;&nbsp;&nbsp;タスク名 | アサイン済みタスク一覧.表示タスク名 | |
  | &nbsp;&nbsp;&nbsp;&nbsp;作業時間スライダー | 工数実績一覧.作業時間をスライダー位置に変換（例: 2.5時間 → 位置2.5） | 工数実績が存在しない場合は0 |
  | &nbsp;&nbsp;&nbsp;&nbsp;作業時間入力 | 工数実績一覧.作業時間をH:MM形式で表示 | 工数実績が存在しない場合は「0:00」 |
  | &nbsp;&nbsp;&nbsp;&nbsp;作業コード | 工数実績一覧.作業コード | 工数実績が存在しない場合は空欄 |
  | 合計時間 | 全タスクの作業時間の合計をH:MM形式で表示 | |

#### No.2
- 編集仕様名：合計時間算出
- 関連する取得仕様名：-
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | 合計作業時間 | 入力データ一覧の全タスクの作業時間を合計 | |
  | 合計時間 | 合計作業時間をH:MM形式で表示 | |

#### No.3
- 編集仕様名：残り時間算出
- 関連する取得仕様名：-
  | 項目名 | 編集内容 | 条件or前提 |
  | :--- | :--- | :--- |
  | 残り時間 | 入出力項目定義.実労働時間 - （合計作業時間 - 該当タスクの作業時間） | |
  | 残り時間 | 残り時間が負の値の場合は0に設定 | |

## チェック仕様

#### No.1
- チェック仕様：作業時間フォーマットチェック
- 分類：単項目チェック
- 取得元：画面項目定義
  | 項目名 | 区分 | チェック内容 | メッセージコード | メッセージ |
  | :--- | :--- | :--- | :--- | :--- |
  | 作業時間入力 | フォーマット | 作業時間がH:MM形式でない場合、エラー | E_JOB_001 | 作業時間の形式が正しくありません。H:MM形式で入力してください。 |
  | 作業時間入力 | 数値範囲 | 作業時間が0:00未満の場合、エラー | E_JOB_002 | 作業時間は0:00以上で入力してください。 |
  | 作業時間入力 | 数値範囲 | 作業時間が24:00を超える場合、エラー | E_JOB_003 | 作業時間は24:00以下で入力してください。 |

#### No.2
- チェック仕様：工数実績入力チェック
- 分類：相関項目チェック
- 取得元：その他の項目定義
  | 項目名 | 区分 | チェック内容 | メッセージコード | メッセージ |
  | :--- | :--- | :--- | :--- | :--- |
  | 作業コード | 桁数 | 作業コードが50文字を超える場合、エラー | E_JOB_004 | 作業コードは50文字以内で入力してください。 |

## テーブル取得仕様

#### No.1
- 取得仕様名：アサイン済みタスク取得
- テーブル名：JOB_ASSIGNMENT
  | 項目名 | 取得内容 | 補足 |
  | :--- | :--- | :--- |
  | タスクID | JOB_ASSIGNMENT.JOB_ID | |
  | ジョブコード | JOB_MASTER.JOB_CODE | |
  | ジョブ名 | JOB_MASTER.JOB_NAME | |
  | 予算コード | JOB_MASTER.BUDGET_CODE | |
- 関連する取得仕様
  - なし
- 取得条件
  - JOB_ASSIGNMENT.EMPLOYEE_ID = 入出力項目定義.従業員ID
  - JOB_ASSIGNMENT.IS_ACTIVE = TRUE
  - JOB_MASTER.JOB_ID = JOB_ASSIGNMENT.JOB_ID
- その他
  - JOB_ASSIGNMENT.DISPLAY_ORDER, JOB_MASTER.JOB_CODEの昇順でソート

#### No.2
- 取得仕様名：工数実績取得
- テーブル名：WORK_TIME_RECORD
  | 項目名 | 取得内容 | 補足 |
  | :--- | :--- | :--- |
  | 工数実績ID | WORK_TIME_RECORD.RECORD_ID | |
  | タスクID | WORK_TIME_RECORD.JOB_ID | |
  | 作業時間 | WORK_TIME_RECORD.WORK_HOURS | 時間単位（小数） |
  | 作業コード | WORK_TIME_RECORD.WORK_CODE | |
- 関連する取得仕様
  - テーブル取得仕様 No.1（アサイン済みタスク取得）
- 取得条件
  - WORK_TIME_RECORD.EMPLOYEE_ID = 入出力項目定義.従業員ID
  - WORK_TIME_RECORD.WORK_DATE = 入出力項目定義.対象日付
- その他
  - なし

## テーブル更新仕様

#### No.1
- 更新仕様名：工数実績登録
- テーブル名：WORK_TIME_RECORD
- 種別：削除・登録
  | 項目名 | 更新内容 | 補足 |
  | :--- | :--- | :--- |
  | RECORD_ID | UUID生成 | 新規登録時に自動生成 |
  | EMPLOYEE_ID | 入出力項目定義.従業員ID | |
  | WORK_DATE | 入出力項目定義.対象日付 | |
  | JOB_ID | 入力データ一覧.タスクID | |
  | WORK_HOURS | 入力データ一覧.作業時間 | 時間単位（小数） |
  | WORK_CODE | 入力データ一覧.作業コード | |
  | CREATED_AT | 現在日時 | |
  | UPDATED_AT | 現在日時 | |
- 関連する取得仕様
  - なし
- 更新条件
  - 対象日付の既存工数実績を全て削除後、作業時間が0より大きいタスクのみ新規登録
- その他
  - トランザクション制御を行い、削除と登録を一括で実行

## API利用仕様

#### No.1
- API仕様名：アサイン済みタスク取得API
- リクエスト
  | 項目名 | リクエスト内容 | 補足 |
  | :--- | :--- | :--- |
  | HTTPメソッド | GET | |
  | エンドポイント | /api/jobs/assigned | |
  | EMPLOYEE_ID | 入出力項目定義.従業員ID | クエリパラメータ |
- レスポンス
  | 項目名 | レスポンス内容 | 補足 |
  | :--- | :--- | :--- |
  | アサイン済みタスク一覧 | タスク情報のリスト | JSON形式 |
  | &nbsp;&nbsp;&nbsp;&nbsp;タスクID | JOB_ASSIGNMENT.JOB_ID | |
  | &nbsp;&nbsp;&nbsp;&nbsp;ジョブコード | JOB_MASTER.JOB_CODE | |
  | &nbsp;&nbsp;&nbsp;&nbsp;ジョブ名 | JOB_MASTER.JOB_NAME | |
  | &nbsp;&nbsp;&nbsp;&nbsp;予算コード | JOB_MASTER.BUDGET_CODE | |
  | &nbsp;&nbsp;&nbsp;&nbsp;表示タスク名 | 編集済みのタスク名 | ジョブコード + ジョブ名 + 予算コード等を結合 |
- 関連する取得仕様
  - テーブル取得仕様 No.1（アサイン済みタスク取得）
- その他
  - IS_ACTIVE=TRUEのアサイン済みタスクをDISPLAY_ORDER順で取得

#### No.2
- API仕様名：工数実績取得API
- リクエスト
  | 項目名 | リクエスト内容 | 補足 |
  | :--- | :--- | :--- |
  | HTTPメソッド | GET | |
  | エンドポイント | /api/work-time/daily | |
  | EMPLOYEE_ID | 入出力項目定義.従業員ID | クエリパラメータ |
  | WORK_DATE | 入出力項目定義.対象日付 | クエリパラメータ、YYYY-MM-DD形式 |
- レスポンス
  | 項目名 | レスポンス内容 | 補足 |
  | :--- | :--- | :--- |
  | 工数実績一覧 | 工数実績情報のリスト | JSON形式 |
  | &nbsp;&nbsp;&nbsp;&nbsp;工数実績ID | WORK_TIME_RECORD.RECORD_ID | |
  | &nbsp;&nbsp;&nbsp;&nbsp;タスクID | WORK_TIME_RECORD.JOB_ID | |
  | &nbsp;&nbsp;&nbsp;&nbsp;作業時間 | WORK_TIME_RECORD.WORK_HOURS | 時間単位（小数） |
  | &nbsp;&nbsp;&nbsp;&nbsp;作業コード | WORK_TIME_RECORD.WORK_CODE | |
- 関連する取得仕様
  - テーブル取得仕様 No.2（工数実績取得）
- その他
  - なし

#### No.3
- API仕様名：工数実績登録API
- リクエスト
  | 項目名 | リクエスト内容 | 補足 |
  | :--- | :--- | :--- |
  | HTTPメソッド | PUT | |
  | エンドポイント | /api/work-time/daily | |
  | EMPLOYEE_ID | 入出力項目定義.従業員ID | リクエストボディ |
  | WORK_DATE | 入出力項目定義.対象日付 | リクエストボディ、YYYY-MM-DD形式 |
  | WORK_TIME_RECORDS | 工数実績リスト | リクエストボディ、配列形式 |
  | &nbsp;&nbsp;&nbsp;&nbsp;JOB_ID | タスクID | |
  | &nbsp;&nbsp;&nbsp;&nbsp;WORK_HOURS | 作業時間 | 時間単位（小数） |
  | &nbsp;&nbsp;&nbsp;&nbsp;WORK_CODE | 作業コード | |
- レスポンス
  | 項目名 | レスポンス内容 | 補足 |
  | :--- | :--- | :--- |
  | 成功フラグ | 成功/失敗 | true/false |
  | メッセージ | 処理結果メッセージ | |
- 関連する取得仕様
  - なし
- その他
  - テーブル更新仕様 No.1（工数実績登録）を実行
  - 既存データを削除後、作業時間が0より大きいレコードのみ新規登録

## 補足説明

### 勤務表画面からの連携
勤務表画面の工数列にある「+」アイコンを押下することで、本画面がダイアログ形式で表示されます。
対象日付は勤務表画面で選択された日付が渡されます。

### 作業時間の入力方法
作業時間は以下の2つの方法で入力できます：

1. **スライダー操作**
   - 0〜10時間の範囲で、0.25時間（15分）単位で入力可能です。
   - スライダーを操作すると、右側の作業時間入力欄にH:MM形式で時間が反映されます。

2. **直接入力**
   - 作業時間入力欄にH:MM形式で直接時間を入力できます。
   - 入力すると、左側のスライダーが連動して移動します。
   - 10時間を超える場合（例: 12:00）もテキストボックスには入力可能ですが、スライダーは最大位置（10）に設定されます。

### 時計アイコンの機能
各タスク行の右側にある時計アイコンを押下すると、実労働時間から他のタスクの作業時間を引いた「残り時間」が自動的に入力されます。

- **タスクが1つの場合**: 実労働時間がそのまま入力されます。
- **タスクが複数ある場合**: 最後のタスクで時計アイコンを押下すると、実労働時間から他のタスクの合計作業時間を引いた残り時間が入力されます。

### 合計時間のリアルタイム更新
作業時間を入力（スライダー操作または直接入力）すると、画面下部の「合計」欄がリアルタイムで更新されます。
これにより、実労働時間と合計作業時間の差異を確認しながら、正確に工数を入力できます。

### 入力方式の選択
画面の説明にある「時間で入力」と「ボリュームで入力」の選択により、スライダーの動作が異なります：

- **時間で入力**: メモリは時間を表し、0〜10時間を指定できます。10時間を超える場合は直接入力します。
- **ボリュームで入力**: メモリはボリュームを表し、0〜10段階を指定できます。勤怠が入力されていれば、その日の全ジョブのボリュームの相対比率で割り出した時間がセットされます。

### タスク名の表示形式
タスク名は以下の形式で表示されます：
`{ジョブコード} {ジョブ名}{予算コード}／{予算詳細}`

例: `ZXXXA2506B 人推_育成活動実施25152025-300／00X100 00X収益`

## 変更履歴

| 日付 | 変更内容 | 変更者 |
| --- | --- | --- |
| 2025-12-09 | 初版作成 | AI Assistant |