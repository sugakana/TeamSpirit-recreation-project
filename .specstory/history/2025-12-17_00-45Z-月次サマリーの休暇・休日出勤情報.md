<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session 1df8b524-11a5-4e30-883e-7c89cbd5f2f7 (2025-12-17 00:45Z) -->

# 月次サマリーの休暇・休日出勤情報 (2025-12-17 00:45Z)

_**User**_

月次サマリー情報画像にて休暇や休日出勤申請などに関する情報も記載してください。「イベント/勤務状況/勤務場所」に記載するようにしてください。画像のような感じです。また休日出勤の場合は、休日出勤、日次確定、在宅みたいな書き方になるかと思います。
まずは設計書から修正しましょう。Sequential Thinking MCPを活用してください。

---

_**Agent (model composer-1, mode Agent)**_



---


設計書を確認し、月次サマリー情報への休暇・休日出勤申請の追加を検討します。Sequential Thinking MCPで段階的に進めます。


---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** • Searched codebase "undefined" • **7** results in **1** directory</summary>

Directory: **undefined** (7 files)

| File |
|------|
| `.\.specstory\history\2025-12-15_13-02Z-申請取り消し処理の設計書.md` |
| `.\.specstory\history\2025-12-15_06-28Z-休日出勤申請の詳細設計書.md` |
| `.\.specstory\history\2025-12-12_13-49Z-mysqlテーブル設計の更新.md` |
| `.\.specstory\history\2025-12-11_23-43Z-月次サマリー情報画面の詳細設計書.md` |
| `.\.specstory\history\2025-12-09_04-55Z-工数実績入力ダイアログの詳細設計書作成.md` |
| `.\.specstory\history\2025-12-09_01-23Z-勤怠情報入力画面の詳細設計.md` |
| `.\.specstory\history\2025-12-08_07-44Z-勤怠申請画面の詳細設計書作成.md` |

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="mcp-sequential-thinking-user-sequential-thinking-sequentialthinking">
<details>
<summary>Tool use: **mcp-sequential-thinking-user-sequential-thinking-sequentialthinking**</summary>


Parameters:

```json
{
  "tools": [
    {
      "name": "sequentialthinking",
      "parameters": "{\"thought\":\"まず、現在のプロジェクト構造を理解する必要があります。設計書がどこにあるか、月次サマリー情報がどのように実装されているかを確認します。また、休暇や休日出勤申請のデータがどこから取得されるかも把握する必要があります。\",\"thoughtNumber\":1,\"totalThoughts\":8,\"nextThoughtNeeded\":true}",
      "serverName": "sequential-thinking"
    }
  ]
}
```
Additional data:

```json
{
  "status": "success"
}
```
Result:

```json
{
  "result": "{\"content\":[{\"type\":\"text\",\"text\":\"{\\n  \\\"thoughtNumber\\\": 1,\\n  \\\"totalThoughts\\\": 8,\\n  \\\"nextThoughtNeeded\\\": true,\\n  \\\"branches\\\": [],\\n  \\\"thoughtHistoryLength\\\": 1\\n}\"}]}"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** • Searched codebase "undefined" • **0** result in **1** directory</summary>

Directory: **undefined** (0 file)

</details>
</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="glob_file_search">
<details>
<summary>Tool use: **glob_file_search** • Searched codebase "undefined" • **3** results in **1** directory</summary>

Directory: **undefined** (3 files)

| File |
|------|
| `.\docs\detailed-design\ui\detailed-design-list.md` |
| `.\prompts\03_Detailed_Design\ui_detailed_design.md` |
| `.\prompts\03_Detailed_Design\api_detailed_design.md` |

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "月次サマリー情報の実装と表示方法",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\MonthlySummaryScreen.vue",
        "range": {
          "startPosition": {
            "line": 492
          },
          "endPosition": {
            "line": 551
          }
        },
        "contents": "  },\n  methods: {\n    async loadData(employeeId, yearMonth) {\n      this.loading = true\n      this.error = null\n      \n      try {\n        const response = await getMonthlySummaryDetail(employeeId, yearMonth)\n        \n        if (response.success) {\n          this.employee = response.employee\n          this.dailyData = response.dailyData || []\n          this.monthlySummary = response.monthlySummary || {}\n          this.vacationInfo = response.vacationInfo || {}\n          this.monthlyApprovalStatus = response.monthlyApprovalStatus || 'NOT_SUBMITTED'\n        } else {\n          this.error = response.message || 'データの取得に失敗しました。'\n        }\n      } catch (err) {\n        console.error('月次サマリー情報の取得エラー:', err)\n        this.error = err.message || 'データの取得に失敗しました。'\n      } finally {\n        this.loading = false\n      }\n    },\n    formatDate(dateStr, index) {\n      if (!dateStr) return ''\n      const date = new Date(dateStr)\n      // 最初の行だけ月を含める\n      if (index === 0) {\n        return &#96;${date.getMonth() + 1}/${date.getDate()}&#96;\n      }\n      return &#96;${date.getDate()}&#96;\n    },\n    getDatePaddingLeft(index, dateStr) {\n      // 最初の行の日付の1桁目の位置に合わせる\n      if (index === 0) return 0\n      \n      if (!dateStr) return 18\n      const date = new Date(dateStr)\n      const day = date.getDate()\n      \n      // 「12/」の幅を計算（フォントサイズ10px、文字数3文字分）\n      // 約18px程度の幅があると仮定\n      let baseOffset = 18\n      \n      // 2~9は4px左にずらす\n      if (day &gt;= 2 &amp;&amp; day &lt;= 9) {\n        baseOffset -= 4\n      }\n      // 10~31は9px左にずらす\n      if (day &gt;= 10 &amp;&amp; day &lt;= 31) {\n        baseOffset -= 9\n      }\n      \n      return baseOffset\n    },\n    getDayOfWeek(dateStr) {\n      if (!dateStr) return ''",
        "signatures": {},
        "detailedLines": [
          {
            "text": "  },",
            "lineNumber": 493
          },
          {
            "text": "  methods: {",
            "lineNumber": 494
          },
          {
            "text": "    async loadData(employeeId, yearMonth) {",
            "lineNumber": 495
          },
          {
            "text": "      this.loading = true",
            "lineNumber": 496
          },
          {
            "text": "      this.error = null",
            "lineNumber": 497
          },
          {
            "text": "      ",
            "lineNumber": 498
          },
          {
            "text": "      try {",
            "lineNumber": 499
          },
          {
            "text": "        const response = await getMonthlySummaryDetail(employeeId, yearMonth)",
            "lineNumber": 500
          },
          {
            "text": "        ",
            "lineNumber": 501
          },
          {
            "text": "        if (response.success) {",
            "lineNumber": 502
          },
          {
            "text": "          this.employee = response.employee",
            "lineNumber": 503
          },
          {
            "text": "          this.dailyData = response.dailyData || []",
            "lineNumber": 504
          },
          {
            "text": "          this.monthlySummary = response.monthlySummary || {}",
            "lineNumber": 505
          },
          {
            "text": "          this.vacationInfo = response.vacationInfo || {}",
            "lineNumber": 506
          },
          {
            "text": "          this.monthlyApprovalStatus = response.monthlyApprovalStatus || 'NOT_SUBMITTED'",
            "lineNumber": 507
          },
          {
            "text": "        } else {",
            "lineNumber": 508
          },
          {
            "text": "          this.error = response.message || 'データの取得に失敗しました。'",
            "lineNumber": 509
          },
          {
            "text": "        }",
            "lineNumber": 510
          },
          {
            "text": "      } catch (err) {",
            "lineNumber": 511
          },
          {
            "text": "        console.error('月次サマリー情報の取得エラー:', err)",
            "lineNumber": 512
          },
          {
            "text": "        this.error = err.message || 'データの取得に失敗しました。'",
            "lineNumber": 513
          },
          {
            "text": "      } finally {",
            "lineNumber": 514
          },
          {
            "text": "        this.loading = false",
            "lineNumber": 515
          },
          {
            "text": "      }",
            "lineNumber": 516
          },
          {
            "text": "    },",
            "lineNumber": 517
          },
          {
            "text": "    formatDate(dateStr, index) {",
            "lineNumber": 518
          },
          {
            "text": "      if (!dateStr) return ''",
            "lineNumber": 519
          },
          {
            "text": "      const date = new Date(dateStr)",
            "lineNumber": 520
          },
          {
            "text": "      // 最初の行だけ月を含める",
            "lineNumber": 521
          },
          {
            "text": "      if (index === 0) {",
            "lineNumber": 522
          },
          {
            "text": "        return &#96;${date.getMonth() + 1}/${date.getDate()}&#96;",
            "lineNumber": 523
          },
          {
            "text": "      }",
            "lineNumber": 524
          },
          {
            "text": "      return &#96;${date.getDate()}&#96;",
            "lineNumber": 525
          },
          {
            "text": "    },",
            "lineNumber": 526
          },
          {
            "text": "    getDatePaddingLeft(index, dateStr) {",
            "lineNumber": 527
          },
          {
            "text": "      // 最初の行の日付の1桁目の位置に合わせる",
            "lineNumber": 528
          },
          {
            "text": "      if (index === 0) return 0",
            "lineNumber": 529
          },
          {
            "text": "      ",
            "lineNumber": 530
          },
          {
            "text": "      if (!dateStr) return 18",
            "lineNumber": 531
          },
          {
            "text": "      const date = new Date(dateStr)",
            "lineNumber": 532
          },
          {
            "text": "      const day = date.getDate()",
            "lineNumber": 533
          },
          {
            "text": "      ",
            "lineNumber": 534
          },
          {
            "text": "      // 「12/」の幅を計算（フォントサイズ10px、文字数3文字分）",
            "lineNumber": 535
          },
          {
            "text": "      // 約18px程度の幅があると仮定",
            "lineNumber": 536
          },
          {
            "text": "      let baseOffset = 18",
            "lineNumber": 537
          },
          {
            "text": "      ",
            "lineNumber": 538
          },
          {
            "text": "      // 2~9は4px左にずらす",
            "lineNumber": 539
          },
          {
            "text": "      if (day &gt;= 2 &amp;&amp; day &lt;= 9) {",
            "lineNumber": 540
          },
          {
            "text": "        baseOffset -= 4",
            "lineNumber": 541
          },
          {
            "text": "      }",
            "lineNumber": 542
          },
          {
            "text": "      // 10~31は9px左にずらす",
            "lineNumber": 543
          },
          {
            "text": "      if (day &gt;= 10 &amp;&amp; day &lt;= 31) {",
            "lineNumber": 544
          },
          {
            "text": "        baseOffset -= 9",
            "lineNumber": 545
          },
          {
            "text": "      }",
            "lineNumber": 546
          },
          {
            "text": "      ",
            "lineNumber": 547
          },
          {
            "text": "      return baseOffset",
            "lineNumber": 548
          },
          {
            "text": "    },",
            "lineNumber": 549
          },
          {
            "text": "    getDayOfWeek(dateStr) {",
            "lineNumber": 550
          },
          {
            "text": "      if (!dateStr) return ''",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.43987464904785156
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\monthly-summary-screen.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 35
          }
        },
        "contents": "# TeamSpirit勤怠管理システム\n# 月次サマリー情報画面\n\n## 概要\n本画面は、月間の勤務表データを一覧表示し、月次の勤怠サマリー情報を表示する機能です。\n勤務表画面から「月次サマリー」リンクを押下することで、新規ウィンドウが開き、そのウィンドウに月次サマリー情報が記載されています。\n月間の日次勤務記録（出退勤時刻、休憩時間、実労働時間など）と、月次集計データ（所定出勤日数、実出勤日数、総労働時間、過不足時間など）を表示します。\n\n## 画面レイアウト\n\n### Figmaデザイン\n\n**月次サマリー情報画面のデザイン（Figma）**\n\nhttps://www.figma.com/design/OVw1Ofj7KB3O5zuj4NzLiu/%E7%84%A1%E9%A1%8C?node-id=5-1572&amp;t=RqArqbX2wGvNeiKv-4\n\n### 参考HTML\n\n以下のHTMLファイルは参考として掲載しています。正式なデザイン仕様は上記のFigmaを参照してください。\n\n- 月次サマリー情報画面（参考）\n\n![月次サマリー情報画面](../../figma-plugin/figma-json-split/monthly-report/monthly-report-full.html)\n\n## 画面項目定義\n\n| No | 項目名 | 種別 | 入力タイプ | ドメイン | 最小桁数 | 最大桁数 | 表示文字数 | 表示形式 | 表示/非表示 | 活性/非活性 | 初期値 | 備考 |\n| :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- |\n| | &lt;ヘッダー部分&gt; | | | | | | | | | | | |\n| 1 | プリンタへ出力ボタン | ボタン | | | | | | | 表示 | 活性 | | 青色のボタン。押下で印刷ダイアログを表示 |\n| 2 | 閉じるリンク | リンク | | | | | | | 表示 | 活性 | | 画面を閉じる |\n| | &lt;情報ヘッダー部分&gt; | | | | | | | | | | | |\n| 3 | 勤務表 | 出力 | | 文字 | | | | | 表示 | 活性 | 勤務表 | 固定表示 |\n| 4 | ステータス | 出力 | | 文字 | | | | | 表示 | 活性 | | 月次確定状態のラベル |\n| 5 | 対象年月 | 出力 | | 文字 | | | | YYYY年MM月 | 表示 | 活性 | | 表示対象の年月（例: 2025年11月） |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# TeamSpirit勤怠管理システム",
            "lineNumber": 1
          },
          {
            "text": "# 月次サマリー情報画面",
            "lineNumber": 2
          },
          {
            "lineNumber": 3
          },
          {
            "text": "## 概要",
            "lineNumber": 4
          },
          {
            "text": "本画面は、月間の勤務表データを一覧表示し、月次の勤怠サマリー情報を表示する機能です。",
            "lineNumber": 5
          },
          {
            "text": "勤務表画面から「月次サマリー」リンクを押下することで、新規ウィンドウが開き、そのウィンドウに月次サマリー情報が記載されています。",
            "lineNumber": 6
          },
          {
            "text": "月間の日次勤務記録（出退勤時刻、休憩時間、実労働時間など）と、月次集計データ（所定出勤日数、実出勤日数、総労働時間、過不足時間など）を表示します。",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "## 画面レイアウト",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "### Figmaデザイン",
            "lineNumber": 11
          },
          {
            "lineNumber": 12
          },
          {
            "text": "**月次サマリー情報画面のデザイン（Figma）**",
            "lineNumber": 13
          },
          {
            "lineNumber": 14
          },
          {
            "text": "https://www.figma.com/design/OVw1Ofj7KB3O5zuj4NzLiu/%E7%84%A1%E9%A1%8C?node-id=5-1572&amp;t=RqArqbX2wGvNeiKv-4",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "### 参考HTML",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "以下のHTMLファイルは参考として掲載しています。正式なデザイン仕様は上記のFigmaを参照してください。",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "- 月次サマリー情報画面（参考）",
            "lineNumber": 21
          },
          {
            "lineNumber": 22
          },
          {
            "text": "![月次サマリー情報画面](../../figma-plugin/figma-json-split/monthly-report/monthly-report-full.html)",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "## 画面項目定義",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "| No | 項目名 | 種別 | 入力タイプ | ドメイン | 最小桁数 | 最大桁数 | 表示文字数 | 表示形式 | 表示/非表示 | 活性/非活性 | 初期値 | 備考 |",
            "lineNumber": 27
          },
          {
            "text": "| :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- | :----- |",
            "lineNumber": 28
          },
          {
            "text": "| | &lt;ヘッダー部分&gt; | | | | | | | | | | | |",
            "lineNumber": 29
          },
          {
            "text": "| 1 | プリンタへ出力ボタン | ボタン | | | | | | | 表示 | 活性 | | 青色のボタン。押下で印刷ダイアログを表示 |",
            "lineNumber": 30
          },
          {
            "text": "| 2 | 閉じるリンク | リンク | | | | | | | 表示 | 活性 | | 画面を閉じる |",
            "lineNumber": 31
          },
          {
            "text": "| | &lt;情報ヘッダー部分&gt; | | | | | | | | | | | |",
            "lineNumber": 32
          },
          {
            "text": "| 3 | 勤務表 | 出力 | | 文字 | | | | | 表示 | 活性 | 勤務表 | 固定表示 |",
            "lineNumber": 33
          },
          {
            "text": "| 4 | ステータス | 出力 | | 文字 | | | | | 表示 | 活性 | | 月次確定状態のラベル |",
            "lineNumber": 34
          },
          {
            "text": "| 5 | 対象年月 | 出力 | | 文字 | | | | YYYY年MM月 | 表示 | 活性 | | 表示対象の年月（例: 2025年11月） |",
            "lineNumber": 35
          }
        ]
      },
      "score": 0.41272079944610596
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\monthly-summary-screen.md",
        "range": {
          "startPosition": {
            "line": 469
          },
          "endPosition": {
            "line": 497
          }
        },
        "contents": "### セクションごとの枠分けについて\n- 月次サマリー情報は、セクションごとに枠でグループ化されて表示されます。\n- **左カラム**:\n  - **Section 1**: 所定出勤日数、実出勤日数、法定休日出勤日数、所定休日出勤日数\n  - **Section 2**: 所定労働時間、総労働時間(有休を含む)、総労働時間-法定休日労働(有休を含む)、過不足時間\n  - **Section 3**: 当月度の超過時間、安全配慮上の超過時間\n- **中央カラム**:\n  - **Section 4**: 法定労働時間、実労働時間-法定休日労働(有休を含めない)、法定時間内残業、法定時間外残業、法定休日労働時間\n  - **Section 5**: 深夜労働時間、45時間を超える時間外労働、60時間を超える時間外労働\n  - **Section 6**: 遅刻回数・時間、早退回数・時間、コア時間内の私用外出回数・時間\n- **右カラム**:\n  - **Section 7**: 有給取得日数、[内訳]\n  - **Section 8**: 代休取得日数、[内訳]\n  - **Section 9**: 無給休暇日数、[内訳]\n  - **Section 10**: 有給残日数(月末日時点)、計画付与予定日（次月以降）\n\n### データの表示形式について\n- 時間の表示形式は、H:MM（例: 8:00）またはHHH:MM（例: 114:05）です。\n- 日数の表示形式は、「XX 日」（例: 18 日）です。\n- 過不足時間がマイナスの場合は赤色（#D9534F）で表示します。\n\n### 月次サマリーの計算について\n- 月次サマリーデータは、V_MONTHLY_ATTENDANCEビューを使用して取得します。\n- 一部の項目（法定休日出勤日数、所定休日出勤日数、45時間を超える時間外労働、60時間を超える時間外労働、遅刻回数・時間、早退回数・時間、コア時間内の私用外出回数・時間）は、ATTENDANCE_RECORDテーブルから別途集計する必要があります。\n\n### 遅刻回数・時間などの表示形式について\n- 遅刻回数・時間、早退回数・時間、コア時間内の私用外出回数・時間は、「XX回 XX:XX」形式で表示します（例: 0回 0:00）。",
        "signatures": {},
        "detailedLines": [
          {
            "text": "### セクションごとの枠分けについて",
            "lineNumber": 471
          },
          {
            "text": "- 月次サマリー情報は、セクションごとに枠でグループ化されて表示されます。",
            "lineNumber": 472
          },
          {
            "text": "- **左カラム**:",
            "lineNumber": 473
          },
          {
            "text": "  - **Section 1**: 所定出勤日数、実出勤日数、法定休日出勤日数、所定休日出勤日数",
            "lineNumber": 474
          },
          {
            "text": "  - **Section 2**: 所定労働時間、総労働時間(有休を含む)、総労働時間-法定休日労働(有休を含む)、過不足時間",
            "lineNumber": 475
          },
          {
            "text": "  - **Section 3**: 当月度の超過時間、安全配慮上の超過時間",
            "lineNumber": 476
          },
          {
            "text": "- **中央カラム**:",
            "lineNumber": 477
          },
          {
            "text": "  - **Section 4**: 法定労働時間、実労働時間-法定休日労働(有休を含めない)、法定時間内残業、法定時間外残業、法定休日労働時間",
            "lineNumber": 478
          },
          {
            "text": "  - **Section 5**: 深夜労働時間、45時間を超える時間外労働、60時間を超える時間外労働",
            "lineNumber": 479
          },
          {
            "text": "  - **Section 6**: 遅刻回数・時間、早退回数・時間、コア時間内の私用外出回数・時間",
            "lineNumber": 480
          },
          {
            "text": "- **右カラム**:",
            "lineNumber": 481
          },
          {
            "text": "  - **Section 7**: 有給取得日数、[内訳]",
            "lineNumber": 482
          },
          {
            "text": "  - **Section 8**: 代休取得日数、[内訳]",
            "lineNumber": 483
          },
          {
            "text": "  - **Section 9**: 無給休暇日数、[内訳]",
            "lineNumber": 484
          },
          {
            "text": "  - **Section 10**: 有給残日数(月末日時点)、計画付与予定日（次月以降）",
            "lineNumber": 485
          },
          {
            "lineNumber": 486
          },
          {
            "text": "### データの表示形式について",
            "lineNumber": 487
          },
          {
            "text": "- 時間の表示形式は、H:MM（例: 8:00）またはHHH:MM（例: 114:05）です。",
            "lineNumber": 488
          },
          {
            "text": "- 日数の表示形式は、「XX 日」（例: 18 日）です。",
            "lineNumber": 489
          },
          {
            "text": "- 過不足時間がマイナスの場合は赤色（#D9534F）で表示します。",
            "lineNumber": 490
          },
          {
            "lineNumber": 491
          },
          {
            "text": "### 月次サマリーの計算について",
            "lineNumber": 492
          },
          {
            "text": "- 月次サマリーデータは、V_MONTHLY_ATTENDANCEビューを使用して取得します。",
            "lineNumber": 493
          },
          {
            "text": "- 一部の項目（法定休日出勤日数、所定休日出勤日数、45時間を超える時間外労働、60時間を超える時間外労働、遅刻回数・時間、早退回数・時間、コア時間内の私用外出回数・時間）は、ATTENDANCE_RECORDテーブルから別途集計する必要があります。",
            "lineNumber": 494
          },
          {
            "lineNumber": 495
          },
          {
            "text": "### 遅刻回数・時間などの表示形式について",
            "lineNumber": 496
          },
          {
            "text": "- 遅刻回数・時間、早退回数・時間、コア時間内の私用外出回数・時間は、「XX回 XX:XX」形式で表示します（例: 0回 0:00）。",
            "lineNumber": 497
          }
        ]
      },
      "score": 0.4108220338821411
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 123,
            "column": 1
          },
          "endPosition": {
            "line": 144,
            "column": 3
          }
        },
        "contents": "/**\n * 月次サマリーを取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} year 年（YYYY形式）\n * @param {string} month 月（MM形式）\n * @returns {Promise&lt;Object&gt;} 月次サマリーデータ\n */\nexport async function getMonthlySummary(employeeId, year, month) {\n  const yearMonth = &#96;${year}-${month.padStart(2, '0')}&#96;\n  const endpoint = &#96;/monthly-summary/detail?employeeId=${employeeId}&amp;yearMonth=${yearMonth}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * 休暇情報を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @returns {Promise&lt;Object&gt;} 休暇情報データ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 126
          },
          {
            "text": " * 月次サマリーを取得する。",
            "lineNumber": 127
          },
          {
            "text": " *",
            "lineNumber": 128
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 129
          },
          {
            "text": " * @param {string} year 年（YYYY形式）",
            "lineNumber": 130
          },
          {
            "text": " * @param {string} month 月（MM形式）",
            "lineNumber": 131
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリーデータ",
            "lineNumber": 132
          },
          {
            "text": " */",
            "lineNumber": 133
          },
          {
            "text": "export async function getMonthlySummary(employeeId, year, month) {",
            "lineNumber": 134,
            "isSignature": true
          },
          {
            "text": "  const yearMonth = &#96;${year}-${month.padStart(2, '0')}&#96;",
            "lineNumber": 135
          },
          {
            "text": "  const endpoint = &#96;/monthly-summary/detail?employeeId=${employeeId}&amp;yearMonth=${yearMonth}&#96;",
            "lineNumber": 136
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 137
          },
          {
            "text": "}",
            "lineNumber": 138,
            "isSignature": true
          },
          {
            "lineNumber": 139
          },
          {
            "text": "/**",
            "lineNumber": 140
          },
          {
            "text": " * 休暇情報を取得する。",
            "lineNumber": 141
          },
          {
            "text": " *",
            "lineNumber": 142
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 143
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 休暇情報データ",
            "lineNumber": 144
          },
          {
            "text": " */",
            "lineNumber": 145
          }
        ]
      },
      "score": 0.397824764251709
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "/**\n * 月次サマリーサービス\n */\nconst employeeModel = require('../models/employeeModel');\nconst attendanceModel = require('../models/attendanceModel');\nconst breakTimeModel = require('../models/breakTimeModel');\nconst applicationModel = require('../models/applicationModel');\nconst masterModel = require('../models/masterModel');\nconst { \n  getMonthRange,\n  getScheduledWorkDays,\n  normalizeDate,\n  formatHours,\n  formatOverUnder,\n  calculateMinutes\n} = require('../utils/dateUtils');\nconst HolidayJp = require('@holiday-jp/holiday_jp');\nconst db = require('../config/database');\n\n/**\n * 月次サマリー情報を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} yearMonth - 対象年月（YYYY-MM形式）\n * @returns {Promise&lt;Object&gt;} 月次サマリー情報\n */\nconst getMonthlySummary = async (employeeId, yearMonth) =&gt; {\n  // 年月をパース\n  const [year, month] = yearMonth.split('-').map(Number);\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * 月次サマリーサービス",
            "lineNumber": 2
          },
          {
            "text": " */",
            "lineNumber": 3
          },
          {
            "text": "const employeeModel = require('../models/employeeModel');",
            "lineNumber": 4
          },
          {
            "text": "const attendanceModel = require('../models/attendanceModel');",
            "lineNumber": 5
          },
          {
            "text": "const breakTimeModel = require('../models/breakTimeModel');",
            "lineNumber": 6
          },
          {
            "text": "const applicationModel = require('../models/applicationModel');",
            "lineNumber": 7
          },
          {
            "text": "const masterModel = require('../models/masterModel');",
            "lineNumber": 8
          },
          {
            "text": "const { ",
            "lineNumber": 9
          },
          {
            "text": "  getMonthRange,",
            "lineNumber": 10
          },
          {
            "text": "  getScheduledWorkDays,",
            "lineNumber": 11
          },
          {
            "text": "  normalizeDate,",
            "lineNumber": 12
          },
          {
            "text": "  formatHours,",
            "lineNumber": 13
          },
          {
            "text": "  formatOverUnder,",
            "lineNumber": 14
          },
          {
            "text": "  calculateMinutes",
            "lineNumber": 15
          },
          {
            "text": "} = require('../utils/dateUtils');",
            "lineNumber": 16
          },
          {
            "text": "const HolidayJp = require('@holiday-jp/holiday_jp');",
            "lineNumber": 17
          },
          {
            "text": "const db = require('../config/database');",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "/**",
            "lineNumber": 20
          },
          {
            "text": " * 月次サマリー情報を取得",
            "lineNumber": 21
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 22
          },
          {
            "text": " * @param {string} yearMonth - 対象年月（YYYY-MM形式）",
            "lineNumber": 23
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリー情報",
            "lineNumber": 24
          },
          {
            "text": " */",
            "lineNumber": 25
          },
          {
            "text": "const getMonthlySummary = async (employeeId, yearMonth) =&gt; {",
            "lineNumber": 26
          },
          {
            "text": "  // 年月をパース",
            "lineNumber": 27
          },
          {
            "text": "  const [year, month] = yearMonth.split('-').map(Number);",
            "lineNumber": 28
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.39351990818977356
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 182,
            "column": 1
          },
          "endPosition": {
            "line": 203,
            "column": 3
          }
        },
        "contents": "/**\n * 月次サマリー情報を取得する（月次サマリー情報画面用）。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} yearMonth 対象年月（YYYY-MM形式）\n * @returns {Promise&lt;Object&gt;} 月次サマリー情報データ\n */\nexport async function getMonthlySummaryDetail(employeeId, yearMonth) {\n  const endpoint = &#96;/monthly-summary/detail?employeeId=${employeeId}&amp;yearMonth=${yearMonth}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * 申請状態を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請状態データ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 185
          },
          {
            "text": " * 月次サマリー情報を取得する（月次サマリー情報画面用）。",
            "lineNumber": 186
          },
          {
            "text": " *",
            "lineNumber": 187
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 188
          },
          {
            "text": " * @param {string} yearMonth 対象年月（YYYY-MM形式）",
            "lineNumber": 189
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリー情報データ",
            "lineNumber": 190
          },
          {
            "text": " */",
            "lineNumber": 191
          },
          {
            "text": "export async function getMonthlySummaryDetail(employeeId, yearMonth) {",
            "lineNumber": 192,
            "isSignature": true
          },
          {
            "text": "  const endpoint = &#96;/monthly-summary/detail?employeeId=${employeeId}&amp;yearMonth=${yearMonth}&#96;",
            "lineNumber": 193
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 194
          },
          {
            "text": "}",
            "lineNumber": 195,
            "isSignature": true
          },
          {
            "lineNumber": 196
          },
          {
            "text": "/**",
            "lineNumber": 197
          },
          {
            "text": " * 申請状態を取得する。",
            "lineNumber": 198
          },
          {
            "text": " *",
            "lineNumber": 199
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 200
          },
          {
            "text": " * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 201
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式）",
            "lineNumber": 202
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請状態データ",
            "lineNumber": 203
          },
          {
            "text": " */",
            "lineNumber": 204
          }
        ]
      },
      "score": 0.3857094943523407
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\masterService.js",
        "range": {
          "startPosition": {
            "line": 29,
            "column": 2
          },
          "endPosition": {
            "line": 77,
            "column": 19
          }
        },
        "contents": "/**\n * 月次サマリーを取得\n * @param {string} employeeId - 従業員ID\n * @param {number} year - 年\n * @param {number} month - 月\n * @returns {Promise&lt;Object&gt;} 月次サマリー\n */\nconst getMonthlySummary = async (employeeId, year, month) =&gt; {\n  const summary = await masterModel.getMonthlySummary(employeeId, year, month);\n  \n  if (!summary) {\n    return {\n      scheduledWorkDays: 0,\n      actualWorkDays: 0,\n      scheduledWorkHours: '0:00',\n      totalWorkHours: '0:00',\n      overUnderTime: '+0:00',\n      legalHolidayWork: '0:00',\n      withinLegalOvertime: '0:00',\n      overLegalOvertime: '0:00'\n    };\n  }\n  \n  return {\n    scheduledWorkDays: summary.SCHEDULED_WORK_DAYS || 0,\n    actualWorkDays: summary.ACTUAL_WORK_DAYS || 0,\n    scheduledWorkHours: formatHours(summary.SCHEDULED_WORK_HOURS),\n    totalWorkHours: formatHours(summary.TOTAL_WORK_HOURS),\n    overUnderTime: (() =&gt; {\n      let sign = '';\n\n      if (summary.OVER_UNDER_TIME &gt;= 0) {\n        sign = '+';\n      }\n\n      return &#96;${sign}${formatHours(Math.abs(summary.OVER_UNDER_TIME))}&#96;;\n    })(),\n    legalHolidayWork: formatHours(summary.LEGAL_HOLIDAY_WORK_HOURS),\n    withinLegalOvertime: formatHours(summary.WITHIN_LEGAL_OVERTIME_HOURS),\n    overLegalOvertime: formatHours(summary.OVER_LEGAL_OVERTIME_HOURS)\n  };\n};\n\nmodule.exports = {\n  getWorkLocations,\n  getJobs,\n  getVacationTypes,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 32
          },
          {
            "text": " * 月次サマリーを取得",
            "lineNumber": 33
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 34
          },
          {
            "text": " * @param {number} year - 年",
            "lineNumber": 35
          },
          {
            "text": " * @param {number} month - 月",
            "lineNumber": 36
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリー",
            "lineNumber": 37
          },
          {
            "text": " */",
            "lineNumber": 38
          },
          {
            "text": "const getMonthlySummary = async (employeeId, year, month) =&gt; {",
            "lineNumber": 39
          },
          {
            "text": "  const summary = await masterModel.getMonthlySummary(employeeId, year, month);",
            "lineNumber": 40
          },
          {
            "text": "  ",
            "lineNumber": 41
          },
          {
            "text": "  if (!summary) {",
            "lineNumber": 42
          },
          {
            "text": "    return {",
            "lineNumber": 43
          },
          {
            "text": "      scheduledWorkDays: 0,",
            "lineNumber": 44
          },
          {
            "text": "      actualWorkDays: 0,",
            "lineNumber": 45
          },
          {
            "text": "      scheduledWorkHours: '0:00',",
            "lineNumber": 46
          },
          {
            "text": "      totalWorkHours: '0:00',",
            "lineNumber": 47
          },
          {
            "text": "      overUnderTime: '+0:00',",
            "lineNumber": 48
          },
          {
            "text": "      legalHolidayWork: '0:00',",
            "lineNumber": 49
          },
          {
            "text": "      withinLegalOvertime: '0:00',",
            "lineNumber": 50
          },
          {
            "text": "      overLegalOvertime: '0:00'",
            "lineNumber": 51
          },
          {
            "text": "    };",
            "lineNumber": 52
          },
          {
            "text": "  }",
            "lineNumber": 53
          },
          {
            "text": "  ",
            "lineNumber": 54
          },
          {
            "text": "  return {",
            "lineNumber": 55
          },
          {
            "text": "    scheduledWorkDays: summary.SCHEDULED_WORK_DAYS || 0,",
            "lineNumber": 56
          },
          {
            "text": "    actualWorkDays: summary.ACTUAL_WORK_DAYS || 0,",
            "lineNumber": 57
          },
          {
            "text": "    scheduledWorkHours: formatHours(summary.SCHEDULED_WORK_HOURS),",
            "lineNumber": 58
          },
          {
            "text": "    totalWorkHours: formatHours(summary.TOTAL_WORK_HOURS),",
            "lineNumber": 59
          },
          {
            "text": "    overUnderTime: (() =&gt; {",
            "lineNumber": 60
          },
          {
            "text": "      let sign = '';",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "      if (summary.OVER_UNDER_TIME &gt;= 0) {",
            "lineNumber": 63
          },
          {
            "text": "        sign = '+';",
            "lineNumber": 64
          },
          {
            "text": "      }",
            "lineNumber": 65
          },
          {
            "lineNumber": 66
          },
          {
            "text": "      return &#96;${sign}${formatHours(Math.abs(summary.OVER_UNDER_TIME))}&#96;;",
            "lineNumber": 67
          },
          {
            "text": "    })(),",
            "lineNumber": 68
          },
          {
            "text": "    legalHolidayWork: formatHours(summary.LEGAL_HOLIDAY_WORK_HOURS),",
            "lineNumber": 69
          },
          {
            "text": "    withinLegalOvertime: formatHours(summary.WITHIN_LEGAL_OVERTIME_HOURS),",
            "lineNumber": 70
          },
          {
            "text": "    overLegalOvertime: formatHours(summary.OVER_LEGAL_OVERTIME_HOURS)",
            "lineNumber": 71
          },
          {
            "text": "  };",
            "lineNumber": 72
          },
          {
            "text": "};",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "module.exports = {",
            "lineNumber": 75
          },
          {
            "text": "  getWorkLocations,",
            "lineNumber": 76
          },
          {
            "text": "  getJobs,",
            "lineNumber": 77
          },
          {
            "text": "  getVacationTypes,",
            "lineNumber": 78
          }
        ]
      },
      "score": 0.38370436429977417
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\controllers\\monthlySummaryController.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 40,
            "column": 2
          }
        },
        "contents": "/**\n * 月次サマリーコントローラー\n */\nconst monthlySummaryService = require('../services/monthlySummaryService');\n\n/**\n * 月次サマリー情報取得\n */\nconst getMonthlySummary = async (req, res, next) =&gt; {\n  try {\n    const { employeeId, yearMonth } = req.query;\n    \n    if (!employeeId || !yearMonth) {\n      return res.status(400).json({\n        success: false,\n        message: '従業員IDと対象年月が必要です。'\n      });\n    }\n    \n    // 対象年月の形式チェック（YYYY-MM形式）\n    if (!/^\\d{4}-\\d{2}$/.test(yearMonth)) {\n      return res.status(400).json({\n        success: false,\n        message: '対象年月の形式が正しくありません。YYYY-MM形式で指定してください。'\n      });\n    }\n    \n    const result = await monthlySummaryService.getMonthlySummary(employeeId, yearMonth);\n    \n    res.json({\n      success: true,\n      ...result\n    });\n  } catch (error) {\n    next(error);\n  }\n};\n\nmodule.exports = {\n  getMonthlySummary\n};",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * 月次サマリーコントローラー",
            "lineNumber": 2
          },
          {
            "text": " */",
            "lineNumber": 3
          },
          {
            "text": "const monthlySummaryService = require('../services/monthlySummaryService');",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "/**",
            "lineNumber": 6
          },
          {
            "text": " * 月次サマリー情報取得",
            "lineNumber": 7
          },
          {
            "text": " */",
            "lineNumber": 8
          },
          {
            "text": "const getMonthlySummary = async (req, res, next) =&gt; {",
            "lineNumber": 9
          },
          {
            "text": "  try {",
            "lineNumber": 10
          },
          {
            "text": "    const { employeeId, yearMonth } = req.query;",
            "lineNumber": 11
          },
          {
            "text": "    ",
            "lineNumber": 12
          },
          {
            "text": "    if (!employeeId || !yearMonth) {",
            "lineNumber": 13
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 14
          },
          {
            "text": "        success: false,",
            "lineNumber": 15
          },
          {
            "text": "        message: '従業員IDと対象年月が必要です。'",
            "lineNumber": 16
          },
          {
            "text": "      });",
            "lineNumber": 17
          },
          {
            "text": "    }",
            "lineNumber": 18
          },
          {
            "text": "    ",
            "lineNumber": 19
          },
          {
            "text": "    // 対象年月の形式チェック（YYYY-MM形式）",
            "lineNumber": 20
          },
          {
            "text": "    if (!/^\\d{4}-\\d{2}$/.test(yearMonth)) {",
            "lineNumber": 21
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 22
          },
          {
            "text": "        success: false,",
            "lineNumber": 23
          },
          {
            "text": "        message: '対象年月の形式が正しくありません。YYYY-MM形式で指定してください。'",
            "lineNumber": 24
          },
          {
            "text": "      });",
            "lineNumber": 25
          },
          {
            "text": "    }",
            "lineNumber": 26
          },
          {
            "text": "    ",
            "lineNumber": 27
          },
          {
            "text": "    const result = await monthlySummaryService.getMonthlySummary(employeeId, yearMonth);",
            "lineNumber": 28
          },
          {
            "text": "    ",
            "lineNumber": 29
          },
          {
            "text": "    res.json({",
            "lineNumber": 30
          },
          {
            "text": "      success: true,",
            "lineNumber": 31
          },
          {
            "text": "      ...result",
            "lineNumber": 32
          },
          {
            "text": "    });",
            "lineNumber": 33
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 34
          },
          {
            "text": "    next(error);",
            "lineNumber": 35
          },
          {
            "text": "  }",
            "lineNumber": 36
          },
          {
            "text": "};",
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "module.exports = {",
            "lineNumber": 39
          },
          {
            "text": "  getMonthlySummary",
            "lineNumber": 40
          },
          {
            "text": "};",
            "lineNumber": 41
          }
        ]
      },
      "score": 0.37816110253334045
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-table-screen.md",
        "range": {
          "startPosition": {
            "line": 1133
          },
          "endPosition": {
            "line": 1159
          }
        },
        "contents": "1. **法定時間内残業**:\n   - 計算方法: 実作業時間 - 所定労働時間\n   - 表示できる時間の下限上限: 0:00 &lt;= time &lt;= (所定出勤日数 * 8:00) - 所定労働時間\n   - 所定労働時間（7.5h/日）を超えて法定労働時間（8h/日）以内の残業時間\n\n2. **法定時間外残業**:\n   - 計算方法: 実作業時間 - 所定出勤日数 * 8:00\n   - 清算期間の法定労働時間（所定出勤日数 * 8時間）を超えた部分の残業時間\n\n### 月次サマリーデータの表示\n画面下部に月間の集計データが表示されます：\n\n1. **所定出勤日数**: 月間の所定出勤日数（平日など、出勤予定の日数）\n2. **実出勤日数**: 実際に出勤した日数（出勤時刻と退勤時刻が両方記録されている日数）\n3. **所定労働時間**: 月間の所定労働時間（標準勤務時間: 9:00-17:30、所定労働7.5時間/日、例: 150:00）\n4. **総労働時間**: 月間の総労働時間（清算期間内の実労働時間の合計、例: 70:01）\n5. **過不足時間**: 過不足時間を+/-H:MM形式で表示（例: +2:31）\n   - 計算方法: 前日までの実作業時間 - (前日までの想定出勤日数 * 7:30)\n   - 正の値（プラス）: 所定労働時間より多く働いている → 翌清算期間に繰越可能\n   - 負の値（マイナス）: 所定労働時間より少ない → 賃金控除または翌清算期間から控除\n   - 計算基準日: 当日退勤済みの場合は当日まで、退勤していない場合は前日までの過不足時間を計算\n   - 画面表示時は「過不足時間（MM/DDまで）」のように計算基準日が表示されます\n6. **法定休日労働**: 法定休日（週1回の休日）に働いた時間（例: 0:00）\n7. **法定時間内残業**: 所定労働時間（7.5h/日）を超えて法定労働時間（8h/日）以内の残業時間（例: 0:00）\n   - 実作業時間が所定労働時間を超えている場合、その超過分のうち法定労働時間（所定出勤日数 * 8:00）以内の部分",
        "signatures": {},
        "detailedLines": [
          {
            "text": "1. **法定時間内残業**:",
            "lineNumber": 1135
          },
          {
            "text": "   - 計算方法: 実作業時間 - 所定労働時間",
            "lineNumber": 1136
          },
          {
            "text": "   - 表示できる時間の下限上限: 0:00 &lt;= time &lt;= (所定出勤日数 * 8:00) - 所定労働時間",
            "lineNumber": 1137
          },
          {
            "text": "   - 所定労働時間（7.5h/日）を超えて法定労働時間（8h/日）以内の残業時間",
            "lineNumber": 1138
          },
          {
            "lineNumber": 1139
          },
          {
            "text": "2. **法定時間外残業**:",
            "lineNumber": 1140
          },
          {
            "text": "   - 計算方法: 実作業時間 - 所定出勤日数 * 8:00",
            "lineNumber": 1141
          },
          {
            "text": "   - 清算期間の法定労働時間（所定出勤日数 * 8時間）を超えた部分の残業時間",
            "lineNumber": 1142
          },
          {
            "lineNumber": 1143
          },
          {
            "text": "### 月次サマリーデータの表示",
            "lineNumber": 1144
          },
          {
            "text": "画面下部に月間の集計データが表示されます：",
            "lineNumber": 1145
          },
          {
            "lineNumber": 1146
          },
          {
            "text": "1. **所定出勤日数**: 月間の所定出勤日数（平日など、出勤予定の日数）",
            "lineNumber": 1147
          },
          {
            "text": "2. **実出勤日数**: 実際に出勤した日数（出勤時刻と退勤時刻が両方記録されている日数）",
            "lineNumber": 1148
          },
          {
            "text": "3. **所定労働時間**: 月間の所定労働時間（標準勤務時間: 9:00-17:30、所定労働7.5時間/日、例: 150:00）",
            "lineNumber": 1149
          },
          {
            "text": "4. **総労働時間**: 月間の総労働時間（清算期間内の実労働時間の合計、例: 70:01）",
            "lineNumber": 1150
          },
          {
            "text": "5. **過不足時間**: 過不足時間を+/-H:MM形式で表示（例: +2:31）",
            "lineNumber": 1151
          },
          {
            "text": "   - 計算方法: 前日までの実作業時間 - (前日までの想定出勤日数 * 7:30)",
            "lineNumber": 1152
          },
          {
            "text": "   - 正の値（プラス）: 所定労働時間より多く働いている → 翌清算期間に繰越可能",
            "lineNumber": 1153
          },
          {
            "text": "   - 負の値（マイナス）: 所定労働時間より少ない → 賃金控除または翌清算期間から控除",
            "lineNumber": 1154
          },
          {
            "text": "   - 計算基準日: 当日退勤済みの場合は当日まで、退勤していない場合は前日までの過不足時間を計算",
            "lineNumber": 1155
          },
          {
            "text": "   - 画面表示時は「過不足時間（MM/DDまで）」のように計算基準日が表示されます",
            "lineNumber": 1156
          },
          {
            "text": "6. **法定休日労働**: 法定休日（週1回の休日）に働いた時間（例: 0:00）",
            "lineNumber": 1157
          },
          {
            "text": "7. **法定時間内残業**: 所定労働時間（7.5h/日）を超えて法定労働時間（8h/日）以内の残業時間（例: 0:00）",
            "lineNumber": 1158
          },
          {
            "text": "   - 実作業時間が所定労働時間を超えている場合、その超過分のうち法定労働時間（所定出勤日数 * 8:00）以内の部分",
            "lineNumber": 1159
          }
        ]
      },
      "score": 0.37715834379196167
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\masterModel.js",
        "range": {
          "startPosition": {
            "line": 88,
            "column": 2
          },
          "endPosition": {
            "line": 115,
            "column": 3
          }
        },
        "contents": "/**\n * 月次サマリーを取得\n * @param {string} employeeId - 従業員ID\n * @param {number} year - 年\n * @param {number} month - 月\n * @returns {Promise&lt;Object|null&gt;} 月次サマリー\n */\nconst getMonthlySummary = async (employeeId, year, month) =&gt; {\n  const query = &#96;\n    SELECT * FROM V_MONTHLY_ATTENDANCE \n    WHERE EMPLOYEE_ID = ? AND WORK_YEAR = ? AND WORK_MONTH = ?\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, year, month]);\n  if (rows.length &gt; 0) {\n    return rows[0];\n  }\n\n  return null;\n};\n\n/**\n * 休暇残日数サマリーを取得\n * @param {string} employeeId - 従業員ID\n * @returns {Promise&lt;Array&gt;} 休暇残日数の配列\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 91
          },
          {
            "text": " * 月次サマリーを取得",
            "lineNumber": 92
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 93
          },
          {
            "text": " * @param {number} year - 年",
            "lineNumber": 94
          },
          {
            "text": " * @param {number} month - 月",
            "lineNumber": 95
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 月次サマリー",
            "lineNumber": 96
          },
          {
            "text": " */",
            "lineNumber": 97
          },
          {
            "text": "const getMonthlySummary = async (employeeId, year, month) =&gt; {",
            "lineNumber": 98
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 99
          },
          {
            "text": "    SELECT * FROM V_MONTHLY_ATTENDANCE ",
            "lineNumber": 100
          },
          {
            "text": "    WHERE EMPLOYEE_ID = ? AND WORK_YEAR = ? AND WORK_MONTH = ?",
            "lineNumber": 101
          },
          {
            "text": "  &#96;;",
            "lineNumber": 102
          },
          {
            "text": "  ",
            "lineNumber": 103
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, year, month]);",
            "lineNumber": 104
          },
          {
            "text": "  if (rows.length &gt; 0) {",
            "lineNumber": 105
          },
          {
            "text": "    return rows[0];",
            "lineNumber": 106
          },
          {
            "text": "  }",
            "lineNumber": 107
          },
          {
            "lineNumber": 108
          },
          {
            "text": "  return null;",
            "lineNumber": 109
          },
          {
            "text": "};",
            "lineNumber": 110
          },
          {
            "lineNumber": 111
          },
          {
            "text": "/**",
            "lineNumber": 112
          },
          {
            "text": " * 休暇残日数サマリーを取得",
            "lineNumber": 113
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 114
          },
          {
            "text": " * @returns {Promise&lt;Array&gt;} 休暇残日数の配列",
            "lineNumber": 115
          },
          {
            "text": " */",
            "lineNumber": 116
          }
        ]
      },
      "score": 0.3761579096317291
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 420,
            "column": 2
          }
        },
        "contents": "const getMonthlySummary = async \n\n  \n  // 無給休暇日数（簡易的に0とする）\n  const unpaidLeaveDays = 0;\n  const unpaidLeaveTypeName = '';\n  \n  // 有給残日数（月末日時点）\n  const endOfMonth = new Date(year, month, 0);\n  const endOfMonthStr = endOfMonth.toISOString().split('T')[0];\n  const paidLeaveBalance = await applicationModel.getVacationBalance(employeeId, 'PAID_LEAVE');\n  \n  // 計画付与予定日（次月以降）\n  let nextMonth = { year, month: month + 1 };\n\n  if (month === 12) {\n    nextMonth = { year: year + 1, month: 1 };\n  }\n  const plannedGrantDays = 0; // TODO: 計画付与予定日を取得\n  \n  const vacationInfo = {\n    paidLeaveDays,\n    paidLeaveTypeName,\n    hourlyPaidLeaveHours,\n    substituteHolidayDays,\n    substituteHolidayTypeName,\n    unpaidLeaveDays,\n    unpaidLeaveTypeName,\n    paidLeaveBalance,\n    plannedGrantDays\n  };\n  \n  // 月次承認状態（簡易的にNOT_SUBMITTEDとする）\n  const monthlyApprovalStatus = 'NOT_SUBMITTED';\n  \n  return {\n    employee: {\n      employeeId: employee.EMPLOYEE_ID,\n      employeeName: employee.EMPLOYEE_NAME,\n      department: employee.DEPARTMENT,\n      attendanceSystem: 'フレックスタイム制(一般)'\n    },\n    yearMonth: yearMonth,\n    dailyData,\n    monthlySummary,\n    vacationInfo,\n    monthlyApprovalStatus\n  };\n};\n\nmodule.exports = {\n  getMonthlySummary\n};",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "lineNumber": 370
          },
          {
            "text": "  ",
            "lineNumber": 371
          },
          {
            "text": "  // 無給休暇日数（簡易的に0とする）",
            "lineNumber": 372
          },
          {
            "text": "  const unpaidLeaveDays = 0;",
            "lineNumber": 373
          },
          {
            "text": "  const unpaidLeaveTypeName = '';",
            "lineNumber": 374
          },
          {
            "text": "  ",
            "lineNumber": 375
          },
          {
            "text": "  // 有給残日数（月末日時点）",
            "lineNumber": 376
          },
          {
            "text": "  const endOfMonth = new Date(year, month, 0);",
            "lineNumber": 377
          },
          {
            "text": "  const endOfMonthStr = endOfMonth.toISOString().split('T')[0];",
            "lineNumber": 378
          },
          {
            "text": "  const paidLeaveBalance = await applicationModel.getVacationBalance(employeeId, 'PAID_LEAVE');",
            "lineNumber": 379
          },
          {
            "text": "  ",
            "lineNumber": 380
          },
          {
            "text": "  // 計画付与予定日（次月以降）",
            "lineNumber": 381
          },
          {
            "text": "  let nextMonth = { year, month: month + 1 };",
            "lineNumber": 382
          },
          {
            "lineNumber": 383
          },
          {
            "text": "  if (month === 12) {",
            "lineNumber": 384
          },
          {
            "text": "    nextMonth = { year: year + 1, month: 1 };",
            "lineNumber": 385
          },
          {
            "text": "  }",
            "lineNumber": 386
          },
          {
            "text": "  const plannedGrantDays = 0; // TODO: 計画付与予定日を取得",
            "lineNumber": 387
          },
          {
            "text": "  ",
            "lineNumber": 388
          },
          {
            "text": "  const vacationInfo = {",
            "lineNumber": 389
          },
          {
            "text": "    paidLeaveDays,",
            "lineNumber": 390
          },
          {
            "text": "    paidLeaveTypeName,",
            "lineNumber": 391
          },
          {
            "text": "    hourlyPaidLeaveHours,",
            "lineNumber": 392
          },
          {
            "text": "    substituteHolidayDays,",
            "lineNumber": 393
          },
          {
            "text": "    substituteHolidayTypeName,",
            "lineNumber": 394
          },
          {
            "text": "    unpaidLeaveDays,",
            "lineNumber": 395
          },
          {
            "text": "    unpaidLeaveTypeName,",
            "lineNumber": 396
          },
          {
            "text": "    paidLeaveBalance,",
            "lineNumber": 397
          },
          {
            "text": "    plannedGrantDays",
            "lineNumber": 398
          },
          {
            "text": "  };",
            "lineNumber": 399
          },
          {
            "text": "  ",
            "lineNumber": 400
          },
          {
            "text": "  // 月次承認状態（簡易的にNOT_SUBMITTEDとする）",
            "lineNumber": 401
          },
          {
            "text": "  const monthlyApprovalStatus = 'NOT_SUBMITTED';",
            "lineNumber": 402
          },
          {
            "text": "  ",
            "lineNumber": 403
          },
          {
            "text": "  return {",
            "lineNumber": 404
          },
          {
            "text": "    employee: {",
            "lineNumber": 405
          },
          {
            "text": "      employeeId: employee.EMPLOYEE_ID,",
            "lineNumber": 406
          },
          {
            "text": "      employeeName: employee.EMPLOYEE_NAME,",
            "lineNumber": 407
          },
          {
            "text": "      department: employee.DEPARTMENT,",
            "lineNumber": 408
          },
          {
            "text": "      attendanceSystem: 'フレックスタイム制(一般)'",
            "lineNumber": 409
          },
          {
            "text": "    },",
            "lineNumber": 410
          },
          {
            "text": "    yearMonth: yearMonth,",
            "lineNumber": 411
          },
          {
            "text": "    dailyData,",
            "lineNumber": 412
          },
          {
            "text": "    monthlySummary,",
            "lineNumber": 413
          },
          {
            "text": "    vacationInfo,",
            "lineNumber": 414
          },
          {
            "text": "    monthlyApprovalStatus",
            "lineNumber": 415
          },
          {
            "text": "  };",
            "lineNumber": 416
          },
          {
            "text": "};",
            "lineNumber": 417
          },
          {
            "lineNumber": 418
          },
          {
            "text": "module.exports = {",
            "lineNumber": 419
          },
          {
            "text": "  getMonthlySummary",
            "lineNumber": 420
          },
          {
            "text": "};",
            "lineNumber": 421
          }
        ]
      },
      "score": 0.376045286655426
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async  {\n  // 年月をパース\n  const [year, month] = yearMonth.split('-').map(Number);\n  const { startDate, endDate } = getMonthRange(year, month);\n  \n  // 1. 従業員情報取得\n  const employee = await employeeModel.getEmployeeById(employeeId);\n  if (!employee) {\n    throw new Error('従業員情報が見つかりません。');\n  }\n  \n  // 2. 月間勤務データ取得\n  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);\n  \n  // 休暇情報を取得\n  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);\n  \n  // 休暇種別マスタを取得（休暇種別名を取得するため）\n  const vacationTypes = await masterModel.getVacationTypes();\n  const vacationTypeMap = {};\n  for (const vt of vacationTypes) {\n    vacationTypeMap[vt.VACATION_TYPE_CODE] = vt.VACATION_TYPE_NAME;\n  }\n  \n  // 月間の全ての日付を生成（勤務記録がない日も含む）\n  const daysInMonth = new Date(year, month, 0).getDate();\n  const scheduledWorkDays = getScheduledWorkDays(year, month);\n  const monthlyScheduledWorkHours = scheduledWorkDays * 7.5;\n  const monthlyLegalWorkHours = scheduledWorkDays * 8;\n  \n  const dailyData = [];\n  let previousCumulativeWorkHours = 0;\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    \n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async  {",
            "lineNumber": 26
          },
          {
            "text": "  // 年月をパース",
            "lineNumber": 27
          },
          {
            "text": "  const [year, month] = yearMonth.split('-').map(Number);",
            "lineNumber": 28
          },
          {
            "text": "  const { startDate, endDate } = getMonthRange(year, month);",
            "lineNumber": 29
          },
          {
            "text": "  ",
            "lineNumber": 30
          },
          {
            "text": "  // 1. 従業員情報取得",
            "lineNumber": 31
          },
          {
            "text": "  const employee = await employeeModel.getEmployeeById(employeeId);",
            "lineNumber": 32
          },
          {
            "text": "  if (!employee) {",
            "lineNumber": 33
          },
          {
            "text": "    throw new Error('従業員情報が見つかりません。');",
            "lineNumber": 34
          },
          {
            "text": "  }",
            "lineNumber": 35
          },
          {
            "text": "  ",
            "lineNumber": 36
          },
          {
            "text": "  // 2. 月間勤務データ取得",
            "lineNumber": 37
          },
          {
            "text": "  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);",
            "lineNumber": 38
          },
          {
            "text": "  ",
            "lineNumber": 39
          },
          {
            "text": "  // 休暇情報を取得",
            "lineNumber": 40
          },
          {
            "text": "  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);",
            "lineNumber": 41
          },
          {
            "text": "  ",
            "lineNumber": 42
          },
          {
            "text": "  // 休暇種別マスタを取得（休暇種別名を取得するため）",
            "lineNumber": 43
          },
          {
            "text": "  const vacationTypes = await masterModel.getVacationTypes();",
            "lineNumber": 44
          },
          {
            "text": "  const vacationTypeMap = {};",
            "lineNumber": 45
          },
          {
            "text": "  for (const vt of vacationTypes) {",
            "lineNumber": 46
          },
          {
            "text": "    vacationTypeMap[vt.VACATION_TYPE_CODE] = vt.VACATION_TYPE_NAME;",
            "lineNumber": 47
          },
          {
            "text": "  }",
            "lineNumber": 48
          },
          {
            "text": "  ",
            "lineNumber": 49
          },
          {
            "text": "  // 月間の全ての日付を生成（勤務記録がない日も含む）",
            "lineNumber": 50
          },
          {
            "text": "  const daysInMonth = new Date(year, month, 0).getDate();",
            "lineNumber": 51
          },
          {
            "text": "  const scheduledWorkDays = getScheduledWorkDays(year, month);",
            "lineNumber": 52
          },
          {
            "text": "  const monthlyScheduledWorkHours = scheduledWorkDays * 7.5;",
            "lineNumber": 53
          },
          {
            "text": "  const monthlyLegalWorkHours = scheduledWorkDays * 8;",
            "lineNumber": 54
          },
          {
            "text": "  ",
            "lineNumber": 55
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 56
          },
          {
            "text": "  let previousCumulativeWorkHours = 0;",
            "lineNumber": 57
          },
          {
            "text": "  ",
            "lineNumber": 58
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 59
          },
          {
            "text": "    ",
            "lineNumber": 60
          },
          {
            "text": "  }",
            "lineNumber": 206
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.37453925609588623
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\TimesheetScreen.vue",
        "range": {
          "startPosition": {
            "line": 1000
          },
          "endPosition": {
            "line": 1041
          }
        },
        "contents": "    &lt;/div&gt;\n  &lt;/div&gt;\n  \n  &lt;!-- Bottom: 月次サマリー情報 --&gt;\n    &lt;div class=\"bottom-summary\"&gt;\n      &lt;!-- Group 6 (左側) --&gt;\n      &lt;div class=\"summary-group-left\"&gt;\n        &lt;!-- 背景 --&gt;\n        &lt;div class=\"summary-background-left\"&gt;&lt;/div&gt;\n        \n        &lt;!-- 所定出勤日数 --&gt;\n        &lt;span class=\"summary-label-left\" style=\"top: 4px;\"&gt;所定出勤日数&lt;/span&gt;\n        \n        &lt;!-- 実出勤日数 --&gt;\n        &lt;span class=\"summary-label-left\" style=\"top: 23px;\"&gt;実出勤日数&lt;/span&gt;\n        \n        &lt;!-- 所定労働時間 --&gt;\n        &lt;span class=\"summary-label-left\" style=\"top: 43px;\"&gt;所定労働時間&lt;/span&gt;\n        \n        &lt;!-- 総労働時間 --&gt;\n        &lt;span class=\"summary-label-left\" style=\"top: 63px;\"&gt;総労働時間&lt;/span&gt;\n        \n        &lt;!-- 縦線 --&gt;\n        &lt;div class=\"summary-divider-left\"&gt;&lt;/div&gt;\n        \n        &lt;!-- 所定出勤日数 --&gt;\n        &lt;span v-if=\"monthlySummary\" class=\"summary-value-left\" style=\"top: 4px; right: 14px;\"&gt;{{ monthlySummary.scheduledWorkDays }}日&lt;/span&gt;\n        \n        &lt;!-- 実出勤日数 --&gt;\n        &lt;span v-if=\"monthlySummary\" class=\"summary-value-left\" style=\"top: 23px; right: 14px;\"&gt;{{ monthlySummary.actualWorkDays }}日&lt;/span&gt;\n        \n        &lt;!-- 所定労働時間 --&gt;\n        &lt;span v-if=\"monthlySummary\" class=\"summary-value-left\" style=\"top: 46px; right: 14px;\"&gt;{{ monthlySummary.scheduledWorkHours }}&lt;/span&gt;\n        \n        &lt;!-- 総労働時間 --&gt;\n        &lt;span v-if=\"monthlySummary\" class=\"summary-value-left\" style=\"top: 66px; right: 14px;\"&gt;{{ monthlySummary.totalWorkHours }}&lt;/span&gt;\n      &lt;/div&gt;\n      \n      &lt;!-- Group 7 (右側) --&gt;\n      &lt;div class=\"summary-group-right\"&gt;\n        &lt;!-- 背景 --&gt;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 1001
          },
          {
            "text": "  &lt;/div&gt;",
            "lineNumber": 1002
          },
          {
            "text": "  ",
            "lineNumber": 1003
          },
          {
            "text": "  &lt;!-- Bottom: 月次サマリー情報 --&gt;",
            "lineNumber": 1004
          },
          {
            "text": "    &lt;div class=\"bottom-summary\"&gt;",
            "lineNumber": 1005
          },
          {
            "text": "      &lt;!-- Group 6 (左側) --&gt;",
            "lineNumber": 1006
          },
          {
            "text": "      &lt;div class=\"summary-group-left\"&gt;",
            "lineNumber": 1007
          },
          {
            "text": "        &lt;!-- 背景 --&gt;",
            "lineNumber": 1008
          },
          {
            "text": "        &lt;div class=\"summary-background-left\"&gt;&lt;/div&gt;",
            "lineNumber": 1009
          },
          {
            "text": "        ",
            "lineNumber": 1010
          },
          {
            "text": "        &lt;!-- 所定出勤日数 --&gt;",
            "lineNumber": 1011
          },
          {
            "text": "        &lt;span class=\"summary-label-left\" style=\"top: 4px;\"&gt;所定出勤日数&lt;/span&gt;",
            "lineNumber": 1012
          },
          {
            "text": "        ",
            "lineNumber": 1013
          },
          {
            "text": "        &lt;!-- 実出勤日数 --&gt;",
            "lineNumber": 1014
          },
          {
            "text": "        &lt;span class=\"summary-label-left\" style=\"top: 23px;\"&gt;実出勤日数&lt;/span&gt;",
            "lineNumber": 1015
          },
          {
            "text": "        ",
            "lineNumber": 1016
          },
          {
            "text": "        &lt;!-- 所定労働時間 --&gt;",
            "lineNumber": 1017
          },
          {
            "text": "        &lt;span class=\"summary-label-left\" style=\"top: 43px;\"&gt;所定労働時間&lt;/span&gt;",
            "lineNumber": 1018
          },
          {
            "text": "        ",
            "lineNumber": 1019
          },
          {
            "text": "        &lt;!-- 総労働時間 --&gt;",
            "lineNumber": 1020
          },
          {
            "text": "        &lt;span class=\"summary-label-left\" style=\"top: 63px;\"&gt;総労働時間&lt;/span&gt;",
            "lineNumber": 1021
          },
          {
            "text": "        ",
            "lineNumber": 1022
          },
          {
            "text": "        &lt;!-- 縦線 --&gt;",
            "lineNumber": 1023
          },
          {
            "text": "        &lt;div class=\"summary-divider-left\"&gt;&lt;/div&gt;",
            "lineNumber": 1024
          },
          {
            "text": "        ",
            "lineNumber": 1025
          },
          {
            "text": "        &lt;!-- 所定出勤日数 --&gt;",
            "lineNumber": 1026
          },
          {
            "text": "        &lt;span v-if=\"monthlySummary\" class=\"summary-value-left\" style=\"top: 4px; right: 14px;\"&gt;{{ monthlySummary.scheduledWorkDays }}日&lt;/span&gt;",
            "lineNumber": 1027
          },
          {
            "text": "        ",
            "lineNumber": 1028
          },
          {
            "text": "        &lt;!-- 実出勤日数 --&gt;",
            "lineNumber": 1029
          },
          {
            "text": "        &lt;span v-if=\"monthlySummary\" class=\"summary-value-left\" style=\"top: 23px; right: 14px;\"&gt;{{ monthlySummary.actualWorkDays }}日&lt;/span&gt;",
            "lineNumber": 1030
          },
          {
            "text": "        ",
            "lineNumber": 1031
          },
          {
            "text": "        &lt;!-- 所定労働時間 --&gt;",
            "lineNumber": 1032
          },
          {
            "text": "        &lt;span v-if=\"monthlySummary\" class=\"summary-value-left\" style=\"top: 46px; right: 14px;\"&gt;{{ monthlySummary.scheduledWorkHours }}&lt;/span&gt;",
            "lineNumber": 1033
          },
          {
            "text": "        ",
            "lineNumber": 1034
          },
          {
            "text": "        &lt;!-- 総労働時間 --&gt;",
            "lineNumber": 1035
          },
          {
            "text": "        &lt;span v-if=\"monthlySummary\" class=\"summary-value-left\" style=\"top: 66px; right: 14px;\"&gt;{{ monthlySummary.totalWorkHours }}&lt;/span&gt;",
            "lineNumber": 1036
          },
          {
            "text": "      &lt;/div&gt;",
            "lineNumber": 1037
          },
          {
            "text": "      ",
            "lineNumber": 1038
          },
          {
            "text": "      &lt;!-- Group 7 (右側) --&gt;",
            "lineNumber": 1039
          },
          {
            "text": "      &lt;div class=\"summary-group-right\"&gt;",
            "lineNumber": 1040
          },
          {
            "text": "        &lt;!-- 背景 --&gt;",
            "lineNumber": 1041
          }
        ]
      },
      "score": 0.37422069907188416
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\controllers\\masterController.js",
        "range": {
          "startPosition": {
            "line": 52,
            "column": 2
          },
          "endPosition": {
            "line": 86,
            "column": 19
          }
        },
        "contents": "/**\n * 月次サマリー取得\n */\nconst getMonthlySummary = async (req, res, next) =&gt; {\n  try {\n    const { employeeId, year, month } = req.query;\n    \n    if (!employeeId || !year || !month) {\n      return res.status(400).json({\n        success: false,\n        message: '従業員ID、年、月が必要です。'\n      });\n    }\n    \n    const summary = await masterService.getMonthlySummary(\n      employeeId,\n      parseInt(year),\n      parseInt(month)\n    );\n    \n    res.json({\n      success: true,\n      summary\n    });\n  } catch (error) {\n    next(error);\n  }\n};\n\nmodule.exports = {\n  getWorkLocations,\n  getJobs,\n  getVacationTypes,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 55
          },
          {
            "text": " * 月次サマリー取得",
            "lineNumber": 56
          },
          {
            "text": " */",
            "lineNumber": 57
          },
          {
            "text": "const getMonthlySummary = async (req, res, next) =&gt; {",
            "lineNumber": 58
          },
          {
            "text": "  try {",
            "lineNumber": 59
          },
          {
            "text": "    const { employeeId, year, month } = req.query;",
            "lineNumber": 60
          },
          {
            "text": "    ",
            "lineNumber": 61
          },
          {
            "text": "    if (!employeeId || !year || !month) {",
            "lineNumber": 62
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 63
          },
          {
            "text": "        success: false,",
            "lineNumber": 64
          },
          {
            "text": "        message: '従業員ID、年、月が必要です。'",
            "lineNumber": 65
          },
          {
            "text": "      });",
            "lineNumber": 66
          },
          {
            "text": "    }",
            "lineNumber": 67
          },
          {
            "text": "    ",
            "lineNumber": 68
          },
          {
            "text": "    const summary = await masterService.getMonthlySummary(",
            "lineNumber": 69
          },
          {
            "text": "      employeeId,",
            "lineNumber": 70
          },
          {
            "text": "      parseInt(year),",
            "lineNumber": 71
          },
          {
            "text": "      parseInt(month)",
            "lineNumber": 72
          },
          {
            "text": "    );",
            "lineNumber": 73
          },
          {
            "text": "    ",
            "lineNumber": 74
          },
          {
            "text": "    res.json({",
            "lineNumber": 75
          },
          {
            "text": "      success: true,",
            "lineNumber": 76
          },
          {
            "text": "      summary",
            "lineNumber": 77
          },
          {
            "text": "    });",
            "lineNumber": 78
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 79
          },
          {
            "text": "    next(error);",
            "lineNumber": 80
          },
          {
            "text": "  }",
            "lineNumber": 81
          },
          {
            "text": "};",
            "lineNumber": 82
          },
          {
            "lineNumber": 83
          },
          {
            "text": "module.exports = {",
            "lineNumber": 84
          },
          {
            "text": "  getWorkLocations,",
            "lineNumber": 85
          },
          {
            "text": "  getJobs,",
            "lineNumber": 86
          },
          {
            "text": "  getVacationTypes,",
            "lineNumber": 87
          }
        ]
      },
      "score": 0.36493009328842163
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async \n\n  \n  const monthlySummary = {\n    scheduledWorkDays,\n    actualWorkDays,\n    legalHolidayWorkDays,\n    scheduledHolidayWorkDays,\n    scheduledWorkHours,\n    totalWorkHours,\n    totalWorkHoursExcludingLegalHoliday,\n    overUnderHours,\n    currentMonthOvertime,\n    safetyOvertime,\n    legalWorkHours,\n    actualWorkHoursExcludingLegalHoliday,\n    withinLegalOvertime,\n    overLegalOvertime,\n    legalHolidayWorkHours,\n    nightWorkHours,\n    overtimeOver45Hours,\n    overtimeOver60Hours,\n    lateCount,\n    lateHours,\n    earlyLeaveCount,\n    earlyLeaveHours,\n    privateOutingCount,\n    privateOutingHours,\n    totalBreakHours\n  };\n  \n  // 4. 休暇情報取得（月次サマリー用の集計）\n  // 有給取得日数\n  const paidLeaveDays = vacations\n    .filter(v =&gt; v.VACATION_TYPE_CODE === 'PAID_LEAVE' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED')\n    .reduce((sum, v) =&gt; sum + (parseFloat(v.VACATION_DAYS) || 0), 0);\n  \n  // 有給取得日数内訳\n  let paidLeaveTypeName = '';\n\n  if (paidLeaveDays &gt; 0) {\n    paidLeaveTypeName = '年次有給休暇';\n  }\n\n  // 時間単位有休取得時間（VACATION_DAYSが1未満の有給休暇を時間単位として集計）\n  const hourlyPaidLeaveHours = vacations\n    .filter(v =&gt; v.VACATION_TYPE_CODE === 'PAID_LEAVE' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED' &amp;&amp; parseFloat(v.VACATION_DAYS) &lt; 1)\n    .reduce((sum, v) =&gt; {\n      // VACATION_DAYSが1未満の場合、時間単位として扱う（例：0.5日 = 4時間）\n      const days = parseFloat(v.VACATION_DAYS) || 0;\n      // 1日 = 8時間として計算\n      return sum + (days * 8);\n    }, 0);\n\n  // 代休取得日数\n  const substituteHolidayDays = vacations\n    .filter(v =&gt; v.VACATION_TYPE_CODE === 'SUBSTITUTE_HOLIDAY' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED')\n    .reduce((sum, v) =&gt; sum + (parseFloat(v.VACATION_DAYS) || 0), 0);\n\n  // 代休取得日数内訳\n  let substituteHolidayTypeName = '';\n\n  if (substituteHolidayDays &gt; 0) {\n    substituteHolidayTypeName = '代休';\n  }\n  \n  // 無給休暇日数（簡易的に0とする）\n  const unpaidLeaveDays = 0;\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "lineNumber": 307
          },
          {
            "text": "  ",
            "lineNumber": 308
          },
          {
            "text": "  const monthlySummary = {",
            "lineNumber": 309
          },
          {
            "text": "    scheduledWorkDays,",
            "lineNumber": 310
          },
          {
            "text": "    actualWorkDays,",
            "lineNumber": 311
          },
          {
            "text": "    legalHolidayWorkDays,",
            "lineNumber": 312
          },
          {
            "text": "    scheduledHolidayWorkDays,",
            "lineNumber": 313
          },
          {
            "text": "    scheduledWorkHours,",
            "lineNumber": 314
          },
          {
            "text": "    totalWorkHours,",
            "lineNumber": 315
          },
          {
            "text": "    totalWorkHoursExcludingLegalHoliday,",
            "lineNumber": 316
          },
          {
            "text": "    overUnderHours,",
            "lineNumber": 317
          },
          {
            "text": "    currentMonthOvertime,",
            "lineNumber": 318
          },
          {
            "text": "    safetyOvertime,",
            "lineNumber": 319
          },
          {
            "text": "    legalWorkHours,",
            "lineNumber": 320
          },
          {
            "text": "    actualWorkHoursExcludingLegalHoliday,",
            "lineNumber": 321
          },
          {
            "text": "    withinLegalOvertime,",
            "lineNumber": 322
          },
          {
            "text": "    overLegalOvertime,",
            "lineNumber": 323
          },
          {
            "text": "    legalHolidayWorkHours,",
            "lineNumber": 324
          },
          {
            "text": "    nightWorkHours,",
            "lineNumber": 325
          },
          {
            "text": "    overtimeOver45Hours,",
            "lineNumber": 326
          },
          {
            "text": "    overtimeOver60Hours,",
            "lineNumber": 327
          },
          {
            "text": "    lateCount,",
            "lineNumber": 328
          },
          {
            "text": "    lateHours,",
            "lineNumber": 329
          },
          {
            "text": "    earlyLeaveCount,",
            "lineNumber": 330
          },
          {
            "text": "    earlyLeaveHours,",
            "lineNumber": 331
          },
          {
            "text": "    privateOutingCount,",
            "lineNumber": 332
          },
          {
            "text": "    privateOutingHours,",
            "lineNumber": 333
          },
          {
            "text": "    totalBreakHours",
            "lineNumber": 334
          },
          {
            "text": "  };",
            "lineNumber": 335
          },
          {
            "text": "  ",
            "lineNumber": 336
          },
          {
            "text": "  // 4. 休暇情報取得（月次サマリー用の集計）",
            "lineNumber": 337
          },
          {
            "text": "  // 有給取得日数",
            "lineNumber": 338
          },
          {
            "text": "  const paidLeaveDays = vacations",
            "lineNumber": 339
          },
          {
            "text": "    .filter(v =&gt; v.VACATION_TYPE_CODE === 'PAID_LEAVE' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED')",
            "lineNumber": 340
          },
          {
            "text": "    .reduce((sum, v) =&gt; sum + (parseFloat(v.VACATION_DAYS) || 0), 0);",
            "lineNumber": 341
          },
          {
            "text": "  ",
            "lineNumber": 342
          },
          {
            "text": "  // 有給取得日数内訳",
            "lineNumber": 343
          },
          {
            "text": "  let paidLeaveTypeName = '';",
            "lineNumber": 344
          },
          {
            "lineNumber": 345
          },
          {
            "text": "  if (paidLeaveDays &gt; 0) {",
            "lineNumber": 346
          },
          {
            "text": "    paidLeaveTypeName = '年次有給休暇';",
            "lineNumber": 347
          },
          {
            "text": "  }",
            "lineNumber": 348
          },
          {
            "lineNumber": 349
          },
          {
            "text": "  // 時間単位有休取得時間（VACATION_DAYSが1未満の有給休暇を時間単位として集計）",
            "lineNumber": 350
          },
          {
            "text": "  const hourlyPaidLeaveHours = vacations",
            "lineNumber": 351
          },
          {
            "text": "    .filter(v =&gt; v.VACATION_TYPE_CODE === 'PAID_LEAVE' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED' &amp;&amp; parseFloat(v.VACATION_DAYS) &lt; 1)",
            "lineNumber": 352
          },
          {
            "text": "    .reduce((sum, v) =&gt; {",
            "lineNumber": 353
          },
          {
            "text": "      // VACATION_DAYSが1未満の場合、時間単位として扱う（例：0.5日 = 4時間）",
            "lineNumber": 354
          },
          {
            "text": "      const days = parseFloat(v.VACATION_DAYS) || 0;",
            "lineNumber": 355
          },
          {
            "text": "      // 1日 = 8時間として計算",
            "lineNumber": 356
          },
          {
            "text": "      return sum + (days * 8);",
            "lineNumber": 357
          },
          {
            "text": "    }, 0);",
            "lineNumber": 358
          },
          {
            "lineNumber": 359
          },
          {
            "text": "  // 代休取得日数",
            "lineNumber": 360
          },
          {
            "text": "  const substituteHolidayDays = vacations",
            "lineNumber": 361
          },
          {
            "text": "    .filter(v =&gt; v.VACATION_TYPE_CODE === 'SUBSTITUTE_HOLIDAY' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED')",
            "lineNumber": 362
          },
          {
            "text": "    .reduce((sum, v) =&gt; sum + (parseFloat(v.VACATION_DAYS) || 0), 0);",
            "lineNumber": 363
          },
          {
            "lineNumber": 364
          },
          {
            "text": "  // 代休取得日数内訳",
            "lineNumber": 365
          },
          {
            "text": "  let substituteHolidayTypeName = '';",
            "lineNumber": 366
          },
          {
            "lineNumber": 367
          },
          {
            "text": "  if (substituteHolidayDays &gt; 0) {",
            "lineNumber": 368
          },
          {
            "text": "    substituteHolidayTypeName = '代休';",
            "lineNumber": 369
          },
          {
            "text": "  }",
            "lineNumber": 370
          },
          {
            "text": "  ",
            "lineNumber": 371
          },
          {
            "text": "  // 無給休暇日数（簡易的に0とする）",
            "lineNumber": 372
          },
          {
            "text": "  const unpaidLeaveDays = 0;",
            "lineNumber": 373
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.36401641368865967
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\monthly-summary-screen.md",
        "range": {
          "startPosition": {
            "line": 291
          },
          "endPosition": {
            "line": 309
          }
        },
        "contents": "  | 合計実労働時間 | 月次サマリーデータ取得.総労働時間をHHH:MM形式で表示 | |\n  | 合計残業時間 | 月次サマリーデータ取得.法定時間内残業 + 法定時間外残業をH:MM形式で表示 | |\n  | 合計休日労働時間 | 月次サマリーデータ取得.法定休日労働時間をH:MM形式で表示 | |\n  | 合計深夜労働時間 | 月次サマリーデータ取得.深夜労働時間をH:MM形式で表示 | |\n  | 月次サマリータイトル | 入出力項目定義.対象年月をYYYY年MM月月次サマリー形式で表示 | |\n  | 所定出勤日数値 | 月次サマリーデータ取得.所定出勤日数を「XX 日」形式で表示 | |\n  | 実出勤日数値 | 月次サマリーデータ取得.実出勤日数を「XX 日」形式で表示 | |\n  | 法定休日出勤日数値 | 月次サマリーデータ取得.法定休日出勤日数を「XX 日」形式で表示 | |\n  | 所定休日出勤日数値 | 月次サマリーデータ取得.所定休日出勤日数を「XX 日」形式で表示 | |\n  | 所定労働時間値 | 月次サマリーデータ取得.所定労働時間をHHH:MM形式で表示 | |\n  | 総労働時間(有休を含む)値 | 月次サマリーデータ取得.総労働時間をHHH:MM形式で表示 | |\n  | 総労働時間-法定休日労働(有休を含む)値 | 月次サマリーデータ取得.総労働時間-法定休日労働をHHH:MM形式で表示 | |\n  | 過不足時間値 | 月次サマリーデータ取得.過不足時間を+/-H:MM形式で表示 | マイナスの場合は赤色表示 |\n  | 当月度の超過時間値 | 月次サマリーデータ取得.当月度の超過時間をH:MM形式で表示 | |\n  | 安全配慮上の超過時間値 | 月次サマリーデータ取得.安全配慮上の超過時間をH:MM形式で表示 | |\n  | 法定労働時間値 | 月次サマリーデータ取得.法定労働時間をHHH:MM形式で表示 | |\n  | 実労働時間-法定休日労働(有休を含めない)値 | 月次サマリーデータ取得.実労働時間-法定休日労働(有休を含めない)をHHH:MM形式で表示 | |\n  | 法定時間内残業値 | 月次サマリーデータ取得.法定時間内残業をH:MM形式で表示 | |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "  | 合計実労働時間 | 月次サマリーデータ取得.総労働時間をHHH:MM形式で表示 | |",
            "lineNumber": 292
          },
          {
            "text": "  | 合計残業時間 | 月次サマリーデータ取得.法定時間内残業 + 法定時間外残業をH:MM形式で表示 | |",
            "lineNumber": 293
          },
          {
            "text": "  | 合計休日労働時間 | 月次サマリーデータ取得.法定休日労働時間をH:MM形式で表示 | |",
            "lineNumber": 294
          },
          {
            "text": "  | 合計深夜労働時間 | 月次サマリーデータ取得.深夜労働時間をH:MM形式で表示 | |",
            "lineNumber": 295
          },
          {
            "text": "  | 月次サマリータイトル | 入出力項目定義.対象年月をYYYY年MM月月次サマリー形式で表示 | |",
            "lineNumber": 296
          },
          {
            "text": "  | 所定出勤日数値 | 月次サマリーデータ取得.所定出勤日数を「XX 日」形式で表示 | |",
            "lineNumber": 297
          },
          {
            "text": "  | 実出勤日数値 | 月次サマリーデータ取得.実出勤日数を「XX 日」形式で表示 | |",
            "lineNumber": 298
          },
          {
            "text": "  | 法定休日出勤日数値 | 月次サマリーデータ取得.法定休日出勤日数を「XX 日」形式で表示 | |",
            "lineNumber": 299
          },
          {
            "text": "  | 所定休日出勤日数値 | 月次サマリーデータ取得.所定休日出勤日数を「XX 日」形式で表示 | |",
            "lineNumber": 300
          },
          {
            "text": "  | 所定労働時間値 | 月次サマリーデータ取得.所定労働時間をHHH:MM形式で表示 | |",
            "lineNumber": 301
          },
          {
            "text": "  | 総労働時間(有休を含む)値 | 月次サマリーデータ取得.総労働時間をHHH:MM形式で表示 | |",
            "lineNumber": 302
          },
          {
            "text": "  | 総労働時間-法定休日労働(有休を含む)値 | 月次サマリーデータ取得.総労働時間-法定休日労働をHHH:MM形式で表示 | |",
            "lineNumber": 303
          },
          {
            "text": "  | 過不足時間値 | 月次サマリーデータ取得.過不足時間を+/-H:MM形式で表示 | マイナスの場合は赤色表示 |",
            "lineNumber": 304
          },
          {
            "text": "  | 当月度の超過時間値 | 月次サマリーデータ取得.当月度の超過時間をH:MM形式で表示 | |",
            "lineNumber": 305
          },
          {
            "text": "  | 安全配慮上の超過時間値 | 月次サマリーデータ取得.安全配慮上の超過時間をH:MM形式で表示 | |",
            "lineNumber": 306
          },
          {
            "text": "  | 法定労働時間値 | 月次サマリーデータ取得.法定労働時間をHHH:MM形式で表示 | |",
            "lineNumber": 307
          },
          {
            "text": "  | 実労働時間-法定休日労働(有休を含めない)値 | 月次サマリーデータ取得.実労働時間-法定休日労働(有休を含めない)をHHH:MM形式で表示 | |",
            "lineNumber": 308
          },
          {
            "text": "  | 法定時間内残業値 | 月次サマリーデータ取得.法定時間内残業をH:MM形式で表示 | |",
            "lineNumber": 309
          }
        ]
      },
      "score": 0.3611524999141693
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\routes\\monthlySummary.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 10,
            "column": 24
          }
        },
        "contents": "const express = require('express');\nconst router = express.Router();\nconst monthlySummaryController = require('../controllers/monthlySummaryController');\n\n/**\n * 月次サマリー取得API（月次サマリー情報画面用）\n * GET /api/monthly-summary/detail\n */\nrouter.get('/detail', monthlySummaryController.getMonthlySummary);\n\nmodule.exports = router;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "const express = require('express');",
            "lineNumber": 1
          },
          {
            "text": "const router = express.Router();",
            "lineNumber": 2
          },
          {
            "text": "const monthlySummaryController = require('../controllers/monthlySummaryController');",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "/**",
            "lineNumber": 5
          },
          {
            "text": " * 月次サマリー取得API（月次サマリー情報画面用）",
            "lineNumber": 6
          },
          {
            "text": " * GET /api/monthly-summary/detail",
            "lineNumber": 7
          },
          {
            "text": " */",
            "lineNumber": 8
          },
          {
            "text": "router.get('/detail', monthlySummaryController.getMonthlySummary);",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "module.exports = router;",
            "lineNumber": 11
          }
        ]
      },
      "score": 0.3606903553009033
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\MonthlySummaryScreen.vue",
        "range": {
          "startPosition": {
            "line": 449
          },
          "endPosition": {
            "line": 495,
            "column": 6
          }
        },
        "contents": "export default {\n  name: 'MonthlySummaryScreen',\n  data() {\n    return {\n      employee: null,\n      yearMonth: '',\n      dailyData: [],\n      monthlySummary: null,\n      vacationInfo: null,\n      monthlyApprovalStatus: 'NOT_SUBMITTED',\n      loading: false,\n      error: null,\n      tableColumnDividers: [229, 530, 670, 805, 935, 1070, 1200, 1330, 1465]\n    }\n  },\n  computed: {\n    formattedYearMonth() {\n      if (!this.yearMonth) return ''\n      const [year, month] = this.yearMonth.split('-')\n      return &#96;${year}年${month}月&#96;\n    },\n    approvalStatusText() {\n      const statusMap = {\n        'NOT_SUBMITTED': '未確定',\n        'PENDING': '承認中',\n        'APPROVED': '承認済み',\n        'REJECTED': '却下'\n      }\n      return statusMap[this.monthlyApprovalStatus] || '未確定'\n    }\n  },\n  async mounted() {\n    const params = new URLSearchParams(window.location.search)\n    const employeeId = params.get('employeeId')\n    const yearMonth = params.get('yearMonth')\n    \n    if (!employeeId || !yearMonth) {\n      this.error = '従業員IDと対象年月が必要です。'\n      return\n    }\n    \n    this.yearMonth = yearMonth\n    await this.loadData(employeeId, yearMonth)\n  },\n  methods: {\n    async loadData(employeeId, yearMonth) {\n      ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "export default {",
            "lineNumber": 450
          },
          {
            "text": "  name: 'MonthlySummaryScreen',",
            "lineNumber": 451
          },
          {
            "text": "  data() {",
            "lineNumber": 452
          },
          {
            "text": "    return {",
            "lineNumber": 453
          },
          {
            "text": "      employee: null,",
            "lineNumber": 454
          },
          {
            "text": "      yearMonth: '',",
            "lineNumber": 455
          },
          {
            "text": "      dailyData: [],",
            "lineNumber": 456
          },
          {
            "text": "      monthlySummary: null,",
            "lineNumber": 457
          },
          {
            "text": "      vacationInfo: null,",
            "lineNumber": 458
          },
          {
            "text": "      monthlyApprovalStatus: 'NOT_SUBMITTED',",
            "lineNumber": 459
          },
          {
            "text": "      loading: false,",
            "lineNumber": 460
          },
          {
            "text": "      error: null,",
            "lineNumber": 461
          },
          {
            "text": "      tableColumnDividers: [229, 530, 670, 805, 935, 1070, 1200, 1330, 1465]",
            "lineNumber": 462
          },
          {
            "text": "    }",
            "lineNumber": 463
          },
          {
            "text": "  },",
            "lineNumber": 464
          },
          {
            "text": "  computed: {",
            "lineNumber": 465
          },
          {
            "text": "    formattedYearMonth() {",
            "lineNumber": 466
          },
          {
            "text": "      if (!this.yearMonth) return ''",
            "lineNumber": 467
          },
          {
            "text": "      const [year, month] = this.yearMonth.split('-')",
            "lineNumber": 468
          },
          {
            "text": "      return &#96;${year}年${month}月&#96;",
            "lineNumber": 469
          },
          {
            "text": "    },",
            "lineNumber": 470
          },
          {
            "text": "    approvalStatusText() {",
            "lineNumber": 471
          },
          {
            "text": "      const statusMap = {",
            "lineNumber": 472
          },
          {
            "text": "        'NOT_SUBMITTED': '未確定',",
            "lineNumber": 473
          },
          {
            "text": "        'PENDING': '承認中',",
            "lineNumber": 474
          },
          {
            "text": "        'APPROVED': '承認済み',",
            "lineNumber": 475
          },
          {
            "text": "        'REJECTED': '却下'",
            "lineNumber": 476
          },
          {
            "text": "      }",
            "lineNumber": 477
          },
          {
            "text": "      return statusMap[this.monthlyApprovalStatus] || '未確定'",
            "lineNumber": 478
          },
          {
            "text": "    }",
            "lineNumber": 479
          },
          {
            "text": "  },",
            "lineNumber": 480
          },
          {
            "text": "  async mounted() {",
            "lineNumber": 481
          },
          {
            "text": "    const params = new URLSearchParams(window.location.search)",
            "lineNumber": 482
          },
          {
            "text": "    const employeeId = params.get('employeeId')",
            "lineNumber": 483
          },
          {
            "text": "    const yearMonth = params.get('yearMonth')",
            "lineNumber": 484
          },
          {
            "text": "    ",
            "lineNumber": 485
          },
          {
            "text": "    if (!employeeId || !yearMonth) {",
            "lineNumber": 486
          },
          {
            "text": "      this.error = '従業員IDと対象年月が必要です。'",
            "lineNumber": 487
          },
          {
            "text": "      return",
            "lineNumber": 488
          },
          {
            "text": "    }",
            "lineNumber": 489
          },
          {
            "text": "    ",
            "lineNumber": 490
          },
          {
            "text": "    this.yearMonth = yearMonth",
            "lineNumber": 491
          },
          {
            "text": "    await this.loadData(employeeId, yearMonth)",
            "lineNumber": 492
          },
          {
            "text": "  },",
            "lineNumber": 493
          },
          {
            "text": "  methods: {",
            "lineNumber": 494
          },
          {
            "text": "    async loadData(employeeId, yearMonth) {",
            "lineNumber": 495
          },
          {
            "text": "      ",
            "lineNumber": 496
          }
        ]
      },
      "score": 0.35035276412963867
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\monthly-summary-screen.md",
        "range": {
          "startPosition": {
            "line": 382
          },
          "endPosition": {
            "line": 413
          }
        },
        "contents": "- 取得条件\n  - ATTENDANCE_RECORD.EMPLOYEE_ID = 入出力項目定義.従業員ID\n  - DATE_FORMAT(ATTENDANCE_RECORD.WORK_DATE, '%Y-%m') = 入出力項目定義.対象年月\n- その他\n  - 対象年月の1日から月末日まで、全ての日付のレコードを取得（勤務記録がない日も含む）\n  - WORK_DATEで昇順ソート\n  - 各日付ごとに以下の情報を追加で取得する：\n    - 祝日名: 祝日マスタ（@holiday-jp/holiday_jp）から取得した祝日名（祝日の場合のみ）\n    - 休暇種別名: VACATION_HISTORYとVACATION_TYPEを結合して取得した休暇種別名（承認済みまたは申請中の休暇がある場合のみ）\n\n#### No.3\n- 取得仕様名：月次サマリーデータ取得\n- テーブル名：V_MONTHLY_ATTENDANCE（ビュー）\n  | 項目名 | 取得内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 所定出勤日数 | V_MONTHLY_ATTENDANCE.SCHEDULED_WORK_DAYS | |\n  | 実出勤日数 | V_MONTHLY_ATTENDANCE.ACTUAL_WORK_DAYS | |\n  | 所定労働時間 | V_MONTHLY_ATTENDANCE.SCHEDULED_WORK_HOURS | |\n  | 総労働時間 | V_MONTHLY_ATTENDANCE.TOTAL_WORK_HOURS | |\n  | 過不足時間 | V_MONTHLY_ATTENDANCE.OVER_UNDER_HOURS | |\n  | 法定休日労働時間 | V_MONTHLY_ATTENDANCE.LEGAL_HOLIDAY_WORK_HOURS | |\n  | 法定時間内残業 | V_MONTHLY_ATTENDANCE.WITHIN_LEGAL_OVERTIME_HOURS | |\n  | 法定時間外残業 | V_MONTHLY_ATTENDANCE.OVER_LEGAL_OVERTIME_HOURS | |\n  | 深夜労働時間 | V_MONTHLY_ATTENDANCE.NIGHT_WORK_HOURS | |\n- 関連する取得仕様\n  - なし\n- 取得条件\n  - V_MONTHLY_ATTENDANCE.EMPLOYEE_ID = 入出力項目定義.従業員ID\n  - V_MONTHLY_ATTENDANCE.YEAR_MONTH = 入出力項目定義.対象年月\n- その他\n  - ビューV_MONTHLY_ATTENDANCEを使用して月次集計データを取得",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- 取得条件",
            "lineNumber": 383
          },
          {
            "text": "  - ATTENDANCE_RECORD.EMPLOYEE_ID = 入出力項目定義.従業員ID",
            "lineNumber": 384
          },
          {
            "text": "  - DATE_FORMAT(ATTENDANCE_RECORD.WORK_DATE, '%Y-%m') = 入出力項目定義.対象年月",
            "lineNumber": 385
          },
          {
            "text": "- その他",
            "lineNumber": 386
          },
          {
            "text": "  - 対象年月の1日から月末日まで、全ての日付のレコードを取得（勤務記録がない日も含む）",
            "lineNumber": 387
          },
          {
            "text": "  - WORK_DATEで昇順ソート",
            "lineNumber": 388
          },
          {
            "text": "  - 各日付ごとに以下の情報を追加で取得する：",
            "lineNumber": 389
          },
          {
            "text": "    - 祝日名: 祝日マスタ（@holiday-jp/holiday_jp）から取得した祝日名（祝日の場合のみ）",
            "lineNumber": 390
          },
          {
            "text": "    - 休暇種別名: VACATION_HISTORYとVACATION_TYPEを結合して取得した休暇種別名（承認済みまたは申請中の休暇がある場合のみ）",
            "lineNumber": 391
          },
          {
            "lineNumber": 392
          },
          {
            "text": "#### No.3",
            "lineNumber": 393
          },
          {
            "text": "- 取得仕様名：月次サマリーデータ取得",
            "lineNumber": 394
          },
          {
            "text": "- テーブル名：V_MONTHLY_ATTENDANCE（ビュー）",
            "lineNumber": 395
          },
          {
            "text": "  | 項目名 | 取得内容 | 補足 |",
            "lineNumber": 396
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 397
          },
          {
            "text": "  | 所定出勤日数 | V_MONTHLY_ATTENDANCE.SCHEDULED_WORK_DAYS | |",
            "lineNumber": 398
          },
          {
            "text": "  | 実出勤日数 | V_MONTHLY_ATTENDANCE.ACTUAL_WORK_DAYS | |",
            "lineNumber": 399
          },
          {
            "text": "  | 所定労働時間 | V_MONTHLY_ATTENDANCE.SCHEDULED_WORK_HOURS | |",
            "lineNumber": 400
          },
          {
            "text": "  | 総労働時間 | V_MONTHLY_ATTENDANCE.TOTAL_WORK_HOURS | |",
            "lineNumber": 401
          },
          {
            "text": "  | 過不足時間 | V_MONTHLY_ATTENDANCE.OVER_UNDER_HOURS | |",
            "lineNumber": 402
          },
          {
            "text": "  | 法定休日労働時間 | V_MONTHLY_ATTENDANCE.LEGAL_HOLIDAY_WORK_HOURS | |",
            "lineNumber": 403
          },
          {
            "text": "  | 法定時間内残業 | V_MONTHLY_ATTENDANCE.WITHIN_LEGAL_OVERTIME_HOURS | |",
            "lineNumber": 404
          },
          {
            "text": "  | 法定時間外残業 | V_MONTHLY_ATTENDANCE.OVER_LEGAL_OVERTIME_HOURS | |",
            "lineNumber": 405
          },
          {
            "text": "  | 深夜労働時間 | V_MONTHLY_ATTENDANCE.NIGHT_WORK_HOURS | |",
            "lineNumber": 406
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 407
          },
          {
            "text": "  - なし",
            "lineNumber": 408
          },
          {
            "text": "- 取得条件",
            "lineNumber": 409
          },
          {
            "text": "  - V_MONTHLY_ATTENDANCE.EMPLOYEE_ID = 入出力項目定義.従業員ID",
            "lineNumber": 410
          },
          {
            "text": "  - V_MONTHLY_ATTENDANCE.YEAR_MONTH = 入出力項目定義.対象年月",
            "lineNumber": 411
          },
          {
            "text": "- その他",
            "lineNumber": 412
          },
          {
            "text": "  - ビューV_MONTHLY_ATTENDANCEを使用して月次集計データを取得",
            "lineNumber": 413
          }
        ]
      },
      "score": 0.34946921467781067
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\monthly-summary-screen.md",
        "range": {
          "startPosition": {
            "line": 73
          },
          "endPosition": {
            "line": 91
          }
        },
        "contents": "| 41 | 合計出社時刻 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の出社時刻の合計（意味がないため通常は表示しない） |\n| 42 | 合計退社時刻 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の退社時刻の合計（意味がないため通常は表示しない） |\n| 43 | 合計休憩時間 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の休憩時間の合計 |\n| 44 | 合計実労働時間 | 出力 | | 時間 | | | | HHH:MM | 表示 | 活性 | | 月間の実労働時間の合計 |\n| 45 | 合計残業時間 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の残業時間の合計 |\n| 46 | 合計休日労働時間 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の休日労働時間の合計 |\n| 47 | 合計深夜労働時間 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の深夜労働時間の合計 |\n| | &lt;記号説明部分&gt; | | | | | | | | | | | |\n| 48 | 記号の説明 | 出力 | | 文字 | | | | | 表示 | 活性 | | 記号の説明テキスト（○＝所定休日（勤務表画面のテーブルでいえば土と祝日）、◎＝法定休日（日曜日）、△＝有休計画付与日） |\n| | &lt;月次サマリータイトル部分&gt; | | | | | | | | | | | |\n| 49 | 月次サマリータイトル | 出力 | | 文字 | | | | | 表示 | 活性 | | YYYY年MM月月次サマリー（例: 2025年11月月次サマリー） |\n| | &lt;左カラム部分 - Section 1&gt; | | | | | | | | | | | |\n| 50 | Section 1背景 | 出力 | | 画像 | | | | | 表示 | 活性 | | 白色の背景。枠でグループ化されている |\n| 51 | 所定出勤日数 | 出力 | | 文字 | | | | | 表示 | 活性 | | 項目ラベル |\n| 52 | 所定出勤日数値 | 出力 | | 整数 | | | | | 表示 | 活性 | | 所定出勤日数（例: 18 日） |\n| 53 | 実出勤日数 | 出力 | | 文字 | | | | | 表示 | 活性 | | 項目ラベル |\n| 54 | 実出勤日数値 | 出力 | | 整数 | | | | | 表示 | 活性 | | 実出勤日数（例: 14 日） |\n| 55 | 法定休日出勤日数 | 出力 | | 文字 | | | | | 表示 | 活性 | | 項目ラベル |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| 41 | 合計出社時刻 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の出社時刻の合計（意味がないため通常は表示しない） |",
            "lineNumber": 74
          },
          {
            "text": "| 42 | 合計退社時刻 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の退社時刻の合計（意味がないため通常は表示しない） |",
            "lineNumber": 75
          },
          {
            "text": "| 43 | 合計休憩時間 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の休憩時間の合計 |",
            "lineNumber": 76
          },
          {
            "text": "| 44 | 合計実労働時間 | 出力 | | 時間 | | | | HHH:MM | 表示 | 活性 | | 月間の実労働時間の合計 |",
            "lineNumber": 77
          },
          {
            "text": "| 45 | 合計残業時間 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の残業時間の合計 |",
            "lineNumber": 78
          },
          {
            "text": "| 46 | 合計休日労働時間 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の休日労働時間の合計 |",
            "lineNumber": 79
          },
          {
            "text": "| 47 | 合計深夜労働時間 | 出力 | | 時間 | | | | H:MM | 表示 | 活性 | | 月間の深夜労働時間の合計 |",
            "lineNumber": 80
          },
          {
            "text": "| | &lt;記号説明部分&gt; | | | | | | | | | | | |",
            "lineNumber": 81
          },
          {
            "text": "| 48 | 記号の説明 | 出力 | | 文字 | | | | | 表示 | 活性 | | 記号の説明テキスト（○＝所定休日（勤務表画面のテーブルでいえば土と祝日）、◎＝法定休日（日曜日）、△＝有休計画付与日） |",
            "lineNumber": 82
          },
          {
            "text": "| | &lt;月次サマリータイトル部分&gt; | | | | | | | | | | | |",
            "lineNumber": 83
          },
          {
            "text": "| 49 | 月次サマリータイトル | 出力 | | 文字 | | | | | 表示 | 活性 | | YYYY年MM月月次サマリー（例: 2025年11月月次サマリー） |",
            "lineNumber": 84
          },
          {
            "text": "| | &lt;左カラム部分 - Section 1&gt; | | | | | | | | | | | |",
            "lineNumber": 85
          },
          {
            "text": "| 50 | Section 1背景 | 出力 | | 画像 | | | | | 表示 | 活性 | | 白色の背景。枠でグループ化されている |",
            "lineNumber": 86
          },
          {
            "text": "| 51 | 所定出勤日数 | 出力 | | 文字 | | | | | 表示 | 活性 | | 項目ラベル |",
            "lineNumber": 87
          },
          {
            "text": "| 52 | 所定出勤日数値 | 出力 | | 整数 | | | | | 表示 | 活性 | | 所定出勤日数（例: 18 日） |",
            "lineNumber": 88
          },
          {
            "text": "| 53 | 実出勤日数 | 出力 | | 文字 | | | | | 表示 | 活性 | | 項目ラベル |",
            "lineNumber": 89
          },
          {
            "text": "| 54 | 実出勤日数値 | 出力 | | 整数 | | | | | 表示 | 活性 | | 実出勤日数（例: 14 日） |",
            "lineNumber": 90
          },
          {
            "text": "| 55 | 法定休日出勤日数 | 出力 | | 文字 | | | | | 表示 | 活性 | | 項目ラベル |",
            "lineNumber": 91
          }
        ]
      },
      "score": 0.34791725873947144
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\monthly-summary-screen.md",
        "range": {
          "startPosition": {
            "line": 281
          },
          "endPosition": {
            "line": 293
          }
        },
        "contents": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;イベント/勤務状況/勤務場所 | 以下の優先順位で表示する。&lt;br&gt;1. 祝日の場合は「(祝日名)」形式（例: (勤労感謝の日)）&lt;br&gt;2. 休暇の場合は「休暇(休暇種別名)」形式（例: 休暇(年次有給休暇)、休暇(夏季休暇)）&lt;br&gt;3. 日時確定済みの場合は「日時確定,勤務場所」形式（例: 日時確定,在宅、日時確定,通勤）&lt;br&gt;4. 通常勤務で日時確定ではない場合は勤務場所のみ（例: 在宅、通勤） | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出社時刻 | 日次勤務データ.出勤時刻をHH:MM形式で表示 | 出勤時刻が存在する場合のみ |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退社時刻 | 日次勤務データ.退勤時刻をHH:MM形式で表示 | 退勤時刻が存在する場合のみ |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩時間 | 日次勤務データ.休憩時間合計をH:MM形式で表示 | 休憩時間が存在する場合のみ |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実労働時間 | 日次勤務データ.実労働時間をH:MM形式で表示 | 実労働時間が存在する場合のみ |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;残業時間 | 日次勤務データ.残業時間をH:MM形式で表示 | 残業時間が存在する場合のみ |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休日労働時間 | 日次勤務データ.休日労働時間をH:MM形式で表示 | 休日労働時間が存在する場合のみ |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;深夜労働時間 | 日次勤務データ.深夜労働時間をH:MM形式で表示 | 深夜労働時間が存在する場合のみ |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;備考 | 日次勤務データ.備考を表示。打刻漏れや手入力修正の情報も表示 | 備考が存在する場合、または打刻漏れ・手入力修正がある場合のみ |\n  | 合計休憩時間 | 月次サマリーデータ取得の休憩時間合計をH:MM形式で表示 | |\n  | 合計実労働時間 | 月次サマリーデータ取得.総労働時間をHHH:MM形式で表示 | |\n  | 合計残業時間 | 月次サマリーデータ取得.法定時間内残業 + 法定時間外残業をH:MM形式で表示 | |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;イベント/勤務状況/勤務場所 | 以下の優先順位で表示する。&lt;br&gt;1. 祝日の場合は「(祝日名)」形式（例: (勤労感謝の日)）&lt;br&gt;2. 休暇の場合は「休暇(休暇種別名)」形式（例: 休暇(年次有給休暇)、休暇(夏季休暇)）&lt;br&gt;3. 日時確定済みの場合は「日時確定,勤務場所」形式（例: 日時確定,在宅、日時確定,通勤）&lt;br&gt;4. 通常勤務で日時確定ではない場合は勤務場所のみ（例: 在宅、通勤） | |",
            "lineNumber": 282
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出社時刻 | 日次勤務データ.出勤時刻をHH:MM形式で表示 | 出勤時刻が存在する場合のみ |",
            "lineNumber": 283
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退社時刻 | 日次勤務データ.退勤時刻をHH:MM形式で表示 | 退勤時刻が存在する場合のみ |",
            "lineNumber": 284
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩時間 | 日次勤務データ.休憩時間合計をH:MM形式で表示 | 休憩時間が存在する場合のみ |",
            "lineNumber": 285
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実労働時間 | 日次勤務データ.実労働時間をH:MM形式で表示 | 実労働時間が存在する場合のみ |",
            "lineNumber": 286
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;残業時間 | 日次勤務データ.残業時間をH:MM形式で表示 | 残業時間が存在する場合のみ |",
            "lineNumber": 287
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休日労働時間 | 日次勤務データ.休日労働時間をH:MM形式で表示 | 休日労働時間が存在する場合のみ |",
            "lineNumber": 288
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;深夜労働時間 | 日次勤務データ.深夜労働時間をH:MM形式で表示 | 深夜労働時間が存在する場合のみ |",
            "lineNumber": 289
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;備考 | 日次勤務データ.備考を表示。打刻漏れや手入力修正の情報も表示 | 備考が存在する場合、または打刻漏れ・手入力修正がある場合のみ |",
            "lineNumber": 290
          },
          {
            "text": "  | 合計休憩時間 | 月次サマリーデータ取得の休憩時間合計をH:MM形式で表示 | |",
            "lineNumber": 291
          },
          {
            "text": "  | 合計実労働時間 | 月次サマリーデータ取得.総労働時間をHHH:MM形式で表示 | |",
            "lineNumber": 292
          },
          {
            "text": "  | 合計残業時間 | 月次サマリーデータ取得.法定時間内残業 + 法定時間外残業をH:MM形式で表示 | |",
            "lineNumber": 293
          }
        ]
      },
      "score": 0.34744226932525635
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\feture_list\\TeamSpirit機能一覧.md",
        "range": {
          "startPosition": {
            "line": 81
          },
          "endPosition": {
            "line": 89
          }
        },
        "contents": "| 78 | 勤務表 | 画面 | SCR_TS_0214 | 月次サマリー表示 | MonthlySummaryDisplay | N/A | N/A | SCR_TS_021101 | 月次サマリー画面 | MonthlySummaryDialog | 従業員 | 月間の勤務情報の集計表示 | 勤務時間集計_表示 | 総勤務時間、所定勤務時間、実勤務時間などを表示 |\n| 79 | 勤務表 | 画面 | SCR_TS_0214 | 月次サマリー表示 | MonthlySummaryDisplay | N/A | N/A | SCR_TS_021101 | 月次サマリー画面 | MonthlySummaryDialog | 従業員 | 月間の勤務情報の集計表示 | 残業時間集計_表示 | 残業時間、深夜残業時間、休日勤務時間などを表示 |\n| 80 | 勤務表 | 画面 | SCR_TS_0214 | 月次サマリー表示 | MonthlySummaryDisplay | N/A | N/A | SCR_TS_021101 | 月次サマリー画面 | MonthlySummaryDialog | 従業員 | 月間の勤務情報の集計表示 | 閉じる_押下 | 月次サマリー画面を閉じる |\n| 81 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 休暇情報_押下 | 個人休暇表示画面を表示 |\n| 82 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 初期表示 | 休暇残日数、取得履歴、休暇種別ごとの情報を表示 |\n| 83 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 休暇種別_表示 | 有給休暇、特別休暇などの休暇種別を表示 |\n| 84 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 休暇残日数_表示 | 各休暇種別の残日数と付与日数を表示 |\n| 85 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 休暇取得履歴_表示 | 過去の休暇取得履歴（日付、種別、日数）を表示 |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| 78 | 勤務表 | 画面 | SCR_TS_0214 | 月次サマリー表示 | MonthlySummaryDisplay | N/A | N/A | SCR_TS_021101 | 月次サマリー画面 | MonthlySummaryDialog | 従業員 | 月間の勤務情報の集計表示 | 勤務時間集計_表示 | 総勤務時間、所定勤務時間、実勤務時間などを表示 |",
            "lineNumber": 82
          },
          {
            "text": "| 79 | 勤務表 | 画面 | SCR_TS_0214 | 月次サマリー表示 | MonthlySummaryDisplay | N/A | N/A | SCR_TS_021101 | 月次サマリー画面 | MonthlySummaryDialog | 従業員 | 月間の勤務情報の集計表示 | 残業時間集計_表示 | 残業時間、深夜残業時間、休日勤務時間などを表示 |",
            "lineNumber": 83
          },
          {
            "text": "| 80 | 勤務表 | 画面 | SCR_TS_0214 | 月次サマリー表示 | MonthlySummaryDisplay | N/A | N/A | SCR_TS_021101 | 月次サマリー画面 | MonthlySummaryDialog | 従業員 | 月間の勤務情報の集計表示 | 閉じる_押下 | 月次サマリー画面を閉じる |",
            "lineNumber": 84
          },
          {
            "text": "| 81 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 休暇情報_押下 | 個人休暇表示画面を表示 |",
            "lineNumber": 85
          },
          {
            "text": "| 82 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 初期表示 | 休暇残日数、取得履歴、休暇種別ごとの情報を表示 |",
            "lineNumber": 86
          },
          {
            "text": "| 83 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 休暇種別_表示 | 有給休暇、特別休暇などの休暇種別を表示 |",
            "lineNumber": 87
          },
          {
            "text": "| 84 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 休暇残日数_表示 | 各休暇種別の残日数と付与日数を表示 |",
            "lineNumber": 88
          },
          {
            "text": "| 85 | 勤務表 | 画面 | SCR_TS_0215 | 休暇情報 | VacationInfo | N/A | N/A | SCR_TS_021201 | 個人休暇表示画面 | PersonalVacationDialog | 従業員 | 有給休暇などの休暇情報の表示 | 休暇取得履歴_表示 | 過去の休暇取得履歴（日付、種別、日数）を表示 |",
            "lineNumber": 89
          }
        ]
      },
      "score": 0.34587720036506653
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\MonthlySummaryScreen.vue",
        "range": {
          "startPosition": {
            "line": 132
          },
          "endPosition": {
            "line": 147,
            "column": 8
          }
        },
        "contents": "    &lt;span class=\"total-break\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHours(monthlySummary?.totalBreakHours || 0) }}&lt;/span&gt;\n    &lt;span class=\"total-actual-work\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHoursLong(monthlySummary?.totalWorkHours || 0) }}&lt;/span&gt;\n    &lt;span class=\"total-overtime\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHours(calculateTotalOvertime()) }}&lt;/span&gt;\n    &lt;span class=\"total-holiday-work\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHours(monthlySummary?.legalHolidayWorkHours || 0) }}&lt;/span&gt;\n    &lt;span class=\"total-night-work\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHours(monthlySummary?.nightWorkHours || 0) }}&lt;/span&gt;\n\n    &lt;!-- Symbol Explanation --&gt;\n    &lt;span class=\"symbol-explanation\" :style=\"{ top: getSymbolExplanationTop() + 'px' }\"&gt;記号の説明 ○＝所定休日、◎＝法定休日、△＝有休計画付与日&lt;/span&gt;\n\n    &lt;!-- Monthly Summary Title --&gt;\n    &lt;h2 class=\"monthly-summary-title\"&gt;{{ formattedYearMonth }}月次サマリー&lt;/h2&gt;\n\n    &lt;!-- Section 1: 所定出勤日数から所定休日出勤日数 --&gt;\n    &lt;div class=\"summary-section section-1\"&gt;\n      &lt;svg class=\"section-border\" viewBox=\"0 0 603 84\" preserveAspectRatio=\"none\"&gt;\n        ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    &lt;span class=\"total-break\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHours(monthlySummary?.totalBreakHours || 0) }}&lt;/span&gt;",
            "lineNumber": 133
          },
          {
            "text": "    &lt;span class=\"total-actual-work\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHoursLong(monthlySummary?.totalWorkHours || 0) }}&lt;/span&gt;",
            "lineNumber": 134
          },
          {
            "text": "    &lt;span class=\"total-overtime\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHours(calculateTotalOvertime()) }}&lt;/span&gt;",
            "lineNumber": 135
          },
          {
            "text": "    &lt;span class=\"total-holiday-work\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHours(monthlySummary?.legalHolidayWorkHours || 0) }}&lt;/span&gt;",
            "lineNumber": 136
          },
          {
            "text": "    &lt;span class=\"total-night-work\" :style=\"{ top: getTotalRowTop() + 5 + 'px' }\"&gt;{{ formatHours(monthlySummary?.nightWorkHours || 0) }}&lt;/span&gt;",
            "lineNumber": 137
          },
          {
            "lineNumber": 138
          },
          {
            "text": "    &lt;!-- Symbol Explanation --&gt;",
            "lineNumber": 139
          },
          {
            "text": "    &lt;span class=\"symbol-explanation\" :style=\"{ top: getSymbolExplanationTop() + 'px' }\"&gt;記号の説明 ○＝所定休日、◎＝法定休日、△＝有休計画付与日&lt;/span&gt;",
            "lineNumber": 140
          },
          {
            "lineNumber": 141
          },
          {
            "text": "    &lt;!-- Monthly Summary Title --&gt;",
            "lineNumber": 142
          },
          {
            "text": "    &lt;h2 class=\"monthly-summary-title\"&gt;{{ formattedYearMonth }}月次サマリー&lt;/h2&gt;",
            "lineNumber": 143
          },
          {
            "lineNumber": 144
          },
          {
            "text": "    &lt;!-- Section 1: 所定出勤日数から所定休日出勤日数 --&gt;",
            "lineNumber": 145
          },
          {
            "text": "    &lt;div class=\"summary-section section-1\"&gt;",
            "lineNumber": 146
          },
          {
            "text": "      &lt;svg class=\"section-border\" viewBox=\"0 0 603 84\" preserveAspectRatio=\"none\"&gt;",
            "lineNumber": 147
          },
          {
            "text": "        ",
            "lineNumber": 148
          }
        ]
      },
      "score": 0.3371186852455139
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\MonthlySummaryScreen.vue",
        "range": {
          "startPosition": {
            "line": 412
          },
          "endPosition": {
            "line": 451
          }
        },
        "contents": "    &lt;div class=\"summary-section section-10\"&gt;\n      &lt;svg class=\"section-border\" viewBox=\"0 0 580 42\" preserveAspectRatio=\"none\"&gt;\n        &lt;path d=\"M 0.5 0.5 L 579.5 0.5 M 0.5 0.5 L 0.5 41.5 M 579.5 0.5 L 579.5 41.5\" stroke=\"rgb(0, 0, 0)\" stroke-width=\"1\" fill=\"none\" /&gt;\n      &lt;/svg&gt;\n      &lt;svg class=\"section-row-border\" style=\"top: 0px;\" viewBox=\"0 0 580 21\" preserveAspectRatio=\"none\"&gt;\n        &lt;rect width=\"580\" height=\"21\" fill=\"rgb(255, 255, 255)\" /&gt;\n        &lt;path d=\"M 0 0 L 580 0\" stroke=\"rgb(0, 0, 0)\" stroke-width=\"1\" fill=\"none\" /&gt;\n      &lt;/svg&gt;\n      &lt;div class=\"section-row section-row-white\" style=\"top: 0px;\"&gt;\n        &lt;span class=\"section-label\"&gt;{{ getPaidLeaveBalanceLabel() }}&lt;/span&gt;\n        &lt;span class=\"section-value\"&gt;{{ Math.floor(vacationInfo?.paidLeaveBalance || 0) }} 日&lt;/span&gt;\n      &lt;/div&gt;\n      &lt;svg class=\"section-row-border\" style=\"top: 21px;\" viewBox=\"0 0 580 21\" preserveAspectRatio=\"none\"&gt;\n        &lt;rect width=\"580\" height=\"21\" fill=\"rgb(245, 245, 245)\" /&gt;\n        &lt;path d=\"M 0 0 L 580 0\" stroke=\"rgb(0, 0, 0)\" stroke-width=\"1\" fill=\"none\" /&gt;\n      &lt;/svg&gt;\n      &lt;div class=\"section-row section-row-gray\" style=\"top: 21px;\"&gt;\n        &lt;span class=\"section-label\"&gt;{{ getPlannedGrantDaysLabel() }}&lt;/span&gt;\n        &lt;span class=\"section-value\"&gt;{{ vacationInfo?.plannedGrantDays || 0 }} 日&lt;/span&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;!-- Loading Overlay --&gt;\n    &lt;div v-if=\"loading\" class=\"loading-overlay\"&gt;\n      &lt;div class=\"loading-spinner\"&gt;読み込み中...&lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;!-- Error Message --&gt;\n    &lt;div v-if=\"error\" class=\"error-message\"&gt;\n      {{ error }}\n    &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/template&gt;\n\n&lt;script&gt;\nimport { getMonthlySummaryDetail } from '@/services/api'\n\nexport default {\n  name: 'MonthlySummaryScreen',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    &lt;div class=\"summary-section section-10\"&gt;",
            "lineNumber": 413
          },
          {
            "text": "      &lt;svg class=\"section-border\" viewBox=\"0 0 580 42\" preserveAspectRatio=\"none\"&gt;",
            "lineNumber": 414
          },
          {
            "text": "        &lt;path d=\"M 0.5 0.5 L 579.5 0.5 M 0.5 0.5 L 0.5 41.5 M 579.5 0.5 L 579.5 41.5\" stroke=\"rgb(0, 0, 0)\" stroke-width=\"1\" fill=\"none\" /&gt;",
            "lineNumber": 415
          },
          {
            "text": "      &lt;/svg&gt;",
            "lineNumber": 416
          },
          {
            "text": "      &lt;svg class=\"section-row-border\" style=\"top: 0px;\" viewBox=\"0 0 580 21\" preserveAspectRatio=\"none\"&gt;",
            "lineNumber": 417
          },
          {
            "text": "        &lt;rect width=\"580\" height=\"21\" fill=\"rgb(255, 255, 255)\" /&gt;",
            "lineNumber": 418
          },
          {
            "text": "        &lt;path d=\"M 0 0 L 580 0\" stroke=\"rgb(0, 0, 0)\" stroke-width=\"1\" fill=\"none\" /&gt;",
            "lineNumber": 419
          },
          {
            "text": "      &lt;/svg&gt;",
            "lineNumber": 420
          },
          {
            "text": "      &lt;div class=\"section-row section-row-white\" style=\"top: 0px;\"&gt;",
            "lineNumber": 421
          },
          {
            "text": "        &lt;span class=\"section-label\"&gt;{{ getPaidLeaveBalanceLabel() }}&lt;/span&gt;",
            "lineNumber": 422
          },
          {
            "text": "        &lt;span class=\"section-value\"&gt;{{ Math.floor(vacationInfo?.paidLeaveBalance || 0) }} 日&lt;/span&gt;",
            "lineNumber": 423
          },
          {
            "text": "      &lt;/div&gt;",
            "lineNumber": 424
          },
          {
            "text": "      &lt;svg class=\"section-row-border\" style=\"top: 21px;\" viewBox=\"0 0 580 21\" preserveAspectRatio=\"none\"&gt;",
            "lineNumber": 425
          },
          {
            "text": "        &lt;rect width=\"580\" height=\"21\" fill=\"rgb(245, 245, 245)\" /&gt;",
            "lineNumber": 426
          },
          {
            "text": "        &lt;path d=\"M 0 0 L 580 0\" stroke=\"rgb(0, 0, 0)\" stroke-width=\"1\" fill=\"none\" /&gt;",
            "lineNumber": 427
          },
          {
            "text": "      &lt;/svg&gt;",
            "lineNumber": 428
          },
          {
            "text": "      &lt;div class=\"section-row section-row-gray\" style=\"top: 21px;\"&gt;",
            "lineNumber": 429
          },
          {
            "text": "        &lt;span class=\"section-label\"&gt;{{ getPlannedGrantDaysLabel() }}&lt;/span&gt;",
            "lineNumber": 430
          },
          {
            "text": "        &lt;span class=\"section-value\"&gt;{{ vacationInfo?.plannedGrantDays || 0 }} 日&lt;/span&gt;",
            "lineNumber": 431
          },
          {
            "text": "      &lt;/div&gt;",
            "lineNumber": 432
          },
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 433
          },
          {
            "lineNumber": 434
          },
          {
            "text": "    &lt;!-- Loading Overlay --&gt;",
            "lineNumber": 435
          },
          {
            "text": "    &lt;div v-if=\"loading\" class=\"loading-overlay\"&gt;",
            "lineNumber": 436
          },
          {
            "text": "      &lt;div class=\"loading-spinner\"&gt;読み込み中...&lt;/div&gt;",
            "lineNumber": 437
          },
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 438
          },
          {
            "lineNumber": 439
          },
          {
            "text": "    &lt;!-- Error Message --&gt;",
            "lineNumber": 440
          },
          {
            "text": "    &lt;div v-if=\"error\" class=\"error-message\"&gt;",
            "lineNumber": 441
          },
          {
            "text": "      {{ error }}",
            "lineNumber": 442
          },
          {
            "text": "    &lt;/div&gt;",
            "lineNumber": 443
          },
          {
            "text": "  &lt;/div&gt;",
            "lineNumber": 444
          },
          {
            "text": "&lt;/template&gt;",
            "lineNumber": 445
          },
          {
            "lineNumber": 446
          },
          {
            "text": "&lt;script&gt;",
            "lineNumber": 447
          },
          {
            "text": "import { getMonthlySummaryDetail } from '@/services/api'",
            "lineNumber": 448
          },
          {
            "lineNumber": 449
          },
          {
            "text": "export default {",
            "lineNumber": 450
          },
          {
            "text": "  name: 'MonthlySummaryScreen',",
            "lineNumber": 451
          }
        ]
      },
      "score": 0.32148146629333496
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async \nfor (let day = 1; day &lt;= daysInMonth; day++) {\n\n\n    dailyData.push({\n      attendanceId: attendanceId,\n      employeeId: employeeId,\n      workDate: workDate,\n      clockInTime: clockInTime,\n      clockOutTime: clockOutTime,\n      clockInType: clockInType,\n      clockOutType: clockOutType,\n      originalClockInTime: originalClockInTime,\n      originalClockOutTime: originalClockOutTime,\n      actualWorkHours: actualWorkHours,\n      breakTimeTotal: breakTimeTotal,\n      overtimeHours: overtimeHours,\n      holidayWorkHours: holidayWorkHours,\n      nightWorkHours: nightWorkHours,\n      workLocationCode: workLocationCode,\n      remarkText: remarkText,\n      isDailyConfirmed: isDailyConfirmed,\n      holidayName: holidayName,\n      vacationTypeName: vacationTypeName,\n      withinLegalOvertimeMinutes: withinLegalOvertimeMinutes,\n      overLegalOvertimeMinutes: overLegalOvertimeMinutes\n    });\n  }\n  \n  // 3. 月次サマリーデータ取得（計算）\n  const actualWorkDays = attendanceRows.filter(row =&gt; \n    row.CLOCK_IN_TIME &amp;&amp; row.CLOCK_OUT_TIME\n  ).length;\n  \n  // 法定休日出勤日数、所定休日出勤日数は簡易的に計算\n  // （実際の実装では、祝日マスタやカレンダーマスタを参照する必要がある）\n  const legalHolidayWorkDays = 0; // TODO: 法定休日出勤日数を計算\n  const scheduledHolidayWorkDays = 0; // TODO: 所定休日出勤日数を計算\n  \n  // 所定労働時間（1日7.5時間 × 所定出勤日数）\n  const scheduledWorkHours = scheduledWorkDays * 7.5;\n  \n  // 総労働時間（丸め誤差を避けるため、各日の出退勤時刻と休憩時間から直接計算）\n  let totalWorkMinutes = 0;\n  for (const row of attendanceRows) {\n    if (row.CLOCK_IN_TIME &amp;&amp; row.CLOCK_OUT_TIME)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            },
            {
              "startPosition": {
                "line": 59,
                "column": 3
              },
              "endPosition": {
                "line": 60,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "text": "for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 59
          },
          {
            "lineNumber": 181
          },
          {
            "lineNumber": 182
          },
          {
            "text": "    dailyData.push({",
            "lineNumber": 183
          },
          {
            "text": "      attendanceId: attendanceId,",
            "lineNumber": 184
          },
          {
            "text": "      employeeId: employeeId,",
            "lineNumber": 185
          },
          {
            "text": "      workDate: workDate,",
            "lineNumber": 186
          },
          {
            "text": "      clockInTime: clockInTime,",
            "lineNumber": 187
          },
          {
            "text": "      clockOutTime: clockOutTime,",
            "lineNumber": 188
          },
          {
            "text": "      clockInType: clockInType,",
            "lineNumber": 189
          },
          {
            "text": "      clockOutType: clockOutType,",
            "lineNumber": 190
          },
          {
            "text": "      originalClockInTime: originalClockInTime,",
            "lineNumber": 191
          },
          {
            "text": "      originalClockOutTime: originalClockOutTime,",
            "lineNumber": 192
          },
          {
            "text": "      actualWorkHours: actualWorkHours,",
            "lineNumber": 193
          },
          {
            "text": "      breakTimeTotal: breakTimeTotal,",
            "lineNumber": 194
          },
          {
            "text": "      overtimeHours: overtimeHours,",
            "lineNumber": 195
          },
          {
            "text": "      holidayWorkHours: holidayWorkHours,",
            "lineNumber": 196
          },
          {
            "text": "      nightWorkHours: nightWorkHours,",
            "lineNumber": 197
          },
          {
            "text": "      workLocationCode: workLocationCode,",
            "lineNumber": 198
          },
          {
            "text": "      remarkText: remarkText,",
            "lineNumber": 199
          },
          {
            "text": "      isDailyConfirmed: isDailyConfirmed,",
            "lineNumber": 200
          },
          {
            "text": "      holidayName: holidayName,",
            "lineNumber": 201
          },
          {
            "text": "      vacationTypeName: vacationTypeName,",
            "lineNumber": 202
          },
          {
            "text": "      withinLegalOvertimeMinutes: withinLegalOvertimeMinutes,",
            "lineNumber": 203
          },
          {
            "text": "      overLegalOvertimeMinutes: overLegalOvertimeMinutes",
            "lineNumber": 204
          },
          {
            "text": "    });",
            "lineNumber": 205
          },
          {
            "text": "  }",
            "lineNumber": 206
          },
          {
            "text": "  ",
            "lineNumber": 207
          },
          {
            "text": "  // 3. 月次サマリーデータ取得（計算）",
            "lineNumber": 208
          },
          {
            "text": "  const actualWorkDays = attendanceRows.filter(row =&gt; ",
            "lineNumber": 209
          },
          {
            "text": "    row.CLOCK_IN_TIME &amp;&amp; row.CLOCK_OUT_TIME",
            "lineNumber": 210
          },
          {
            "text": "  ).length;",
            "lineNumber": 211
          },
          {
            "text": "  ",
            "lineNumber": 212
          },
          {
            "text": "  // 法定休日出勤日数、所定休日出勤日数は簡易的に計算",
            "lineNumber": 213
          },
          {
            "text": "  // （実際の実装では、祝日マスタやカレンダーマスタを参照する必要がある）",
            "lineNumber": 214
          },
          {
            "text": "  const legalHolidayWorkDays = 0; // TODO: 法定休日出勤日数を計算",
            "lineNumber": 215
          },
          {
            "text": "  const scheduledHolidayWorkDays = 0; // TODO: 所定休日出勤日数を計算",
            "lineNumber": 216
          },
          {
            "text": "  ",
            "lineNumber": 217
          },
          {
            "text": "  // 所定労働時間（1日7.5時間 × 所定出勤日数）",
            "lineNumber": 218
          },
          {
            "text": "  const scheduledWorkHours = scheduledWorkDays * 7.5;",
            "lineNumber": 219
          },
          {
            "text": "  ",
            "lineNumber": 220
          },
          {
            "text": "  // 総労働時間（丸め誤差を避けるため、各日の出退勤時刻と休憩時間から直接計算）",
            "lineNumber": 221
          },
          {
            "text": "  let totalWorkMinutes = 0;",
            "lineNumber": 222
          },
          {
            "text": "  for (const row of attendanceRows) {",
            "lineNumber": 223
          },
          {
            "text": "    if (row.CLOCK_IN_TIME &amp;&amp; row.CLOCK_OUT_TIME)",
            "lineNumber": 224
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.3145383596420288
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "休暇申請や休日出勤申請のデータ取得方法",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 333,
            "column": 2
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "/**\n * 月間勤務表を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {number} year 年\n * @param {number} month 月\n * @returns {Promise&lt;Object&gt;} 月間勤務表データ\n */\nconst getMonthlyAttendance = async (employeeId, year, month) =&gt; {\n  const { startDate, endDate } = getMonthRange(year, month);\n  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);\n\n  // 休日出勤申請を取得\n  const holidayWorkApplications = await applicationModel.getApplicationsByType(\n    employeeId,\n    'HOLIDAY_WORK',\n    startDate,\n    endDate\n  );\n  \n  // 休暇申請を取得\n  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);\n  \n  // 各勤怠記録に対して休憩時間、公用外出、工数実績を取得\n  const dailyData = [];\n  for (const attendance of attendanceRows) {\n    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 336
          },
          {
            "text": " * 月間勤務表を取得する。",
            "lineNumber": 337
          },
          {
            "text": " *",
            "lineNumber": 338
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 339
          },
          {
            "text": " * @param {number} year 年",
            "lineNumber": 340
          },
          {
            "text": " * @param {number} month 月",
            "lineNumber": 341
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月間勤務表データ",
            "lineNumber": 342
          },
          {
            "text": " */",
            "lineNumber": 343
          },
          {
            "text": "const getMonthlyAttendance = async (employeeId, year, month) =&gt; {",
            "lineNumber": 344
          },
          {
            "text": "  const { startDate, endDate } = getMonthRange(year, month);",
            "lineNumber": 345
          },
          {
            "text": "  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);",
            "lineNumber": 346
          },
          {
            "lineNumber": 347
          },
          {
            "text": "  // 休日出勤申請を取得",
            "lineNumber": 348
          },
          {
            "text": "  const holidayWorkApplications = await applicationModel.getApplicationsByType(",
            "lineNumber": 349
          },
          {
            "text": "    employeeId,",
            "lineNumber": 350
          },
          {
            "text": "    'HOLIDAY_WORK',",
            "lineNumber": 351
          },
          {
            "text": "    startDate,",
            "lineNumber": 352
          },
          {
            "text": "    endDate",
            "lineNumber": 353
          },
          {
            "text": "  );",
            "lineNumber": 354
          },
          {
            "text": "  ",
            "lineNumber": 355
          },
          {
            "text": "  // 休暇申請を取得",
            "lineNumber": 356
          },
          {
            "text": "  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);",
            "lineNumber": 357
          },
          {
            "text": "  ",
            "lineNumber": 358
          },
          {
            "text": "  // 各勤怠記録に対して休憩時間、公用外出、工数実績を取得",
            "lineNumber": 359
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 360
          },
          {
            "text": "  for (const attendance of attendanceRows) {",
            "lineNumber": 361
          },
          {
            "text": "    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 362
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.5293615460395813
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 343
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "const getMonthlyAttendance = async \n\n  const dailyData = [];\n  for (const attendance of attendanceRows) {\n    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n    const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);\n    const workHours = await workHoursModel.getWorkHours(employeeId, normalizeDate(attendance.WORK_DATE));\n    \n    // 該当日の休日出勤申請を取得\n    const workDate = normalizeDate(attendance.WORK_DATE);\n    const holidayWorkApp = holidayWorkApplications.find(app =&gt; {\n      const appStartDate = normalizeDate(app.TARGET_START_DATE);\n      const appEndDate = normalizeDate(app.TARGET_END_DATE);\n      return workDate &gt;= appStartDate &amp;&amp; workDate &lt;= appEndDate &amp;&amp; \n             (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');\n    });\n    \n    // 該当日の休暇申請を取得\n    const vacation = vacations.find(v =&gt; {\n      const vStartDate = normalizeDate(v.START_DATE);\n      const vEndDate = normalizeDate(v.END_DATE);\n      return workDate &gt;= vStartDate &amp;&amp; workDate &lt;= vEndDate &amp;&amp; \n             (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');\n    });\n    \n    dailyData.push({\n      ...attendance,\n      WORK_DATE: normalizeDate(attendance.WORK_DATE),\n      breakTimes,\n      officialOutings,\n      workHours,\n      holidayWorkApplication: holidayWorkApp || null,\n      vacation: vacation || null\n    });\n  }\n  \n  // 勤怠記録がない日付にも休日出勤申請の情報を追加\n  const daysInMonth = new Date(year, month, 0).getDate();\n  const existingDates = new Set(dailyData.map(d =&gt; d.WORK_DATE));\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const dateStr = &#96;${year}&#96;;\n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 344,
                "column": 1
              },
              "endPosition": {
                "line": 344,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 344,
                "column": 7
              },
              "endPosition": {
                "line": 344,
                "column": 36
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlyAttendance = async ",
            "lineNumber": 344
          },
          {
            "lineNumber": 359
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 360
          },
          {
            "text": "  for (const attendance of attendanceRows) {",
            "lineNumber": 361
          },
          {
            "text": "    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 362
          },
          {
            "text": "    const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);",
            "lineNumber": 363
          },
          {
            "text": "    const workHours = await workHoursModel.getWorkHours(employeeId, normalizeDate(attendance.WORK_DATE));",
            "lineNumber": 364
          },
          {
            "text": "    ",
            "lineNumber": 365
          },
          {
            "text": "    // 該当日の休日出勤申請を取得",
            "lineNumber": 366
          },
          {
            "text": "    const workDate = normalizeDate(attendance.WORK_DATE);",
            "lineNumber": 367
          },
          {
            "text": "    const holidayWorkApp = holidayWorkApplications.find(app =&gt; {",
            "lineNumber": 368
          },
          {
            "text": "      const appStartDate = normalizeDate(app.TARGET_START_DATE);",
            "lineNumber": 369
          },
          {
            "text": "      const appEndDate = normalizeDate(app.TARGET_END_DATE);",
            "lineNumber": 370
          },
          {
            "text": "      return workDate &gt;= appStartDate &amp;&amp; workDate &lt;= appEndDate &amp;&amp; ",
            "lineNumber": 371
          },
          {
            "text": "             (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 372
          },
          {
            "text": "    });",
            "lineNumber": 373
          },
          {
            "text": "    ",
            "lineNumber": 374
          },
          {
            "text": "    // 該当日の休暇申請を取得",
            "lineNumber": 375
          },
          {
            "text": "    const vacation = vacations.find(v =&gt; {",
            "lineNumber": 376
          },
          {
            "text": "      const vStartDate = normalizeDate(v.START_DATE);",
            "lineNumber": 377
          },
          {
            "text": "      const vEndDate = normalizeDate(v.END_DATE);",
            "lineNumber": 378
          },
          {
            "text": "      return workDate &gt;= vStartDate &amp;&amp; workDate &lt;= vEndDate &amp;&amp; ",
            "lineNumber": 379
          },
          {
            "text": "             (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 380
          },
          {
            "text": "    });",
            "lineNumber": 381
          },
          {
            "text": "    ",
            "lineNumber": 382
          },
          {
            "text": "    dailyData.push({",
            "lineNumber": 383
          },
          {
            "text": "      ...attendance,",
            "lineNumber": 384
          },
          {
            "text": "      WORK_DATE: normalizeDate(attendance.WORK_DATE),",
            "lineNumber": 385
          },
          {
            "text": "      breakTimes,",
            "lineNumber": 386
          },
          {
            "text": "      officialOutings,",
            "lineNumber": 387
          },
          {
            "text": "      workHours,",
            "lineNumber": 388
          },
          {
            "text": "      holidayWorkApplication: holidayWorkApp || null,",
            "lineNumber": 389
          },
          {
            "text": "      vacation: vacation || null",
            "lineNumber": 390
          },
          {
            "text": "    });",
            "lineNumber": 391
          },
          {
            "text": "  }",
            "lineNumber": 392
          },
          {
            "text": "  ",
            "lineNumber": 393
          },
          {
            "text": "  // 勤怠記録がない日付にも休日出勤申請の情報を追加",
            "lineNumber": 394
          },
          {
            "text": "  const daysInMonth = new Date(year, month, 0).getDate();",
            "lineNumber": 395
          },
          {
            "text": "  const existingDates = new Set(dailyData.map(d =&gt; d.WORK_DATE));",
            "lineNumber": 396
          },
          {
            "text": "  ",
            "lineNumber": 397
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 398
          },
          {
            "text": "    const dateStr = &#96;${year}&#96;;",
            "lineNumber": 399
          },
          {
            "text": "  }",
            "lineNumber": 431
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.5167034268379211
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\applicationModel.js",
        "range": {
          "startPosition": {
            "line": 44,
            "column": 2
          },
          "endPosition": {
            "line": 73,
            "column": 3
          }
        },
        "contents": "/**\n * 休暇申請を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} startDate - 開始日（YYYY-MM-DD形式）\n * @param {string} endDate - 終了日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Array&gt;} 休暇申請の配列\n */\nconst getVacations = async (employeeId, startDate, endDate) =&gt; {\n  const query = &#96;\n    SELECT VACATION_ID, VACATION_TYPE_CODE, START_DATE, END_DATE, VACATION_DAYS, APPROVAL_STATUS, REASON, CONTACT_INFO, CREATED_AT, UPDATED_AT\n    FROM VACATION_HISTORY\n    WHERE EMPLOYEE_ID = ? \n      AND START_DATE &lt;= ? \n      AND END_DATE &gt;= ? \n      AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')\n    ORDER BY START_DATE\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, endDate, startDate]);\n  return rows;\n};\n\n/**\n * 休暇残日数を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} vacationTypeCode - 休暇種別コード\n * @returns {Promise&lt;number&gt;} 残日数\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 47
          },
          {
            "text": " * 休暇申請を取得",
            "lineNumber": 48
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 49
          },
          {
            "text": " * @param {string} startDate - 開始日（YYYY-MM-DD形式）",
            "lineNumber": 50
          },
          {
            "text": " * @param {string} endDate - 終了日（YYYY-MM-DD形式）",
            "lineNumber": 51
          },
          {
            "text": " * @returns {Promise&lt;Array&gt;} 休暇申請の配列",
            "lineNumber": 52
          },
          {
            "text": " */",
            "lineNumber": 53
          },
          {
            "text": "const getVacations = async (employeeId, startDate, endDate) =&gt; {",
            "lineNumber": 54
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 55
          },
          {
            "text": "    SELECT VACATION_ID, VACATION_TYPE_CODE, START_DATE, END_DATE, VACATION_DAYS, APPROVAL_STATUS, REASON, CONTACT_INFO, CREATED_AT, UPDATED_AT",
            "lineNumber": 56
          },
          {
            "text": "    FROM VACATION_HISTORY",
            "lineNumber": 57
          },
          {
            "text": "    WHERE EMPLOYEE_ID = ? ",
            "lineNumber": 58
          },
          {
            "text": "      AND START_DATE &lt;= ? ",
            "lineNumber": 59
          },
          {
            "text": "      AND END_DATE &gt;= ? ",
            "lineNumber": 60
          },
          {
            "text": "      AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')",
            "lineNumber": 61
          },
          {
            "text": "    ORDER BY START_DATE",
            "lineNumber": 62
          },
          {
            "text": "  &#96;;",
            "lineNumber": 63
          },
          {
            "text": "  ",
            "lineNumber": 64
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, endDate, startDate]);",
            "lineNumber": 65
          },
          {
            "text": "  return rows;",
            "lineNumber": 66
          },
          {
            "text": "};",
            "lineNumber": 67
          },
          {
            "lineNumber": 68
          },
          {
            "text": "/**",
            "lineNumber": 69
          },
          {
            "text": " * 休暇残日数を取得",
            "lineNumber": 70
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 71
          },
          {
            "text": " * @param {string} vacationTypeCode - 休暇種別コード",
            "lineNumber": 72
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 残日数",
            "lineNumber": 73
          },
          {
            "text": " */",
            "lineNumber": 74
          }
        ]
      },
      "score": 0.5011809468269348
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1952
          },
          "endPosition": {
            "line": 2000
          }
        },
        "contents": "    async loadHolidayWorkApplicationData() {\n      // 休日出勤申請データを読み込む（申請中または承認済みの場合）\n      try {\n        const response = await getHolidayWorkStatus(this.employeeId, this.targetDate)\n        if (response.success &amp;&amp; response.applicationStatus) {\n          // 申請データを取得してフォームに設定\n          // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定\n        }\n      } catch (error) {\n        console.error('休日出勤申請データ取得エラー:', error)\n      }\n    },\n    \n    async loadVacationApplicationData() {\n      // 休暇申請データを読み込む（申請中または承認済みの場合）\n      try {\n        const response = await getApplicationInfo(this.employeeId, 'VACATION', this.targetDate)\n        if (response.success &amp;&amp; response.applicationData) {\n          const data = response.applicationData\n          // フォームに申請データを設定\n          if (data.VACATION_TYPE_CODE) {\n            this.vacationForm.vacationType = data.VACATION_TYPE_CODE\n          }\n          if (data.START_DATE) {\n            this.vacationForm.startDate = data.START_DATE\n          }\n          if (data.END_DATE) {\n            this.vacationForm.endDate = data.END_DATE\n            this.vacationForm.enableEndDate = true\n          } else if (data.START_DATE) {\n            // 終了日がない場合は開始日と同じにする\n            this.vacationForm.endDate = data.START_DATE\n            this.vacationForm.enableEndDate = false\n          }\n          if (data.REASON) {\n            this.vacationForm.reason = data.REASON\n          }\n          if (data.CONTACT_INFO) {\n            this.vacationForm.contact = data.CONTACT_INFO\n          }\n        }\n      } catch (error) {\n        console.error('休暇申請データ取得エラー:', error)\n      }\n    },\n    \n    async loadOvertimeApplicationData() {\n      // 残業申請データを読み込む（申請中または承認済みの場合）",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    async loadHolidayWorkApplicationData() {",
            "lineNumber": 1953
          },
          {
            "text": "      // 休日出勤申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 1954
          },
          {
            "text": "      try {",
            "lineNumber": 1955
          },
          {
            "text": "        const response = await getHolidayWorkStatus(this.employeeId, this.targetDate)",
            "lineNumber": 1956
          },
          {
            "text": "        if (response.success &amp;&amp; response.applicationStatus) {",
            "lineNumber": 1957
          },
          {
            "text": "          // 申請データを取得してフォームに設定",
            "lineNumber": 1958
          },
          {
            "text": "          // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定",
            "lineNumber": 1959
          },
          {
            "text": "        }",
            "lineNumber": 1960
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1961
          },
          {
            "text": "        console.error('休日出勤申請データ取得エラー:', error)",
            "lineNumber": 1962
          },
          {
            "text": "      }",
            "lineNumber": 1963
          },
          {
            "text": "    },",
            "lineNumber": 1964
          },
          {
            "text": "    ",
            "lineNumber": 1965
          },
          {
            "text": "    async loadVacationApplicationData() {",
            "lineNumber": 1966
          },
          {
            "text": "      // 休暇申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 1967
          },
          {
            "text": "      try {",
            "lineNumber": 1968
          },
          {
            "text": "        const response = await getApplicationInfo(this.employeeId, 'VACATION', this.targetDate)",
            "lineNumber": 1969
          },
          {
            "text": "        if (response.success &amp;&amp; response.applicationData) {",
            "lineNumber": 1970
          },
          {
            "text": "          const data = response.applicationData",
            "lineNumber": 1971
          },
          {
            "text": "          // フォームに申請データを設定",
            "lineNumber": 1972
          },
          {
            "text": "          if (data.VACATION_TYPE_CODE) {",
            "lineNumber": 1973
          },
          {
            "text": "            this.vacationForm.vacationType = data.VACATION_TYPE_CODE",
            "lineNumber": 1974
          },
          {
            "text": "          }",
            "lineNumber": 1975
          },
          {
            "text": "          if (data.START_DATE) {",
            "lineNumber": 1976
          },
          {
            "text": "            this.vacationForm.startDate = data.START_DATE",
            "lineNumber": 1977
          },
          {
            "text": "          }",
            "lineNumber": 1978
          },
          {
            "text": "          if (data.END_DATE) {",
            "lineNumber": 1979
          },
          {
            "text": "            this.vacationForm.endDate = data.END_DATE",
            "lineNumber": 1980
          },
          {
            "text": "            this.vacationForm.enableEndDate = true",
            "lineNumber": 1981
          },
          {
            "text": "          } else if (data.START_DATE) {",
            "lineNumber": 1982
          },
          {
            "text": "            // 終了日がない場合は開始日と同じにする",
            "lineNumber": 1983
          },
          {
            "text": "            this.vacationForm.endDate = data.START_DATE",
            "lineNumber": 1984
          },
          {
            "text": "            this.vacationForm.enableEndDate = false",
            "lineNumber": 1985
          },
          {
            "text": "          }",
            "lineNumber": 1986
          },
          {
            "text": "          if (data.REASON) {",
            "lineNumber": 1987
          },
          {
            "text": "            this.vacationForm.reason = data.REASON",
            "lineNumber": 1988
          },
          {
            "text": "          }",
            "lineNumber": 1989
          },
          {
            "text": "          if (data.CONTACT_INFO) {",
            "lineNumber": 1990
          },
          {
            "text": "            this.vacationForm.contact = data.CONTACT_INFO",
            "lineNumber": 1991
          },
          {
            "text": "          }",
            "lineNumber": 1992
          },
          {
            "text": "        }",
            "lineNumber": 1993
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1994
          },
          {
            "text": "        console.error('休暇申請データ取得エラー:', error)",
            "lineNumber": 1995
          },
          {
            "text": "      }",
            "lineNumber": 1996
          },
          {
            "text": "    },",
            "lineNumber": 1997
          },
          {
            "text": "    ",
            "lineNumber": 1998
          },
          {
            "text": "    async loadOvertimeApplicationData() {",
            "lineNumber": 1999
          },
          {
            "text": "      // 残業申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 2000
          }
        ]
      },
      "score": 0.4949624538421631
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\applicationModel.js",
        "range": {
          "startPosition": {
            "line": 472,
            "column": 2
          },
          "endPosition": {
            "line": 577,
            "column": 1
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得（休暇申請）\n * @param {string} employeeId - 従業員ID\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴\n */\nconst getVacationApplicationInfo = async (employeeId, targetDate) =&gt; {\n  // 全ての申請履歴を取得（PENDING, APPROVED, NOT_SUBMITTEDを含む）\n  const query = &#96;\n    SELECT \n      vh.VACATION_ID,\n      vh.VACATION_TYPE_CODE,\n      vh.START_DATE,\n      vh.END_DATE,\n      vh.REASON,\n      vh.CONTACT_INFO,\n      DATE_FORMAT(vh.CREATED_AT, '%Y/%m/%d %H:%i') AS APPLICATION_DATE,\n      vh.CREATED_AT,\n      vh.APPROVAL_STATUS,\n      DATE_FORMAT(vh.UPDATED_AT, '%Y/%m/%d %H:%i') AS UPDATED_DATE,\n      e.EMPLOYEE_NAME AS ACTOR_NAME\n    FROM VACATION_HISTORY vh\n    LEFT JOIN EMPLOYEE e ON vh.EMPLOYEE_ID = e.EMPLOYEE_ID\n    WHERE vh.EMPLOYEE_ID = ? \n      AND vh.START_DATE &lt;= ?\n      AND vh.END_DATE &gt;= ?\n      AND vh.APPROVAL_STATUS IN ('PENDING', 'APPROVED', 'NOT_SUBMITTED')\n    ORDER BY vh.CREATED_AT ASC\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, targetDate, targetDate]);\n  if (rows.length === 0) {\n    return null;\n  }\n  \n  // 最新の申請（PENDINGまたはAPPROVED）を取得\n  // PENDINGまたはAPPROVEDの申請をフィルタして、CREATED_ATが最新のものを取得\n  const validApplications = rows.filter(r =&gt; r.APPROVAL_STATUS === 'PENDING' || r.APPROVAL_STATUS === 'APPROVED');\n  if (validApplications.length === 0) {\n    return null;\n  }\n  // CREATED_ATでソートして最新のものを取得\n  const latestApplication = validApplications.sort((a, b) =&gt; new Date(b.CREATED_AT) - new Date(a.CREATED_AT))[0];\n  if (!latestApplication) {\n    return null;\n  }\n  \n  // 承認履歴を構築（時系列順）\n  const history = [];\n  let seqNo = 1;\n  \n  for (let i = 0; i &lt; rows.length; i++) {\n    const app = rows[i];\n  }\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 475
          },
          {
            "text": " * 申請情報と承認履歴を取得（休暇申請）",
            "lineNumber": 476
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 477
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 478
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴",
            "lineNumber": 479
          },
          {
            "text": " */",
            "lineNumber": 480
          },
          {
            "text": "const getVacationApplicationInfo = async (employeeId, targetDate) =&gt; {",
            "lineNumber": 481
          },
          {
            "text": "  // 全ての申請履歴を取得（PENDING, APPROVED, NOT_SUBMITTEDを含む）",
            "lineNumber": 482
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 483
          },
          {
            "text": "    SELECT ",
            "lineNumber": 484
          },
          {
            "text": "      vh.VACATION_ID,",
            "lineNumber": 485
          },
          {
            "text": "      vh.VACATION_TYPE_CODE,",
            "lineNumber": 486
          },
          {
            "text": "      vh.START_DATE,",
            "lineNumber": 487
          },
          {
            "text": "      vh.END_DATE,",
            "lineNumber": 488
          },
          {
            "text": "      vh.REASON,",
            "lineNumber": 489
          },
          {
            "text": "      vh.CONTACT_INFO,",
            "lineNumber": 490
          },
          {
            "text": "      DATE_FORMAT(vh.CREATED_AT, '%Y/%m/%d %H:%i') AS APPLICATION_DATE,",
            "lineNumber": 491
          },
          {
            "text": "      vh.CREATED_AT,",
            "lineNumber": 492
          },
          {
            "text": "      vh.APPROVAL_STATUS,",
            "lineNumber": 493
          },
          {
            "text": "      DATE_FORMAT(vh.UPDATED_AT, '%Y/%m/%d %H:%i') AS UPDATED_DATE,",
            "lineNumber": 494
          },
          {
            "text": "      e.EMPLOYEE_NAME AS ACTOR_NAME",
            "lineNumber": 495
          },
          {
            "text": "    FROM VACATION_HISTORY vh",
            "lineNumber": 496
          },
          {
            "text": "    LEFT JOIN EMPLOYEE e ON vh.EMPLOYEE_ID = e.EMPLOYEE_ID",
            "lineNumber": 497
          },
          {
            "text": "    WHERE vh.EMPLOYEE_ID = ? ",
            "lineNumber": 498
          },
          {
            "text": "      AND vh.START_DATE &lt;= ?",
            "lineNumber": 499
          },
          {
            "text": "      AND vh.END_DATE &gt;= ?",
            "lineNumber": 500
          },
          {
            "text": "      AND vh.APPROVAL_STATUS IN ('PENDING', 'APPROVED', 'NOT_SUBMITTED')",
            "lineNumber": 501
          },
          {
            "text": "    ORDER BY vh.CREATED_AT ASC",
            "lineNumber": 502
          },
          {
            "text": "  &#96;;",
            "lineNumber": 503
          },
          {
            "text": "  ",
            "lineNumber": 504
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, targetDate, targetDate]);",
            "lineNumber": 505
          },
          {
            "text": "  if (rows.length === 0) {",
            "lineNumber": 506
          },
          {
            "text": "    return null;",
            "lineNumber": 507
          },
          {
            "text": "  }",
            "lineNumber": 508
          },
          {
            "text": "  ",
            "lineNumber": 509
          },
          {
            "text": "  // 最新の申請（PENDINGまたはAPPROVED）を取得",
            "lineNumber": 510
          },
          {
            "text": "  // PENDINGまたはAPPROVEDの申請をフィルタして、CREATED_ATが最新のものを取得",
            "lineNumber": 511
          },
          {
            "text": "  const validApplications = rows.filter(r =&gt; r.APPROVAL_STATUS === 'PENDING' || r.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 512
          },
          {
            "text": "  if (validApplications.length === 0) {",
            "lineNumber": 513
          },
          {
            "text": "    return null;",
            "lineNumber": 514
          },
          {
            "text": "  }",
            "lineNumber": 515
          },
          {
            "text": "  // CREATED_ATでソートして最新のものを取得",
            "lineNumber": 516
          },
          {
            "text": "  const latestApplication = validApplications.sort((a, b) =&gt; new Date(b.CREATED_AT) - new Date(a.CREATED_AT))[0];",
            "lineNumber": 517
          },
          {
            "text": "  if (!latestApplication) {",
            "lineNumber": 518
          },
          {
            "text": "    return null;",
            "lineNumber": 519
          },
          {
            "text": "  }",
            "lineNumber": 520
          },
          {
            "text": "  ",
            "lineNumber": 521
          },
          {
            "text": "  // 承認履歴を構築（時系列順）",
            "lineNumber": 522
          },
          {
            "text": "  const history = [];",
            "lineNumber": 523
          },
          {
            "text": "  let seqNo = 1;",
            "lineNumber": 524
          },
          {
            "text": "  ",
            "lineNumber": 525
          },
          {
            "text": "  for (let i = 0; i &lt; rows.length; i++) {",
            "lineNumber": 526
          },
          {
            "text": "    const app = rows[i];",
            "lineNumber": 527
          },
          {
            "text": "  }",
            "lineNumber": 563
          },
          {
            "text": ";",
            "lineNumber": 578
          }
        ]
      },
      "score": 0.47937315702438354
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 343
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "const getMonthlyAttendance = async \n\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const dateStr = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;\n    if (!existingDates.has(dateStr)) {\n      // 該当日の休日出勤申請を取得\n      const holidayWorkApp = holidayWorkApplications.find(app =&gt; {\n        const appStartDate = normalizeDate(app.TARGET_START_DATE);\n        const appEndDate = normalizeDate(app.TARGET_END_DATE);\n        return dateStr &gt;= appStartDate &amp;&amp; dateStr &lt;= appEndDate &amp;&amp; \n               (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');\n      });\n      \n      // 該当日の休暇申請を取得\n      const vacation = vacations.find(v =&gt; {\n        const vStartDate = normalizeDate(v.START_DATE);\n        const vEndDate = normalizeDate(v.END_DATE);\n        return dateStr &gt;= vStartDate &amp;&amp; dateStr &lt;= vEndDate &amp;&amp; \n               (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');\n      });\n      \n      if (holidayWorkApp || vacation) {\n        dailyData.push({\n          WORK_DATE: dateStr,\n          ATTENDANCE_ID: null,\n          CLOCK_IN_TIME: null,\n          CLOCK_OUT_TIME: null,\n          breakTimes: [],\n          officialOutings: [],\n          workHours: [],\n          holidayWorkApplication: holidayWorkApp || null,\n          vacation: vacation || null\n        });\n      }\n    }\n  }\n  \n  // 月次サマリーを計算\n  const todayStr = getTodayJST();\n  const isCurrentMonth = parseInt(year) === new Date().getFullYear() &amp;&amp; parseInt(month) === new Date().getMonth() + 1;\n  let cutoffDate = endDate;\n\n  if (isCurrentMonth) {\n    cutoffDate = todayStr;\n  }\n\n  // 当日退勤していない場合は前日までの過不足時間を計算\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 344,
                "column": 1
              },
              "endPosition": {
                "line": 344,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 344,
                "column": 7
              },
              "endPosition": {
                "line": 344,
                "column": 36
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlyAttendance = async ",
            "lineNumber": 344
          },
          {
            "lineNumber": 396
          },
          {
            "text": "  ",
            "lineNumber": 397
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 398
          },
          {
            "text": "    const dateStr = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;",
            "lineNumber": 399
          },
          {
            "text": "    if (!existingDates.has(dateStr)) {",
            "lineNumber": 400
          },
          {
            "text": "      // 該当日の休日出勤申請を取得",
            "lineNumber": 401
          },
          {
            "text": "      const holidayWorkApp = holidayWorkApplications.find(app =&gt; {",
            "lineNumber": 402
          },
          {
            "text": "        const appStartDate = normalizeDate(app.TARGET_START_DATE);",
            "lineNumber": 403
          },
          {
            "text": "        const appEndDate = normalizeDate(app.TARGET_END_DATE);",
            "lineNumber": 404
          },
          {
            "text": "        return dateStr &gt;= appStartDate &amp;&amp; dateStr &lt;= appEndDate &amp;&amp; ",
            "lineNumber": 405
          },
          {
            "text": "               (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 406
          },
          {
            "text": "      });",
            "lineNumber": 407
          },
          {
            "text": "      ",
            "lineNumber": 408
          },
          {
            "text": "      // 該当日の休暇申請を取得",
            "lineNumber": 409
          },
          {
            "text": "      const vacation = vacations.find(v =&gt; {",
            "lineNumber": 410
          },
          {
            "text": "        const vStartDate = normalizeDate(v.START_DATE);",
            "lineNumber": 411
          },
          {
            "text": "        const vEndDate = normalizeDate(v.END_DATE);",
            "lineNumber": 412
          },
          {
            "text": "        return dateStr &gt;= vStartDate &amp;&amp; dateStr &lt;= vEndDate &amp;&amp; ",
            "lineNumber": 413
          },
          {
            "text": "               (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 414
          },
          {
            "text": "      });",
            "lineNumber": 415
          },
          {
            "text": "      ",
            "lineNumber": 416
          },
          {
            "text": "      if (holidayWorkApp || vacation) {",
            "lineNumber": 417
          },
          {
            "text": "        dailyData.push({",
            "lineNumber": 418
          },
          {
            "text": "          WORK_DATE: dateStr,",
            "lineNumber": 419
          },
          {
            "text": "          ATTENDANCE_ID: null,",
            "lineNumber": 420
          },
          {
            "text": "          CLOCK_IN_TIME: null,",
            "lineNumber": 421
          },
          {
            "text": "          CLOCK_OUT_TIME: null,",
            "lineNumber": 422
          },
          {
            "text": "          breakTimes: [],",
            "lineNumber": 423
          },
          {
            "text": "          officialOutings: [],",
            "lineNumber": 424
          },
          {
            "text": "          workHours: [],",
            "lineNumber": 425
          },
          {
            "text": "          holidayWorkApplication: holidayWorkApp || null,",
            "lineNumber": 426
          },
          {
            "text": "          vacation: vacation || null",
            "lineNumber": 427
          },
          {
            "text": "        });",
            "lineNumber": 428
          },
          {
            "text": "      }",
            "lineNumber": 429
          },
          {
            "text": "    }",
            "lineNumber": 430
          },
          {
            "text": "  }",
            "lineNumber": 431
          },
          {
            "text": "  ",
            "lineNumber": 432
          },
          {
            "text": "  // 月次サマリーを計算",
            "lineNumber": 433
          },
          {
            "text": "  const todayStr = getTodayJST();",
            "lineNumber": 434
          },
          {
            "text": "  const isCurrentMonth = parseInt(year) === new Date().getFullYear() &amp;&amp; parseInt(month) === new Date().getMonth() + 1;",
            "lineNumber": 435
          },
          {
            "text": "  let cutoffDate = endDate;",
            "lineNumber": 436
          },
          {
            "lineNumber": 437
          },
          {
            "text": "  if (isCurrentMonth) {",
            "lineNumber": 438
          },
          {
            "text": "    cutoffDate = todayStr;",
            "lineNumber": 439
          },
          {
            "text": "  }",
            "lineNumber": 440
          },
          {
            "lineNumber": 441
          },
          {
            "text": "  // 当日退勤していない場合は前日までの過不足時間を計算",
            "lineNumber": 442
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.46792054176330566
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\routes\\application.js",
        "range": {
          "startPosition": {
            "line": 53,
            "column": 79
          },
          "endPosition": {
            "line": 91,
            "column": 78
          }
        },
        "contents": "/**\n * 休日出勤申請リスト取得API（代休取得可能日数計算用）\n * GET /api/application/holiday-work-list\n */\nrouter.get('/holiday-work-list', async (req, res, next) =&gt; {\n  try {\n    const { employeeId, startDate, endDate } = req.query;\n    \n    if (!employeeId || !startDate || !endDate) {\n      return res.status(400).json({\n        success: false,\n        message: '従業員ID、開始日、終了日が必要です。'\n      });\n    }\n    \n    const applicationModel = require('../models/applicationModel');\n    const applications = await applicationModel.getApplicationsByType(\n      employeeId,\n      'HOLIDAY_WORK',\n      startDate,\n      endDate\n    );\n    \n    res.json({\n      success: true,\n      applications\n    });\n  } catch (error) {\n    next(error);\n  }\n});\n\n/**\n * 申請状態取得API\n * GET /api/application/application-status\n */\nrouter.get('/application-status', applicationController.getApplicationStatus);",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 56
          },
          {
            "text": " * 休日出勤申請リスト取得API（代休取得可能日数計算用）",
            "lineNumber": 57
          },
          {
            "text": " * GET /api/application/holiday-work-list",
            "lineNumber": 58
          },
          {
            "text": " */",
            "lineNumber": 59
          },
          {
            "text": "router.get('/holiday-work-list', async (req, res, next) =&gt; {",
            "lineNumber": 60
          },
          {
            "text": "  try {",
            "lineNumber": 61
          },
          {
            "text": "    const { employeeId, startDate, endDate } = req.query;",
            "lineNumber": 62
          },
          {
            "text": "    ",
            "lineNumber": 63
          },
          {
            "text": "    if (!employeeId || !startDate || !endDate) {",
            "lineNumber": 64
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 65
          },
          {
            "text": "        success: false,",
            "lineNumber": 66
          },
          {
            "text": "        message: '従業員ID、開始日、終了日が必要です。'",
            "lineNumber": 67
          },
          {
            "text": "      });",
            "lineNumber": 68
          },
          {
            "text": "    }",
            "lineNumber": 69
          },
          {
            "text": "    ",
            "lineNumber": 70
          },
          {
            "text": "    const applicationModel = require('../models/applicationModel');",
            "lineNumber": 71
          },
          {
            "text": "    const applications = await applicationModel.getApplicationsByType(",
            "lineNumber": 72
          },
          {
            "text": "      employeeId,",
            "lineNumber": 73
          },
          {
            "text": "      'HOLIDAY_WORK',",
            "lineNumber": 74
          },
          {
            "text": "      startDate,",
            "lineNumber": 75
          },
          {
            "text": "      endDate",
            "lineNumber": 76
          },
          {
            "text": "    );",
            "lineNumber": 77
          },
          {
            "text": "    ",
            "lineNumber": 78
          },
          {
            "text": "    res.json({",
            "lineNumber": 79
          },
          {
            "text": "      success: true,",
            "lineNumber": 80
          },
          {
            "text": "      applications",
            "lineNumber": 81
          },
          {
            "text": "    });",
            "lineNumber": 82
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 83
          },
          {
            "text": "    next(error);",
            "lineNumber": 84
          },
          {
            "text": "  }",
            "lineNumber": 85
          },
          {
            "text": "});",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "/**",
            "lineNumber": 88
          },
          {
            "text": " * 申請状態取得API",
            "lineNumber": 89
          },
          {
            "text": " * GET /api/application/application-status",
            "lineNumber": 90
          },
          {
            "text": " */",
            "lineNumber": 91
          },
          {
            "text": "router.get('/application-status', applicationController.getApplicationStatus);",
            "lineNumber": 92
          }
        ]
      },
      "score": 0.4644418954849243
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\applicationModel.js",
        "range": {
          "startPosition": {
            "line": 577,
            "column": 2
          },
          "endPosition": {
            "line": 672,
            "column": 1
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得（その他の申請：休日出勤、残業、早朝勤務、振替）\n * @param {string} employeeId - 従業員ID\n * @param {string} applicationType - 申請種別\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴\n */\nconst getApplicationInfo = async (employeeId, applicationType, targetDate) =&gt; {\n  // 全ての申請履歴を取得（PENDING, APPROVED, NOT_SUBMITTEDを含む）\n  const query = &#96;\n    SELECT \n      ah.APPLICATION_ID,\n      DATE_FORMAT(ah.CREATED_AT, '%Y/%m/%d %H:%i') AS APPLICATION_DATE,\n      ah.CREATED_AT,\n      ah.APPROVAL_STATUS,\n      DATE_FORMAT(ah.UPDATED_AT, '%Y/%m/%d %H:%i') AS UPDATED_DATE,\n      e.EMPLOYEE_NAME AS ACTOR_NAME\n    FROM APPLICATION_HISTORY ah\n    LEFT JOIN EMPLOYEE e ON ah.EMPLOYEE_ID = e.EMPLOYEE_ID\n    WHERE ah.EMPLOYEE_ID = ? \n      AND ah.APPLICATION_TYPE = ?\n      AND ah.TARGET_START_DATE &lt;= ?\n      AND ah.TARGET_END_DATE &gt;= ?\n      AND ah.APPROVAL_STATUS IN ('PENDING', 'APPROVED', 'NOT_SUBMITTED')\n    ORDER BY ah.CREATED_AT ASC\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, applicationType, targetDate, targetDate]);\n  if (rows.length === 0) {\n    return null;\n  }\n  \n  // 最新の申請（PENDINGまたはAPPROVED）を取得\n  // PENDINGまたはAPPROVEDの申請をフィルタして、CREATED_ATが最新のものを取得\n  const validApplications = rows.filter(r =&gt; r.APPROVAL_STATUS === 'PENDING' || r.APPROVAL_STATUS === 'APPROVED');\n  if (validApplications.length === 0) {\n    return null;\n  }\n  // CREATED_ATでソートして最新のものを取得\n  const latestApplication = validApplications.sort((a, b) =&gt; new Date(b.CREATED_AT) - new Date(a.CREATED_AT))[0];\n  if (!latestApplication) {\n    return null;\n  }\n  \n  // 承認履歴を構築（時系列順）\n  const history = [];\n  let seqNo = 1;\n  \n  for (let i = 0; i &lt; rows.length; i++) {\n    const app = rows[i];\n  }\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 580
          },
          {
            "text": " * 申請情報と承認履歴を取得（その他の申請：休日出勤、残業、早朝勤務、振替）",
            "lineNumber": 581
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 582
          },
          {
            "text": " * @param {string} applicationType - 申請種別",
            "lineNumber": 583
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 584
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴",
            "lineNumber": 585
          },
          {
            "text": " */",
            "lineNumber": 586
          },
          {
            "text": "const getApplicationInfo = async (employeeId, applicationType, targetDate) =&gt; {",
            "lineNumber": 587
          },
          {
            "text": "  // 全ての申請履歴を取得（PENDING, APPROVED, NOT_SUBMITTEDを含む）",
            "lineNumber": 588
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 589
          },
          {
            "text": "    SELECT ",
            "lineNumber": 590
          },
          {
            "text": "      ah.APPLICATION_ID,",
            "lineNumber": 591
          },
          {
            "text": "      DATE_FORMAT(ah.CREATED_AT, '%Y/%m/%d %H:%i') AS APPLICATION_DATE,",
            "lineNumber": 592
          },
          {
            "text": "      ah.CREATED_AT,",
            "lineNumber": 593
          },
          {
            "text": "      ah.APPROVAL_STATUS,",
            "lineNumber": 594
          },
          {
            "text": "      DATE_FORMAT(ah.UPDATED_AT, '%Y/%m/%d %H:%i') AS UPDATED_DATE,",
            "lineNumber": 595
          },
          {
            "text": "      e.EMPLOYEE_NAME AS ACTOR_NAME",
            "lineNumber": 596
          },
          {
            "text": "    FROM APPLICATION_HISTORY ah",
            "lineNumber": 597
          },
          {
            "text": "    LEFT JOIN EMPLOYEE e ON ah.EMPLOYEE_ID = e.EMPLOYEE_ID",
            "lineNumber": 598
          },
          {
            "text": "    WHERE ah.EMPLOYEE_ID = ? ",
            "lineNumber": 599
          },
          {
            "text": "      AND ah.APPLICATION_TYPE = ?",
            "lineNumber": 600
          },
          {
            "text": "      AND ah.TARGET_START_DATE &lt;= ?",
            "lineNumber": 601
          },
          {
            "text": "      AND ah.TARGET_END_DATE &gt;= ?",
            "lineNumber": 602
          },
          {
            "text": "      AND ah.APPROVAL_STATUS IN ('PENDING', 'APPROVED', 'NOT_SUBMITTED')",
            "lineNumber": 603
          },
          {
            "text": "    ORDER BY ah.CREATED_AT ASC",
            "lineNumber": 604
          },
          {
            "text": "  &#96;;",
            "lineNumber": 605
          },
          {
            "text": "  ",
            "lineNumber": 606
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, applicationType, targetDate, targetDate]);",
            "lineNumber": 607
          },
          {
            "text": "  if (rows.length === 0) {",
            "lineNumber": 608
          },
          {
            "text": "    return null;",
            "lineNumber": 609
          },
          {
            "text": "  }",
            "lineNumber": 610
          },
          {
            "text": "  ",
            "lineNumber": 611
          },
          {
            "text": "  // 最新の申請（PENDINGまたはAPPROVED）を取得",
            "lineNumber": 612
          },
          {
            "text": "  // PENDINGまたはAPPROVEDの申請をフィルタして、CREATED_ATが最新のものを取得",
            "lineNumber": 613
          },
          {
            "text": "  const validApplications = rows.filter(r =&gt; r.APPROVAL_STATUS === 'PENDING' || r.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 614
          },
          {
            "text": "  if (validApplications.length === 0) {",
            "lineNumber": 615
          },
          {
            "text": "    return null;",
            "lineNumber": 616
          },
          {
            "text": "  }",
            "lineNumber": 617
          },
          {
            "text": "  // CREATED_ATでソートして最新のものを取得",
            "lineNumber": 618
          },
          {
            "text": "  const latestApplication = validApplications.sort((a, b) =&gt; new Date(b.CREATED_AT) - new Date(a.CREATED_AT))[0];",
            "lineNumber": 619
          },
          {
            "text": "  if (!latestApplication) {",
            "lineNumber": 620
          },
          {
            "text": "    return null;",
            "lineNumber": 621
          },
          {
            "text": "  }",
            "lineNumber": 622
          },
          {
            "text": "  ",
            "lineNumber": 623
          },
          {
            "text": "  // 承認履歴を構築（時系列順）",
            "lineNumber": 624
          },
          {
            "text": "  const history = [];",
            "lineNumber": 625
          },
          {
            "text": "  let seqNo = 1;",
            "lineNumber": 626
          },
          {
            "text": "  ",
            "lineNumber": 627
          },
          {
            "text": "  for (let i = 0; i &lt; rows.length; i++) {",
            "lineNumber": 628
          },
          {
            "text": "    const app = rows[i];",
            "lineNumber": 629
          },
          {
            "text": "  }",
            "lineNumber": 665
          },
          {
            "text": ";",
            "lineNumber": 673
          }
        ]
      },
      "score": 0.4643751382827759
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 206,
            "column": 2
          },
          "endPosition": {
            "line": 270,
            "column": 3
          }
        },
        "contents": "/**\n * 申請状態を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} applicationType - 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請状態\n */\nconst getApplicationStatus = async (employeeId, applicationType, targetDate) =&gt; {\n  let status = 'NOT_SUBMITTED';\n  let applicationId = null;\n  \n  switch (applicationType) {\n    case 'DAILY_CONFIRMATION': {\n      // 日次確定申請の状態を取得\n      const attendanceModel = require('../models/attendanceModel');\n      const attendance = await attendanceModel.getAttendanceDetail(employeeId, targetDate);\n      if (attendance &amp;&amp; attendance.APPROVAL_STATUS) {\n        status = attendance.APPROVAL_STATUS;\n      }\n      break;\n    }\n    case 'VACATION': {\n      // 休暇申請の状態を取得\n      const vacations = await applicationModel.getVacations(employeeId, targetDate, targetDate);\n      if (vacations &amp;&amp; vacations.length &gt; 0) {\n        const vacation = vacations.find(v =&gt; \n          v.START_DATE &lt;= targetDate &amp;&amp; v.END_DATE &gt;= targetDate &amp;&amp;\n          (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED')\n        );\n        if (vacation) {\n          status = vacation.APPROVAL_STATUS;\n          applicationId = vacation.VACATION_ID;\n        }\n      }\n      break;\n    }\n    case 'HOLIDAY_WORK':\n    case 'OVERTIME':\n    case 'EARLY_WORK':\n    case 'TRANSFER': {\n      // APPLICATION_HISTORYから取得\n      const application = await applicationModel.getApplicationStatus(employeeId, applicationType, targetDate);\n      if (application) {\n        status = application.APPROVAL_STATUS;\n        applicationId = application.APPLICATION_ID;\n      }\n      break;\n    }\n  }\n  \n  return {\n    status,\n    applicationId\n  };\n};\n\n/**\n * 月次確定申請取消\n * @param {string} employeeId - 従業員ID\n * @param {number} year - 年\n * @param {number} month - 月\n * @returns {Promise&lt;void&gt;}\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 209
          },
          {
            "text": " * 申請状態を取得",
            "lineNumber": 210
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 211
          },
          {
            "text": " * @param {string} applicationType - 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 212
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 213
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請状態",
            "lineNumber": 214
          },
          {
            "text": " */",
            "lineNumber": 215
          },
          {
            "text": "const getApplicationStatus = async (employeeId, applicationType, targetDate) =&gt; {",
            "lineNumber": 216
          },
          {
            "text": "  let status = 'NOT_SUBMITTED';",
            "lineNumber": 217
          },
          {
            "text": "  let applicationId = null;",
            "lineNumber": 218
          },
          {
            "text": "  ",
            "lineNumber": 219
          },
          {
            "text": "  switch (applicationType) {",
            "lineNumber": 220
          },
          {
            "text": "    case 'DAILY_CONFIRMATION': {",
            "lineNumber": 221
          },
          {
            "text": "      // 日次確定申請の状態を取得",
            "lineNumber": 222
          },
          {
            "text": "      const attendanceModel = require('../models/attendanceModel');",
            "lineNumber": 223
          },
          {
            "text": "      const attendance = await attendanceModel.getAttendanceDetail(employeeId, targetDate);",
            "lineNumber": 224
          },
          {
            "text": "      if (attendance &amp;&amp; attendance.APPROVAL_STATUS) {",
            "lineNumber": 225
          },
          {
            "text": "        status = attendance.APPROVAL_STATUS;",
            "lineNumber": 226
          },
          {
            "text": "      }",
            "lineNumber": 227
          },
          {
            "text": "      break;",
            "lineNumber": 228
          },
          {
            "text": "    }",
            "lineNumber": 229
          },
          {
            "text": "    case 'VACATION': {",
            "lineNumber": 230
          },
          {
            "text": "      // 休暇申請の状態を取得",
            "lineNumber": 231
          },
          {
            "text": "      const vacations = await applicationModel.getVacations(employeeId, targetDate, targetDate);",
            "lineNumber": 232
          },
          {
            "text": "      if (vacations &amp;&amp; vacations.length &gt; 0) {",
            "lineNumber": 233
          },
          {
            "text": "        const vacation = vacations.find(v =&gt; ",
            "lineNumber": 234
          },
          {
            "text": "          v.START_DATE &lt;= targetDate &amp;&amp; v.END_DATE &gt;= targetDate &amp;&amp;",
            "lineNumber": 235
          },
          {
            "text": "          (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED')",
            "lineNumber": 236
          },
          {
            "text": "        );",
            "lineNumber": 237
          },
          {
            "text": "        if (vacation) {",
            "lineNumber": 238
          },
          {
            "text": "          status = vacation.APPROVAL_STATUS;",
            "lineNumber": 239
          },
          {
            "text": "          applicationId = vacation.VACATION_ID;",
            "lineNumber": 240
          },
          {
            "text": "        }",
            "lineNumber": 241
          },
          {
            "text": "      }",
            "lineNumber": 242
          },
          {
            "text": "      break;",
            "lineNumber": 243
          },
          {
            "text": "    }",
            "lineNumber": 244
          },
          {
            "text": "    case 'HOLIDAY_WORK':",
            "lineNumber": 245
          },
          {
            "text": "    case 'OVERTIME':",
            "lineNumber": 246
          },
          {
            "text": "    case 'EARLY_WORK':",
            "lineNumber": 247
          },
          {
            "text": "    case 'TRANSFER': {",
            "lineNumber": 248
          },
          {
            "text": "      // APPLICATION_HISTORYから取得",
            "lineNumber": 249
          },
          {
            "text": "      const application = await applicationModel.getApplicationStatus(employeeId, applicationType, targetDate);",
            "lineNumber": 250
          },
          {
            "text": "      if (application) {",
            "lineNumber": 251
          },
          {
            "text": "        status = application.APPROVAL_STATUS;",
            "lineNumber": 252
          },
          {
            "text": "        applicationId = application.APPLICATION_ID;",
            "lineNumber": 253
          },
          {
            "text": "      }",
            "lineNumber": 254
          },
          {
            "text": "      break;",
            "lineNumber": 255
          },
          {
            "text": "    }",
            "lineNumber": 256
          },
          {
            "text": "  }",
            "lineNumber": 257
          },
          {
            "text": "  ",
            "lineNumber": 258
          },
          {
            "text": "  return {",
            "lineNumber": 259
          },
          {
            "text": "    status,",
            "lineNumber": 260
          },
          {
            "text": "    applicationId",
            "lineNumber": 261
          },
          {
            "text": "  };",
            "lineNumber": 262
          },
          {
            "text": "};",
            "lineNumber": 263
          },
          {
            "lineNumber": 264
          },
          {
            "text": "/**",
            "lineNumber": 265
          },
          {
            "text": " * 月次確定申請取消",
            "lineNumber": 266
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 267
          },
          {
            "text": " * @param {number} year - 年",
            "lineNumber": 268
          },
          {
            "text": " * @param {number} month - 月",
            "lineNumber": 269
          },
          {
            "text": " * @returns {Promise&lt;void&gt;}",
            "lineNumber": 270
          },
          {
            "text": " */",
            "lineNumber": 271
          }
        ]
      },
      "score": 0.452267050743103
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1889,
            "column": 8
          },
          "endPosition": {
            "line": 1918
          }
        },
        "contents": "await this.loadApplicationInfo('transfer')\n      }\n      \n      // 休日出勤申請タブを開いた場合、当月時間外残業を取得\n      if (applicationType === 'holidayWork') {\n        await this.loadMonthlyOvertime()\n        // 申請中または承認済みの場合、申請データを読み込む\n        if (this.isPendingOrApproved('holidayWork')) {\n          await this.loadHolidayWorkApplicationData()\n        }\n      }\n      \n      // その他の申請タイプで申請中または承認済みの場合、申請データを読み込む\n      if (applicationType === 'vacation' &amp;&amp; this.isPendingOrApproved('vacation')) {\n        await this.loadVacationApplicationData()\n      }\n      if (applicationType === 'overtime' &amp;&amp; this.isPendingOrApproved('overtime')) {\n        await this.loadOvertimeApplicationData()\n      }\n      if (applicationType === 'earlyWork' &amp;&amp; this.isPendingOrApproved('earlyWork')) {\n        await this.loadEarlyWorkApplicationData()\n      }\n      if (applicationType === 'transfer' &amp;&amp; this.isPendingOrApproved('transfer')) {\n        await this.loadTransferApplicationData()\n      }\n    },\n    \n    async loadApplicationStatus(applicationType) {\n      // 初期申請状態が指定されている場合は、APIを呼び出さずにそれを使用",
        "signatures": {},
        "detailedLines": [
          {
            "text": "await this.loadApplicationInfo('transfer')",
            "lineNumber": 1890
          },
          {
            "text": "      }",
            "lineNumber": 1891
          },
          {
            "text": "      ",
            "lineNumber": 1892
          },
          {
            "text": "      // 休日出勤申請タブを開いた場合、当月時間外残業を取得",
            "lineNumber": 1893
          },
          {
            "text": "      if (applicationType === 'holidayWork') {",
            "lineNumber": 1894
          },
          {
            "text": "        await this.loadMonthlyOvertime()",
            "lineNumber": 1895
          },
          {
            "text": "        // 申請中または承認済みの場合、申請データを読み込む",
            "lineNumber": 1896
          },
          {
            "text": "        if (this.isPendingOrApproved('holidayWork')) {",
            "lineNumber": 1897
          },
          {
            "text": "          await this.loadHolidayWorkApplicationData()",
            "lineNumber": 1898
          },
          {
            "text": "        }",
            "lineNumber": 1899
          },
          {
            "text": "      }",
            "lineNumber": 1900
          },
          {
            "text": "      ",
            "lineNumber": 1901
          },
          {
            "text": "      // その他の申請タイプで申請中または承認済みの場合、申請データを読み込む",
            "lineNumber": 1902
          },
          {
            "text": "      if (applicationType === 'vacation' &amp;&amp; this.isPendingOrApproved('vacation')) {",
            "lineNumber": 1903
          },
          {
            "text": "        await this.loadVacationApplicationData()",
            "lineNumber": 1904
          },
          {
            "text": "      }",
            "lineNumber": 1905
          },
          {
            "text": "      if (applicationType === 'overtime' &amp;&amp; this.isPendingOrApproved('overtime')) {",
            "lineNumber": 1906
          },
          {
            "text": "        await this.loadOvertimeApplicationData()",
            "lineNumber": 1907
          },
          {
            "text": "      }",
            "lineNumber": 1908
          },
          {
            "text": "      if (applicationType === 'earlyWork' &amp;&amp; this.isPendingOrApproved('earlyWork')) {",
            "lineNumber": 1909
          },
          {
            "text": "        await this.loadEarlyWorkApplicationData()",
            "lineNumber": 1910
          },
          {
            "text": "      }",
            "lineNumber": 1911
          },
          {
            "text": "      if (applicationType === 'transfer' &amp;&amp; this.isPendingOrApproved('transfer')) {",
            "lineNumber": 1912
          },
          {
            "text": "        await this.loadTransferApplicationData()",
            "lineNumber": 1913
          },
          {
            "text": "      }",
            "lineNumber": 1914
          },
          {
            "text": "    },",
            "lineNumber": 1915
          },
          {
            "text": "    ",
            "lineNumber": 1916
          },
          {
            "text": "    async loadApplicationStatus(applicationType) {",
            "lineNumber": 1917
          },
          {
            "text": "      // 初期申請状態が指定されている場合は、APIを呼び出さずにそれを使用",
            "lineNumber": 1918
          }
        ]
      },
      "score": 0.4501403868198395
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 149,
            "column": 2
          },
          "endPosition": {
            "line": 195,
            "column": 3
          }
        },
        "contents": "/**\n * 休日出勤申請状態を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請状態\n */\nconst getHolidayWorkStatus = async (employeeId, targetDate) =&gt; {\n  const application = await applicationModel.getApplicationStatus(employeeId, 'HOLIDAY_WORK', targetDate);\n  \n  let applicationStatus = null;\n\n  if (application) {\n    applicationStatus = application.APPROVAL_STATUS;\n  }\n\n  // 代休の表示条件：過去の休日出勤申請（承認済みまたは申請中）も確認\n  // 対象日から過去1年間の休日出勤申請を確認\n  const oneYearAgo = new Date(targetDate);\n  oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);\n  const oneYearAgoStr = oneYearAgo.toISOString().split('T')[0];\n  \n  const pastApplications = await applicationModel.getApplicationsByType(\n    employeeId,\n    'HOLIDAY_WORK',\n    oneYearAgoStr,\n    targetDate\n  );\n\n  const hasPastHolidayWork = pastApplications.length &gt; 0;\n\n  return {\n    success: true,\n    hasHolidayWorkApplication: !!application || hasPastHolidayWork,\n    applicationStatus: applicationStatus,\n    hasPastHolidayWorkApplication: hasPastHolidayWork\n  };\n};\n\n/**\n * 月次承認履歴を取得\n * @param {string} employeeId - 従業員ID\n * @param {number} year - 年\n * @param {number} month - 月\n * @returns {Promise&lt;Object&gt;} 月次承認情報\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 152
          },
          {
            "text": " * 休日出勤申請状態を取得",
            "lineNumber": 153
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 154
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 155
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請状態",
            "lineNumber": 156
          },
          {
            "text": " */",
            "lineNumber": 157
          },
          {
            "text": "const getHolidayWorkStatus = async (employeeId, targetDate) =&gt; {",
            "lineNumber": 158
          },
          {
            "text": "  const application = await applicationModel.getApplicationStatus(employeeId, 'HOLIDAY_WORK', targetDate);",
            "lineNumber": 159
          },
          {
            "text": "  ",
            "lineNumber": 160
          },
          {
            "text": "  let applicationStatus = null;",
            "lineNumber": 161
          },
          {
            "lineNumber": 162
          },
          {
            "text": "  if (application) {",
            "lineNumber": 163
          },
          {
            "text": "    applicationStatus = application.APPROVAL_STATUS;",
            "lineNumber": 164
          },
          {
            "text": "  }",
            "lineNumber": 165
          },
          {
            "lineNumber": 166
          },
          {
            "text": "  // 代休の表示条件：過去の休日出勤申請（承認済みまたは申請中）も確認",
            "lineNumber": 167
          },
          {
            "text": "  // 対象日から過去1年間の休日出勤申請を確認",
            "lineNumber": 168
          },
          {
            "text": "  const oneYearAgo = new Date(targetDate);",
            "lineNumber": 169
          },
          {
            "text": "  oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);",
            "lineNumber": 170
          },
          {
            "text": "  const oneYearAgoStr = oneYearAgo.toISOString().split('T')[0];",
            "lineNumber": 171
          },
          {
            "text": "  ",
            "lineNumber": 172
          },
          {
            "text": "  const pastApplications = await applicationModel.getApplicationsByType(",
            "lineNumber": 173
          },
          {
            "text": "    employeeId,",
            "lineNumber": 174
          },
          {
            "text": "    'HOLIDAY_WORK',",
            "lineNumber": 175
          },
          {
            "text": "    oneYearAgoStr,",
            "lineNumber": 176
          },
          {
            "text": "    targetDate",
            "lineNumber": 177
          },
          {
            "text": "  );",
            "lineNumber": 178
          },
          {
            "lineNumber": 179
          },
          {
            "text": "  const hasPastHolidayWork = pastApplications.length &gt; 0;",
            "lineNumber": 180
          },
          {
            "lineNumber": 181
          },
          {
            "text": "  return {",
            "lineNumber": 182
          },
          {
            "text": "    success: true,",
            "lineNumber": 183
          },
          {
            "text": "    hasHolidayWorkApplication: !!application || hasPastHolidayWork,",
            "lineNumber": 184
          },
          {
            "text": "    applicationStatus: applicationStatus,",
            "lineNumber": 185
          },
          {
            "text": "    hasPastHolidayWorkApplication: hasPastHolidayWork",
            "lineNumber": 186
          },
          {
            "text": "  };",
            "lineNumber": 187
          },
          {
            "text": "};",
            "lineNumber": 188
          },
          {
            "lineNumber": 189
          },
          {
            "text": "/**",
            "lineNumber": 190
          },
          {
            "text": " * 月次承認履歴を取得",
            "lineNumber": 191
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 192
          },
          {
            "text": " * @param {number} year - 年",
            "lineNumber": 193
          },
          {
            "text": " * @param {number} month - 月",
            "lineNumber": 194
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次承認情報",
            "lineNumber": 195
          },
          {
            "text": " */",
            "lineNumber": 196
          }
        ]
      },
      "score": 0.44967299699783325
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 85,
            "column": 1
          }
        },
        "contents": "/**\n * 勤怠サービス\n */\nconst attendanceModel = require('../models/attendanceModel');\nconst breakTimeModel = require('../models/breakTimeModel');\nconst workHoursModel = require('../models/workHoursModel');\nconst applicationModel = require('../models/applicationModel');\nconst { \n  getTodayJST, \n  getNow, \n  toDateTime, \n  formatHours, \n  formatOverUnder,\n  getMonthRange,\n  getScheduledWorkDays,\n  normalizeDate,\n  calculateMinutes\n} = require('../utils/dateUtils');\nconst db = require('../config/database');\n\n/**\n * 日次勤怠記録を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} workDate 勤務日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 勤怠記録\n */\nconst getDailyAttendance = async (employeeId, workDate) =&gt; {\n  const attendance = await attendanceModel.getAttendanceDetail(employeeId, workDate);\n  \n  if (!attendance) {\n    return null;\n  }\n  \n  const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n  const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);\n  \n  // 休憩時間と公用外出を統合\n  const combinedBreakTimes = [];\n  \n  for (const breakTime of breakTimes) {\n    combinedBreakTimes.push({\n      ...breakTime,\n      BREAK_TYPE: 'BREAK'\n    });\n  }\n  \n  for (const outing of officialOutings) {\n    combinedBreakTimes.push({\n      BREAK_ID: outing.OUTING_ID,\n      BREAK_SEQ: outing.OUTING_SEQ,\n      BREAK_START_TIME: outing.OUTING_START_TIME,\n      BREAK_END_TIME: outing.OUTING_END_TIME,\n      BREAK_DURATION_MINUTES: outing.OUTING_DURATION_MINUTES,\n      BREAK_TYPE: 'OFFICIAL_OUTING',\n      OUTING_PURPOSE: outing.OUTING_PURPOSE\n    });\n  }\n  \n  const isClockInManual = attendance.CLOCK_IN_TYPE === 'MANUAL';\n  const isClockOutManual = attendance.CLOCK_OUT_TYPE === 'MANUAL';\n\n  // ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEはデータベースから直接取得\n  // データベースに値が存在しない場合は、CLOCK_IN_TYPEがSTAMPの場合にCLOCK_IN_TIMEを使用\n  let originalClockInTime = attendance.ORIGINAL_CLOCK_IN_TIME;\n\n  if (!originalClockInTime &amp;&amp; attendance.CLOCK_IN_TYPE === 'STAMP')\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * 勤怠サービス",
            "lineNumber": 2
          },
          {
            "text": " */",
            "lineNumber": 3
          },
          {
            "text": "const attendanceModel = require('../models/attendanceModel');",
            "lineNumber": 4
          },
          {
            "text": "const breakTimeModel = require('../models/breakTimeModel');",
            "lineNumber": 5
          },
          {
            "text": "const workHoursModel = require('../models/workHoursModel');",
            "lineNumber": 6
          },
          {
            "text": "const applicationModel = require('../models/applicationModel');",
            "lineNumber": 7
          },
          {
            "text": "const { ",
            "lineNumber": 8
          },
          {
            "text": "  getTodayJST, ",
            "lineNumber": 9
          },
          {
            "text": "  getNow, ",
            "lineNumber": 10
          },
          {
            "text": "  toDateTime, ",
            "lineNumber": 11
          },
          {
            "text": "  formatHours, ",
            "lineNumber": 12
          },
          {
            "text": "  formatOverUnder,",
            "lineNumber": 13
          },
          {
            "text": "  getMonthRange,",
            "lineNumber": 14
          },
          {
            "text": "  getScheduledWorkDays,",
            "lineNumber": 15
          },
          {
            "text": "  normalizeDate,",
            "lineNumber": 16
          },
          {
            "text": "  calculateMinutes",
            "lineNumber": 17
          },
          {
            "text": "} = require('../utils/dateUtils');",
            "lineNumber": 18
          },
          {
            "text": "const db = require('../config/database');",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "/**",
            "lineNumber": 21
          },
          {
            "text": " * 日次勤怠記録を取得する。",
            "lineNumber": 22
          },
          {
            "text": " *",
            "lineNumber": 23
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 24
          },
          {
            "text": " * @param {string} workDate 勤務日（YYYY-MM-DD形式）",
            "lineNumber": 25
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 勤怠記録",
            "lineNumber": 26
          },
          {
            "text": " */",
            "lineNumber": 27
          },
          {
            "text": "const getDailyAttendance = async (employeeId, workDate) =&gt; {",
            "lineNumber": 28
          },
          {
            "text": "  const attendance = await attendanceModel.getAttendanceDetail(employeeId, workDate);",
            "lineNumber": 29
          },
          {
            "text": "  ",
            "lineNumber": 30
          },
          {
            "text": "  if (!attendance) {",
            "lineNumber": 31
          },
          {
            "text": "    return null;",
            "lineNumber": 32
          },
          {
            "text": "  }",
            "lineNumber": 33
          },
          {
            "text": "  ",
            "lineNumber": 34
          },
          {
            "text": "  const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 35
          },
          {
            "text": "  const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);",
            "lineNumber": 36
          },
          {
            "text": "  ",
            "lineNumber": 37
          },
          {
            "text": "  // 休憩時間と公用外出を統合",
            "lineNumber": 38
          },
          {
            "text": "  const combinedBreakTimes = [];",
            "lineNumber": 39
          },
          {
            "text": "  ",
            "lineNumber": 40
          },
          {
            "text": "  for (const breakTime of breakTimes) {",
            "lineNumber": 41
          },
          {
            "text": "    combinedBreakTimes.push({",
            "lineNumber": 42
          },
          {
            "text": "      ...breakTime,",
            "lineNumber": 43
          },
          {
            "text": "      BREAK_TYPE: 'BREAK'",
            "lineNumber": 44
          },
          {
            "text": "    });",
            "lineNumber": 45
          },
          {
            "text": "  }",
            "lineNumber": 46
          },
          {
            "text": "  ",
            "lineNumber": 47
          },
          {
            "text": "  for (const outing of officialOutings) {",
            "lineNumber": 48
          },
          {
            "text": "    combinedBreakTimes.push({",
            "lineNumber": 49
          },
          {
            "text": "      BREAK_ID: outing.OUTING_ID,",
            "lineNumber": 50
          },
          {
            "text": "      BREAK_SEQ: outing.OUTING_SEQ,",
            "lineNumber": 51
          },
          {
            "text": "      BREAK_START_TIME: outing.OUTING_START_TIME,",
            "lineNumber": 52
          },
          {
            "text": "      BREAK_END_TIME: outing.OUTING_END_TIME,",
            "lineNumber": 53
          },
          {
            "text": "      BREAK_DURATION_MINUTES: outing.OUTING_DURATION_MINUTES,",
            "lineNumber": 54
          },
          {
            "text": "      BREAK_TYPE: 'OFFICIAL_OUTING',",
            "lineNumber": 55
          },
          {
            "text": "      OUTING_PURPOSE: outing.OUTING_PURPOSE",
            "lineNumber": 56
          },
          {
            "text": "    });",
            "lineNumber": 57
          },
          {
            "text": "  }",
            "lineNumber": 58
          },
          {
            "text": "  ",
            "lineNumber": 59
          },
          {
            "text": "  const isClockInManual = attendance.CLOCK_IN_TYPE === 'MANUAL';",
            "lineNumber": 60
          },
          {
            "text": "  const isClockOutManual = attendance.CLOCK_OUT_TYPE === 'MANUAL';",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "  // ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEはデータベースから直接取得",
            "lineNumber": 63
          },
          {
            "text": "  // データベースに値が存在しない場合は、CLOCK_IN_TYPEがSTAMPの場合にCLOCK_IN_TIMEを使用",
            "lineNumber": 64
          },
          {
            "text": "  let originalClockInTime = attendance.ORIGINAL_CLOCK_IN_TIME;",
            "lineNumber": 65
          },
          {
            "lineNumber": 66
          },
          {
            "text": "  if (!originalClockInTime &amp;&amp; attendance.CLOCK_IN_TYPE === 'STAMP')",
            "lineNumber": 67
          },
          {
            "text": ";",
            "lineNumber": 86
          }
        ]
      },
      "score": 0.44561299681663513
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 435,
            "column": 2
          },
          "endPosition": {
            "line": 457,
            "column": 3
          }
        },
        "contents": "/**\n * 休暇情報を取得\n * @param {string} employeeId - 従業員ID\n * @returns {Promise&lt;Object&gt;} 休暇情報\n */\nconst getVacationInfo = async (employeeId) =&gt; {\n  const balances = await applicationModel.getVacationBalanceSummary(employeeId);\n  const history = await applicationModel.getVacationHistory(employeeId, 20);\n  \n  return {\n    balances,\n    history\n  };\n};\n\n/**\n * 有給残日数を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} vacationTypeCode - 休暇種別コード\n * @returns {Promise&lt;number&gt;} 残日数\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 438
          },
          {
            "text": " * 休暇情報を取得",
            "lineNumber": 439
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 440
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 休暇情報",
            "lineNumber": 441
          },
          {
            "text": " */",
            "lineNumber": 442
          },
          {
            "text": "const getVacationInfo = async (employeeId) =&gt; {",
            "lineNumber": 443
          },
          {
            "text": "  const balances = await applicationModel.getVacationBalanceSummary(employeeId);",
            "lineNumber": 444
          },
          {
            "text": "  const history = await applicationModel.getVacationHistory(employeeId, 20);",
            "lineNumber": 445
          },
          {
            "text": "  ",
            "lineNumber": 446
          },
          {
            "text": "  return {",
            "lineNumber": 447
          },
          {
            "text": "    balances,",
            "lineNumber": 448
          },
          {
            "text": "    history",
            "lineNumber": 449
          },
          {
            "text": "  };",
            "lineNumber": 450
          },
          {
            "text": "};",
            "lineNumber": 451
          },
          {
            "lineNumber": 452
          },
          {
            "text": "/**",
            "lineNumber": 453
          },
          {
            "text": " * 有給残日数を取得",
            "lineNumber": 454
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 455
          },
          {
            "text": " * @param {string} vacationTypeCode - 休暇種別コード",
            "lineNumber": 456
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 残日数",
            "lineNumber": 457
          },
          {
            "text": " */",
            "lineNumber": 458
          }
        ]
      },
      "score": 0.4444195032119751
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1547
          },
          "endPosition": {
            "line": 1584,
            "column": 8
          }
        },
        "contents": "    \n    async loadCompensatoryLeaveBalance() {\n      try {\n        // 代休取得可能日数は、承認済みまたは申請中の休日出勤申請の日数をカウント\n        // 対象日から過去1年間の休日出勤申請を取得\n        const oneYearAgo = new Date(this.targetDate);\n        oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);\n        const oneYearAgoStr = oneYearAgo.toISOString().split('T')[0];\n        \n        const response = await fetch(\n          &#96;http://localhost:3000/api/application/holiday-work-list?employeeId=${this.employeeId}&amp;startDate=${oneYearAgoStr}&amp;endDate=${this.targetDate}&#96;\n        );\n        const data = await response.json();\n        \n        if (data.success &amp;&amp; data.applications) {\n          // 承認済みまたは申請中の休日出勤申請の日数をカウント\n          let totalDays = 0;\n          for (const app of data.applications) {\n            if (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED') {\n              const startDate = new Date(app.TARGET_START_DATE);\n              const endDate = new Date(app.TARGET_END_DATE);\n              const days = Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;\n              totalDays += days;\n            }\n          }\n          this.compensatoryLeaveBalance = totalDays;\n        } else {\n          this.compensatoryLeaveBalance = 0;\n        }\n      } catch (error) {\n        console.error('代休取得可能日数取得エラー:', error)\n        this.compensatoryLeaveBalance = 0\n      }\n    },\n    \n    async loadClockStatus() {\n      try {\n        ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    ",
            "lineNumber": 1548
          },
          {
            "text": "    async loadCompensatoryLeaveBalance() {",
            "lineNumber": 1549
          },
          {
            "text": "      try {",
            "lineNumber": 1550
          },
          {
            "text": "        // 代休取得可能日数は、承認済みまたは申請中の休日出勤申請の日数をカウント",
            "lineNumber": 1551
          },
          {
            "text": "        // 対象日から過去1年間の休日出勤申請を取得",
            "lineNumber": 1552
          },
          {
            "text": "        const oneYearAgo = new Date(this.targetDate);",
            "lineNumber": 1553
          },
          {
            "text": "        oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);",
            "lineNumber": 1554
          },
          {
            "text": "        const oneYearAgoStr = oneYearAgo.toISOString().split('T')[0];",
            "lineNumber": 1555
          },
          {
            "text": "        ",
            "lineNumber": 1556
          },
          {
            "text": "        const response = await fetch(",
            "lineNumber": 1557
          },
          {
            "text": "          &#96;http://localhost:3000/api/application/holiday-work-list?employeeId=${this.employeeId}&amp;startDate=${oneYearAgoStr}&amp;endDate=${this.targetDate}&#96;",
            "lineNumber": 1558
          },
          {
            "text": "        );",
            "lineNumber": 1559
          },
          {
            "text": "        const data = await response.json();",
            "lineNumber": 1560
          },
          {
            "text": "        ",
            "lineNumber": 1561
          },
          {
            "text": "        if (data.success &amp;&amp; data.applications) {",
            "lineNumber": 1562
          },
          {
            "text": "          // 承認済みまたは申請中の休日出勤申請の日数をカウント",
            "lineNumber": 1563
          },
          {
            "text": "          let totalDays = 0;",
            "lineNumber": 1564
          },
          {
            "text": "          for (const app of data.applications) {",
            "lineNumber": 1565
          },
          {
            "text": "            if (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED') {",
            "lineNumber": 1566
          },
          {
            "text": "              const startDate = new Date(app.TARGET_START_DATE);",
            "lineNumber": 1567
          },
          {
            "text": "              const endDate = new Date(app.TARGET_END_DATE);",
            "lineNumber": 1568
          },
          {
            "text": "              const days = Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24)) + 1;",
            "lineNumber": 1569
          },
          {
            "text": "              totalDays += days;",
            "lineNumber": 1570
          },
          {
            "text": "            }",
            "lineNumber": 1571
          },
          {
            "text": "          }",
            "lineNumber": 1572
          },
          {
            "text": "          this.compensatoryLeaveBalance = totalDays;",
            "lineNumber": 1573
          },
          {
            "text": "        } else {",
            "lineNumber": 1574
          },
          {
            "text": "          this.compensatoryLeaveBalance = 0;",
            "lineNumber": 1575
          },
          {
            "text": "        }",
            "lineNumber": 1576
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1577
          },
          {
            "text": "        console.error('代休取得可能日数取得エラー:', error)",
            "lineNumber": 1578
          },
          {
            "text": "        this.compensatoryLeaveBalance = 0",
            "lineNumber": 1579
          },
          {
            "text": "      }",
            "lineNumber": 1580
          },
          {
            "text": "    },",
            "lineNumber": 1581
          },
          {
            "text": "    ",
            "lineNumber": 1582
          },
          {
            "text": "    async loadClockStatus() {",
            "lineNumber": 1583
          },
          {
            "text": "      try {",
            "lineNumber": 1584
          },
          {
            "text": "        ",
            "lineNumber": 1585
          }
        ]
      },
      "score": 0.44321346282958984
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1480
          },
          "endPosition": {
            "line": 1517
          }
        },
        "contents": "      }\n    },\n    \n    async loadPaidLeaveBalance() {\n      try {\n        const response = await fetch(\n          &#96;http://localhost:3000/api/application/vacation/balance?employeeId=${this.employeeId}&amp;vacationTypeCode=PAID_LEAVE&#96;\n        )\n        const data = await response.json()\n        if (data.success) {\n          this.paidLeaveBalance = data.balance || 0\n        }\n      } catch (error) {\n        console.error('有給残日数取得エラー:', error)\n      }\n    },\n    \n    async loadHolidayWorkStatus() {\n      try {\n        const response = await getHolidayWorkStatus(this.employeeId, this.targetDate)\n        if (response.success) {\n          // 対象日の休日出勤申請または過去の休日出勤申請がある場合、代休を表示可能\n          this.hasHolidayWorkApplication = response.hasHolidayWorkApplication || false\n          // 休日出勤申請がある場合、代休取得可能日数を取得\n          if (this.hasHolidayWorkApplication) {\n            await this.loadCompensatoryLeaveBalance()\n          }\n        }\n      } catch (error) {\n        console.error('休日出勤申請状態取得エラー:', error)\n        // エラー時はfalseとして扱う\n        this.hasHolidayWorkApplication = false\n      }\n    },\n    \n    async loadApplicationStatuses() {\n      // 各申請タイプの申請状態を取得",
        "signatures": {},
        "detailedLines": [
          {
            "text": "      }",
            "lineNumber": 1481
          },
          {
            "text": "    },",
            "lineNumber": 1482
          },
          {
            "text": "    ",
            "lineNumber": 1483
          },
          {
            "text": "    async loadPaidLeaveBalance() {",
            "lineNumber": 1484
          },
          {
            "text": "      try {",
            "lineNumber": 1485
          },
          {
            "text": "        const response = await fetch(",
            "lineNumber": 1486
          },
          {
            "text": "          &#96;http://localhost:3000/api/application/vacation/balance?employeeId=${this.employeeId}&amp;vacationTypeCode=PAID_LEAVE&#96;",
            "lineNumber": 1487
          },
          {
            "text": "        )",
            "lineNumber": 1488
          },
          {
            "text": "        const data = await response.json()",
            "lineNumber": 1489
          },
          {
            "text": "        if (data.success) {",
            "lineNumber": 1490
          },
          {
            "text": "          this.paidLeaveBalance = data.balance || 0",
            "lineNumber": 1491
          },
          {
            "text": "        }",
            "lineNumber": 1492
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1493
          },
          {
            "text": "        console.error('有給残日数取得エラー:', error)",
            "lineNumber": 1494
          },
          {
            "text": "      }",
            "lineNumber": 1495
          },
          {
            "text": "    },",
            "lineNumber": 1496
          },
          {
            "text": "    ",
            "lineNumber": 1497
          },
          {
            "text": "    async loadHolidayWorkStatus() {",
            "lineNumber": 1498
          },
          {
            "text": "      try {",
            "lineNumber": 1499
          },
          {
            "text": "        const response = await getHolidayWorkStatus(this.employeeId, this.targetDate)",
            "lineNumber": 1500
          },
          {
            "text": "        if (response.success) {",
            "lineNumber": 1501
          },
          {
            "text": "          // 対象日の休日出勤申請または過去の休日出勤申請がある場合、代休を表示可能",
            "lineNumber": 1502
          },
          {
            "text": "          this.hasHolidayWorkApplication = response.hasHolidayWorkApplication || false",
            "lineNumber": 1503
          },
          {
            "text": "          // 休日出勤申請がある場合、代休取得可能日数を取得",
            "lineNumber": 1504
          },
          {
            "text": "          if (this.hasHolidayWorkApplication) {",
            "lineNumber": 1505
          },
          {
            "text": "            await this.loadCompensatoryLeaveBalance()",
            "lineNumber": 1506
          },
          {
            "text": "          }",
            "lineNumber": 1507
          },
          {
            "text": "        }",
            "lineNumber": 1508
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1509
          },
          {
            "text": "        console.error('休日出勤申請状態取得エラー:', error)",
            "lineNumber": 1510
          },
          {
            "text": "        // エラー時はfalseとして扱う",
            "lineNumber": 1511
          },
          {
            "text": "        this.hasHolidayWorkApplication = false",
            "lineNumber": 1512
          },
          {
            "text": "      }",
            "lineNumber": 1513
          },
          {
            "text": "    },",
            "lineNumber": 1514
          },
          {
            "text": "    ",
            "lineNumber": 1515
          },
          {
            "text": "    async loadApplicationStatuses() {",
            "lineNumber": 1516
          },
          {
            "text": "      // 各申請タイプの申請状態を取得",
            "lineNumber": 1517
          }
        ]
      },
      "score": 0.4300802946090698
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 56,
            "column": 3
          }
        },
        "contents": "/**\n * 申請サービス\n */\nconst applicationModel = require('../models/applicationModel');\nconst { getNow, calculateDays, normalizeDate, getFiscalYear } = require('../utils/dateUtils');\n\n/**\n * 休暇申請\n * @param {Object} vacationData - 休暇申請データ\n * @returns {Promise&lt;number&gt;} 作成されたVACATION_ID\n */\nconst applyVacation = async (vacationData) =&gt; {\n  const {\n    employeeId,\n    vacationTypeCode,\n    startDate,\n    endDate,\n    reason,\n    contact\n  } = vacationData;\n  \n  // 日数を計算\n  const vacationDays = calculateDays(startDate, endDate);\n  \n  // 有給休暇の場合、残日数チェックと残日数の減算\n  if (vacationTypeCode === 'PAID_LEAVE') {\n    const remainingDays = await applicationModel.getVacationBalance(employeeId, vacationTypeCode);\n    if (vacationDays &gt; remainingDays) {\n      throw new Error('有給休暇の残日数が不足しています。');\n    }\n    \n    // 申請時に残日数を減らす\n    const fiscalYear = getFiscalYear(startDate);\n    await applicationModel.decreaseVacationBalance(employeeId, vacationTypeCode, vacationDays, fiscalYear);\n  }\n  \n  const now = getNow();\n  \n  return await applicationModel.createVacation({\n    employeeId,\n    vacationTypeCode,\n    startDate,\n    endDate,\n    vacationDays,\n    reason,\n    contactInfo: contact,\n    approvalStatus: 'PENDING',\n    createdAt: now,\n    updatedAt: now\n  });\n};\n\n/**\n * 休日出勤申請\n * @param {Object} applicationData - 申請データ\n * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * 申請サービス",
            "lineNumber": 2
          },
          {
            "text": " */",
            "lineNumber": 3
          },
          {
            "text": "const applicationModel = require('../models/applicationModel');",
            "lineNumber": 4
          },
          {
            "text": "const { getNow, calculateDays, normalizeDate, getFiscalYear } = require('../utils/dateUtils');",
            "lineNumber": 5
          },
          {
            "lineNumber": 6
          },
          {
            "text": "/**",
            "lineNumber": 7
          },
          {
            "text": " * 休暇申請",
            "lineNumber": 8
          },
          {
            "text": " * @param {Object} vacationData - 休暇申請データ",
            "lineNumber": 9
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたVACATION_ID",
            "lineNumber": 10
          },
          {
            "text": " */",
            "lineNumber": 11
          },
          {
            "text": "const applyVacation = async (vacationData) =&gt; {",
            "lineNumber": 12
          },
          {
            "text": "  const {",
            "lineNumber": 13
          },
          {
            "text": "    employeeId,",
            "lineNumber": 14
          },
          {
            "text": "    vacationTypeCode,",
            "lineNumber": 15
          },
          {
            "text": "    startDate,",
            "lineNumber": 16
          },
          {
            "text": "    endDate,",
            "lineNumber": 17
          },
          {
            "text": "    reason,",
            "lineNumber": 18
          },
          {
            "text": "    contact",
            "lineNumber": 19
          },
          {
            "text": "  } = vacationData;",
            "lineNumber": 20
          },
          {
            "text": "  ",
            "lineNumber": 21
          },
          {
            "text": "  // 日数を計算",
            "lineNumber": 22
          },
          {
            "text": "  const vacationDays = calculateDays(startDate, endDate);",
            "lineNumber": 23
          },
          {
            "text": "  ",
            "lineNumber": 24
          },
          {
            "text": "  // 有給休暇の場合、残日数チェックと残日数の減算",
            "lineNumber": 25
          },
          {
            "text": "  if (vacationTypeCode === 'PAID_LEAVE') {",
            "lineNumber": 26
          },
          {
            "text": "    const remainingDays = await applicationModel.getVacationBalance(employeeId, vacationTypeCode);",
            "lineNumber": 27
          },
          {
            "text": "    if (vacationDays &gt; remainingDays) {",
            "lineNumber": 28
          },
          {
            "text": "      throw new Error('有給休暇の残日数が不足しています。');",
            "lineNumber": 29
          },
          {
            "text": "    }",
            "lineNumber": 30
          },
          {
            "text": "    ",
            "lineNumber": 31
          },
          {
            "text": "    // 申請時に残日数を減らす",
            "lineNumber": 32
          },
          {
            "text": "    const fiscalYear = getFiscalYear(startDate);",
            "lineNumber": 33
          },
          {
            "text": "    await applicationModel.decreaseVacationBalance(employeeId, vacationTypeCode, vacationDays, fiscalYear);",
            "lineNumber": 34
          },
          {
            "text": "  }",
            "lineNumber": 35
          },
          {
            "text": "  ",
            "lineNumber": 36
          },
          {
            "text": "  const now = getNow();",
            "lineNumber": 37
          },
          {
            "text": "  ",
            "lineNumber": 38
          },
          {
            "text": "  return await applicationModel.createVacation({",
            "lineNumber": 39
          },
          {
            "text": "    employeeId,",
            "lineNumber": 40
          },
          {
            "text": "    vacationTypeCode,",
            "lineNumber": 41
          },
          {
            "text": "    startDate,",
            "lineNumber": 42
          },
          {
            "text": "    endDate,",
            "lineNumber": 43
          },
          {
            "text": "    vacationDays,",
            "lineNumber": 44
          },
          {
            "text": "    reason,",
            "lineNumber": 45
          },
          {
            "text": "    contactInfo: contact,",
            "lineNumber": 46
          },
          {
            "text": "    approvalStatus: 'PENDING',",
            "lineNumber": 47
          },
          {
            "text": "    createdAt: now,",
            "lineNumber": 48
          },
          {
            "text": "    updatedAt: now",
            "lineNumber": 49
          },
          {
            "text": "  });",
            "lineNumber": 50
          },
          {
            "text": "};",
            "lineNumber": 51
          },
          {
            "lineNumber": 52
          },
          {
            "text": "/**",
            "lineNumber": 53
          },
          {
            "text": " * 休日出勤申請",
            "lineNumber": 54
          },
          {
            "text": " * @param {Object} applicationData - 申請データ",
            "lineNumber": 55
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID",
            "lineNumber": 56
          },
          {
            "text": " */",
            "lineNumber": 57
          }
        ]
      },
      "score": 0.4275381565093994
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 460,
            "column": 2
          },
          "endPosition": {
            "line": 488,
            "column": 16
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} applicationType - 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴\n */\nconst getApplicationInfo = async (employeeId, applicationType, targetDate) =&gt; {\n  switch (applicationType) {\n    case 'DAILY_CONFIRMATION':\n      return await applicationModel.getDailyConfirmationApplicationInfo(employeeId, targetDate);\n    case 'VACATION':\n      return await applicationModel.getVacationApplicationInfo(employeeId, targetDate);\n    case 'HOLIDAY_WORK':\n    case 'OVERTIME':\n    case 'EARLY_WORK':\n    case 'TRANSFER':\n      return await applicationModel.getApplicationInfo(employeeId, applicationType, targetDate);\n    default:\n      throw new Error('無効な申請タイプです。');\n  }\n};\n\nmodule.exports = {\n  applyVacation,\n  applyHolidayWork,\n  applyOvertime,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 463
          },
          {
            "text": " * 申請情報と承認履歴を取得",
            "lineNumber": 464
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 465
          },
          {
            "text": " * @param {string} applicationType - 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 466
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 467
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴",
            "lineNumber": 468
          },
          {
            "text": " */",
            "lineNumber": 469
          },
          {
            "text": "const getApplicationInfo = async (employeeId, applicationType, targetDate) =&gt; {",
            "lineNumber": 470
          },
          {
            "text": "  switch (applicationType) {",
            "lineNumber": 471
          },
          {
            "text": "    case 'DAILY_CONFIRMATION':",
            "lineNumber": 472
          },
          {
            "text": "      return await applicationModel.getDailyConfirmationApplicationInfo(employeeId, targetDate);",
            "lineNumber": 473
          },
          {
            "text": "    case 'VACATION':",
            "lineNumber": 474
          },
          {
            "text": "      return await applicationModel.getVacationApplicationInfo(employeeId, targetDate);",
            "lineNumber": 475
          },
          {
            "text": "    case 'HOLIDAY_WORK':",
            "lineNumber": 476
          },
          {
            "text": "    case 'OVERTIME':",
            "lineNumber": 477
          },
          {
            "text": "    case 'EARLY_WORK':",
            "lineNumber": 478
          },
          {
            "text": "    case 'TRANSFER':",
            "lineNumber": 479
          },
          {
            "text": "      return await applicationModel.getApplicationInfo(employeeId, applicationType, targetDate);",
            "lineNumber": 480
          },
          {
            "text": "    default:",
            "lineNumber": 481
          },
          {
            "text": "      throw new Error('無効な申請タイプです。');",
            "lineNumber": 482
          },
          {
            "text": "  }",
            "lineNumber": 483
          },
          {
            "text": "};",
            "lineNumber": 484
          },
          {
            "lineNumber": 485
          },
          {
            "text": "module.exports = {",
            "lineNumber": 486
          },
          {
            "text": "  applyVacation,",
            "lineNumber": 487
          },
          {
            "text": "  applyHolidayWork,",
            "lineNumber": 488
          },
          {
            "text": "  applyOvertime,",
            "lineNumber": 489
          }
        ]
      },
      "score": 0.4273728132247925
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 207,
            "column": 1
          },
          "endPosition": {
            "line": 230,
            "column": 3
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請情報データ\n */\nexport async function getApplicationInfo(employeeId, applicationType, targetDate) {\n  const endpoint = &#96;/application/application-info?employeeId=${employeeId}&amp;applicationType=${applicationType}&amp;targetDate=${targetDate}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * 申請を取り消す。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string|number} applicationId 申請ID（日次確定の場合は不要）\n * @param {string} targetDate 対象日（YYYY-MM-DD形式、日次確定の場合のみ必要）\n * @returns {Promise&lt;Object&gt;} レスポンスデータ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 210
          },
          {
            "text": " * 申請情報と承認履歴を取得する。",
            "lineNumber": 211
          },
          {
            "text": " *",
            "lineNumber": 212
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 213
          },
          {
            "text": " * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 214
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式）",
            "lineNumber": 215
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請情報データ",
            "lineNumber": 216
          },
          {
            "text": " */",
            "lineNumber": 217
          },
          {
            "text": "export async function getApplicationInfo(employeeId, applicationType, targetDate) {",
            "lineNumber": 218,
            "isSignature": true
          },
          {
            "text": "  const endpoint = &#96;/application/application-info?employeeId=${employeeId}&amp;applicationType=${applicationType}&amp;targetDate=${targetDate}&#96;",
            "lineNumber": 219
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 220
          },
          {
            "text": "}",
            "lineNumber": 221,
            "isSignature": true
          },
          {
            "lineNumber": 222
          },
          {
            "text": "/**",
            "lineNumber": 223
          },
          {
            "text": " * 申請を取り消す。",
            "lineNumber": 224
          },
          {
            "text": " *",
            "lineNumber": 225
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 226
          },
          {
            "text": " * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 227
          },
          {
            "text": " * @param {string|number} applicationId 申請ID（日次確定の場合は不要）",
            "lineNumber": 228
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式、日次確定の場合のみ必要）",
            "lineNumber": 229
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} レスポンスデータ",
            "lineNumber": 230
          },
          {
            "text": " */",
            "lineNumber": 231
          }
        ]
      },
      "score": 0.42723536491394043
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\applicationModel.js",
        "range": {
          "startPosition": {
            "line": 325,
            "column": 2
          },
          "endPosition": {
            "line": 357,
            "column": 3
          }
        },
        "contents": "/**\n * 申請種別と期間で申請を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} applicationType - 申請種別\n * @param {string} startDate - 開始日（YYYY-MM-DD形式）\n * @param {string} endDate - 終了日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Array&gt;} 申請の配列\n */\nconst getApplicationsByType = async (employeeId, applicationType, startDate, endDate) =&gt; {\n  const query = &#96;\n    SELECT APPLICATION_ID, EMPLOYEE_ID, APPLICATION_TYPE, TARGET_START_DATE, TARGET_END_DATE, \n           OVERTIME_HOURS, REASON, APPROVAL_STATUS, CREATED_AT, UPDATED_AT\n    FROM APPLICATION_HISTORY\n    WHERE EMPLOYEE_ID = ? \n      AND APPLICATION_TYPE = ?\n      AND TARGET_START_DATE &lt;= ?\n      AND TARGET_END_DATE &gt;= ?\n      AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')\n    ORDER BY TARGET_START_DATE\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, applicationType, endDate, startDate]);\n  return rows;\n};\n\n/**\n * 申請情報と承認履歴を取得（日次確定申請）\n * @param {string} employeeId - 従業員ID\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 328
          },
          {
            "text": " * 申請種別と期間で申請を取得",
            "lineNumber": 329
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 330
          },
          {
            "text": " * @param {string} applicationType - 申請種別",
            "lineNumber": 331
          },
          {
            "text": " * @param {string} startDate - 開始日（YYYY-MM-DD形式）",
            "lineNumber": 332
          },
          {
            "text": " * @param {string} endDate - 終了日（YYYY-MM-DD形式）",
            "lineNumber": 333
          },
          {
            "text": " * @returns {Promise&lt;Array&gt;} 申請の配列",
            "lineNumber": 334
          },
          {
            "text": " */",
            "lineNumber": 335
          },
          {
            "text": "const getApplicationsByType = async (employeeId, applicationType, startDate, endDate) =&gt; {",
            "lineNumber": 336
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 337
          },
          {
            "text": "    SELECT APPLICATION_ID, EMPLOYEE_ID, APPLICATION_TYPE, TARGET_START_DATE, TARGET_END_DATE, ",
            "lineNumber": 338
          },
          {
            "text": "           OVERTIME_HOURS, REASON, APPROVAL_STATUS, CREATED_AT, UPDATED_AT",
            "lineNumber": 339
          },
          {
            "text": "    FROM APPLICATION_HISTORY",
            "lineNumber": 340
          },
          {
            "text": "    WHERE EMPLOYEE_ID = ? ",
            "lineNumber": 341
          },
          {
            "text": "      AND APPLICATION_TYPE = ?",
            "lineNumber": 342
          },
          {
            "text": "      AND TARGET_START_DATE &lt;= ?",
            "lineNumber": 343
          },
          {
            "text": "      AND TARGET_END_DATE &gt;= ?",
            "lineNumber": 344
          },
          {
            "text": "      AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')",
            "lineNumber": 345
          },
          {
            "text": "    ORDER BY TARGET_START_DATE",
            "lineNumber": 346
          },
          {
            "text": "  &#96;;",
            "lineNumber": 347
          },
          {
            "text": "  ",
            "lineNumber": 348
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, applicationType, endDate, startDate]);",
            "lineNumber": 349
          },
          {
            "text": "  return rows;",
            "lineNumber": 350
          },
          {
            "text": "};",
            "lineNumber": 351
          },
          {
            "lineNumber": 352
          },
          {
            "text": "/**",
            "lineNumber": 353
          },
          {
            "text": " * 申請情報と承認履歴を取得（日次確定申請）",
            "lineNumber": 354
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 355
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 356
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴",
            "lineNumber": 357
          },
          {
            "text": " */",
            "lineNumber": 358
          }
        ]
      },
      "score": 0.4196164608001709
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 50,
            "column": 2
          },
          "endPosition": {
            "line": 85,
            "column": 3
          }
        },
        "contents": "/**\n * 休日出勤申請\n * @param {Object} applicationData - 申請データ\n * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID\n */\nconst applyHolidayWork = async (applicationData) =&gt; {\n  const { employeeId, workDate, startTime, endTime, breakHours, reason } = applicationData;\n  const now = getNow();\n  \n  // REASONフィールドにJSON形式で時間情報を保存\n  const reasonData = {\n    text: reason || '',\n    startTime: startTime,\n    endTime: endTime,\n    breakHours: breakHours\n  };\n  \n  return await applicationModel.createApplication({\n    employeeId,\n    applicationType: 'HOLIDAY_WORK',\n    targetStartDate: workDate,\n    targetEndDate: workDate,\n    reason: JSON.stringify(reasonData),\n    approvalStatus: 'PENDING',\n    createdAt: now,\n    updatedAt: now\n  });\n};\n\n/**\n * 残業申請\n * @param {Object} applicationData - 申請データ\n * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 53
          },
          {
            "text": " * 休日出勤申請",
            "lineNumber": 54
          },
          {
            "text": " * @param {Object} applicationData - 申請データ",
            "lineNumber": 55
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID",
            "lineNumber": 56
          },
          {
            "text": " */",
            "lineNumber": 57
          },
          {
            "text": "const applyHolidayWork = async (applicationData) =&gt; {",
            "lineNumber": 58
          },
          {
            "text": "  const { employeeId, workDate, startTime, endTime, breakHours, reason } = applicationData;",
            "lineNumber": 59
          },
          {
            "text": "  const now = getNow();",
            "lineNumber": 60
          },
          {
            "text": "  ",
            "lineNumber": 61
          },
          {
            "text": "  // REASONフィールドにJSON形式で時間情報を保存",
            "lineNumber": 62
          },
          {
            "text": "  const reasonData = {",
            "lineNumber": 63
          },
          {
            "text": "    text: reason || '',",
            "lineNumber": 64
          },
          {
            "text": "    startTime: startTime,",
            "lineNumber": 65
          },
          {
            "text": "    endTime: endTime,",
            "lineNumber": 66
          },
          {
            "text": "    breakHours: breakHours",
            "lineNumber": 67
          },
          {
            "text": "  };",
            "lineNumber": 68
          },
          {
            "text": "  ",
            "lineNumber": 69
          },
          {
            "text": "  return await applicationModel.createApplication({",
            "lineNumber": 70
          },
          {
            "text": "    employeeId,",
            "lineNumber": 71
          },
          {
            "text": "    applicationType: 'HOLIDAY_WORK',",
            "lineNumber": 72
          },
          {
            "text": "    targetStartDate: workDate,",
            "lineNumber": 73
          },
          {
            "text": "    targetEndDate: workDate,",
            "lineNumber": 74
          },
          {
            "text": "    reason: JSON.stringify(reasonData),",
            "lineNumber": 75
          },
          {
            "text": "    approvalStatus: 'PENDING',",
            "lineNumber": 76
          },
          {
            "text": "    createdAt: now,",
            "lineNumber": 77
          },
          {
            "text": "    updatedAt: now",
            "lineNumber": 78
          },
          {
            "text": "  });",
            "lineNumber": 79
          },
          {
            "text": "};",
            "lineNumber": 80
          },
          {
            "lineNumber": 81
          },
          {
            "text": "/**",
            "lineNumber": 82
          },
          {
            "text": " * 残業申請",
            "lineNumber": 83
          },
          {
            "text": " * @param {Object} applicationData - 申請データ",
            "lineNumber": 84
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID",
            "lineNumber": 85
          },
          {
            "text": " */",
            "lineNumber": 86
          }
        ]
      },
      "score": 0.416629433631897
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\TimesheetScreen.vue",
        "range": {
          "startPosition": {
            "line": 1512
          },
          "endPosition": {
            "line": 1556
          }
        },
        "contents": "          }\n        }\n        \n        // 休日出勤申請が申請中または承認済みの場合、休憩時間が設定されていない場合はデフォルト値を設定\n        if (hasHolidayWorkApplication &amp;&amp; holidayWorkBreakHours === null) {\n          holidayWorkBreakHours = 1.0\n        }\n        \n        // 休暇申請の情報を取得\n        const vacation = apiRecord?.vacation\n        const hasVacation = !!(vacation &amp;&amp; \n          (vacation.APPROVAL_STATUS === 'PENDING' || vacation.APPROVAL_STATUS === 'APPROVED'))\n        const vacationTypeCode = vacation?.VACATION_TYPE_CODE || null\n        const vacationApplicationStatus = vacation?.APPROVAL_STATUS || null\n        \n        displayData.push({\n          date: dateStr,\n          dateNumber: dateNumber,\n          dateDayOfWeek: dateDayOfWeek,\n          dayOfWeek: dayNames[dayOfWeek],\n          dayOfWeekNum: dayOfWeek,\n          hasWarning: false,\n          hasStampManualMismatch: hasStampManualMismatch,\n          approvalStatus: apiRecord?.APPROVAL_STATUS || 'NOT_SUBMITTED',\n          clockIn: clockIn,\n          clockOut: clockOut,\n          clockInType: clockInType,\n          clockOutType: clockOutType,\n          location: apiRecord?.WORK_LOCATION_NAME || apiRecord?.WORK_LOCATION_CODE || '',\n          workHours: formatWorkHours(totalWorkHours),\n          hasWorkHoursError: apiRecord?.ACTUAL_WORK_HOURS &amp;&amp; Math.abs((apiRecord.ACTUAL_WORK_HOURS - totalWorkHours)) &gt; 0.01,\n          canEdit: !apiRecord?.IS_DAILY_CONFIRMED,\n          isHoliday: holiday,\n          hasVacation: hasVacation,\n          vacationTypeCode: vacationTypeCode,\n          vacationApplicationStatus: vacationApplicationStatus,\n          attendanceId: apiRecord?.ATTENDANCE_ID,\n          actualWorkHours: apiRecord?.ACTUAL_WORK_HOURS || 0,\n          breakTimes: breakTimes,\n          hasHolidayWorkApplication: hasHolidayWorkApplication,\n          holidayWorkApplicationStatus: holidayWorkApplicationStatus,\n          holidayWorkStartTime: holidayWorkStartTime,\n          holidayWorkEndTime: holidayWorkEndTime,\n          holidayWorkBreakHours: holidayWorkBreakHours,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "          }",
            "lineNumber": 1513
          },
          {
            "text": "        }",
            "lineNumber": 1514
          },
          {
            "text": "        ",
            "lineNumber": 1515
          },
          {
            "text": "        // 休日出勤申請が申請中または承認済みの場合、休憩時間が設定されていない場合はデフォルト値を設定",
            "lineNumber": 1516
          },
          {
            "text": "        if (hasHolidayWorkApplication &amp;&amp; holidayWorkBreakHours === null) {",
            "lineNumber": 1517
          },
          {
            "text": "          holidayWorkBreakHours = 1.0",
            "lineNumber": 1518
          },
          {
            "text": "        }",
            "lineNumber": 1519
          },
          {
            "text": "        ",
            "lineNumber": 1520
          },
          {
            "text": "        // 休暇申請の情報を取得",
            "lineNumber": 1521
          },
          {
            "text": "        const vacation = apiRecord?.vacation",
            "lineNumber": 1522
          },
          {
            "text": "        const hasVacation = !!(vacation &amp;&amp; ",
            "lineNumber": 1523
          },
          {
            "text": "          (vacation.APPROVAL_STATUS === 'PENDING' || vacation.APPROVAL_STATUS === 'APPROVED'))",
            "lineNumber": 1524
          },
          {
            "text": "        const vacationTypeCode = vacation?.VACATION_TYPE_CODE || null",
            "lineNumber": 1525
          },
          {
            "text": "        const vacationApplicationStatus = vacation?.APPROVAL_STATUS || null",
            "lineNumber": 1526
          },
          {
            "text": "        ",
            "lineNumber": 1527
          },
          {
            "text": "        displayData.push({",
            "lineNumber": 1528
          },
          {
            "text": "          date: dateStr,",
            "lineNumber": 1529
          },
          {
            "text": "          dateNumber: dateNumber,",
            "lineNumber": 1530
          },
          {
            "text": "          dateDayOfWeek: dateDayOfWeek,",
            "lineNumber": 1531
          },
          {
            "text": "          dayOfWeek: dayNames[dayOfWeek],",
            "lineNumber": 1532
          },
          {
            "text": "          dayOfWeekNum: dayOfWeek,",
            "lineNumber": 1533
          },
          {
            "text": "          hasWarning: false,",
            "lineNumber": 1534
          },
          {
            "text": "          hasStampManualMismatch: hasStampManualMismatch,",
            "lineNumber": 1535
          },
          {
            "text": "          approvalStatus: apiRecord?.APPROVAL_STATUS || 'NOT_SUBMITTED',",
            "lineNumber": 1536
          },
          {
            "text": "          clockIn: clockIn,",
            "lineNumber": 1537
          },
          {
            "text": "          clockOut: clockOut,",
            "lineNumber": 1538
          },
          {
            "text": "          clockInType: clockInType,",
            "lineNumber": 1539
          },
          {
            "text": "          clockOutType: clockOutType,",
            "lineNumber": 1540
          },
          {
            "text": "          location: apiRecord?.WORK_LOCATION_NAME || apiRecord?.WORK_LOCATION_CODE || '',",
            "lineNumber": 1541
          },
          {
            "text": "          workHours: formatWorkHours(totalWorkHours),",
            "lineNumber": 1542
          },
          {
            "text": "          hasWorkHoursError: apiRecord?.ACTUAL_WORK_HOURS &amp;&amp; Math.abs((apiRecord.ACTUAL_WORK_HOURS - totalWorkHours)) &gt; 0.01,",
            "lineNumber": 1543
          },
          {
            "text": "          canEdit: !apiRecord?.IS_DAILY_CONFIRMED,",
            "lineNumber": 1544
          },
          {
            "text": "          isHoliday: holiday,",
            "lineNumber": 1545
          },
          {
            "text": "          hasVacation: hasVacation,",
            "lineNumber": 1546
          },
          {
            "text": "          vacationTypeCode: vacationTypeCode,",
            "lineNumber": 1547
          },
          {
            "text": "          vacationApplicationStatus: vacationApplicationStatus,",
            "lineNumber": 1548
          },
          {
            "text": "          attendanceId: apiRecord?.ATTENDANCE_ID,",
            "lineNumber": 1549
          },
          {
            "text": "          actualWorkHours: apiRecord?.ACTUAL_WORK_HOURS || 0,",
            "lineNumber": 1550
          },
          {
            "text": "          breakTimes: breakTimes,",
            "lineNumber": 1551
          },
          {
            "text": "          hasHolidayWorkApplication: hasHolidayWorkApplication,",
            "lineNumber": 1552
          },
          {
            "text": "          holidayWorkApplicationStatus: holidayWorkApplicationStatus,",
            "lineNumber": 1553
          },
          {
            "text": "          holidayWorkStartTime: holidayWorkStartTime,",
            "lineNumber": 1554
          },
          {
            "text": "          holidayWorkEndTime: holidayWorkEndTime,",
            "lineNumber": 1555
          },
          {
            "text": "          holidayWorkBreakHours: holidayWorkBreakHours,",
            "lineNumber": 1556
          }
        ]
      },
      "score": 0.41648420691490173
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 170,
            "column": 1
          },
          "endPosition": {
            "line": 190,
            "column": 3
          }
        },
        "contents": "/**\n * 休日出勤申請状態を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} targetDate 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 休日出勤申請状態データ\n */\nexport async function getHolidayWorkStatus(employeeId, targetDate) {\n  const endpoint = &#96;/application/holiday-work-status?employeeId=${employeeId}&amp;targetDate=${targetDate}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * 月次サマリー情報を取得する（月次サマリー情報画面用）。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} yearMonth 対象年月（YYYY-MM形式）\n * @returns {Promise&lt;Object&gt;} 月次サマリー情報データ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 173
          },
          {
            "text": " * 休日出勤申請状態を取得する。",
            "lineNumber": 174
          },
          {
            "text": " *",
            "lineNumber": 175
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 176
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式）",
            "lineNumber": 177
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 休日出勤申請状態データ",
            "lineNumber": 178
          },
          {
            "text": " */",
            "lineNumber": 179
          },
          {
            "text": "export async function getHolidayWorkStatus(employeeId, targetDate) {",
            "lineNumber": 180,
            "isSignature": true
          },
          {
            "text": "  const endpoint = &#96;/application/holiday-work-status?employeeId=${employeeId}&amp;targetDate=${targetDate}&#96;",
            "lineNumber": 181
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 182
          },
          {
            "text": "}",
            "lineNumber": 183,
            "isSignature": true
          },
          {
            "lineNumber": 184
          },
          {
            "text": "/**",
            "lineNumber": 185
          },
          {
            "text": " * 月次サマリー情報を取得する（月次サマリー情報画面用）。",
            "lineNumber": 186
          },
          {
            "text": " *",
            "lineNumber": 187
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 188
          },
          {
            "text": " * @param {string} yearMonth 対象年月（YYYY-MM形式）",
            "lineNumber": 189
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリー情報データ",
            "lineNumber": 190
          },
          {
            "text": " */",
            "lineNumber": 191
          }
        ]
      },
      "score": 0.40976008772850037
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 137,
            "column": 1
          },
          "endPosition": {
            "line": 155,
            "column": 3
          }
        },
        "contents": "/**\n * 休暇情報を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @returns {Promise&lt;Object&gt;} 休暇情報データ\n */\nexport async function getVacationInfo(employeeId) {\n  const endpoint = &#96;/application/vacation-info?employeeId=${employeeId}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * お知らせを取得する。\n *\n * @param {string} employeeId 従業員ID\n * @returns {Promise&lt;Array&gt;} お知らせデータ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 140
          },
          {
            "text": " * 休暇情報を取得する。",
            "lineNumber": 141
          },
          {
            "text": " *",
            "lineNumber": 142
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 143
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 休暇情報データ",
            "lineNumber": 144
          },
          {
            "text": " */",
            "lineNumber": 145
          },
          {
            "text": "export async function getVacationInfo(employeeId) {",
            "lineNumber": 146,
            "isSignature": true
          },
          {
            "text": "  const endpoint = &#96;/application/vacation-info?employeeId=${employeeId}&#96;",
            "lineNumber": 147
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 148
          },
          {
            "text": "}",
            "lineNumber": 149,
            "isSignature": true
          },
          {
            "lineNumber": 150
          },
          {
            "text": "/**",
            "lineNumber": 151
          },
          {
            "text": " * お知らせを取得する。",
            "lineNumber": 152
          },
          {
            "text": " *",
            "lineNumber": 153
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 154
          },
          {
            "text": " * @returns {Promise&lt;Array&gt;} お知らせデータ",
            "lineNumber": 155
          },
          {
            "text": " */",
            "lineNumber": 156
          }
        ]
      },
      "score": 0.40716296434402466
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async \n\n  let previousCumulativeWorkHours = 0;\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const workDate = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;\n    const attendance = attendanceRows.find(row =&gt; normalizeDate(row.WORK_DATE) === workDate);\n    \n    // 祝日情報を取得\n    const dateObj = new Date(year, month - 1, day);\n    let holidayName = null;\n    try {\n      // isHolidayはbooleanを返すので、betweenで祝日情報を取得\n      const holidays = HolidayJp.between(dateObj, dateObj);\n      if (holidays &amp;&amp; holidays.length &gt; 0) {\n        holidayName = holidays[0].name || null;\n      }\n    } catch (error) {\n      console.error(&#96;祝日判定エラー (${workDate}):&#96;, error);\n      holidayName = null;\n    }\n    \n    // その日の休暇情報を取得（承認済みまたは申請中の休暇）\n    const dayVacation = vacations.find(v =&gt; {\n      const startDate = normalizeDate(v.START_DATE);\n      const endDate = normalizeDate(v.END_DATE);\n      return workDate &gt;= startDate &amp;&amp; workDate &lt;= endDate &amp;&amp; \n             (v.APPROVAL_STATUS === 'APPROVED' || v.APPROVAL_STATUS === 'PENDING');\n    });\n    let vacationTypeName = null;\n    if (dayVacation &amp;&amp; dayVacation.VACATION_TYPE_CODE) {\n      vacationTypeName = vacationTypeMap[dayVacation.VACATION_TYPE_CODE] || null;\n    }\n    \n    let breakTimeTotal = 0;\n    let actualWorkHours = 0;\n    let overtimeHours = 0;\n    // 日次の法定時間内残業・法定時間外残業（分単位）を保存\n    let withinLegalOvertimeMinutes = 0;\n    let overLegalOvertimeMinutes = 0;\n    \n    if (attendance) {\n      const breakTimes = await breakTimeModel.getBreakTimes;\n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "lineNumber": 56
          },
          {
            "text": "  let previousCumulativeWorkHours = 0;",
            "lineNumber": 57
          },
          {
            "text": "  ",
            "lineNumber": 58
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 59
          },
          {
            "text": "    const workDate = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;",
            "lineNumber": 60
          },
          {
            "text": "    const attendance = attendanceRows.find(row =&gt; normalizeDate(row.WORK_DATE) === workDate);",
            "lineNumber": 61
          },
          {
            "text": "    ",
            "lineNumber": 62
          },
          {
            "text": "    // 祝日情報を取得",
            "lineNumber": 63
          },
          {
            "text": "    const dateObj = new Date(year, month - 1, day);",
            "lineNumber": 64
          },
          {
            "text": "    let holidayName = null;",
            "lineNumber": 65
          },
          {
            "text": "    try {",
            "lineNumber": 66
          },
          {
            "text": "      // isHolidayはbooleanを返すので、betweenで祝日情報を取得",
            "lineNumber": 67
          },
          {
            "text": "      const holidays = HolidayJp.between(dateObj, dateObj);",
            "lineNumber": 68
          },
          {
            "text": "      if (holidays &amp;&amp; holidays.length &gt; 0) {",
            "lineNumber": 69
          },
          {
            "text": "        holidayName = holidays[0].name || null;",
            "lineNumber": 70
          },
          {
            "text": "      }",
            "lineNumber": 71
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 72
          },
          {
            "text": "      console.error(&#96;祝日判定エラー (${workDate}):&#96;, error);",
            "lineNumber": 73
          },
          {
            "text": "      holidayName = null;",
            "lineNumber": 74
          },
          {
            "text": "    }",
            "lineNumber": 75
          },
          {
            "text": "    ",
            "lineNumber": 76
          },
          {
            "text": "    // その日の休暇情報を取得（承認済みまたは申請中の休暇）",
            "lineNumber": 77
          },
          {
            "text": "    const dayVacation = vacations.find(v =&gt; {",
            "lineNumber": 78
          },
          {
            "text": "      const startDate = normalizeDate(v.START_DATE);",
            "lineNumber": 79
          },
          {
            "text": "      const endDate = normalizeDate(v.END_DATE);",
            "lineNumber": 80
          },
          {
            "text": "      return workDate &gt;= startDate &amp;&amp; workDate &lt;= endDate &amp;&amp; ",
            "lineNumber": 81
          },
          {
            "text": "             (v.APPROVAL_STATUS === 'APPROVED' || v.APPROVAL_STATUS === 'PENDING');",
            "lineNumber": 82
          },
          {
            "text": "    });",
            "lineNumber": 83
          },
          {
            "text": "    let vacationTypeName = null;",
            "lineNumber": 84
          },
          {
            "text": "    if (dayVacation &amp;&amp; dayVacation.VACATION_TYPE_CODE) {",
            "lineNumber": 85
          },
          {
            "text": "      vacationTypeName = vacationTypeMap[dayVacation.VACATION_TYPE_CODE] || null;",
            "lineNumber": 86
          },
          {
            "text": "    }",
            "lineNumber": 87
          },
          {
            "text": "    ",
            "lineNumber": 88
          },
          {
            "text": "    let breakTimeTotal = 0;",
            "lineNumber": 89
          },
          {
            "text": "    let actualWorkHours = 0;",
            "lineNumber": 90
          },
          {
            "text": "    let overtimeHours = 0;",
            "lineNumber": 91
          },
          {
            "text": "    // 日次の法定時間内残業・法定時間外残業（分単位）を保存",
            "lineNumber": 92
          },
          {
            "text": "    let withinLegalOvertimeMinutes = 0;",
            "lineNumber": 93
          },
          {
            "text": "    let overLegalOvertimeMinutes = 0;",
            "lineNumber": 94
          },
          {
            "text": "    ",
            "lineNumber": 95
          },
          {
            "text": "    if (attendance) {",
            "lineNumber": 96
          },
          {
            "text": "      const breakTimes = await breakTimeModel.getBreakTimes;",
            "lineNumber": 97
          },
          {
            "text": "  }",
            "lineNumber": 206
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.4053891897201538
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async  {\n  // 年月をパース\n  const [year, month] = yearMonth.split('-').map(Number);\n  const { startDate, endDate } = getMonthRange(year, month);\n  \n  // 1. 従業員情報取得\n  const employee = await employeeModel.getEmployeeById(employeeId);\n  if (!employee) {\n    throw new Error('従業員情報が見つかりません。');\n  }\n  \n  // 2. 月間勤務データ取得\n  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);\n  \n  // 休暇情報を取得\n  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);\n  \n  // 休暇種別マスタを取得（休暇種別名を取得するため）\n  const vacationTypes = await masterModel.getVacationTypes();\n  const vacationTypeMap = {};\n  for (const vt of vacationTypes) {\n    vacationTypeMap[vt.VACATION_TYPE_CODE] = vt.VACATION_TYPE_NAME;\n  }\n  \n  // 月間の全ての日付を生成（勤務記録がない日も含む）\n  const daysInMonth = new Date(year, month, 0).getDate();\n  const scheduledWorkDays = getScheduledWorkDays(year, month);\n  const monthlyScheduledWorkHours = scheduledWorkDays * 7.5;\n  const monthlyLegalWorkHours = scheduledWorkDays * 8;\n  \n  const dailyData = [];\n  let previousCumulativeWorkHours = 0;\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    \n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async  {",
            "lineNumber": 26
          },
          {
            "text": "  // 年月をパース",
            "lineNumber": 27
          },
          {
            "text": "  const [year, month] = yearMonth.split('-').map(Number);",
            "lineNumber": 28
          },
          {
            "text": "  const { startDate, endDate } = getMonthRange(year, month);",
            "lineNumber": 29
          },
          {
            "text": "  ",
            "lineNumber": 30
          },
          {
            "text": "  // 1. 従業員情報取得",
            "lineNumber": 31
          },
          {
            "text": "  const employee = await employeeModel.getEmployeeById(employeeId);",
            "lineNumber": 32
          },
          {
            "text": "  if (!employee) {",
            "lineNumber": 33
          },
          {
            "text": "    throw new Error('従業員情報が見つかりません。');",
            "lineNumber": 34
          },
          {
            "text": "  }",
            "lineNumber": 35
          },
          {
            "text": "  ",
            "lineNumber": 36
          },
          {
            "text": "  // 2. 月間勤務データ取得",
            "lineNumber": 37
          },
          {
            "text": "  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);",
            "lineNumber": 38
          },
          {
            "text": "  ",
            "lineNumber": 39
          },
          {
            "text": "  // 休暇情報を取得",
            "lineNumber": 40
          },
          {
            "text": "  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);",
            "lineNumber": 41
          },
          {
            "text": "  ",
            "lineNumber": 42
          },
          {
            "text": "  // 休暇種別マスタを取得（休暇種別名を取得するため）",
            "lineNumber": 43
          },
          {
            "text": "  const vacationTypes = await masterModel.getVacationTypes();",
            "lineNumber": 44
          },
          {
            "text": "  const vacationTypeMap = {};",
            "lineNumber": 45
          },
          {
            "text": "  for (const vt of vacationTypes) {",
            "lineNumber": 46
          },
          {
            "text": "    vacationTypeMap[vt.VACATION_TYPE_CODE] = vt.VACATION_TYPE_NAME;",
            "lineNumber": 47
          },
          {
            "text": "  }",
            "lineNumber": 48
          },
          {
            "text": "  ",
            "lineNumber": 49
          },
          {
            "text": "  // 月間の全ての日付を生成（勤務記録がない日も含む）",
            "lineNumber": 50
          },
          {
            "text": "  const daysInMonth = new Date(year, month, 0).getDate();",
            "lineNumber": 51
          },
          {
            "text": "  const scheduledWorkDays = getScheduledWorkDays(year, month);",
            "lineNumber": 52
          },
          {
            "text": "  const monthlyScheduledWorkHours = scheduledWorkDays * 7.5;",
            "lineNumber": 53
          },
          {
            "text": "  const monthlyLegalWorkHours = scheduledWorkDays * 8;",
            "lineNumber": 54
          },
          {
            "text": "  ",
            "lineNumber": 55
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 56
          },
          {
            "text": "  let previousCumulativeWorkHours = 0;",
            "lineNumber": 57
          },
          {
            "text": "  ",
            "lineNumber": 58
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 59
          },
          {
            "text": "    ",
            "lineNumber": 60
          },
          {
            "text": "  }",
            "lineNumber": 206
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.40084975957870483
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---



---





---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: frontend/src/views/MonthlySummaryScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---



---


設計書を確認し、Sequential Thinkingで整理してから修正します。


---

<tool-use data-tool-type="unknown" data-tool-name="mcp-sequential-thinking-user-sequential-thinking-sequentialthinking">
<details>
<summary>Tool use: **mcp-sequential-thinking-user-sequential-thinking-sequentialthinking**</summary>


Parameters:

```json
{
  "tools": [
    {
      "name": "sequentialthinking",
      "parameters": "{\"thought\":\"現在の設計書を確認しました。No.30の「イベント/勤務状況/勤務場所」欄の表示優先順位は以下の通りです：\\n1. 祝日名\\n2. 休暇種別名（「休暇(休暇種別名)」形式）\\n3. 日時確定済みの場合（「日時確定,勤務場所」形式）\\n4. 通常勤務で日時確定ではない場合（勤務場所のみ）\\n\\nユーザーの要求は、休日出勤申請の情報も追加することです。休日出勤の場合は「休日出勤、日次確定、在宅」のような書き方になるとのことです。\",\"thoughtNumber\":2,\"totalThoughts\":8,\"nextThoughtNeeded\":true}",
      "serverName": "sequential-thinking"
    }
  ]
}
```
Additional data:

```json
{
  "status": "success"
}
```
Result:

```json
{
  "result": "{\"content\":[{\"type\":\"text\",\"text\":\"{\\n  \\\"thoughtNumber\\\": 2,\\n  \\\"totalThoughts\\\": 8,\\n  \\\"nextThoughtNeeded\\\": true,\\n  \\\"branches\\\": [],\\n  \\\"thoughtHistoryLength\\\": 2\\n}\"}]}"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="mcp-sequential-thinking-user-sequential-thinking-sequentialthinking">
<details>
<summary>Tool use: **mcp-sequential-thinking-user-sequential-thinking-sequentialthinking**</summary>


Parameters:

```json
{
  "tools": [
    {
      "name": "sequentialthinking",
      "parameters": "{\"thought\":\"休日出勤申請の情報を追加する必要があります。休日出勤申請が承認済みまたは申請中の場合は、以下のような表示形式にする必要があります：\\n- 「休日出勤、日次確定、在宅」のような形式\\n- 日次確定の有無と勤務場所も含める\\n\\n現在の実装では、休日出勤申請の情報は取得されていますが、「イベント/勤務状況/勤務場所」欄には表示されていません。優先順位を再検討する必要があります。\",\"thoughtNumber\":3,\"totalThoughts\":8,\"nextThoughtNeeded\":true}",
      "serverName": "sequential-thinking"
    }
  ]
}
```
Additional data:

```json
{
  "status": "success"
}
```
Result:

```json
{
  "result": "{\"content\":[{\"type\":\"text\",\"text\":\"{\\n  \\\"thoughtNumber\\\": 3,\\n  \\\"totalThoughts\\\": 8,\\n  \\\"nextThoughtNeeded\\\": true,\\n  \\\"branches\\\": [],\\n  \\\"thoughtHistoryLength\\\": 3\\n}\"}]}"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="mcp-sequential-thinking-user-sequential-thinking-sequentialthinking">
<details>
<summary>Tool use: **mcp-sequential-thinking-user-sequential-thinking-sequentialthinking**</summary>


Parameters:

```json
{
  "tools": [
    {
      "name": "sequentialthinking",
      "parameters": "{\"thought\":\"新しい優先順位を決定します：\\n1. 祝日名（最優先）\\n2. 休暇申請（「休暇(休暇種別名)」形式）\\n3. 休日出勤申請（「休日出勤、日次確定、在宅」のような形式）\\n4. 日時確定済みの場合（「日時確定,勤務場所」形式）\\n5. 通常勤務で日時確定ではない場合（勤務場所のみ）\\n\\n休日出勤申請の表示形式は、日次確定の有無と勤務場所を含める必要があります。例えば：\\n- 日次確定あり、在宅の場合：「休日出勤、日次確定、在宅」\\n- 日次確定なし、通勤の場合：「休日出勤、通勤」\",\"thoughtNumber\":4,\"totalThoughts\":8,\"nextThoughtNeeded\":true}",
      "serverName": "sequential-thinking"
    }
  ]
}
```
Additional data:

```json
{
  "status": "success"
}
```
Result:

```json
{
  "result": "{\"content\":[{\"type\":\"text\",\"text\":\"{\\n  \\\"thoughtNumber\\\": 4,\\n  \\\"totalThoughts\\\": 8,\\n  \\\"nextThoughtNeeded\\\": true,\\n  \\\"branches\\\": [],\\n  \\\"thoughtHistoryLength\\\": 4\\n}\"}]}"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="mcp-sequential-thinking-user-sequential-thinking-sequentialthinking">
<details>
<summary>Tool use: **mcp-sequential-thinking-user-sequential-thinking-sequentialthinking**</summary>


Parameters:

```json
{
  "tools": [
    {
      "name": "sequentialthinking",
      "parameters": "{\"thought\":\"設計書の修正箇所を特定します：\\n1. 画面項目定義のNo.30「イベント/勤務状況/勤務場所」の備考欄を修正\\n2. 編集仕様のNo.1の「イベント/勤務状況/勤務場所」の編集内容を修正\\n3. 補足説明の「イベント/勤務状況/勤務場所の表示形式について」を修正\\n4. その他の項目定義に休日出勤申請の情報を追加（必要に応じて）\\n\\nまた、テーブル取得仕様のNo.2（月間勤務データ取得）に、休日出勤申請の情報も含める必要があることを確認します。\",\"thoughtNumber\":5,\"totalThoughts\":8,\"nextThoughtNeeded\":true}",
      "serverName": "sequential-thinking"
    }
  ]
}
```
Additional data:

```json
{
  "status": "success"
}
```
Result:

```json
{
  "result": "{\"content\":[{\"type\":\"text\",\"text\":\"{\\n  \\\"thoughtNumber\\\": 5,\\n  \\\"totalThoughts\\\": 8,\\n  \\\"nextThoughtNeeded\\\": true,\\n  \\\"branches\\\": [],\\n  \\\"thoughtHistoryLength\\\": 5\\n}\"}]}"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="mcp-sequential-thinking-user-sequential-thinking-sequentialthinking">
<details>
<summary>Tool use: **mcp-sequential-thinking-user-sequential-thinking-sequentialthinking**</summary>


Parameters:

```json
{
  "tools": [
    {
      "name": "sequentialthinking",
      "parameters": "{\"thought\":\"実装の確認が必要です。現在のコードでは、休日出勤申請の情報は&#96;day.holidayWorkApplication&#96;として取得されている可能性があります。また、日次確定フラグは&#96;day.isDailyConfirmed&#96;として取得されています。勤務場所コードは&#96;day.workLocationCode&#96;として取得されています。\\n\\nこれらの情報を使って、休日出勤申請の表示形式を実装する必要があります。\",\"thoughtNumber\":6,\"totalThoughts\":8,\"nextThoughtNeeded\":true}",
      "serverName": "sequential-thinking"
    }
  ]
}
```
Additional data:

```json
{
  "status": "success"
}
```
Result:

```json
{
  "result": "{\"content\":[{\"type\":\"text\",\"text\":\"{\\n  \\\"thoughtNumber\\\": 6,\\n  \\\"totalThoughts\\\": 8,\\n  \\\"nextThoughtNeeded\\\": true,\\n  \\\"branches\\\": [],\\n  \\\"thoughtHistoryLength\\\": 6\\n}\"}]}"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="mcp-sequential-thinking-user-sequential-thinking-sequentialthinking">
<details>
<summary>Tool use: **mcp-sequential-thinking-user-sequential-thinking-sequentialthinking**</summary>


Parameters:

```json
{
  "tools": [
    {
      "name": "sequentialthinking",
      "parameters": "{\"thought\":\"設計書の修正内容をまとめます：\\n1. 画面項目定義のNo.30の備考欄を更新して、休日出勤申請の表示形式を追加\\n2. 編集仕様のNo.1の「イベント/勤務状況/勤務場所」の編集内容を更新\\n3. 補足説明の「イベント/勤務状況/勤務場所の表示形式について」を更新\\n4. 変更履歴に今回の変更を追加\\n\\n休日出勤申請の表示形式の詳細：\\n- 休日出勤申請が承認済みまたは申請中の場合\\n- 日次確定ありの場合：「休日出勤、日次確定、勤務場所」\\n- 日次確定なしの場合：「休日出勤、勤務場所」\\n- 勤務場所がない場合は「休日出勤」のみ\",\"thoughtNumber\":7,\"totalThoughts\":8,\"nextThoughtNeeded\":true}",
      "serverName": "sequential-thinking"
    }
  ]
}
```
Additional data:

```json
{
  "status": "success"
}
```
Result:

```json
{
  "result": "{\"content\":[{\"type\":\"text\",\"text\":\"{\\n  \\\"thoughtNumber\\\": 7,\\n  \\\"totalThoughts\\\": 8,\\n  \\\"nextThoughtNeeded\\\": true,\\n  \\\"branches\\\": [],\\n  \\\"thoughtHistoryLength\\\": 7\\n}\"}]}"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="mcp-sequential-thinking-user-sequential-thinking-sequentialthinking">
<details>
<summary>Tool use: **mcp-sequential-thinking-user-sequential-thinking-sequentialthinking**</summary>


Parameters:

```json
{
  "tools": [
    {
      "name": "sequentialthinking",
      "parameters": "{\"thought\":\"設計書の修正を実行します。まず、設計書ファイルを読み込んで、該当箇所を修正します。修正後、変更履歴も更新します。これで設計書の修正は完了です。\",\"thoughtNumber\":8,\"totalThoughts\":8,\"nextThoughtNeeded\":false}",
      "serverName": "sequential-thinking"
    }
  ]
}
```
Additional data:

```json
{
  "status": "success"
}
```
Result:

```json
{
  "result": "{\"content\":[{\"type\":\"text\",\"text\":\"{\\n  \\\"thoughtNumber\\\": 8,\\n  \\\"totalThoughts\\\": 8,\\n  \\\"nextThoughtNeeded\\\": false,\\n  \\\"branches\\\": [],\\n  \\\"thoughtHistoryLength\\\": 8\\n}\"}]}"
}
```
User decision: **accepted**

Status: **completed**


</details>
</tool-use>

---



---


設計書を修正します。


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---



---


設計書を修正中です。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "49597689-8a11-41ce-a11b-b66e50fa246e"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "879a2a97-9bda-4eb3-bb61-7b58f931ca53"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "7836dacd-9cb7-4c78-8550-0c108aff9233"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---



---


変更履歴を更新中です。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "398b5f29-2fdb-4777-a30a-2a298c52382b"
}
```
Status: **completed**


</details>
</tool-use>

---



---


その他の項目定義に休日出勤申請の情報が含まれているか確認中です。


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---



---


その他の項目定義に休日出勤申請の情報を追加中です。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "be09d72d-e9e1-458c-ab27-49df41404651"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---



---


テーブル取得仕様に休日出勤申請の情報を追加中です。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "13c5c709-026a-4837-b75d-14ccd1b72850"
}
```
Status: **completed**


</details>
</tool-use>

---



---


設計書の修正を完了しました。変更点は以下の通りです。

## 修正内容

1. **画面項目定義（No.30）**: 「イベント/勤務状況/勤務場所」欄の表示優先順位に休日出勤申請を追加
   - 優先順位3として追加：「休日出勤、日次確定、勤務場所」または「休日出勤、勤務場所」形式

2. **編集仕様（No.1）**: 「イベント/勤務状況/勤務場所」の編集内容を更新し、休日出勤申請の表示形式を追加

3. **補足説明**: 「イベント/勤務状況/勤務場所の表示形式について」に休日出勤申請の詳細を追加
   - 日次確定ありの場合：「休日出勤、日次確定、勤務場所」
   - 日次確定なしの場合：「休日出勤、勤務場所」
   - 勤務場所がない場合：「休日出勤」のみ

4. **その他の項目定義**: 日次勤務データに休日出勤申請情報を追加（No.18）

5. **テーブル取得仕様（No.2）**: 月間勤務データ取得に休日出勤申請情報の取得を追加

6. **変更履歴**: 今回の変更を記録

設計書の修正は完了しました。次は実装に進みますか？

---

_**User**_

休暇の書き方は例えば、年次有給休暇の場合、休暇(年次有給休暇)という書き方になります。

---

_**Agent (model composer-1, mode Agent)**_



---


設計書は既に「休暇(年次有給休暇)」形式で記載済みです。該当箇所を確認します。


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---



---


設計書は既に「休暇(年次有給休暇)」形式で記載済みです。該当箇所を確認しました。

**現在の設計書の記載内容：**

1. **画面項目定義（No.30）**: 
   - 「休暇の場合は「休暇(休暇種別名)」形式（例: 休暇(年次有給休暇)、休暇(夏季休暇)）」

2. **編集仕様（No.1）**: 
   - 同様に「休暇(休暇種別名)」形式で記載

3. **補足説明**: 
   - 「**休暇の場合**: 「休暇(休暇種別名)」形式で表示します（例: 休暇(年次有給休暇)、休暇(夏季休暇)）」

設計書は正しく記載されています。実装でもこの形式に従って表示されます。

他に修正や追加が必要な点があれば教えてください。

---

_**User**_

それでは実装をしてください。

---

_**Agent (model composer-1, mode Agent)**_



---


実装に進みます。月次サマリー情報画面とバックエンドの実装を確認し、休日出勤申請の表示を追加します。


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: frontend/src/views/MonthlySummaryScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "月次サマリー情報のAPIで休日出勤申請の情報を取得する方法",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 343
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "const getMonthlyAttendance = async \n\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const dateStr = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;\n    if (!existingDates.has(dateStr)) {\n      // 該当日の休日出勤申請を取得\n      const holidayWorkApp = holidayWorkApplications.find(app =&gt; {\n        const appStartDate = normalizeDate(app.TARGET_START_DATE);\n        const appEndDate = normalizeDate(app.TARGET_END_DATE);\n        return dateStr &gt;= appStartDate &amp;&amp; dateStr &lt;= appEndDate &amp;&amp; \n               (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');\n      });\n      \n      // 該当日の休暇申請を取得\n      const vacation = vacations.find(v =&gt; {\n        const vStartDate = normalizeDate(v.START_DATE);\n        const vEndDate = normalizeDate(v.END_DATE);\n        return dateStr &gt;= vStartDate &amp;&amp; dateStr &lt;= vEndDate &amp;&amp; \n               (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');\n      });\n      \n      if (holidayWorkApp || vacation) {\n        dailyData.push({\n          WORK_DATE: dateStr,\n          ATTENDANCE_ID: null,\n          CLOCK_IN_TIME: null,\n          CLOCK_OUT_TIME: null,\n          breakTimes: [],\n          officialOutings: [],\n          workHours: [],\n          holidayWorkApplication: holidayWorkApp || null,\n          vacation: vacation || null\n        });\n      }\n    }\n  }\n  \n  // 月次サマリーを計算\n  const todayStr = getTodayJST();\n  const isCurrentMonth = parseInt(year) === new Date().getFullYear() &amp;&amp; parseInt(month) === new Date().getMonth() + 1;\n  let cutoffDate = endDate;\n\n  if (isCurrentMonth) {\n    cutoffDate = todayStr;\n  }\n\n  // 当日退勤していない場合は前日までの過不足時間を計算\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 344,
                "column": 1
              },
              "endPosition": {
                "line": 344,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 344,
                "column": 7
              },
              "endPosition": {
                "line": 344,
                "column": 36
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlyAttendance = async ",
            "lineNumber": 344
          },
          {
            "lineNumber": 396
          },
          {
            "text": "  ",
            "lineNumber": 397
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 398
          },
          {
            "text": "    const dateStr = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;",
            "lineNumber": 399
          },
          {
            "text": "    if (!existingDates.has(dateStr)) {",
            "lineNumber": 400
          },
          {
            "text": "      // 該当日の休日出勤申請を取得",
            "lineNumber": 401
          },
          {
            "text": "      const holidayWorkApp = holidayWorkApplications.find(app =&gt; {",
            "lineNumber": 402
          },
          {
            "text": "        const appStartDate = normalizeDate(app.TARGET_START_DATE);",
            "lineNumber": 403
          },
          {
            "text": "        const appEndDate = normalizeDate(app.TARGET_END_DATE);",
            "lineNumber": 404
          },
          {
            "text": "        return dateStr &gt;= appStartDate &amp;&amp; dateStr &lt;= appEndDate &amp;&amp; ",
            "lineNumber": 405
          },
          {
            "text": "               (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 406
          },
          {
            "text": "      });",
            "lineNumber": 407
          },
          {
            "text": "      ",
            "lineNumber": 408
          },
          {
            "text": "      // 該当日の休暇申請を取得",
            "lineNumber": 409
          },
          {
            "text": "      const vacation = vacations.find(v =&gt; {",
            "lineNumber": 410
          },
          {
            "text": "        const vStartDate = normalizeDate(v.START_DATE);",
            "lineNumber": 411
          },
          {
            "text": "        const vEndDate = normalizeDate(v.END_DATE);",
            "lineNumber": 412
          },
          {
            "text": "        return dateStr &gt;= vStartDate &amp;&amp; dateStr &lt;= vEndDate &amp;&amp; ",
            "lineNumber": 413
          },
          {
            "text": "               (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 414
          },
          {
            "text": "      });",
            "lineNumber": 415
          },
          {
            "text": "      ",
            "lineNumber": 416
          },
          {
            "text": "      if (holidayWorkApp || vacation) {",
            "lineNumber": 417
          },
          {
            "text": "        dailyData.push({",
            "lineNumber": 418
          },
          {
            "text": "          WORK_DATE: dateStr,",
            "lineNumber": 419
          },
          {
            "text": "          ATTENDANCE_ID: null,",
            "lineNumber": 420
          },
          {
            "text": "          CLOCK_IN_TIME: null,",
            "lineNumber": 421
          },
          {
            "text": "          CLOCK_OUT_TIME: null,",
            "lineNumber": 422
          },
          {
            "text": "          breakTimes: [],",
            "lineNumber": 423
          },
          {
            "text": "          officialOutings: [],",
            "lineNumber": 424
          },
          {
            "text": "          workHours: [],",
            "lineNumber": 425
          },
          {
            "text": "          holidayWorkApplication: holidayWorkApp || null,",
            "lineNumber": 426
          },
          {
            "text": "          vacation: vacation || null",
            "lineNumber": 427
          },
          {
            "text": "        });",
            "lineNumber": 428
          },
          {
            "text": "      }",
            "lineNumber": 429
          },
          {
            "text": "    }",
            "lineNumber": 430
          },
          {
            "text": "  }",
            "lineNumber": 431
          },
          {
            "text": "  ",
            "lineNumber": 432
          },
          {
            "text": "  // 月次サマリーを計算",
            "lineNumber": 433
          },
          {
            "text": "  const todayStr = getTodayJST();",
            "lineNumber": 434
          },
          {
            "text": "  const isCurrentMonth = parseInt(year) === new Date().getFullYear() &amp;&amp; parseInt(month) === new Date().getMonth() + 1;",
            "lineNumber": 435
          },
          {
            "text": "  let cutoffDate = endDate;",
            "lineNumber": 436
          },
          {
            "lineNumber": 437
          },
          {
            "text": "  if (isCurrentMonth) {",
            "lineNumber": 438
          },
          {
            "text": "    cutoffDate = todayStr;",
            "lineNumber": 439
          },
          {
            "text": "  }",
            "lineNumber": 440
          },
          {
            "lineNumber": 441
          },
          {
            "text": "  // 当日退勤していない場合は前日までの過不足時間を計算",
            "lineNumber": 442
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.5171640515327454
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 333,
            "column": 2
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "/**\n * 月間勤務表を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {number} year 年\n * @param {number} month 月\n * @returns {Promise&lt;Object&gt;} 月間勤務表データ\n */\nconst getMonthlyAttendance = async (employeeId, year, month) =&gt; {\n  const { startDate, endDate } = getMonthRange(year, month);\n  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);\n\n  // 休日出勤申請を取得\n  const holidayWorkApplications = await applicationModel.getApplicationsByType(\n    employeeId,\n    'HOLIDAY_WORK',\n    startDate,\n    endDate\n  );\n  \n  // 休暇申請を取得\n  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);\n  \n  // 各勤怠記録に対して休憩時間、公用外出、工数実績を取得\n  const dailyData = [];\n  for (const attendance of attendanceRows) {\n    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 336
          },
          {
            "text": " * 月間勤務表を取得する。",
            "lineNumber": 337
          },
          {
            "text": " *",
            "lineNumber": 338
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 339
          },
          {
            "text": " * @param {number} year 年",
            "lineNumber": 340
          },
          {
            "text": " * @param {number} month 月",
            "lineNumber": 341
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月間勤務表データ",
            "lineNumber": 342
          },
          {
            "text": " */",
            "lineNumber": 343
          },
          {
            "text": "const getMonthlyAttendance = async (employeeId, year, month) =&gt; {",
            "lineNumber": 344
          },
          {
            "text": "  const { startDate, endDate } = getMonthRange(year, month);",
            "lineNumber": 345
          },
          {
            "text": "  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);",
            "lineNumber": 346
          },
          {
            "lineNumber": 347
          },
          {
            "text": "  // 休日出勤申請を取得",
            "lineNumber": 348
          },
          {
            "text": "  const holidayWorkApplications = await applicationModel.getApplicationsByType(",
            "lineNumber": 349
          },
          {
            "text": "    employeeId,",
            "lineNumber": 350
          },
          {
            "text": "    'HOLIDAY_WORK',",
            "lineNumber": 351
          },
          {
            "text": "    startDate,",
            "lineNumber": 352
          },
          {
            "text": "    endDate",
            "lineNumber": 353
          },
          {
            "text": "  );",
            "lineNumber": 354
          },
          {
            "text": "  ",
            "lineNumber": 355
          },
          {
            "text": "  // 休暇申請を取得",
            "lineNumber": 356
          },
          {
            "text": "  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);",
            "lineNumber": 357
          },
          {
            "text": "  ",
            "lineNumber": 358
          },
          {
            "text": "  // 各勤怠記録に対して休憩時間、公用外出、工数実績を取得",
            "lineNumber": 359
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 360
          },
          {
            "text": "  for (const attendance of attendanceRows) {",
            "lineNumber": 361
          },
          {
            "text": "    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 362
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.5050865411758423
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 343
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "const getMonthlyAttendance = async \n\n  const dailyData = [];\n  for (const attendance of attendanceRows) {\n    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n    const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);\n    const workHours = await workHoursModel.getWorkHours(employeeId, normalizeDate(attendance.WORK_DATE));\n    \n    // 該当日の休日出勤申請を取得\n    const workDate = normalizeDate(attendance.WORK_DATE);\n    const holidayWorkApp = holidayWorkApplications.find(app =&gt; {\n      const appStartDate = normalizeDate(app.TARGET_START_DATE);\n      const appEndDate = normalizeDate(app.TARGET_END_DATE);\n      return workDate &gt;= appStartDate &amp;&amp; workDate &lt;= appEndDate &amp;&amp; \n             (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');\n    });\n    \n    // 該当日の休暇申請を取得\n    const vacation = vacations.find(v =&gt; {\n      const vStartDate = normalizeDate(v.START_DATE);\n      const vEndDate = normalizeDate(v.END_DATE);\n      return workDate &gt;= vStartDate &amp;&amp; workDate &lt;= vEndDate &amp;&amp; \n             (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');\n    });\n    \n    dailyData.push({\n      ...attendance,\n      WORK_DATE: normalizeDate(attendance.WORK_DATE),\n      breakTimes,\n      officialOutings,\n      workHours,\n      holidayWorkApplication: holidayWorkApp || null,\n      vacation: vacation || null\n    });\n  }\n  \n  // 勤怠記録がない日付にも休日出勤申請の情報を追加\n  const daysInMonth = new Date(year, month, 0).getDate();\n  const existingDates = new Set(dailyData.map(d =&gt; d.WORK_DATE));\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const dateStr = &#96;${year}&#96;;\n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 344,
                "column": 1
              },
              "endPosition": {
                "line": 344,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 344,
                "column": 7
              },
              "endPosition": {
                "line": 344,
                "column": 36
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlyAttendance = async ",
            "lineNumber": 344
          },
          {
            "lineNumber": 359
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 360
          },
          {
            "text": "  for (const attendance of attendanceRows) {",
            "lineNumber": 361
          },
          {
            "text": "    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 362
          },
          {
            "text": "    const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);",
            "lineNumber": 363
          },
          {
            "text": "    const workHours = await workHoursModel.getWorkHours(employeeId, normalizeDate(attendance.WORK_DATE));",
            "lineNumber": 364
          },
          {
            "text": "    ",
            "lineNumber": 365
          },
          {
            "text": "    // 該当日の休日出勤申請を取得",
            "lineNumber": 366
          },
          {
            "text": "    const workDate = normalizeDate(attendance.WORK_DATE);",
            "lineNumber": 367
          },
          {
            "text": "    const holidayWorkApp = holidayWorkApplications.find(app =&gt; {",
            "lineNumber": 368
          },
          {
            "text": "      const appStartDate = normalizeDate(app.TARGET_START_DATE);",
            "lineNumber": 369
          },
          {
            "text": "      const appEndDate = normalizeDate(app.TARGET_END_DATE);",
            "lineNumber": 370
          },
          {
            "text": "      return workDate &gt;= appStartDate &amp;&amp; workDate &lt;= appEndDate &amp;&amp; ",
            "lineNumber": 371
          },
          {
            "text": "             (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 372
          },
          {
            "text": "    });",
            "lineNumber": 373
          },
          {
            "text": "    ",
            "lineNumber": 374
          },
          {
            "text": "    // 該当日の休暇申請を取得",
            "lineNumber": 375
          },
          {
            "text": "    const vacation = vacations.find(v =&gt; {",
            "lineNumber": 376
          },
          {
            "text": "      const vStartDate = normalizeDate(v.START_DATE);",
            "lineNumber": 377
          },
          {
            "text": "      const vEndDate = normalizeDate(v.END_DATE);",
            "lineNumber": 378
          },
          {
            "text": "      return workDate &gt;= vStartDate &amp;&amp; workDate &lt;= vEndDate &amp;&amp; ",
            "lineNumber": 379
          },
          {
            "text": "             (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 380
          },
          {
            "text": "    });",
            "lineNumber": 381
          },
          {
            "text": "    ",
            "lineNumber": 382
          },
          {
            "text": "    dailyData.push({",
            "lineNumber": 383
          },
          {
            "text": "      ...attendance,",
            "lineNumber": 384
          },
          {
            "text": "      WORK_DATE: normalizeDate(attendance.WORK_DATE),",
            "lineNumber": 385
          },
          {
            "text": "      breakTimes,",
            "lineNumber": 386
          },
          {
            "text": "      officialOutings,",
            "lineNumber": 387
          },
          {
            "text": "      workHours,",
            "lineNumber": 388
          },
          {
            "text": "      holidayWorkApplication: holidayWorkApp || null,",
            "lineNumber": 389
          },
          {
            "text": "      vacation: vacation || null",
            "lineNumber": 390
          },
          {
            "text": "    });",
            "lineNumber": 391
          },
          {
            "text": "  }",
            "lineNumber": 392
          },
          {
            "text": "  ",
            "lineNumber": 393
          },
          {
            "text": "  // 勤怠記録がない日付にも休日出勤申請の情報を追加",
            "lineNumber": 394
          },
          {
            "text": "  const daysInMonth = new Date(year, month, 0).getDate();",
            "lineNumber": 395
          },
          {
            "text": "  const existingDates = new Set(dailyData.map(d =&gt; d.WORK_DATE));",
            "lineNumber": 396
          },
          {
            "text": "  ",
            "lineNumber": 397
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 398
          },
          {
            "text": "    const dateStr = &#96;${year}&#96;;",
            "lineNumber": 399
          },
          {
            "text": "  }",
            "lineNumber": 431
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.5038124918937683
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async  {\n  // 年月をパース\n  const [year, month] = yearMonth.split('-').map(Number);\n  const { startDate, endDate } = getMonthRange(year, month);\n  \n  // 1. 従業員情報取得\n  const employee = await employeeModel.getEmployeeById(employeeId);\n  if (!employee) {\n    throw new Error('従業員情報が見つかりません。');\n  }\n  \n  // 2. 月間勤務データ取得\n  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);\n  \n  // 休暇情報を取得\n  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);\n  \n  // 休暇種別マスタを取得（休暇種別名を取得するため）\n  const vacationTypes = await masterModel.getVacationTypes();\n  const vacationTypeMap = {};\n  for (const vt of vacationTypes) {\n    vacationTypeMap[vt.VACATION_TYPE_CODE] = vt.VACATION_TYPE_NAME;\n  }\n  \n  // 月間の全ての日付を生成（勤務記録がない日も含む）\n  const daysInMonth = new Date(year, month, 0).getDate();\n  const scheduledWorkDays = getScheduledWorkDays(year, month);\n  const monthlyScheduledWorkHours = scheduledWorkDays * 7.5;\n  const monthlyLegalWorkHours = scheduledWorkDays * 8;\n  \n  const dailyData = [];\n  let previousCumulativeWorkHours = 0;\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    \n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async  {",
            "lineNumber": 26
          },
          {
            "text": "  // 年月をパース",
            "lineNumber": 27
          },
          {
            "text": "  const [year, month] = yearMonth.split('-').map(Number);",
            "lineNumber": 28
          },
          {
            "text": "  const { startDate, endDate } = getMonthRange(year, month);",
            "lineNumber": 29
          },
          {
            "text": "  ",
            "lineNumber": 30
          },
          {
            "text": "  // 1. 従業員情報取得",
            "lineNumber": 31
          },
          {
            "text": "  const employee = await employeeModel.getEmployeeById(employeeId);",
            "lineNumber": 32
          },
          {
            "text": "  if (!employee) {",
            "lineNumber": 33
          },
          {
            "text": "    throw new Error('従業員情報が見つかりません。');",
            "lineNumber": 34
          },
          {
            "text": "  }",
            "lineNumber": 35
          },
          {
            "text": "  ",
            "lineNumber": 36
          },
          {
            "text": "  // 2. 月間勤務データ取得",
            "lineNumber": 37
          },
          {
            "text": "  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);",
            "lineNumber": 38
          },
          {
            "text": "  ",
            "lineNumber": 39
          },
          {
            "text": "  // 休暇情報を取得",
            "lineNumber": 40
          },
          {
            "text": "  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);",
            "lineNumber": 41
          },
          {
            "text": "  ",
            "lineNumber": 42
          },
          {
            "text": "  // 休暇種別マスタを取得（休暇種別名を取得するため）",
            "lineNumber": 43
          },
          {
            "text": "  const vacationTypes = await masterModel.getVacationTypes();",
            "lineNumber": 44
          },
          {
            "text": "  const vacationTypeMap = {};",
            "lineNumber": 45
          },
          {
            "text": "  for (const vt of vacationTypes) {",
            "lineNumber": 46
          },
          {
            "text": "    vacationTypeMap[vt.VACATION_TYPE_CODE] = vt.VACATION_TYPE_NAME;",
            "lineNumber": 47
          },
          {
            "text": "  }",
            "lineNumber": 48
          },
          {
            "text": "  ",
            "lineNumber": 49
          },
          {
            "text": "  // 月間の全ての日付を生成（勤務記録がない日も含む）",
            "lineNumber": 50
          },
          {
            "text": "  const daysInMonth = new Date(year, month, 0).getDate();",
            "lineNumber": 51
          },
          {
            "text": "  const scheduledWorkDays = getScheduledWorkDays(year, month);",
            "lineNumber": 52
          },
          {
            "text": "  const monthlyScheduledWorkHours = scheduledWorkDays * 7.5;",
            "lineNumber": 53
          },
          {
            "text": "  const monthlyLegalWorkHours = scheduledWorkDays * 8;",
            "lineNumber": 54
          },
          {
            "text": "  ",
            "lineNumber": 55
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 56
          },
          {
            "text": "  let previousCumulativeWorkHours = 0;",
            "lineNumber": 57
          },
          {
            "text": "  ",
            "lineNumber": 58
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 59
          },
          {
            "text": "    ",
            "lineNumber": 60
          },
          {
            "text": "  }",
            "lineNumber": 206
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.48332303762435913
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async \n\n  \n  const monthlySummary = {\n    scheduledWorkDays,\n    actualWorkDays,\n    legalHolidayWorkDays,\n    scheduledHolidayWorkDays,\n    scheduledWorkHours,\n    totalWorkHours,\n    totalWorkHoursExcludingLegalHoliday,\n    overUnderHours,\n    currentMonthOvertime,\n    safetyOvertime,\n    legalWorkHours,\n    actualWorkHoursExcludingLegalHoliday,\n    withinLegalOvertime,\n    overLegalOvertime,\n    legalHolidayWorkHours,\n    nightWorkHours,\n    overtimeOver45Hours,\n    overtimeOver60Hours,\n    lateCount,\n    lateHours,\n    earlyLeaveCount,\n    earlyLeaveHours,\n    privateOutingCount,\n    privateOutingHours,\n    totalBreakHours\n  };\n  \n  // 4. 休暇情報取得（月次サマリー用の集計）\n  // 有給取得日数\n  const paidLeaveDays = vacations\n    .filter(v =&gt; v.VACATION_TYPE_CODE === 'PAID_LEAVE' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED')\n    .reduce((sum, v) =&gt; sum + (parseFloat(v.VACATION_DAYS) || 0), 0);\n  \n  // 有給取得日数内訳\n  let paidLeaveTypeName = '';\n\n  if (paidLeaveDays &gt; 0) {\n    paidLeaveTypeName = '年次有給休暇';\n  }\n\n  // 時間単位有休取得時間（VACATION_DAYSが1未満の有給休暇を時間単位として集計）\n  const hourlyPaidLeaveHours = vacations\n    .filter(v =&gt; v.VACATION_TYPE_CODE === 'PAID_LEAVE' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED' &amp;&amp; parseFloat(v.VACATION_DAYS) &lt; 1)\n    .reduce((sum, v) =&gt; {\n      // VACATION_DAYSが1未満の場合、時間単位として扱う（例：0.5日 = 4時間）\n      const days = parseFloat(v.VACATION_DAYS) || 0;\n      // 1日 = 8時間として計算\n      return sum + (days * 8);\n    }, 0);\n\n  // 代休取得日数\n  const substituteHolidayDays = vacations\n    .filter(v =&gt; v.VACATION_TYPE_CODE === 'SUBSTITUTE_HOLIDAY' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED')\n    .reduce((sum, v) =&gt; sum + (parseFloat(v.VACATION_DAYS) || 0), 0);\n\n  // 代休取得日数内訳\n  let substituteHolidayTypeName = '';\n\n  if (substituteHolidayDays &gt; 0) {\n    substituteHolidayTypeName = '代休';\n  }\n  \n  // 無給休暇日数（簡易的に0とする）\n  const unpaidLeaveDays = 0;\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "lineNumber": 307
          },
          {
            "text": "  ",
            "lineNumber": 308
          },
          {
            "text": "  const monthlySummary = {",
            "lineNumber": 309
          },
          {
            "text": "    scheduledWorkDays,",
            "lineNumber": 310
          },
          {
            "text": "    actualWorkDays,",
            "lineNumber": 311
          },
          {
            "text": "    legalHolidayWorkDays,",
            "lineNumber": 312
          },
          {
            "text": "    scheduledHolidayWorkDays,",
            "lineNumber": 313
          },
          {
            "text": "    scheduledWorkHours,",
            "lineNumber": 314
          },
          {
            "text": "    totalWorkHours,",
            "lineNumber": 315
          },
          {
            "text": "    totalWorkHoursExcludingLegalHoliday,",
            "lineNumber": 316
          },
          {
            "text": "    overUnderHours,",
            "lineNumber": 317
          },
          {
            "text": "    currentMonthOvertime,",
            "lineNumber": 318
          },
          {
            "text": "    safetyOvertime,",
            "lineNumber": 319
          },
          {
            "text": "    legalWorkHours,",
            "lineNumber": 320
          },
          {
            "text": "    actualWorkHoursExcludingLegalHoliday,",
            "lineNumber": 321
          },
          {
            "text": "    withinLegalOvertime,",
            "lineNumber": 322
          },
          {
            "text": "    overLegalOvertime,",
            "lineNumber": 323
          },
          {
            "text": "    legalHolidayWorkHours,",
            "lineNumber": 324
          },
          {
            "text": "    nightWorkHours,",
            "lineNumber": 325
          },
          {
            "text": "    overtimeOver45Hours,",
            "lineNumber": 326
          },
          {
            "text": "    overtimeOver60Hours,",
            "lineNumber": 327
          },
          {
            "text": "    lateCount,",
            "lineNumber": 328
          },
          {
            "text": "    lateHours,",
            "lineNumber": 329
          },
          {
            "text": "    earlyLeaveCount,",
            "lineNumber": 330
          },
          {
            "text": "    earlyLeaveHours,",
            "lineNumber": 331
          },
          {
            "text": "    privateOutingCount,",
            "lineNumber": 332
          },
          {
            "text": "    privateOutingHours,",
            "lineNumber": 333
          },
          {
            "text": "    totalBreakHours",
            "lineNumber": 334
          },
          {
            "text": "  };",
            "lineNumber": 335
          },
          {
            "text": "  ",
            "lineNumber": 336
          },
          {
            "text": "  // 4. 休暇情報取得（月次サマリー用の集計）",
            "lineNumber": 337
          },
          {
            "text": "  // 有給取得日数",
            "lineNumber": 338
          },
          {
            "text": "  const paidLeaveDays = vacations",
            "lineNumber": 339
          },
          {
            "text": "    .filter(v =&gt; v.VACATION_TYPE_CODE === 'PAID_LEAVE' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED')",
            "lineNumber": 340
          },
          {
            "text": "    .reduce((sum, v) =&gt; sum + (parseFloat(v.VACATION_DAYS) || 0), 0);",
            "lineNumber": 341
          },
          {
            "text": "  ",
            "lineNumber": 342
          },
          {
            "text": "  // 有給取得日数内訳",
            "lineNumber": 343
          },
          {
            "text": "  let paidLeaveTypeName = '';",
            "lineNumber": 344
          },
          {
            "lineNumber": 345
          },
          {
            "text": "  if (paidLeaveDays &gt; 0) {",
            "lineNumber": 346
          },
          {
            "text": "    paidLeaveTypeName = '年次有給休暇';",
            "lineNumber": 347
          },
          {
            "text": "  }",
            "lineNumber": 348
          },
          {
            "lineNumber": 349
          },
          {
            "text": "  // 時間単位有休取得時間（VACATION_DAYSが1未満の有給休暇を時間単位として集計）",
            "lineNumber": 350
          },
          {
            "text": "  const hourlyPaidLeaveHours = vacations",
            "lineNumber": 351
          },
          {
            "text": "    .filter(v =&gt; v.VACATION_TYPE_CODE === 'PAID_LEAVE' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED' &amp;&amp; parseFloat(v.VACATION_DAYS) &lt; 1)",
            "lineNumber": 352
          },
          {
            "text": "    .reduce((sum, v) =&gt; {",
            "lineNumber": 353
          },
          {
            "text": "      // VACATION_DAYSが1未満の場合、時間単位として扱う（例：0.5日 = 4時間）",
            "lineNumber": 354
          },
          {
            "text": "      const days = parseFloat(v.VACATION_DAYS) || 0;",
            "lineNumber": 355
          },
          {
            "text": "      // 1日 = 8時間として計算",
            "lineNumber": 356
          },
          {
            "text": "      return sum + (days * 8);",
            "lineNumber": 357
          },
          {
            "text": "    }, 0);",
            "lineNumber": 358
          },
          {
            "lineNumber": 359
          },
          {
            "text": "  // 代休取得日数",
            "lineNumber": 360
          },
          {
            "text": "  const substituteHolidayDays = vacations",
            "lineNumber": 361
          },
          {
            "text": "    .filter(v =&gt; v.VACATION_TYPE_CODE === 'SUBSTITUTE_HOLIDAY' &amp;&amp; v.APPROVAL_STATUS === 'APPROVED')",
            "lineNumber": 362
          },
          {
            "text": "    .reduce((sum, v) =&gt; sum + (parseFloat(v.VACATION_DAYS) || 0), 0);",
            "lineNumber": 363
          },
          {
            "lineNumber": 364
          },
          {
            "text": "  // 代休取得日数内訳",
            "lineNumber": 365
          },
          {
            "text": "  let substituteHolidayTypeName = '';",
            "lineNumber": 366
          },
          {
            "lineNumber": 367
          },
          {
            "text": "  if (substituteHolidayDays &gt; 0) {",
            "lineNumber": 368
          },
          {
            "text": "    substituteHolidayTypeName = '代休';",
            "lineNumber": 369
          },
          {
            "text": "  }",
            "lineNumber": 370
          },
          {
            "text": "  ",
            "lineNumber": 371
          },
          {
            "text": "  // 無給休暇日数（簡易的に0とする）",
            "lineNumber": 372
          },
          {
            "text": "  const unpaidLeaveDays = 0;",
            "lineNumber": 373
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.46532759070396423
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async \n\n  let previousCumulativeWorkHours = 0;\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const workDate = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;\n    const attendance = attendanceRows.find(row =&gt; normalizeDate(row.WORK_DATE) === workDate);\n    \n    // 祝日情報を取得\n    const dateObj = new Date(year, month - 1, day);\n    let holidayName = null;\n    try {\n      // isHolidayはbooleanを返すので、betweenで祝日情報を取得\n      const holidays = HolidayJp.between(dateObj, dateObj);\n      if (holidays &amp;&amp; holidays.length &gt; 0) {\n        holidayName = holidays[0].name || null;\n      }\n    } catch (error) {\n      console.error(&#96;祝日判定エラー (${workDate}):&#96;, error);\n      holidayName = null;\n    }\n    \n    // その日の休暇情報を取得（承認済みまたは申請中の休暇）\n    const dayVacation = vacations.find(v =&gt; {\n      const startDate = normalizeDate(v.START_DATE);\n      const endDate = normalizeDate(v.END_DATE);\n      return workDate &gt;= startDate &amp;&amp; workDate &lt;= endDate &amp;&amp; \n             (v.APPROVAL_STATUS === 'APPROVED' || v.APPROVAL_STATUS === 'PENDING');\n    });\n    let vacationTypeName = null;\n    if (dayVacation &amp;&amp; dayVacation.VACATION_TYPE_CODE) {\n      vacationTypeName = vacationTypeMap[dayVacation.VACATION_TYPE_CODE] || null;\n    }\n    \n    let breakTimeTotal = 0;\n    let actualWorkHours = 0;\n    let overtimeHours = 0;\n    // 日次の法定時間内残業・法定時間外残業（分単位）を保存\n    let withinLegalOvertimeMinutes = 0;\n    let overLegalOvertimeMinutes = 0;\n    \n    if (attendance) {\n      const breakTimes = await breakTimeModel.getBreakTimes;\n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "lineNumber": 56
          },
          {
            "text": "  let previousCumulativeWorkHours = 0;",
            "lineNumber": 57
          },
          {
            "text": "  ",
            "lineNumber": 58
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 59
          },
          {
            "text": "    const workDate = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;",
            "lineNumber": 60
          },
          {
            "text": "    const attendance = attendanceRows.find(row =&gt; normalizeDate(row.WORK_DATE) === workDate);",
            "lineNumber": 61
          },
          {
            "text": "    ",
            "lineNumber": 62
          },
          {
            "text": "    // 祝日情報を取得",
            "lineNumber": 63
          },
          {
            "text": "    const dateObj = new Date(year, month - 1, day);",
            "lineNumber": 64
          },
          {
            "text": "    let holidayName = null;",
            "lineNumber": 65
          },
          {
            "text": "    try {",
            "lineNumber": 66
          },
          {
            "text": "      // isHolidayはbooleanを返すので、betweenで祝日情報を取得",
            "lineNumber": 67
          },
          {
            "text": "      const holidays = HolidayJp.between(dateObj, dateObj);",
            "lineNumber": 68
          },
          {
            "text": "      if (holidays &amp;&amp; holidays.length &gt; 0) {",
            "lineNumber": 69
          },
          {
            "text": "        holidayName = holidays[0].name || null;",
            "lineNumber": 70
          },
          {
            "text": "      }",
            "lineNumber": 71
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 72
          },
          {
            "text": "      console.error(&#96;祝日判定エラー (${workDate}):&#96;, error);",
            "lineNumber": 73
          },
          {
            "text": "      holidayName = null;",
            "lineNumber": 74
          },
          {
            "text": "    }",
            "lineNumber": 75
          },
          {
            "text": "    ",
            "lineNumber": 76
          },
          {
            "text": "    // その日の休暇情報を取得（承認済みまたは申請中の休暇）",
            "lineNumber": 77
          },
          {
            "text": "    const dayVacation = vacations.find(v =&gt; {",
            "lineNumber": 78
          },
          {
            "text": "      const startDate = normalizeDate(v.START_DATE);",
            "lineNumber": 79
          },
          {
            "text": "      const endDate = normalizeDate(v.END_DATE);",
            "lineNumber": 80
          },
          {
            "text": "      return workDate &gt;= startDate &amp;&amp; workDate &lt;= endDate &amp;&amp; ",
            "lineNumber": 81
          },
          {
            "text": "             (v.APPROVAL_STATUS === 'APPROVED' || v.APPROVAL_STATUS === 'PENDING');",
            "lineNumber": 82
          },
          {
            "text": "    });",
            "lineNumber": 83
          },
          {
            "text": "    let vacationTypeName = null;",
            "lineNumber": 84
          },
          {
            "text": "    if (dayVacation &amp;&amp; dayVacation.VACATION_TYPE_CODE) {",
            "lineNumber": 85
          },
          {
            "text": "      vacationTypeName = vacationTypeMap[dayVacation.VACATION_TYPE_CODE] || null;",
            "lineNumber": 86
          },
          {
            "text": "    }",
            "lineNumber": 87
          },
          {
            "text": "    ",
            "lineNumber": 88
          },
          {
            "text": "    let breakTimeTotal = 0;",
            "lineNumber": 89
          },
          {
            "text": "    let actualWorkHours = 0;",
            "lineNumber": 90
          },
          {
            "text": "    let overtimeHours = 0;",
            "lineNumber": 91
          },
          {
            "text": "    // 日次の法定時間内残業・法定時間外残業（分単位）を保存",
            "lineNumber": 92
          },
          {
            "text": "    let withinLegalOvertimeMinutes = 0;",
            "lineNumber": 93
          },
          {
            "text": "    let overLegalOvertimeMinutes = 0;",
            "lineNumber": 94
          },
          {
            "text": "    ",
            "lineNumber": 95
          },
          {
            "text": "    if (attendance) {",
            "lineNumber": 96
          },
          {
            "text": "      const breakTimes = await breakTimeModel.getBreakTimes;",
            "lineNumber": 97
          },
          {
            "text": "  }",
            "lineNumber": 206
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.461335688829422
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 420,
            "column": 2
          }
        },
        "contents": "const getMonthlySummary = async \n\n  \n  // 無給休暇日数（簡易的に0とする）\n  const unpaidLeaveDays = 0;\n  const unpaidLeaveTypeName = '';\n  \n  // 有給残日数（月末日時点）\n  const endOfMonth = new Date(year, month, 0);\n  const endOfMonthStr = endOfMonth.toISOString().split('T')[0];\n  const paidLeaveBalance = await applicationModel.getVacationBalance(employeeId, 'PAID_LEAVE');\n  \n  // 計画付与予定日（次月以降）\n  let nextMonth = { year, month: month + 1 };\n\n  if (month === 12) {\n    nextMonth = { year: year + 1, month: 1 };\n  }\n  const plannedGrantDays = 0; // TODO: 計画付与予定日を取得\n  \n  const vacationInfo = {\n    paidLeaveDays,\n    paidLeaveTypeName,\n    hourlyPaidLeaveHours,\n    substituteHolidayDays,\n    substituteHolidayTypeName,\n    unpaidLeaveDays,\n    unpaidLeaveTypeName,\n    paidLeaveBalance,\n    plannedGrantDays\n  };\n  \n  // 月次承認状態（簡易的にNOT_SUBMITTEDとする）\n  const monthlyApprovalStatus = 'NOT_SUBMITTED';\n  \n  return {\n    employee: {\n      employeeId: employee.EMPLOYEE_ID,\n      employeeName: employee.EMPLOYEE_NAME,\n      department: employee.DEPARTMENT,\n      attendanceSystem: 'フレックスタイム制(一般)'\n    },\n    yearMonth: yearMonth,\n    dailyData,\n    monthlySummary,\n    vacationInfo,\n    monthlyApprovalStatus\n  };\n};\n\nmodule.exports = {\n  getMonthlySummary\n};",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "lineNumber": 370
          },
          {
            "text": "  ",
            "lineNumber": 371
          },
          {
            "text": "  // 無給休暇日数（簡易的に0とする）",
            "lineNumber": 372
          },
          {
            "text": "  const unpaidLeaveDays = 0;",
            "lineNumber": 373
          },
          {
            "text": "  const unpaidLeaveTypeName = '';",
            "lineNumber": 374
          },
          {
            "text": "  ",
            "lineNumber": 375
          },
          {
            "text": "  // 有給残日数（月末日時点）",
            "lineNumber": 376
          },
          {
            "text": "  const endOfMonth = new Date(year, month, 0);",
            "lineNumber": 377
          },
          {
            "text": "  const endOfMonthStr = endOfMonth.toISOString().split('T')[0];",
            "lineNumber": 378
          },
          {
            "text": "  const paidLeaveBalance = await applicationModel.getVacationBalance(employeeId, 'PAID_LEAVE');",
            "lineNumber": 379
          },
          {
            "text": "  ",
            "lineNumber": 380
          },
          {
            "text": "  // 計画付与予定日（次月以降）",
            "lineNumber": 381
          },
          {
            "text": "  let nextMonth = { year, month: month + 1 };",
            "lineNumber": 382
          },
          {
            "lineNumber": 383
          },
          {
            "text": "  if (month === 12) {",
            "lineNumber": 384
          },
          {
            "text": "    nextMonth = { year: year + 1, month: 1 };",
            "lineNumber": 385
          },
          {
            "text": "  }",
            "lineNumber": 386
          },
          {
            "text": "  const plannedGrantDays = 0; // TODO: 計画付与予定日を取得",
            "lineNumber": 387
          },
          {
            "text": "  ",
            "lineNumber": 388
          },
          {
            "text": "  const vacationInfo = {",
            "lineNumber": 389
          },
          {
            "text": "    paidLeaveDays,",
            "lineNumber": 390
          },
          {
            "text": "    paidLeaveTypeName,",
            "lineNumber": 391
          },
          {
            "text": "    hourlyPaidLeaveHours,",
            "lineNumber": 392
          },
          {
            "text": "    substituteHolidayDays,",
            "lineNumber": 393
          },
          {
            "text": "    substituteHolidayTypeName,",
            "lineNumber": 394
          },
          {
            "text": "    unpaidLeaveDays,",
            "lineNumber": 395
          },
          {
            "text": "    unpaidLeaveTypeName,",
            "lineNumber": 396
          },
          {
            "text": "    paidLeaveBalance,",
            "lineNumber": 397
          },
          {
            "text": "    plannedGrantDays",
            "lineNumber": 398
          },
          {
            "text": "  };",
            "lineNumber": 399
          },
          {
            "text": "  ",
            "lineNumber": 400
          },
          {
            "text": "  // 月次承認状態（簡易的にNOT_SUBMITTEDとする）",
            "lineNumber": 401
          },
          {
            "text": "  const monthlyApprovalStatus = 'NOT_SUBMITTED';",
            "lineNumber": 402
          },
          {
            "text": "  ",
            "lineNumber": 403
          },
          {
            "text": "  return {",
            "lineNumber": 404
          },
          {
            "text": "    employee: {",
            "lineNumber": 405
          },
          {
            "text": "      employeeId: employee.EMPLOYEE_ID,",
            "lineNumber": 406
          },
          {
            "text": "      employeeName: employee.EMPLOYEE_NAME,",
            "lineNumber": 407
          },
          {
            "text": "      department: employee.DEPARTMENT,",
            "lineNumber": 408
          },
          {
            "text": "      attendanceSystem: 'フレックスタイム制(一般)'",
            "lineNumber": 409
          },
          {
            "text": "    },",
            "lineNumber": 410
          },
          {
            "text": "    yearMonth: yearMonth,",
            "lineNumber": 411
          },
          {
            "text": "    dailyData,",
            "lineNumber": 412
          },
          {
            "text": "    monthlySummary,",
            "lineNumber": 413
          },
          {
            "text": "    vacationInfo,",
            "lineNumber": 414
          },
          {
            "text": "    monthlyApprovalStatus",
            "lineNumber": 415
          },
          {
            "text": "  };",
            "lineNumber": 416
          },
          {
            "text": "};",
            "lineNumber": 417
          },
          {
            "lineNumber": 418
          },
          {
            "text": "module.exports = {",
            "lineNumber": 419
          },
          {
            "text": "  getMonthlySummary",
            "lineNumber": 420
          },
          {
            "text": "};",
            "lineNumber": 421
          }
        ]
      },
      "score": 0.4557124376296997
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\monthly-summary-screen.md",
        "range": {
          "startPosition": {
            "line": 381
          },
          "endPosition": {
            "line": 413
          }
        },
        "contents": "- 関連する取得仕様\n  - テーブル取得仕様 No.5（休憩時間取得）\n- 取得条件\n  - ATTENDANCE_RECORD.EMPLOYEE_ID = 入出力項目定義.従業員ID\n  - DATE_FORMAT(ATTENDANCE_RECORD.WORK_DATE, '%Y-%m') = 入出力項目定義.対象年月\n- その他\n  - 対象年月の1日から月末日まで、全ての日付のレコードを取得（勤務記録がない日も含む）\n  - WORK_DATEで昇順ソート\n  - 各日付ごとに以下の情報を追加で取得する：\n    - 祝日名: 祝日マスタ（@holiday-jp/holiday_jp）から取得した祝日名（祝日の場合のみ）\n    - 休暇種別名: VACATION_HISTORYとVACATION_TYPEを結合して取得した休暇種別名（承認済みまたは申請中の休暇がある場合のみ）\n    - 休日出勤申請情報: HOLIDAY_WORK_APPLICATIONから取得した休日出勤申請情報（承認済みまたは申請中の休日出勤申請がある場合のみ）\n\n#### No.3\n- 取得仕様名：月次サマリーデータ取得\n- テーブル名：V_MONTHLY_ATTENDANCE（ビュー）\n  | 項目名 | 取得内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 所定出勤日数 | V_MONTHLY_ATTENDANCE.SCHEDULED_WORK_DAYS | |\n  | 実出勤日数 | V_MONTHLY_ATTENDANCE.ACTUAL_WORK_DAYS | |\n  | 所定労働時間 | V_MONTHLY_ATTENDANCE.SCHEDULED_WORK_HOURS | |\n  | 総労働時間 | V_MONTHLY_ATTENDANCE.TOTAL_WORK_HOURS | |\n  | 過不足時間 | V_MONTHLY_ATTENDANCE.OVER_UNDER_HOURS | |\n  | 法定休日労働時間 | V_MONTHLY_ATTENDANCE.LEGAL_HOLIDAY_WORK_HOURS | |\n  | 法定時間内残業 | V_MONTHLY_ATTENDANCE.WITHIN_LEGAL_OVERTIME_HOURS | |\n  | 法定時間外残業 | V_MONTHLY_ATTENDANCE.OVER_LEGAL_OVERTIME_HOURS | |\n  | 深夜労働時間 | V_MONTHLY_ATTENDANCE.NIGHT_WORK_HOURS | |\n- 関連する取得仕様\n  - なし\n- 取得条件\n  - V_MONTHLY_ATTENDANCE.EMPLOYEE_ID = 入出力項目定義.従業員ID\n  - V_MONTHLY_ATTENDANCE.YEAR_MONTH = 入出力項目定義.対象年月",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 382
          },
          {
            "text": "  - テーブル取得仕様 No.5（休憩時間取得）",
            "lineNumber": 383
          },
          {
            "text": "- 取得条件",
            "lineNumber": 384
          },
          {
            "text": "  - ATTENDANCE_RECORD.EMPLOYEE_ID = 入出力項目定義.従業員ID",
            "lineNumber": 385
          },
          {
            "text": "  - DATE_FORMAT(ATTENDANCE_RECORD.WORK_DATE, '%Y-%m') = 入出力項目定義.対象年月",
            "lineNumber": 386
          },
          {
            "text": "- その他",
            "lineNumber": 387
          },
          {
            "text": "  - 対象年月の1日から月末日まで、全ての日付のレコードを取得（勤務記録がない日も含む）",
            "lineNumber": 388
          },
          {
            "text": "  - WORK_DATEで昇順ソート",
            "lineNumber": 389
          },
          {
            "text": "  - 各日付ごとに以下の情報を追加で取得する：",
            "lineNumber": 390
          },
          {
            "text": "    - 祝日名: 祝日マスタ（@holiday-jp/holiday_jp）から取得した祝日名（祝日の場合のみ）",
            "lineNumber": 391
          },
          {
            "text": "    - 休暇種別名: VACATION_HISTORYとVACATION_TYPEを結合して取得した休暇種別名（承認済みまたは申請中の休暇がある場合のみ）",
            "lineNumber": 392
          },
          {
            "text": "    - 休日出勤申請情報: HOLIDAY_WORK_APPLICATIONから取得した休日出勤申請情報（承認済みまたは申請中の休日出勤申請がある場合のみ）",
            "lineNumber": 393
          },
          {
            "lineNumber": 394
          },
          {
            "text": "#### No.3",
            "lineNumber": 395
          },
          {
            "text": "- 取得仕様名：月次サマリーデータ取得",
            "lineNumber": 396
          },
          {
            "text": "- テーブル名：V_MONTHLY_ATTENDANCE（ビュー）",
            "lineNumber": 397
          },
          {
            "text": "  | 項目名 | 取得内容 | 補足 |",
            "lineNumber": 398
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 399
          },
          {
            "text": "  | 所定出勤日数 | V_MONTHLY_ATTENDANCE.SCHEDULED_WORK_DAYS | |",
            "lineNumber": 400
          },
          {
            "text": "  | 実出勤日数 | V_MONTHLY_ATTENDANCE.ACTUAL_WORK_DAYS | |",
            "lineNumber": 401
          },
          {
            "text": "  | 所定労働時間 | V_MONTHLY_ATTENDANCE.SCHEDULED_WORK_HOURS | |",
            "lineNumber": 402
          },
          {
            "text": "  | 総労働時間 | V_MONTHLY_ATTENDANCE.TOTAL_WORK_HOURS | |",
            "lineNumber": 403
          },
          {
            "text": "  | 過不足時間 | V_MONTHLY_ATTENDANCE.OVER_UNDER_HOURS | |",
            "lineNumber": 404
          },
          {
            "text": "  | 法定休日労働時間 | V_MONTHLY_ATTENDANCE.LEGAL_HOLIDAY_WORK_HOURS | |",
            "lineNumber": 405
          },
          {
            "text": "  | 法定時間内残業 | V_MONTHLY_ATTENDANCE.WITHIN_LEGAL_OVERTIME_HOURS | |",
            "lineNumber": 406
          },
          {
            "text": "  | 法定時間外残業 | V_MONTHLY_ATTENDANCE.OVER_LEGAL_OVERTIME_HOURS | |",
            "lineNumber": 407
          },
          {
            "text": "  | 深夜労働時間 | V_MONTHLY_ATTENDANCE.NIGHT_WORK_HOURS | |",
            "lineNumber": 408
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 409
          },
          {
            "text": "  - なし",
            "lineNumber": 410
          },
          {
            "text": "- 取得条件",
            "lineNumber": 411
          },
          {
            "text": "  - V_MONTHLY_ATTENDANCE.EMPLOYEE_ID = 入出力項目定義.従業員ID",
            "lineNumber": 412
          },
          {
            "text": "  - V_MONTHLY_ATTENDANCE.YEAR_MONTH = 入出力項目定義.対象年月",
            "lineNumber": 413
          }
        ]
      },
      "score": 0.446870893239975
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\routes\\application.js",
        "range": {
          "startPosition": {
            "line": 53,
            "column": 79
          },
          "endPosition": {
            "line": 91,
            "column": 78
          }
        },
        "contents": "/**\n * 休日出勤申請リスト取得API（代休取得可能日数計算用）\n * GET /api/application/holiday-work-list\n */\nrouter.get('/holiday-work-list', async (req, res, next) =&gt; {\n  try {\n    const { employeeId, startDate, endDate } = req.query;\n    \n    if (!employeeId || !startDate || !endDate) {\n      return res.status(400).json({\n        success: false,\n        message: '従業員ID、開始日、終了日が必要です。'\n      });\n    }\n    \n    const applicationModel = require('../models/applicationModel');\n    const applications = await applicationModel.getApplicationsByType(\n      employeeId,\n      'HOLIDAY_WORK',\n      startDate,\n      endDate\n    );\n    \n    res.json({\n      success: true,\n      applications\n    });\n  } catch (error) {\n    next(error);\n  }\n});\n\n/**\n * 申請状態取得API\n * GET /api/application/application-status\n */\nrouter.get('/application-status', applicationController.getApplicationStatus);",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 56
          },
          {
            "text": " * 休日出勤申請リスト取得API（代休取得可能日数計算用）",
            "lineNumber": 57
          },
          {
            "text": " * GET /api/application/holiday-work-list",
            "lineNumber": 58
          },
          {
            "text": " */",
            "lineNumber": 59
          },
          {
            "text": "router.get('/holiday-work-list', async (req, res, next) =&gt; {",
            "lineNumber": 60
          },
          {
            "text": "  try {",
            "lineNumber": 61
          },
          {
            "text": "    const { employeeId, startDate, endDate } = req.query;",
            "lineNumber": 62
          },
          {
            "text": "    ",
            "lineNumber": 63
          },
          {
            "text": "    if (!employeeId || !startDate || !endDate) {",
            "lineNumber": 64
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 65
          },
          {
            "text": "        success: false,",
            "lineNumber": 66
          },
          {
            "text": "        message: '従業員ID、開始日、終了日が必要です。'",
            "lineNumber": 67
          },
          {
            "text": "      });",
            "lineNumber": 68
          },
          {
            "text": "    }",
            "lineNumber": 69
          },
          {
            "text": "    ",
            "lineNumber": 70
          },
          {
            "text": "    const applicationModel = require('../models/applicationModel');",
            "lineNumber": 71
          },
          {
            "text": "    const applications = await applicationModel.getApplicationsByType(",
            "lineNumber": 72
          },
          {
            "text": "      employeeId,",
            "lineNumber": 73
          },
          {
            "text": "      'HOLIDAY_WORK',",
            "lineNumber": 74
          },
          {
            "text": "      startDate,",
            "lineNumber": 75
          },
          {
            "text": "      endDate",
            "lineNumber": 76
          },
          {
            "text": "    );",
            "lineNumber": 77
          },
          {
            "text": "    ",
            "lineNumber": 78
          },
          {
            "text": "    res.json({",
            "lineNumber": 79
          },
          {
            "text": "      success: true,",
            "lineNumber": 80
          },
          {
            "text": "      applications",
            "lineNumber": 81
          },
          {
            "text": "    });",
            "lineNumber": 82
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 83
          },
          {
            "text": "    next(error);",
            "lineNumber": 84
          },
          {
            "text": "  }",
            "lineNumber": 85
          },
          {
            "text": "});",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "/**",
            "lineNumber": 88
          },
          {
            "text": " * 申請状態取得API",
            "lineNumber": 89
          },
          {
            "text": " * GET /api/application/application-status",
            "lineNumber": 90
          },
          {
            "text": " */",
            "lineNumber": 91
          },
          {
            "text": "router.get('/application-status', applicationController.getApplicationStatus);",
            "lineNumber": 92
          }
        ]
      },
      "score": 0.43463099002838135
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\monthly-summary-screen.md",
        "range": {
          "startPosition": {
            "line": 411,
            "column": 2
          },
          "endPosition": {
            "line": 433,
            "column": 2
          }
        },
        "contents": "- V_MONTHLY_ATTENDANCE.EMPLOYEE_ID = 入出力項目定義.従業員ID\n  - V_MONTHLY_ATTENDANCE.YEAR_MONTH = 入出力項目定義.対象年月\n- その他\n  - ビューV_MONTHLY_ATTENDANCEを使用して月次集計データを取得\n  - 法定休日出勤日数、所定休日出勤日数、45時間を超える時間外労働、60時間を超える時間外労働、遅刻回数・時間、早退回数・時間、コア時間内の私用外出回数・時間は、ATTENDANCE_RECORDテーブルから別途集計する必要がある\n\n#### No.4\n- 取得仕様名：休暇情報取得\n- テーブル名：VACATION_HISTORY、VACATION_BALANCE、VACATION_TYPE\n  | 項目名 | 取得内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 有給取得日数 | VACATION_HISTORY.VACATION_DAYSの合計 | VACATION_TYPE_CODE = 'PAID_LEAVE' かつ対象年月内の取得日数 |\n  | 有給取得日数内訳 | VACATION_TYPE.VACATION_TYPE_NAME | VACATION_TYPE_CODE = 'PAID_LEAVE' に対応する休暇種別名（例: 年次有給休暇）。データがない場合は空文字 |\n  | 代休取得日数 | VACATION_HISTORY.VACATION_DAYSの合計 | VACATION_TYPE_CODE = 'SUBSTITUTE_HOLIDAY' かつ対象年月内の取得日数 |\n  | 代休取得日数内訳 | VACATION_TYPE.VACATION_TYPE_NAME | VACATION_TYPE_CODE = 'SUBSTITUTE_HOLIDAY' に対応する休暇種別名。データがない場合は空文字 |\n  | 無給休暇日数 | VACATION_HISTORY.VACATION_DAYSの合計 | VACATION_TYPE_CODEが無給の休暇種別 かつ対象年月内の取得日数 |\n  | 無給休暇日数内訳 | VACATION_TYPE.VACATION_TYPE_NAME | VACATION_TYPE_CODEが無給の休暇種別に対応する休暇種別名。データがない場合は空文字 |\n  | 有給残日数 | VACATION_BALANCE.REMAINING_DAYS | 対象年月の月末日時点の有給残日数 |\n  | 計画付与予定日 | VACATION_BALANCE.GRANTED_DAYS | 対象年月の次月以降の計画付与予定日 |\n- 関連する取得仕様\n  - なし\n- 取得条件\n  ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- V_MONTHLY_ATTENDANCE.EMPLOYEE_ID = 入出力項目定義.従業員ID",
            "lineNumber": 412
          },
          {
            "text": "  - V_MONTHLY_ATTENDANCE.YEAR_MONTH = 入出力項目定義.対象年月",
            "lineNumber": 413
          },
          {
            "text": "- その他",
            "lineNumber": 414
          },
          {
            "text": "  - ビューV_MONTHLY_ATTENDANCEを使用して月次集計データを取得",
            "lineNumber": 415
          },
          {
            "text": "  - 法定休日出勤日数、所定休日出勤日数、45時間を超える時間外労働、60時間を超える時間外労働、遅刻回数・時間、早退回数・時間、コア時間内の私用外出回数・時間は、ATTENDANCE_RECORDテーブルから別途集計する必要がある",
            "lineNumber": 416
          },
          {
            "lineNumber": 417
          },
          {
            "text": "#### No.4",
            "lineNumber": 418
          },
          {
            "text": "- 取得仕様名：休暇情報取得",
            "lineNumber": 419
          },
          {
            "text": "- テーブル名：VACATION_HISTORY、VACATION_BALANCE、VACATION_TYPE",
            "lineNumber": 420
          },
          {
            "text": "  | 項目名 | 取得内容 | 補足 |",
            "lineNumber": 421
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 422
          },
          {
            "text": "  | 有給取得日数 | VACATION_HISTORY.VACATION_DAYSの合計 | VACATION_TYPE_CODE = 'PAID_LEAVE' かつ対象年月内の取得日数 |",
            "lineNumber": 423
          },
          {
            "text": "  | 有給取得日数内訳 | VACATION_TYPE.VACATION_TYPE_NAME | VACATION_TYPE_CODE = 'PAID_LEAVE' に対応する休暇種別名（例: 年次有給休暇）。データがない場合は空文字 |",
            "lineNumber": 424
          },
          {
            "text": "  | 代休取得日数 | VACATION_HISTORY.VACATION_DAYSの合計 | VACATION_TYPE_CODE = 'SUBSTITUTE_HOLIDAY' かつ対象年月内の取得日数 |",
            "lineNumber": 425
          },
          {
            "text": "  | 代休取得日数内訳 | VACATION_TYPE.VACATION_TYPE_NAME | VACATION_TYPE_CODE = 'SUBSTITUTE_HOLIDAY' に対応する休暇種別名。データがない場合は空文字 |",
            "lineNumber": 426
          },
          {
            "text": "  | 無給休暇日数 | VACATION_HISTORY.VACATION_DAYSの合計 | VACATION_TYPE_CODEが無給の休暇種別 かつ対象年月内の取得日数 |",
            "lineNumber": 427
          },
          {
            "text": "  | 無給休暇日数内訳 | VACATION_TYPE.VACATION_TYPE_NAME | VACATION_TYPE_CODEが無給の休暇種別に対応する休暇種別名。データがない場合は空文字 |",
            "lineNumber": 428
          },
          {
            "text": "  | 有給残日数 | VACATION_BALANCE.REMAINING_DAYS | 対象年月の月末日時点の有給残日数 |",
            "lineNumber": 429
          },
          {
            "text": "  | 計画付与予定日 | VACATION_BALANCE.GRANTED_DAYS | 対象年月の次月以降の計画付与予定日 |",
            "lineNumber": 430
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 431
          },
          {
            "text": "  - なし",
            "lineNumber": 432
          },
          {
            "text": "- 取得条件",
            "lineNumber": 433
          },
          {
            "text": "  ",
            "lineNumber": 434
          }
        ]
      },
      "score": 0.4338490068912506
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 182,
            "column": 1
          },
          "endPosition": {
            "line": 203,
            "column": 3
          }
        },
        "contents": "/**\n * 月次サマリー情報を取得する（月次サマリー情報画面用）。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} yearMonth 対象年月（YYYY-MM形式）\n * @returns {Promise&lt;Object&gt;} 月次サマリー情報データ\n */\nexport async function getMonthlySummaryDetail(employeeId, yearMonth) {\n  const endpoint = &#96;/monthly-summary/detail?employeeId=${employeeId}&amp;yearMonth=${yearMonth}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * 申請状態を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請状態データ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 185
          },
          {
            "text": " * 月次サマリー情報を取得する（月次サマリー情報画面用）。",
            "lineNumber": 186
          },
          {
            "text": " *",
            "lineNumber": 187
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 188
          },
          {
            "text": " * @param {string} yearMonth 対象年月（YYYY-MM形式）",
            "lineNumber": 189
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリー情報データ",
            "lineNumber": 190
          },
          {
            "text": " */",
            "lineNumber": 191
          },
          {
            "text": "export async function getMonthlySummaryDetail(employeeId, yearMonth) {",
            "lineNumber": 192,
            "isSignature": true
          },
          {
            "text": "  const endpoint = &#96;/monthly-summary/detail?employeeId=${employeeId}&amp;yearMonth=${yearMonth}&#96;",
            "lineNumber": 193
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 194
          },
          {
            "text": "}",
            "lineNumber": 195,
            "isSignature": true
          },
          {
            "lineNumber": 196
          },
          {
            "text": "/**",
            "lineNumber": 197
          },
          {
            "text": " * 申請状態を取得する。",
            "lineNumber": 198
          },
          {
            "text": " *",
            "lineNumber": 199
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 200
          },
          {
            "text": " * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 201
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式）",
            "lineNumber": 202
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請状態データ",
            "lineNumber": 203
          },
          {
            "text": " */",
            "lineNumber": 204
          }
        ]
      },
      "score": 0.43131908774375916
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\masterService.js",
        "range": {
          "startPosition": {
            "line": 29,
            "column": 2
          },
          "endPosition": {
            "line": 77,
            "column": 19
          }
        },
        "contents": "/**\n * 月次サマリーを取得\n * @param {string} employeeId - 従業員ID\n * @param {number} year - 年\n * @param {number} month - 月\n * @returns {Promise&lt;Object&gt;} 月次サマリー\n */\nconst getMonthlySummary = async (employeeId, year, month) =&gt; {\n  const summary = await masterModel.getMonthlySummary(employeeId, year, month);\n  \n  if (!summary) {\n    return {\n      scheduledWorkDays: 0,\n      actualWorkDays: 0,\n      scheduledWorkHours: '0:00',\n      totalWorkHours: '0:00',\n      overUnderTime: '+0:00',\n      legalHolidayWork: '0:00',\n      withinLegalOvertime: '0:00',\n      overLegalOvertime: '0:00'\n    };\n  }\n  \n  return {\n    scheduledWorkDays: summary.SCHEDULED_WORK_DAYS || 0,\n    actualWorkDays: summary.ACTUAL_WORK_DAYS || 0,\n    scheduledWorkHours: formatHours(summary.SCHEDULED_WORK_HOURS),\n    totalWorkHours: formatHours(summary.TOTAL_WORK_HOURS),\n    overUnderTime: (() =&gt; {\n      let sign = '';\n\n      if (summary.OVER_UNDER_TIME &gt;= 0) {\n        sign = '+';\n      }\n\n      return &#96;${sign}${formatHours(Math.abs(summary.OVER_UNDER_TIME))}&#96;;\n    })(),\n    legalHolidayWork: formatHours(summary.LEGAL_HOLIDAY_WORK_HOURS),\n    withinLegalOvertime: formatHours(summary.WITHIN_LEGAL_OVERTIME_HOURS),\n    overLegalOvertime: formatHours(summary.OVER_LEGAL_OVERTIME_HOURS)\n  };\n};\n\nmodule.exports = {\n  getWorkLocations,\n  getJobs,\n  getVacationTypes,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 32
          },
          {
            "text": " * 月次サマリーを取得",
            "lineNumber": 33
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 34
          },
          {
            "text": " * @param {number} year - 年",
            "lineNumber": 35
          },
          {
            "text": " * @param {number} month - 月",
            "lineNumber": 36
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリー",
            "lineNumber": 37
          },
          {
            "text": " */",
            "lineNumber": 38
          },
          {
            "text": "const getMonthlySummary = async (employeeId, year, month) =&gt; {",
            "lineNumber": 39
          },
          {
            "text": "  const summary = await masterModel.getMonthlySummary(employeeId, year, month);",
            "lineNumber": 40
          },
          {
            "text": "  ",
            "lineNumber": 41
          },
          {
            "text": "  if (!summary) {",
            "lineNumber": 42
          },
          {
            "text": "    return {",
            "lineNumber": 43
          },
          {
            "text": "      scheduledWorkDays: 0,",
            "lineNumber": 44
          },
          {
            "text": "      actualWorkDays: 0,",
            "lineNumber": 45
          },
          {
            "text": "      scheduledWorkHours: '0:00',",
            "lineNumber": 46
          },
          {
            "text": "      totalWorkHours: '0:00',",
            "lineNumber": 47
          },
          {
            "text": "      overUnderTime: '+0:00',",
            "lineNumber": 48
          },
          {
            "text": "      legalHolidayWork: '0:00',",
            "lineNumber": 49
          },
          {
            "text": "      withinLegalOvertime: '0:00',",
            "lineNumber": 50
          },
          {
            "text": "      overLegalOvertime: '0:00'",
            "lineNumber": 51
          },
          {
            "text": "    };",
            "lineNumber": 52
          },
          {
            "text": "  }",
            "lineNumber": 53
          },
          {
            "text": "  ",
            "lineNumber": 54
          },
          {
            "text": "  return {",
            "lineNumber": 55
          },
          {
            "text": "    scheduledWorkDays: summary.SCHEDULED_WORK_DAYS || 0,",
            "lineNumber": 56
          },
          {
            "text": "    actualWorkDays: summary.ACTUAL_WORK_DAYS || 0,",
            "lineNumber": 57
          },
          {
            "text": "    scheduledWorkHours: formatHours(summary.SCHEDULED_WORK_HOURS),",
            "lineNumber": 58
          },
          {
            "text": "    totalWorkHours: formatHours(summary.TOTAL_WORK_HOURS),",
            "lineNumber": 59
          },
          {
            "text": "    overUnderTime: (() =&gt; {",
            "lineNumber": 60
          },
          {
            "text": "      let sign = '';",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "      if (summary.OVER_UNDER_TIME &gt;= 0) {",
            "lineNumber": 63
          },
          {
            "text": "        sign = '+';",
            "lineNumber": 64
          },
          {
            "text": "      }",
            "lineNumber": 65
          },
          {
            "lineNumber": 66
          },
          {
            "text": "      return &#96;${sign}${formatHours(Math.abs(summary.OVER_UNDER_TIME))}&#96;;",
            "lineNumber": 67
          },
          {
            "text": "    })(),",
            "lineNumber": 68
          },
          {
            "text": "    legalHolidayWork: formatHours(summary.LEGAL_HOLIDAY_WORK_HOURS),",
            "lineNumber": 69
          },
          {
            "text": "    withinLegalOvertime: formatHours(summary.WITHIN_LEGAL_OVERTIME_HOURS),",
            "lineNumber": 70
          },
          {
            "text": "    overLegalOvertime: formatHours(summary.OVER_LEGAL_OVERTIME_HOURS)",
            "lineNumber": 71
          },
          {
            "text": "  };",
            "lineNumber": 72
          },
          {
            "text": "};",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "module.exports = {",
            "lineNumber": 75
          },
          {
            "text": "  getWorkLocations,",
            "lineNumber": 76
          },
          {
            "text": "  getJobs,",
            "lineNumber": 77
          },
          {
            "text": "  getVacationTypes,",
            "lineNumber": 78
          }
        ]
      },
      "score": 0.42842423915863037
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\feture_list\\TeamSpirit機能一覧.md",
        "range": {
          "startPosition": {
            "line": 131
          },
          "endPosition": {
            "line": 144
          }
        },
        "contents": "| 128 | 勤務表 | API | API_TS_0212 | 月次サマリー取得 | GetMonthlySummary | N/A | N/A | N/A | N/A | N/A | 従業員 | 指定年月の月次サマリーを取得する | GET /api/attendance/monthly-summary | リクエストにEMPLOYEE_ID、YEAR、MONTHを受け取り、V_MONTHLY_ATTENDANCEビューから月間の勤務時間集計、残業時間、深夜時間、休日勤務時間などを取得 |\n| 129 | 勤務表 | API | API_TS_0213 | 休暇情報取得 | GetVacationInfo | N/A | N/A | N/A | N/A | N/A | 従業員 | 休暇残日数と取得履歴を取得する | GET /api/vacation/info | リクエストにEMPLOYEE_IDを受け取り、V_VACATION_BALANCE_SUMMARYビューから休暇残日数、VACATION_HISTORYテーブルから取得履歴を取得 |\n| 130 | マスタ | API | API_TS_0301 | 勤務場所マスタ取得 | GetWorkLocations | N/A | N/A | N/A | N/A | N/A | 従業員 | 勤務場所マスタを取得する | GET /api/master/work-locations | WORK_LOCATIONテーブルからIS_ACTIVE=TRUEの勤務場所をDISPLAY_ORDER順で取得 |\n| 131 | マスタ | API | API_TS_0302 | ジョブマスタ取得 | GetJobMaster | N/A | N/A | N/A | N/A | N/A | 従業員 | ジョブマスタを取得する | GET /api/master/jobs | JOB_MASTERテーブルからIS_ACTIVE=TRUEのジョブを取得。工数入力画面で使用 |\n| 132 | マスタ | API | API_TS_0303 | 休暇種別マスタ取得 | GetVacationTypes | N/A | N/A | N/A | N/A | N/A | 従業員 | 休暇種別マスタを取得する | GET /api/master/vacation-types | VACATION_TYPEテーブルからIS_ACTIVE=TRUEの休暇種別をDISPLAY_ORDER順で取得 |\n\n## 備考\n\n### 対象機能\n- ログイン画面: 社員コードとパスワードによる認証機能\n- ホーム画面: WEBタイムレコーダーでの勤怠入力（出勤・退勤・定時出勤・定時退勤・中断再開）、勤務場所選択（通勤・在宅・直行直帰・出張）、お知らせ表示\n- 勤務表画面: 出退勤時刻表示・入力、休憩入力、公用外出入力、勤務場所選択、備考入力、工数実績入力、動意情報入力（手入力）、月次サマリー表示、休暇情報、日次確定申請など\n- 各種入力画面: 勤怠情報入力画面、動意情報入力画面、備考入力画面、工数実績入力画面、月次サマリー画面、個人休暇表示画面",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| 128 | 勤務表 | API | API_TS_0212 | 月次サマリー取得 | GetMonthlySummary | N/A | N/A | N/A | N/A | N/A | 従業員 | 指定年月の月次サマリーを取得する | GET /api/attendance/monthly-summary | リクエストにEMPLOYEE_ID、YEAR、MONTHを受け取り、V_MONTHLY_ATTENDANCEビューから月間の勤務時間集計、残業時間、深夜時間、休日勤務時間などを取得 |",
            "lineNumber": 132
          },
          {
            "text": "| 129 | 勤務表 | API | API_TS_0213 | 休暇情報取得 | GetVacationInfo | N/A | N/A | N/A | N/A | N/A | 従業員 | 休暇残日数と取得履歴を取得する | GET /api/vacation/info | リクエストにEMPLOYEE_IDを受け取り、V_VACATION_BALANCE_SUMMARYビューから休暇残日数、VACATION_HISTORYテーブルから取得履歴を取得 |",
            "lineNumber": 133
          },
          {
            "text": "| 130 | マスタ | API | API_TS_0301 | 勤務場所マスタ取得 | GetWorkLocations | N/A | N/A | N/A | N/A | N/A | 従業員 | 勤務場所マスタを取得する | GET /api/master/work-locations | WORK_LOCATIONテーブルからIS_ACTIVE=TRUEの勤務場所をDISPLAY_ORDER順で取得 |",
            "lineNumber": 134
          },
          {
            "text": "| 131 | マスタ | API | API_TS_0302 | ジョブマスタ取得 | GetJobMaster | N/A | N/A | N/A | N/A | N/A | 従業員 | ジョブマスタを取得する | GET /api/master/jobs | JOB_MASTERテーブルからIS_ACTIVE=TRUEのジョブを取得。工数入力画面で使用 |",
            "lineNumber": 135
          },
          {
            "text": "| 132 | マスタ | API | API_TS_0303 | 休暇種別マスタ取得 | GetVacationTypes | N/A | N/A | N/A | N/A | N/A | 従業員 | 休暇種別マスタを取得する | GET /api/master/vacation-types | VACATION_TYPEテーブルからIS_ACTIVE=TRUEの休暇種別をDISPLAY_ORDER順で取得 |",
            "lineNumber": 136
          },
          {
            "lineNumber": 137
          },
          {
            "text": "## 備考",
            "lineNumber": 138
          },
          {
            "lineNumber": 139
          },
          {
            "text": "### 対象機能",
            "lineNumber": 140
          },
          {
            "text": "- ログイン画面: 社員コードとパスワードによる認証機能",
            "lineNumber": 141
          },
          {
            "text": "- ホーム画面: WEBタイムレコーダーでの勤怠入力（出勤・退勤・定時出勤・定時退勤・中断再開）、勤務場所選択（通勤・在宅・直行直帰・出張）、お知らせ表示",
            "lineNumber": 142
          },
          {
            "text": "- 勤務表画面: 出退勤時刻表示・入力、休憩入力、公用外出入力、勤務場所選択、備考入力、工数実績入力、動意情報入力（手入力）、月次サマリー表示、休暇情報、日次確定申請など",
            "lineNumber": 143
          },
          {
            "text": "- 各種入力画面: 勤怠情報入力画面、動意情報入力画面、備考入力画面、工数実績入力画面、月次サマリー画面、個人休暇表示画面",
            "lineNumber": 144
          }
        ]
      },
      "score": 0.42767998576164246
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 123,
            "column": 1
          },
          "endPosition": {
            "line": 144,
            "column": 3
          }
        },
        "contents": "/**\n * 月次サマリーを取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} year 年（YYYY形式）\n * @param {string} month 月（MM形式）\n * @returns {Promise&lt;Object&gt;} 月次サマリーデータ\n */\nexport async function getMonthlySummary(employeeId, year, month) {\n  const yearMonth = &#96;${year}-${month.padStart(2, '0')}&#96;\n  const endpoint = &#96;/monthly-summary/detail?employeeId=${employeeId}&amp;yearMonth=${yearMonth}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * 休暇情報を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @returns {Promise&lt;Object&gt;} 休暇情報データ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 126
          },
          {
            "text": " * 月次サマリーを取得する。",
            "lineNumber": 127
          },
          {
            "text": " *",
            "lineNumber": 128
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 129
          },
          {
            "text": " * @param {string} year 年（YYYY形式）",
            "lineNumber": 130
          },
          {
            "text": " * @param {string} month 月（MM形式）",
            "lineNumber": 131
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリーデータ",
            "lineNumber": 132
          },
          {
            "text": " */",
            "lineNumber": 133
          },
          {
            "text": "export async function getMonthlySummary(employeeId, year, month) {",
            "lineNumber": 134,
            "isSignature": true
          },
          {
            "text": "  const yearMonth = &#96;${year}-${month.padStart(2, '0')}&#96;",
            "lineNumber": 135
          },
          {
            "text": "  const endpoint = &#96;/monthly-summary/detail?employeeId=${employeeId}&amp;yearMonth=${yearMonth}&#96;",
            "lineNumber": 136
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 137
          },
          {
            "text": "}",
            "lineNumber": 138,
            "isSignature": true
          },
          {
            "lineNumber": 139
          },
          {
            "text": "/**",
            "lineNumber": 140
          },
          {
            "text": " * 休暇情報を取得する。",
            "lineNumber": 141
          },
          {
            "text": " *",
            "lineNumber": 142
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 143
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 休暇情報データ",
            "lineNumber": 144
          },
          {
            "text": " */",
            "lineNumber": 145
          }
        ]
      },
      "score": 0.42608821392059326
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 85,
            "column": 1
          }
        },
        "contents": "/**\n * 勤怠サービス\n */\nconst attendanceModel = require('../models/attendanceModel');\nconst breakTimeModel = require('../models/breakTimeModel');\nconst workHoursModel = require('../models/workHoursModel');\nconst applicationModel = require('../models/applicationModel');\nconst { \n  getTodayJST, \n  getNow, \n  toDateTime, \n  formatHours, \n  formatOverUnder,\n  getMonthRange,\n  getScheduledWorkDays,\n  normalizeDate,\n  calculateMinutes\n} = require('../utils/dateUtils');\nconst db = require('../config/database');\n\n/**\n * 日次勤怠記録を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} workDate 勤務日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 勤怠記録\n */\nconst getDailyAttendance = async (employeeId, workDate) =&gt; {\n  const attendance = await attendanceModel.getAttendanceDetail(employeeId, workDate);\n  \n  if (!attendance) {\n    return null;\n  }\n  \n  const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n  const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);\n  \n  // 休憩時間と公用外出を統合\n  const combinedBreakTimes = [];\n  \n  for (const breakTime of breakTimes) {\n    combinedBreakTimes.push({\n      ...breakTime,\n      BREAK_TYPE: 'BREAK'\n    });\n  }\n  \n  for (const outing of officialOutings) {\n    combinedBreakTimes.push({\n      BREAK_ID: outing.OUTING_ID,\n      BREAK_SEQ: outing.OUTING_SEQ,\n      BREAK_START_TIME: outing.OUTING_START_TIME,\n      BREAK_END_TIME: outing.OUTING_END_TIME,\n      BREAK_DURATION_MINUTES: outing.OUTING_DURATION_MINUTES,\n      BREAK_TYPE: 'OFFICIAL_OUTING',\n      OUTING_PURPOSE: outing.OUTING_PURPOSE\n    });\n  }\n  \n  const isClockInManual = attendance.CLOCK_IN_TYPE === 'MANUAL';\n  const isClockOutManual = attendance.CLOCK_OUT_TYPE === 'MANUAL';\n\n  // ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEはデータベースから直接取得\n  // データベースに値が存在しない場合は、CLOCK_IN_TYPEがSTAMPの場合にCLOCK_IN_TIMEを使用\n  let originalClockInTime = attendance.ORIGINAL_CLOCK_IN_TIME;\n\n  if (!originalClockInTime &amp;&amp; attendance.CLOCK_IN_TYPE === 'STAMP')\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * 勤怠サービス",
            "lineNumber": 2
          },
          {
            "text": " */",
            "lineNumber": 3
          },
          {
            "text": "const attendanceModel = require('../models/attendanceModel');",
            "lineNumber": 4
          },
          {
            "text": "const breakTimeModel = require('../models/breakTimeModel');",
            "lineNumber": 5
          },
          {
            "text": "const workHoursModel = require('../models/workHoursModel');",
            "lineNumber": 6
          },
          {
            "text": "const applicationModel = require('../models/applicationModel');",
            "lineNumber": 7
          },
          {
            "text": "const { ",
            "lineNumber": 8
          },
          {
            "text": "  getTodayJST, ",
            "lineNumber": 9
          },
          {
            "text": "  getNow, ",
            "lineNumber": 10
          },
          {
            "text": "  toDateTime, ",
            "lineNumber": 11
          },
          {
            "text": "  formatHours, ",
            "lineNumber": 12
          },
          {
            "text": "  formatOverUnder,",
            "lineNumber": 13
          },
          {
            "text": "  getMonthRange,",
            "lineNumber": 14
          },
          {
            "text": "  getScheduledWorkDays,",
            "lineNumber": 15
          },
          {
            "text": "  normalizeDate,",
            "lineNumber": 16
          },
          {
            "text": "  calculateMinutes",
            "lineNumber": 17
          },
          {
            "text": "} = require('../utils/dateUtils');",
            "lineNumber": 18
          },
          {
            "text": "const db = require('../config/database');",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "/**",
            "lineNumber": 21
          },
          {
            "text": " * 日次勤怠記録を取得する。",
            "lineNumber": 22
          },
          {
            "text": " *",
            "lineNumber": 23
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 24
          },
          {
            "text": " * @param {string} workDate 勤務日（YYYY-MM-DD形式）",
            "lineNumber": 25
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 勤怠記録",
            "lineNumber": 26
          },
          {
            "text": " */",
            "lineNumber": 27
          },
          {
            "text": "const getDailyAttendance = async (employeeId, workDate) =&gt; {",
            "lineNumber": 28
          },
          {
            "text": "  const attendance = await attendanceModel.getAttendanceDetail(employeeId, workDate);",
            "lineNumber": 29
          },
          {
            "text": "  ",
            "lineNumber": 30
          },
          {
            "text": "  if (!attendance) {",
            "lineNumber": 31
          },
          {
            "text": "    return null;",
            "lineNumber": 32
          },
          {
            "text": "  }",
            "lineNumber": 33
          },
          {
            "text": "  ",
            "lineNumber": 34
          },
          {
            "text": "  const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 35
          },
          {
            "text": "  const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);",
            "lineNumber": 36
          },
          {
            "text": "  ",
            "lineNumber": 37
          },
          {
            "text": "  // 休憩時間と公用外出を統合",
            "lineNumber": 38
          },
          {
            "text": "  const combinedBreakTimes = [];",
            "lineNumber": 39
          },
          {
            "text": "  ",
            "lineNumber": 40
          },
          {
            "text": "  for (const breakTime of breakTimes) {",
            "lineNumber": 41
          },
          {
            "text": "    combinedBreakTimes.push({",
            "lineNumber": 42
          },
          {
            "text": "      ...breakTime,",
            "lineNumber": 43
          },
          {
            "text": "      BREAK_TYPE: 'BREAK'",
            "lineNumber": 44
          },
          {
            "text": "    });",
            "lineNumber": 45
          },
          {
            "text": "  }",
            "lineNumber": 46
          },
          {
            "text": "  ",
            "lineNumber": 47
          },
          {
            "text": "  for (const outing of officialOutings) {",
            "lineNumber": 48
          },
          {
            "text": "    combinedBreakTimes.push({",
            "lineNumber": 49
          },
          {
            "text": "      BREAK_ID: outing.OUTING_ID,",
            "lineNumber": 50
          },
          {
            "text": "      BREAK_SEQ: outing.OUTING_SEQ,",
            "lineNumber": 51
          },
          {
            "text": "      BREAK_START_TIME: outing.OUTING_START_TIME,",
            "lineNumber": 52
          },
          {
            "text": "      BREAK_END_TIME: outing.OUTING_END_TIME,",
            "lineNumber": 53
          },
          {
            "text": "      BREAK_DURATION_MINUTES: outing.OUTING_DURATION_MINUTES,",
            "lineNumber": 54
          },
          {
            "text": "      BREAK_TYPE: 'OFFICIAL_OUTING',",
            "lineNumber": 55
          },
          {
            "text": "      OUTING_PURPOSE: outing.OUTING_PURPOSE",
            "lineNumber": 56
          },
          {
            "text": "    });",
            "lineNumber": 57
          },
          {
            "text": "  }",
            "lineNumber": 58
          },
          {
            "text": "  ",
            "lineNumber": 59
          },
          {
            "text": "  const isClockInManual = attendance.CLOCK_IN_TYPE === 'MANUAL';",
            "lineNumber": 60
          },
          {
            "text": "  const isClockOutManual = attendance.CLOCK_OUT_TYPE === 'MANUAL';",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "  // ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEはデータベースから直接取得",
            "lineNumber": 63
          },
          {
            "text": "  // データベースに値が存在しない場合は、CLOCK_IN_TYPEがSTAMPの場合にCLOCK_IN_TIMEを使用",
            "lineNumber": 64
          },
          {
            "text": "  let originalClockInTime = attendance.ORIGINAL_CLOCK_IN_TIME;",
            "lineNumber": 65
          },
          {
            "lineNumber": 66
          },
          {
            "text": "  if (!originalClockInTime &amp;&amp; attendance.CLOCK_IN_TYPE === 'STAMP')",
            "lineNumber": 67
          },
          {
            "text": ";",
            "lineNumber": 86
          }
        ]
      },
      "score": 0.42567381262779236
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\MonthlySummaryScreen.vue",
        "range": {
          "startPosition": {
            "line": 492
          },
          "endPosition": {
            "line": 551
          }
        },
        "contents": "  },\n  methods: {\n    async loadData(employeeId, yearMonth) {\n      this.loading = true\n      this.error = null\n      \n      try {\n        const response = await getMonthlySummaryDetail(employeeId, yearMonth)\n        \n        if (response.success) {\n          this.employee = response.employee\n          this.dailyData = response.dailyData || []\n          this.monthlySummary = response.monthlySummary || {}\n          this.vacationInfo = response.vacationInfo || {}\n          this.monthlyApprovalStatus = response.monthlyApprovalStatus || 'NOT_SUBMITTED'\n        } else {\n          this.error = response.message || 'データの取得に失敗しました。'\n        }\n      } catch (err) {\n        console.error('月次サマリー情報の取得エラー:', err)\n        this.error = err.message || 'データの取得に失敗しました。'\n      } finally {\n        this.loading = false\n      }\n    },\n    formatDate(dateStr, index) {\n      if (!dateStr) return ''\n      const date = new Date(dateStr)\n      // 最初の行だけ月を含める\n      if (index === 0) {\n        return &#96;${date.getMonth() + 1}/${date.getDate()}&#96;\n      }\n      return &#96;${date.getDate()}&#96;\n    },\n    getDatePaddingLeft(index, dateStr) {\n      // 最初の行の日付の1桁目の位置に合わせる\n      if (index === 0) return 0\n      \n      if (!dateStr) return 18\n      const date = new Date(dateStr)\n      const day = date.getDate()\n      \n      // 「12/」の幅を計算（フォントサイズ10px、文字数3文字分）\n      // 約18px程度の幅があると仮定\n      let baseOffset = 18\n      \n      // 2~9は4px左にずらす\n      if (day &gt;= 2 &amp;&amp; day &lt;= 9) {\n        baseOffset -= 4\n      }\n      // 10~31は9px左にずらす\n      if (day &gt;= 10 &amp;&amp; day &lt;= 31) {\n        baseOffset -= 9\n      }\n      \n      return baseOffset\n    },\n    getDayOfWeek(dateStr) {\n      if (!dateStr) return ''",
        "signatures": {},
        "detailedLines": [
          {
            "text": "  },",
            "lineNumber": 493
          },
          {
            "text": "  methods: {",
            "lineNumber": 494
          },
          {
            "text": "    async loadData(employeeId, yearMonth) {",
            "lineNumber": 495
          },
          {
            "text": "      this.loading = true",
            "lineNumber": 496
          },
          {
            "text": "      this.error = null",
            "lineNumber": 497
          },
          {
            "text": "      ",
            "lineNumber": 498
          },
          {
            "text": "      try {",
            "lineNumber": 499
          },
          {
            "text": "        const response = await getMonthlySummaryDetail(employeeId, yearMonth)",
            "lineNumber": 500
          },
          {
            "text": "        ",
            "lineNumber": 501
          },
          {
            "text": "        if (response.success) {",
            "lineNumber": 502
          },
          {
            "text": "          this.employee = response.employee",
            "lineNumber": 503
          },
          {
            "text": "          this.dailyData = response.dailyData || []",
            "lineNumber": 504
          },
          {
            "text": "          this.monthlySummary = response.monthlySummary || {}",
            "lineNumber": 505
          },
          {
            "text": "          this.vacationInfo = response.vacationInfo || {}",
            "lineNumber": 506
          },
          {
            "text": "          this.monthlyApprovalStatus = response.monthlyApprovalStatus || 'NOT_SUBMITTED'",
            "lineNumber": 507
          },
          {
            "text": "        } else {",
            "lineNumber": 508
          },
          {
            "text": "          this.error = response.message || 'データの取得に失敗しました。'",
            "lineNumber": 509
          },
          {
            "text": "        }",
            "lineNumber": 510
          },
          {
            "text": "      } catch (err) {",
            "lineNumber": 511
          },
          {
            "text": "        console.error('月次サマリー情報の取得エラー:', err)",
            "lineNumber": 512
          },
          {
            "text": "        this.error = err.message || 'データの取得に失敗しました。'",
            "lineNumber": 513
          },
          {
            "text": "      } finally {",
            "lineNumber": 514
          },
          {
            "text": "        this.loading = false",
            "lineNumber": 515
          },
          {
            "text": "      }",
            "lineNumber": 516
          },
          {
            "text": "    },",
            "lineNumber": 517
          },
          {
            "text": "    formatDate(dateStr, index) {",
            "lineNumber": 518
          },
          {
            "text": "      if (!dateStr) return ''",
            "lineNumber": 519
          },
          {
            "text": "      const date = new Date(dateStr)",
            "lineNumber": 520
          },
          {
            "text": "      // 最初の行だけ月を含める",
            "lineNumber": 521
          },
          {
            "text": "      if (index === 0) {",
            "lineNumber": 522
          },
          {
            "text": "        return &#96;${date.getMonth() + 1}/${date.getDate()}&#96;",
            "lineNumber": 523
          },
          {
            "text": "      }",
            "lineNumber": 524
          },
          {
            "text": "      return &#96;${date.getDate()}&#96;",
            "lineNumber": 525
          },
          {
            "text": "    },",
            "lineNumber": 526
          },
          {
            "text": "    getDatePaddingLeft(index, dateStr) {",
            "lineNumber": 527
          },
          {
            "text": "      // 最初の行の日付の1桁目の位置に合わせる",
            "lineNumber": 528
          },
          {
            "text": "      if (index === 0) return 0",
            "lineNumber": 529
          },
          {
            "text": "      ",
            "lineNumber": 530
          },
          {
            "text": "      if (!dateStr) return 18",
            "lineNumber": 531
          },
          {
            "text": "      const date = new Date(dateStr)",
            "lineNumber": 532
          },
          {
            "text": "      const day = date.getDate()",
            "lineNumber": 533
          },
          {
            "text": "      ",
            "lineNumber": 534
          },
          {
            "text": "      // 「12/」の幅を計算（フォントサイズ10px、文字数3文字分）",
            "lineNumber": 535
          },
          {
            "text": "      // 約18px程度の幅があると仮定",
            "lineNumber": 536
          },
          {
            "text": "      let baseOffset = 18",
            "lineNumber": 537
          },
          {
            "text": "      ",
            "lineNumber": 538
          },
          {
            "text": "      // 2~9は4px左にずらす",
            "lineNumber": 539
          },
          {
            "text": "      if (day &gt;= 2 &amp;&amp; day &lt;= 9) {",
            "lineNumber": 540
          },
          {
            "text": "        baseOffset -= 4",
            "lineNumber": 541
          },
          {
            "text": "      }",
            "lineNumber": 542
          },
          {
            "text": "      // 10~31は9px左にずらす",
            "lineNumber": 543
          },
          {
            "text": "      if (day &gt;= 10 &amp;&amp; day &lt;= 31) {",
            "lineNumber": 544
          },
          {
            "text": "        baseOffset -= 9",
            "lineNumber": 545
          },
          {
            "text": "      }",
            "lineNumber": 546
          },
          {
            "text": "      ",
            "lineNumber": 547
          },
          {
            "text": "      return baseOffset",
            "lineNumber": 548
          },
          {
            "text": "    },",
            "lineNumber": 549
          },
          {
            "text": "    getDayOfWeek(dateStr) {",
            "lineNumber": 550
          },
          {
            "text": "      if (!dateStr) return ''",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.4216875433921814
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "/**\n * 月次サマリーサービス\n */\nconst employeeModel = require('../models/employeeModel');\nconst attendanceModel = require('../models/attendanceModel');\nconst breakTimeModel = require('../models/breakTimeModel');\nconst applicationModel = require('../models/applicationModel');\nconst masterModel = require('../models/masterModel');\nconst { \n  getMonthRange,\n  getScheduledWorkDays,\n  normalizeDate,\n  formatHours,\n  formatOverUnder,\n  calculateMinutes\n} = require('../utils/dateUtils');\nconst HolidayJp = require('@holiday-jp/holiday_jp');\nconst db = require('../config/database');\n\n/**\n * 月次サマリー情報を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} yearMonth - 対象年月（YYYY-MM形式）\n * @returns {Promise&lt;Object&gt;} 月次サマリー情報\n */\nconst getMonthlySummary = async (employeeId, yearMonth) =&gt; {\n  // 年月をパース\n  const [year, month] = yearMonth.split('-').map(Number);\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * 月次サマリーサービス",
            "lineNumber": 2
          },
          {
            "text": " */",
            "lineNumber": 3
          },
          {
            "text": "const employeeModel = require('../models/employeeModel');",
            "lineNumber": 4
          },
          {
            "text": "const attendanceModel = require('../models/attendanceModel');",
            "lineNumber": 5
          },
          {
            "text": "const breakTimeModel = require('../models/breakTimeModel');",
            "lineNumber": 6
          },
          {
            "text": "const applicationModel = require('../models/applicationModel');",
            "lineNumber": 7
          },
          {
            "text": "const masterModel = require('../models/masterModel');",
            "lineNumber": 8
          },
          {
            "text": "const { ",
            "lineNumber": 9
          },
          {
            "text": "  getMonthRange,",
            "lineNumber": 10
          },
          {
            "text": "  getScheduledWorkDays,",
            "lineNumber": 11
          },
          {
            "text": "  normalizeDate,",
            "lineNumber": 12
          },
          {
            "text": "  formatHours,",
            "lineNumber": 13
          },
          {
            "text": "  formatOverUnder,",
            "lineNumber": 14
          },
          {
            "text": "  calculateMinutes",
            "lineNumber": 15
          },
          {
            "text": "} = require('../utils/dateUtils');",
            "lineNumber": 16
          },
          {
            "text": "const HolidayJp = require('@holiday-jp/holiday_jp');",
            "lineNumber": 17
          },
          {
            "text": "const db = require('../config/database');",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "/**",
            "lineNumber": 20
          },
          {
            "text": " * 月次サマリー情報を取得",
            "lineNumber": 21
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 22
          },
          {
            "text": " * @param {string} yearMonth - 対象年月（YYYY-MM形式）",
            "lineNumber": 23
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次サマリー情報",
            "lineNumber": 24
          },
          {
            "text": " */",
            "lineNumber": 25
          },
          {
            "text": "const getMonthlySummary = async (employeeId, yearMonth) =&gt; {",
            "lineNumber": 26
          },
          {
            "text": "  // 年月をパース",
            "lineNumber": 27
          },
          {
            "text": "  const [year, month] = yearMonth.split('-').map(Number);",
            "lineNumber": 28
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.42068108916282654
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-table-screen.md",
        "range": {
          "startPosition": {
            "line": 975
          },
          "endPosition": {
            "line": 1020
          }
        },
        "contents": "- レスポンス\n  | 項目名 | レスポンス内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 成功フラグ | 成功/失敗 | true/false |\n  | メッセージ | 処理結果メッセージ | |\n  | 更新後の勤怠データ | 更新後のATTENDANCE_RECORDデータ | JSON形式 |\n- 関連する取得仕様\n  - なし\n- その他\n  - 日次確定済み（IS_DAILY_CONFIRMED=TRUE）の場合は更新不可\n  - 出勤時刻・退勤時刻を更新した場合、ACTUAL_WORK_HOURSを自動計算\n  - 手入力（MANUAL）の場合、備考の入力を推奨\n\n#### No.6\n- API仕様名：日次確定申請API\n- リクエスト\n  | 項目名 | リクエスト内容 | 補足 |\n  | :--- | :--- | :--- |\n  | HTTPメソッド | POST | |\n  | エンドポイント | /api/attendance/daily-confirmation | |\n  | EMPLOYEE_ID | 入出力項目定義.従業員ID | リクエストボディ |\n  | WORK_DATE | 選択した日付 | リクエストボディ、YYYY-MM-DD形式 |\n- レスポンス\n  | 項目名 | レスポンス内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 成功フラグ | 成功/失敗 | true/false |\n  | メッセージ | 処理結果メッセージ | |\n- 関連する取得仕様\n  - なし\n- その他\n  - 勤務場所が設定されているか、工数合計と実労働時間が一致するかをチェック\n  - 問題なければIS_DAILY_CONFIRMED=TRUE、DAILY_CONFIRMED_ATを現在時刻で更新\n\n#### No.7\n- API仕様名：月次サマリー取得API\n- リクエスト\n  | 項目名 | リクエスト内容 | 補足 |\n  | :--- | :--- | :--- |\n  | HTTPメソッド | GET | |\n  | エンドポイント | /api/attendance/monthly-summary | |\n  | EMPLOYEE_ID | 入出力項目定義.従業員ID | クエリパラメータ |\n  | YEAR | 表示対象年 | クエリパラメータ、YYYY形式 |\n  | MONTH | 表示対象月 | クエリパラメータ、MM形式 |\n- レスポンス\n  | 項目名 | レスポンス内容 | 補足 |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- レスポンス",
            "lineNumber": 976
          },
          {
            "text": "  | 項目名 | レスポンス内容 | 補足 |",
            "lineNumber": 977
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 978
          },
          {
            "text": "  | 成功フラグ | 成功/失敗 | true/false |",
            "lineNumber": 979
          },
          {
            "text": "  | メッセージ | 処理結果メッセージ | |",
            "lineNumber": 980
          },
          {
            "text": "  | 更新後の勤怠データ | 更新後のATTENDANCE_RECORDデータ | JSON形式 |",
            "lineNumber": 981
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 982
          },
          {
            "text": "  - なし",
            "lineNumber": 983
          },
          {
            "text": "- その他",
            "lineNumber": 984
          },
          {
            "text": "  - 日次確定済み（IS_DAILY_CONFIRMED=TRUE）の場合は更新不可",
            "lineNumber": 985
          },
          {
            "text": "  - 出勤時刻・退勤時刻を更新した場合、ACTUAL_WORK_HOURSを自動計算",
            "lineNumber": 986
          },
          {
            "text": "  - 手入力（MANUAL）の場合、備考の入力を推奨",
            "lineNumber": 987
          },
          {
            "lineNumber": 988
          },
          {
            "text": "#### No.6",
            "lineNumber": 989
          },
          {
            "text": "- API仕様名：日次確定申請API",
            "lineNumber": 990
          },
          {
            "text": "- リクエスト",
            "lineNumber": 991
          },
          {
            "text": "  | 項目名 | リクエスト内容 | 補足 |",
            "lineNumber": 992
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 993
          },
          {
            "text": "  | HTTPメソッド | POST | |",
            "lineNumber": 994
          },
          {
            "text": "  | エンドポイント | /api/attendance/daily-confirmation | |",
            "lineNumber": 995
          },
          {
            "text": "  | EMPLOYEE_ID | 入出力項目定義.従業員ID | リクエストボディ |",
            "lineNumber": 996
          },
          {
            "text": "  | WORK_DATE | 選択した日付 | リクエストボディ、YYYY-MM-DD形式 |",
            "lineNumber": 997
          },
          {
            "text": "- レスポンス",
            "lineNumber": 998
          },
          {
            "text": "  | 項目名 | レスポンス内容 | 補足 |",
            "lineNumber": 999
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 1000
          },
          {
            "text": "  | 成功フラグ | 成功/失敗 | true/false |",
            "lineNumber": 1001
          },
          {
            "text": "  | メッセージ | 処理結果メッセージ | |",
            "lineNumber": 1002
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 1003
          },
          {
            "text": "  - なし",
            "lineNumber": 1004
          },
          {
            "text": "- その他",
            "lineNumber": 1005
          },
          {
            "text": "  - 勤務場所が設定されているか、工数合計と実労働時間が一致するかをチェック",
            "lineNumber": 1006
          },
          {
            "text": "  - 問題なければIS_DAILY_CONFIRMED=TRUE、DAILY_CONFIRMED_ATを現在時刻で更新",
            "lineNumber": 1007
          },
          {
            "lineNumber": 1008
          },
          {
            "text": "#### No.7",
            "lineNumber": 1009
          },
          {
            "text": "- API仕様名：月次サマリー取得API",
            "lineNumber": 1010
          },
          {
            "text": "- リクエスト",
            "lineNumber": 1011
          },
          {
            "text": "  | 項目名 | リクエスト内容 | 補足 |",
            "lineNumber": 1012
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 1013
          },
          {
            "text": "  | HTTPメソッド | GET | |",
            "lineNumber": 1014
          },
          {
            "text": "  | エンドポイント | /api/attendance/monthly-summary | |",
            "lineNumber": 1015
          },
          {
            "text": "  | EMPLOYEE_ID | 入出力項目定義.従業員ID | クエリパラメータ |",
            "lineNumber": 1016
          },
          {
            "text": "  | YEAR | 表示対象年 | クエリパラメータ、YYYY形式 |",
            "lineNumber": 1017
          },
          {
            "text": "  | MONTH | 表示対象月 | クエリパラメータ、MM形式 |",
            "lineNumber": 1018
          },
          {
            "text": "- レスポンス",
            "lineNumber": 1019
          },
          {
            "text": "  | 項目名 | レスポンス内容 | 補足 |",
            "lineNumber": 1020
          }
        ]
      },
      "score": 0.4206806421279907
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-table-screen.md",
        "range": {
          "startPosition": {
            "line": 1030
          },
          "endPosition": {
            "line": 1066
          }
        },
        "contents": "- 関連する取得仕様\n  - なし\n- その他\n  - V_MONTHLY_ATTENDANCEビューや関連テーブルから月間の勤務時間集計を取得\n  - 過不足時間は前日までの実作業時間と前日までの想定出勤日数に基づいて計算\n\n#### No.8\n- API仕様名：休暇情報取得API\n- リクエスト\n  | 項目名 | リクエスト内容 | 補足 |\n  | :--- | :--- | :--- |\n  | HTTPメソッド | GET | |\n  | エンドポイント | /api/vacation/info | |\n  | EMPLOYEE_ID | 入出力項目定義.従業員ID | クエリパラメータ |\n- レスポンス\n  | 項目名 | レスポンス内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 休暇残日数リスト | 休暇残日数リスト | JSON形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別コード | V_VACATION_BALANCE_SUMMARY.VACATION_TYPE_CODE | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別名 | V_VACATION_BALANCE_SUMMARY.VACATION_TYPE_NAME | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;付与日数 | V_VACATION_BALANCE_SUMMARY.GRANTED_DAYS | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;使用日数 | V_VACATION_BALANCE_SUMMARY.USED_DAYS | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;残日数 | V_VACATION_BALANCE_SUMMARY.REMAINING_DAYS | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;有効期限 | V_VACATION_BALANCE_SUMMARY.EXPIRATION_DATE | YYYY-MM-DD形式 |\n  | 休暇取得履歴リスト | 休暇取得履歴リスト | JSON形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇取得ID | VACATION_HISTORY.VACATION_ID | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別コード | VACATION_HISTORY.VACATION_TYPE_CODE | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;開始日 | VACATION_HISTORY.START_DATE | YYYY-MM-DD形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;終了日 | VACATION_HISTORY.END_DATE | YYYY-MM-DD形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;取得日数 | VACATION_HISTORY.VACATION_DAYS | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;取得理由 | VACATION_HISTORY.REASON | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;承認状態 | VACATION_HISTORY.APPROVAL_STATUS | PENDING/APPROVED/REJECTED |\n- 関連する取得仕様\n  - なし\n- その他\n  - V_VACATION_BALANCE_SUMMARYビューから休暇残日数、VACATION_HISTORYテーブルから取得履歴を取得",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 1031
          },
          {
            "text": "  - なし",
            "lineNumber": 1032
          },
          {
            "text": "- その他",
            "lineNumber": 1033
          },
          {
            "text": "  - V_MONTHLY_ATTENDANCEビューや関連テーブルから月間の勤務時間集計を取得",
            "lineNumber": 1034
          },
          {
            "text": "  - 過不足時間は前日までの実作業時間と前日までの想定出勤日数に基づいて計算",
            "lineNumber": 1035
          },
          {
            "lineNumber": 1036
          },
          {
            "text": "#### No.8",
            "lineNumber": 1037
          },
          {
            "text": "- API仕様名：休暇情報取得API",
            "lineNumber": 1038
          },
          {
            "text": "- リクエスト",
            "lineNumber": 1039
          },
          {
            "text": "  | 項目名 | リクエスト内容 | 補足 |",
            "lineNumber": 1040
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 1041
          },
          {
            "text": "  | HTTPメソッド | GET | |",
            "lineNumber": 1042
          },
          {
            "text": "  | エンドポイント | /api/vacation/info | |",
            "lineNumber": 1043
          },
          {
            "text": "  | EMPLOYEE_ID | 入出力項目定義.従業員ID | クエリパラメータ |",
            "lineNumber": 1044
          },
          {
            "text": "- レスポンス",
            "lineNumber": 1045
          },
          {
            "text": "  | 項目名 | レスポンス内容 | 補足 |",
            "lineNumber": 1046
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 1047
          },
          {
            "text": "  | 休暇残日数リスト | 休暇残日数リスト | JSON形式 |",
            "lineNumber": 1048
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別コード | V_VACATION_BALANCE_SUMMARY.VACATION_TYPE_CODE | |",
            "lineNumber": 1049
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別名 | V_VACATION_BALANCE_SUMMARY.VACATION_TYPE_NAME | |",
            "lineNumber": 1050
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;付与日数 | V_VACATION_BALANCE_SUMMARY.GRANTED_DAYS | |",
            "lineNumber": 1051
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;使用日数 | V_VACATION_BALANCE_SUMMARY.USED_DAYS | |",
            "lineNumber": 1052
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;残日数 | V_VACATION_BALANCE_SUMMARY.REMAINING_DAYS | |",
            "lineNumber": 1053
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;有効期限 | V_VACATION_BALANCE_SUMMARY.EXPIRATION_DATE | YYYY-MM-DD形式 |",
            "lineNumber": 1054
          },
          {
            "text": "  | 休暇取得履歴リスト | 休暇取得履歴リスト | JSON形式 |",
            "lineNumber": 1055
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇取得ID | VACATION_HISTORY.VACATION_ID | |",
            "lineNumber": 1056
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別コード | VACATION_HISTORY.VACATION_TYPE_CODE | |",
            "lineNumber": 1057
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;開始日 | VACATION_HISTORY.START_DATE | YYYY-MM-DD形式 |",
            "lineNumber": 1058
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;終了日 | VACATION_HISTORY.END_DATE | YYYY-MM-DD形式 |",
            "lineNumber": 1059
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;取得日数 | VACATION_HISTORY.VACATION_DAYS | |",
            "lineNumber": 1060
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;取得理由 | VACATION_HISTORY.REASON | |",
            "lineNumber": 1061
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;承認状態 | VACATION_HISTORY.APPROVAL_STATUS | PENDING/APPROVED/REJECTED |",
            "lineNumber": 1062
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 1063
          },
          {
            "text": "  - なし",
            "lineNumber": 1064
          },
          {
            "text": "- その他",
            "lineNumber": 1065
          },
          {
            "text": "  - V_VACATION_BALANCE_SUMMARYビューから休暇残日数、VACATION_HISTORYテーブルから取得履歴を取得",
            "lineNumber": 1066
          }
        ]
      },
      "score": 0.41816630959510803
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-application-screen.md",
        "range": {
          "startPosition": {
            "line": 1142
          },
          "endPosition": {
            "line": 1180
          }
        },
        "contents": "- レスポンス\n  | 項目名 | レスポンス内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 日次勤務データ | 1日分の勤務記録 | JSON形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤怠ID | ATTENDANCE_RECORD.ATTENDANCE_ID | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;従業員ID | ATTENDANCE_RECORD.EMPLOYEE_ID | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤務日 | ATTENDANCE_RECORD.WORK_DATE | YYYY-MM-DD形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤時刻 | ATTENDANCE_RECORD.CLOCK_IN_TIME | YYYY-MM-DD HH:MM:SS形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤時刻 | ATTENDANCE_RECORD.CLOCK_OUT_TIME | YYYY-MM-DD HH:MM:SS形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実労働時間 | ATTENDANCE_RECORD.ACTUAL_WORK_HOURS | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;備考 | ATTENDANCE_RECORD.REMARK_TEXT | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩時間リスト | BREAK_TIME | |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩開始時刻 | BREAK_TIME.BREAK_START_TIME | HH:MM形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩終了時刻 | BREAK_TIME.BREAK_END_TIME | HH:MM形式 |\n- 関連する取得仕様\n  - なし\n- その他\n  - ATTENDANCE_RECORDとBREAK_TIMEを結合して返却\n  - 勤務記録が存在しない場合は空のレスポンスを返す\n\n#### No.10\n- API仕様名：当月時間外残業取得API\n- リクエスト\n  | 項目名 | リクエスト内容 | 補足 |\n  | :--- | :--- | :--- |\n  | HTTPメソッド | GET | |\n  | エンドポイント | /api/attendance/monthly-overtime | |\n  | EMPLOYEE_ID | 入出力項目定義.従業員ID | クエリパラメータ |\n  | YEAR | 対象年の年 | クエリパラメータ、YYYY形式 |\n  | MONTH | 対象月の月 | クエリパラメータ、MM形式 |\n- レスポンス\n  | 項目名 | レスポンス内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 時間外残業時間 | 当月の時間外残業時間の合計 | 時間単位（小数、例: 0.0） |\n- 関連する取得仕様\n  - なし\n- その他\n  - 対象年月の時間外残業時間の合計を計算して返却",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- レスポンス",
            "lineNumber": 1143
          },
          {
            "text": "  | 項目名 | レスポンス内容 | 補足 |",
            "lineNumber": 1144
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 1145
          },
          {
            "text": "  | 日次勤務データ | 1日分の勤務記録 | JSON形式 |",
            "lineNumber": 1146
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤怠ID | ATTENDANCE_RECORD.ATTENDANCE_ID | |",
            "lineNumber": 1147
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;従業員ID | ATTENDANCE_RECORD.EMPLOYEE_ID | |",
            "lineNumber": 1148
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤務日 | ATTENDANCE_RECORD.WORK_DATE | YYYY-MM-DD形式 |",
            "lineNumber": 1149
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤時刻 | ATTENDANCE_RECORD.CLOCK_IN_TIME | YYYY-MM-DD HH:MM:SS形式 |",
            "lineNumber": 1150
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤時刻 | ATTENDANCE_RECORD.CLOCK_OUT_TIME | YYYY-MM-DD HH:MM:SS形式 |",
            "lineNumber": 1151
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実労働時間 | ATTENDANCE_RECORD.ACTUAL_WORK_HOURS | |",
            "lineNumber": 1152
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;備考 | ATTENDANCE_RECORD.REMARK_TEXT | |",
            "lineNumber": 1153
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩時間リスト | BREAK_TIME | |",
            "lineNumber": 1154
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩開始時刻 | BREAK_TIME.BREAK_START_TIME | HH:MM形式 |",
            "lineNumber": 1155
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩終了時刻 | BREAK_TIME.BREAK_END_TIME | HH:MM形式 |",
            "lineNumber": 1156
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 1157
          },
          {
            "text": "  - なし",
            "lineNumber": 1158
          },
          {
            "text": "- その他",
            "lineNumber": 1159
          },
          {
            "text": "  - ATTENDANCE_RECORDとBREAK_TIMEを結合して返却",
            "lineNumber": 1160
          },
          {
            "text": "  - 勤務記録が存在しない場合は空のレスポンスを返す",
            "lineNumber": 1161
          },
          {
            "lineNumber": 1162
          },
          {
            "text": "#### No.10",
            "lineNumber": 1163
          },
          {
            "text": "- API仕様名：当月時間外残業取得API",
            "lineNumber": 1164
          },
          {
            "text": "- リクエスト",
            "lineNumber": 1165
          },
          {
            "text": "  | 項目名 | リクエスト内容 | 補足 |",
            "lineNumber": 1166
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 1167
          },
          {
            "text": "  | HTTPメソッド | GET | |",
            "lineNumber": 1168
          },
          {
            "text": "  | エンドポイント | /api/attendance/monthly-overtime | |",
            "lineNumber": 1169
          },
          {
            "text": "  | EMPLOYEE_ID | 入出力項目定義.従業員ID | クエリパラメータ |",
            "lineNumber": 1170
          },
          {
            "text": "  | YEAR | 対象年の年 | クエリパラメータ、YYYY形式 |",
            "lineNumber": 1171
          },
          {
            "text": "  | MONTH | 対象月の月 | クエリパラメータ、MM形式 |",
            "lineNumber": 1172
          },
          {
            "text": "- レスポンス",
            "lineNumber": 1173
          },
          {
            "text": "  | 項目名 | レスポンス内容 | 補足 |",
            "lineNumber": 1174
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 1175
          },
          {
            "text": "  | 時間外残業時間 | 当月の時間外残業時間の合計 | 時間単位（小数、例: 0.0） |",
            "lineNumber": 1176
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 1177
          },
          {
            "text": "  - なし",
            "lineNumber": 1178
          },
          {
            "text": "- その他",
            "lineNumber": 1179
          },
          {
            "text": "  - 対象年月の時間外残業時間の合計を計算して返却",
            "lineNumber": 1180
          }
        ]
      },
      "score": 0.415597140789032
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 207,
            "column": 1
          },
          "endPosition": {
            "line": 230,
            "column": 3
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請情報データ\n */\nexport async function getApplicationInfo(employeeId, applicationType, targetDate) {\n  const endpoint = &#96;/application/application-info?employeeId=${employeeId}&amp;applicationType=${applicationType}&amp;targetDate=${targetDate}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * 申請を取り消す。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string|number} applicationId 申請ID（日次確定の場合は不要）\n * @param {string} targetDate 対象日（YYYY-MM-DD形式、日次確定の場合のみ必要）\n * @returns {Promise&lt;Object&gt;} レスポンスデータ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 210
          },
          {
            "text": " * 申請情報と承認履歴を取得する。",
            "lineNumber": 211
          },
          {
            "text": " *",
            "lineNumber": 212
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 213
          },
          {
            "text": " * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 214
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式）",
            "lineNumber": 215
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請情報データ",
            "lineNumber": 216
          },
          {
            "text": " */",
            "lineNumber": 217
          },
          {
            "text": "export async function getApplicationInfo(employeeId, applicationType, targetDate) {",
            "lineNumber": 218,
            "isSignature": true
          },
          {
            "text": "  const endpoint = &#96;/application/application-info?employeeId=${employeeId}&amp;applicationType=${applicationType}&amp;targetDate=${targetDate}&#96;",
            "lineNumber": 219
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 220
          },
          {
            "text": "}",
            "lineNumber": 221,
            "isSignature": true
          },
          {
            "lineNumber": 222
          },
          {
            "text": "/**",
            "lineNumber": 223
          },
          {
            "text": " * 申請を取り消す。",
            "lineNumber": 224
          },
          {
            "text": " *",
            "lineNumber": 225
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 226
          },
          {
            "text": " * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 227
          },
          {
            "text": " * @param {string|number} applicationId 申請ID（日次確定の場合は不要）",
            "lineNumber": 228
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式、日次確定の場合のみ必要）",
            "lineNumber": 229
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} レスポンスデータ",
            "lineNumber": 230
          },
          {
            "text": " */",
            "lineNumber": 231
          }
        ]
      },
      "score": 0.415072500705719
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-table-screen.md",
        "range": {
          "startPosition": {
            "line": 1018
          },
          "endPosition": {
            "line": 1034
          }
        },
        "contents": "- レスポンス\n  | 項目名 | レスポンス内容 | 補足 |\n  | :--- | :--- | :--- |\n  | 月次サマリーデータ | 月間集計データ | JSON形式 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;所定出勤日数 | 月間の所定出勤日数 | 整数（例: 20） |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実出勤日数 | 月間の実出勤日数（出勤時刻と退勤時刻が両方記録されている日数） | 整数（例: 4） |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;所定労働時間 | 月間の所定労働時間 | HHH:MM形式（例: 150:00） |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;総労働時間 | 月間の総労働時間 | HHH:MM形式（例: 70:01） |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;過不足時間 | 過不足時間 | +/-H:MM形式（例: +2:31）。計算方法: 前日までの実作業時間 - (前日までの想定出勤日数 * 7:30)。当日退勤済みの場合は当日まで、退勤していない場合は前日までの過不足時間 |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定休日労働 | 法定休日の労働時間 | H:MM形式（例: 0:00） |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定時間内残業 | 法定時間内の残業時間 | H:MM形式（例: 0:00）。所定労働時間（7.5時間/日）を超えて法定労働時間（8時間/日）以内の残業時間。計算方法: 実作業時間が所定労働時間を超えている場合、その超過分のうち法定労働時間（所定出勤日数 * 8:00）以内の部分。max(0, min(実作業時間 - 所定労働時間, (所定出勤日数 * 8:00) - 所定労働時間)) |\n  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定時間外残業 | 法定時間外の残業時間 | H:MM形式（例: 0:00）。法定労働時間（8時間/日）を超えた残業時間。計算方法: 実作業時間が法定労働時間（所定出勤日数 * 8:00）を超えた部分。max(0, 実作業時間 - (所定出勤日数 * 8:00)) |\n- 関連する取得仕様\n  - なし\n- その他\n  - V_MONTHLY_ATTENDANCEビューや関連テーブルから月間の勤務時間集計を取得",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- レスポンス",
            "lineNumber": 1019
          },
          {
            "text": "  | 項目名 | レスポンス内容 | 補足 |",
            "lineNumber": 1020
          },
          {
            "text": "  | :--- | :--- | :--- |",
            "lineNumber": 1021
          },
          {
            "text": "  | 月次サマリーデータ | 月間集計データ | JSON形式 |",
            "lineNumber": 1022
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;所定出勤日数 | 月間の所定出勤日数 | 整数（例: 20） |",
            "lineNumber": 1023
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実出勤日数 | 月間の実出勤日数（出勤時刻と退勤時刻が両方記録されている日数） | 整数（例: 4） |",
            "lineNumber": 1024
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;所定労働時間 | 月間の所定労働時間 | HHH:MM形式（例: 150:00） |",
            "lineNumber": 1025
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;総労働時間 | 月間の総労働時間 | HHH:MM形式（例: 70:01） |",
            "lineNumber": 1026
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;過不足時間 | 過不足時間 | +/-H:MM形式（例: +2:31）。計算方法: 前日までの実作業時間 - (前日までの想定出勤日数 * 7:30)。当日退勤済みの場合は当日まで、退勤していない場合は前日までの過不足時間 |",
            "lineNumber": 1027
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定休日労働 | 法定休日の労働時間 | H:MM形式（例: 0:00） |",
            "lineNumber": 1028
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定時間内残業 | 法定時間内の残業時間 | H:MM形式（例: 0:00）。所定労働時間（7.5時間/日）を超えて法定労働時間（8時間/日）以内の残業時間。計算方法: 実作業時間が所定労働時間を超えている場合、その超過分のうち法定労働時間（所定出勤日数 * 8:00）以内の部分。max(0, min(実作業時間 - 所定労働時間, (所定出勤日数 * 8:00) - 所定労働時間)) |",
            "lineNumber": 1029
          },
          {
            "text": "  | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定時間外残業 | 法定時間外の残業時間 | H:MM形式（例: 0:00）。法定労働時間（8時間/日）を超えた残業時間。計算方法: 実作業時間が法定労働時間（所定出勤日数 * 8:00）を超えた部分。max(0, 実作業時間 - (所定出勤日数 * 8:00)) |",
            "lineNumber": 1030
          },
          {
            "text": "- 関連する取得仕様",
            "lineNumber": 1031
          },
          {
            "text": "  - なし",
            "lineNumber": 1032
          },
          {
            "text": "- その他",
            "lineNumber": 1033
          },
          {
            "text": "  - V_MONTHLY_ATTENDANCEビューや関連テーブルから月間の勤務時間集計を取得",
            "lineNumber": 1034
          }
        ]
      },
      "score": 0.41092759370803833
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 435,
            "column": 2
          },
          "endPosition": {
            "line": 457,
            "column": 3
          }
        },
        "contents": "/**\n * 休暇情報を取得\n * @param {string} employeeId - 従業員ID\n * @returns {Promise&lt;Object&gt;} 休暇情報\n */\nconst getVacationInfo = async (employeeId) =&gt; {\n  const balances = await applicationModel.getVacationBalanceSummary(employeeId);\n  const history = await applicationModel.getVacationHistory(employeeId, 20);\n  \n  return {\n    balances,\n    history\n  };\n};\n\n/**\n * 有給残日数を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} vacationTypeCode - 休暇種別コード\n * @returns {Promise&lt;number&gt;} 残日数\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 438
          },
          {
            "text": " * 休暇情報を取得",
            "lineNumber": 439
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 440
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 休暇情報",
            "lineNumber": 441
          },
          {
            "text": " */",
            "lineNumber": 442
          },
          {
            "text": "const getVacationInfo = async (employeeId) =&gt; {",
            "lineNumber": 443
          },
          {
            "text": "  const balances = await applicationModel.getVacationBalanceSummary(employeeId);",
            "lineNumber": 444
          },
          {
            "text": "  const history = await applicationModel.getVacationHistory(employeeId, 20);",
            "lineNumber": 445
          },
          {
            "text": "  ",
            "lineNumber": 446
          },
          {
            "text": "  return {",
            "lineNumber": 447
          },
          {
            "text": "    balances,",
            "lineNumber": 448
          },
          {
            "text": "    history",
            "lineNumber": 449
          },
          {
            "text": "  };",
            "lineNumber": 450
          },
          {
            "text": "};",
            "lineNumber": 451
          },
          {
            "lineNumber": 452
          },
          {
            "text": "/**",
            "lineNumber": 453
          },
          {
            "text": " * 有給残日数を取得",
            "lineNumber": 454
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 455
          },
          {
            "text": " * @param {string} vacationTypeCode - 休暇種別コード",
            "lineNumber": 456
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 残日数",
            "lineNumber": 457
          },
          {
            "text": " */",
            "lineNumber": 458
          }
        ]
      },
      "score": 0.41058993339538574
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async \nfor (let day = 1; day &lt;= daysInMonth; day++) {\n\n\n    dailyData.push({\n      attendanceId: attendanceId,\n      employeeId: employeeId,\n      workDate: workDate,\n      clockInTime: clockInTime,\n      clockOutTime: clockOutTime,\n      clockInType: clockInType,\n      clockOutType: clockOutType,\n      originalClockInTime: originalClockInTime,\n      originalClockOutTime: originalClockOutTime,\n      actualWorkHours: actualWorkHours,\n      breakTimeTotal: breakTimeTotal,\n      overtimeHours: overtimeHours,\n      holidayWorkHours: holidayWorkHours,\n      nightWorkHours: nightWorkHours,\n      workLocationCode: workLocationCode,\n      remarkText: remarkText,\n      isDailyConfirmed: isDailyConfirmed,\n      holidayName: holidayName,\n      vacationTypeName: vacationTypeName,\n      withinLegalOvertimeMinutes: withinLegalOvertimeMinutes,\n      overLegalOvertimeMinutes: overLegalOvertimeMinutes\n    });\n  }\n  \n  // 3. 月次サマリーデータ取得（計算）\n  const actualWorkDays = attendanceRows.filter(row =&gt; \n    row.CLOCK_IN_TIME &amp;&amp; row.CLOCK_OUT_TIME\n  ).length;\n  \n  // 法定休日出勤日数、所定休日出勤日数は簡易的に計算\n  // （実際の実装では、祝日マスタやカレンダーマスタを参照する必要がある）\n  const legalHolidayWorkDays = 0; // TODO: 法定休日出勤日数を計算\n  const scheduledHolidayWorkDays = 0; // TODO: 所定休日出勤日数を計算\n  \n  // 所定労働時間（1日7.5時間 × 所定出勤日数）\n  const scheduledWorkHours = scheduledWorkDays * 7.5;\n  \n  // 総労働時間（丸め誤差を避けるため、各日の出退勤時刻と休憩時間から直接計算）\n  let totalWorkMinutes = 0;\n  for (const row of attendanceRows) {\n    if (row.CLOCK_IN_TIME &amp;&amp; row.CLOCK_OUT_TIME)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            },
            {
              "startPosition": {
                "line": 59,
                "column": 3
              },
              "endPosition": {
                "line": 60,
                "column": 5
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "text": "for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 59
          },
          {
            "lineNumber": 181
          },
          {
            "lineNumber": 182
          },
          {
            "text": "    dailyData.push({",
            "lineNumber": 183
          },
          {
            "text": "      attendanceId: attendanceId,",
            "lineNumber": 184
          },
          {
            "text": "      employeeId: employeeId,",
            "lineNumber": 185
          },
          {
            "text": "      workDate: workDate,",
            "lineNumber": 186
          },
          {
            "text": "      clockInTime: clockInTime,",
            "lineNumber": 187
          },
          {
            "text": "      clockOutTime: clockOutTime,",
            "lineNumber": 188
          },
          {
            "text": "      clockInType: clockInType,",
            "lineNumber": 189
          },
          {
            "text": "      clockOutType: clockOutType,",
            "lineNumber": 190
          },
          {
            "text": "      originalClockInTime: originalClockInTime,",
            "lineNumber": 191
          },
          {
            "text": "      originalClockOutTime: originalClockOutTime,",
            "lineNumber": 192
          },
          {
            "text": "      actualWorkHours: actualWorkHours,",
            "lineNumber": 193
          },
          {
            "text": "      breakTimeTotal: breakTimeTotal,",
            "lineNumber": 194
          },
          {
            "text": "      overtimeHours: overtimeHours,",
            "lineNumber": 195
          },
          {
            "text": "      holidayWorkHours: holidayWorkHours,",
            "lineNumber": 196
          },
          {
            "text": "      nightWorkHours: nightWorkHours,",
            "lineNumber": 197
          },
          {
            "text": "      workLocationCode: workLocationCode,",
            "lineNumber": 198
          },
          {
            "text": "      remarkText: remarkText,",
            "lineNumber": 199
          },
          {
            "text": "      isDailyConfirmed: isDailyConfirmed,",
            "lineNumber": 200
          },
          {
            "text": "      holidayName: holidayName,",
            "lineNumber": 201
          },
          {
            "text": "      vacationTypeName: vacationTypeName,",
            "lineNumber": 202
          },
          {
            "text": "      withinLegalOvertimeMinutes: withinLegalOvertimeMinutes,",
            "lineNumber": 203
          },
          {
            "text": "      overLegalOvertimeMinutes: overLegalOvertimeMinutes",
            "lineNumber": 204
          },
          {
            "text": "    });",
            "lineNumber": 205
          },
          {
            "text": "  }",
            "lineNumber": 206
          },
          {
            "text": "  ",
            "lineNumber": 207
          },
          {
            "text": "  // 3. 月次サマリーデータ取得（計算）",
            "lineNumber": 208
          },
          {
            "text": "  const actualWorkDays = attendanceRows.filter(row =&gt; ",
            "lineNumber": 209
          },
          {
            "text": "    row.CLOCK_IN_TIME &amp;&amp; row.CLOCK_OUT_TIME",
            "lineNumber": 210
          },
          {
            "text": "  ).length;",
            "lineNumber": 211
          },
          {
            "text": "  ",
            "lineNumber": 212
          },
          {
            "text": "  // 法定休日出勤日数、所定休日出勤日数は簡易的に計算",
            "lineNumber": 213
          },
          {
            "text": "  // （実際の実装では、祝日マスタやカレンダーマスタを参照する必要がある）",
            "lineNumber": 214
          },
          {
            "text": "  const legalHolidayWorkDays = 0; // TODO: 法定休日出勤日数を計算",
            "lineNumber": 215
          },
          {
            "text": "  const scheduledHolidayWorkDays = 0; // TODO: 所定休日出勤日数を計算",
            "lineNumber": 216
          },
          {
            "text": "  ",
            "lineNumber": 217
          },
          {
            "text": "  // 所定労働時間（1日7.5時間 × 所定出勤日数）",
            "lineNumber": 218
          },
          {
            "text": "  const scheduledWorkHours = scheduledWorkDays * 7.5;",
            "lineNumber": 219
          },
          {
            "text": "  ",
            "lineNumber": 220
          },
          {
            "text": "  // 総労働時間（丸め誤差を避けるため、各日の出退勤時刻と休憩時間から直接計算）",
            "lineNumber": 221
          },
          {
            "text": "  let totalWorkMinutes = 0;",
            "lineNumber": 222
          },
          {
            "text": "  for (const row of attendanceRows) {",
            "lineNumber": 223
          },
          {
            "text": "    if (row.CLOCK_IN_TIME &amp;&amp; row.CLOCK_OUT_TIME)",
            "lineNumber": 224
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.40803593397140503
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\controllers\\monthlySummaryController.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 40,
            "column": 2
          }
        },
        "contents": "/**\n * 月次サマリーコントローラー\n */\nconst monthlySummaryService = require('../services/monthlySummaryService');\n\n/**\n * 月次サマリー情報取得\n */\nconst getMonthlySummary = async (req, res, next) =&gt; {\n  try {\n    const { employeeId, yearMonth } = req.query;\n    \n    if (!employeeId || !yearMonth) {\n      return res.status(400).json({\n        success: false,\n        message: '従業員IDと対象年月が必要です。'\n      });\n    }\n    \n    // 対象年月の形式チェック（YYYY-MM形式）\n    if (!/^\\d{4}-\\d{2}$/.test(yearMonth)) {\n      return res.status(400).json({\n        success: false,\n        message: '対象年月の形式が正しくありません。YYYY-MM形式で指定してください。'\n      });\n    }\n    \n    const result = await monthlySummaryService.getMonthlySummary(employeeId, yearMonth);\n    \n    res.json({\n      success: true,\n      ...result\n    });\n  } catch (error) {\n    next(error);\n  }\n};\n\nmodule.exports = {\n  getMonthlySummary\n};",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * 月次サマリーコントローラー",
            "lineNumber": 2
          },
          {
            "text": " */",
            "lineNumber": 3
          },
          {
            "text": "const monthlySummaryService = require('../services/monthlySummaryService');",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "/**",
            "lineNumber": 6
          },
          {
            "text": " * 月次サマリー情報取得",
            "lineNumber": 7
          },
          {
            "text": " */",
            "lineNumber": 8
          },
          {
            "text": "const getMonthlySummary = async (req, res, next) =&gt; {",
            "lineNumber": 9
          },
          {
            "text": "  try {",
            "lineNumber": 10
          },
          {
            "text": "    const { employeeId, yearMonth } = req.query;",
            "lineNumber": 11
          },
          {
            "text": "    ",
            "lineNumber": 12
          },
          {
            "text": "    if (!employeeId || !yearMonth) {",
            "lineNumber": 13
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 14
          },
          {
            "text": "        success: false,",
            "lineNumber": 15
          },
          {
            "text": "        message: '従業員IDと対象年月が必要です。'",
            "lineNumber": 16
          },
          {
            "text": "      });",
            "lineNumber": 17
          },
          {
            "text": "    }",
            "lineNumber": 18
          },
          {
            "text": "    ",
            "lineNumber": 19
          },
          {
            "text": "    // 対象年月の形式チェック（YYYY-MM形式）",
            "lineNumber": 20
          },
          {
            "text": "    if (!/^\\d{4}-\\d{2}$/.test(yearMonth)) {",
            "lineNumber": 21
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 22
          },
          {
            "text": "        success: false,",
            "lineNumber": 23
          },
          {
            "text": "        message: '対象年月の形式が正しくありません。YYYY-MM形式で指定してください。'",
            "lineNumber": 24
          },
          {
            "text": "      });",
            "lineNumber": 25
          },
          {
            "text": "    }",
            "lineNumber": 26
          },
          {
            "text": "    ",
            "lineNumber": 27
          },
          {
            "text": "    const result = await monthlySummaryService.getMonthlySummary(employeeId, yearMonth);",
            "lineNumber": 28
          },
          {
            "text": "    ",
            "lineNumber": 29
          },
          {
            "text": "    res.json({",
            "lineNumber": 30
          },
          {
            "text": "      success: true,",
            "lineNumber": 31
          },
          {
            "text": "      ...result",
            "lineNumber": 32
          },
          {
            "text": "    });",
            "lineNumber": 33
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 34
          },
          {
            "text": "    next(error);",
            "lineNumber": 35
          },
          {
            "text": "  }",
            "lineNumber": 36
          },
          {
            "text": "};",
            "lineNumber": 37
          },
          {
            "lineNumber": 38
          },
          {
            "text": "module.exports = {",
            "lineNumber": 39
          },
          {
            "text": "  getMonthlySummary",
            "lineNumber": 40
          },
          {
            "text": "};",
            "lineNumber": 41
          }
        ]
      },
      "score": 0.40531960129737854
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: backend/services/monthlySummaryService.js</summary>

</details>
</tool-use>

---



---


バックエンドの実装を確認し、休日出勤申請の情報を取得・返却するよう修正します。


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: backend/services/monthlySummaryService.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "休日出勤申請を取得するメソッド getApplicationsByType HOLIDAY_WORK",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\routes\\application.js",
        "range": {
          "startPosition": {
            "line": 53,
            "column": 79
          },
          "endPosition": {
            "line": 91,
            "column": 78
          }
        },
        "contents": "/**\n * 休日出勤申請リスト取得API（代休取得可能日数計算用）\n * GET /api/application/holiday-work-list\n */\nrouter.get('/holiday-work-list', async (req, res, next) =&gt; {\n  try {\n    const { employeeId, startDate, endDate } = req.query;\n    \n    if (!employeeId || !startDate || !endDate) {\n      return res.status(400).json({\n        success: false,\n        message: '従業員ID、開始日、終了日が必要です。'\n      });\n    }\n    \n    const applicationModel = require('../models/applicationModel');\n    const applications = await applicationModel.getApplicationsByType(\n      employeeId,\n      'HOLIDAY_WORK',\n      startDate,\n      endDate\n    );\n    \n    res.json({\n      success: true,\n      applications\n    });\n  } catch (error) {\n    next(error);\n  }\n});\n\n/**\n * 申請状態取得API\n * GET /api/application/application-status\n */\nrouter.get('/application-status', applicationController.getApplicationStatus);",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 56
          },
          {
            "text": " * 休日出勤申請リスト取得API（代休取得可能日数計算用）",
            "lineNumber": 57
          },
          {
            "text": " * GET /api/application/holiday-work-list",
            "lineNumber": 58
          },
          {
            "text": " */",
            "lineNumber": 59
          },
          {
            "text": "router.get('/holiday-work-list', async (req, res, next) =&gt; {",
            "lineNumber": 60
          },
          {
            "text": "  try {",
            "lineNumber": 61
          },
          {
            "text": "    const { employeeId, startDate, endDate } = req.query;",
            "lineNumber": 62
          },
          {
            "text": "    ",
            "lineNumber": 63
          },
          {
            "text": "    if (!employeeId || !startDate || !endDate) {",
            "lineNumber": 64
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 65
          },
          {
            "text": "        success: false,",
            "lineNumber": 66
          },
          {
            "text": "        message: '従業員ID、開始日、終了日が必要です。'",
            "lineNumber": 67
          },
          {
            "text": "      });",
            "lineNumber": 68
          },
          {
            "text": "    }",
            "lineNumber": 69
          },
          {
            "text": "    ",
            "lineNumber": 70
          },
          {
            "text": "    const applicationModel = require('../models/applicationModel');",
            "lineNumber": 71
          },
          {
            "text": "    const applications = await applicationModel.getApplicationsByType(",
            "lineNumber": 72
          },
          {
            "text": "      employeeId,",
            "lineNumber": 73
          },
          {
            "text": "      'HOLIDAY_WORK',",
            "lineNumber": 74
          },
          {
            "text": "      startDate,",
            "lineNumber": 75
          },
          {
            "text": "      endDate",
            "lineNumber": 76
          },
          {
            "text": "    );",
            "lineNumber": 77
          },
          {
            "text": "    ",
            "lineNumber": 78
          },
          {
            "text": "    res.json({",
            "lineNumber": 79
          },
          {
            "text": "      success: true,",
            "lineNumber": 80
          },
          {
            "text": "      applications",
            "lineNumber": 81
          },
          {
            "text": "    });",
            "lineNumber": 82
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 83
          },
          {
            "text": "    next(error);",
            "lineNumber": 84
          },
          {
            "text": "  }",
            "lineNumber": 85
          },
          {
            "text": "});",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "/**",
            "lineNumber": 88
          },
          {
            "text": " * 申請状態取得API",
            "lineNumber": 89
          },
          {
            "text": " * GET /api/application/application-status",
            "lineNumber": 90
          },
          {
            "text": " */",
            "lineNumber": 91
          },
          {
            "text": "router.get('/application-status', applicationController.getApplicationStatus);",
            "lineNumber": 92
          }
        ]
      },
      "score": 0.5359156727790833
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 333,
            "column": 2
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "/**\n * 月間勤務表を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {number} year 年\n * @param {number} month 月\n * @returns {Promise&lt;Object&gt;} 月間勤務表データ\n */\nconst getMonthlyAttendance = async (employeeId, year, month) =&gt; {\n  const { startDate, endDate } = getMonthRange(year, month);\n  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);\n\n  // 休日出勤申請を取得\n  const holidayWorkApplications = await applicationModel.getApplicationsByType(\n    employeeId,\n    'HOLIDAY_WORK',\n    startDate,\n    endDate\n  );\n  \n  // 休暇申請を取得\n  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);\n  \n  // 各勤怠記録に対して休憩時間、公用外出、工数実績を取得\n  const dailyData = [];\n  for (const attendance of attendanceRows) {\n    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 336
          },
          {
            "text": " * 月間勤務表を取得する。",
            "lineNumber": 337
          },
          {
            "text": " *",
            "lineNumber": 338
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 339
          },
          {
            "text": " * @param {number} year 年",
            "lineNumber": 340
          },
          {
            "text": " * @param {number} month 月",
            "lineNumber": 341
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月間勤務表データ",
            "lineNumber": 342
          },
          {
            "text": " */",
            "lineNumber": 343
          },
          {
            "text": "const getMonthlyAttendance = async (employeeId, year, month) =&gt; {",
            "lineNumber": 344
          },
          {
            "text": "  const { startDate, endDate } = getMonthRange(year, month);",
            "lineNumber": 345
          },
          {
            "text": "  const attendanceRows = await attendanceModel.getMonthlyAttendance(employeeId, startDate, endDate);",
            "lineNumber": 346
          },
          {
            "lineNumber": 347
          },
          {
            "text": "  // 休日出勤申請を取得",
            "lineNumber": 348
          },
          {
            "text": "  const holidayWorkApplications = await applicationModel.getApplicationsByType(",
            "lineNumber": 349
          },
          {
            "text": "    employeeId,",
            "lineNumber": 350
          },
          {
            "text": "    'HOLIDAY_WORK',",
            "lineNumber": 351
          },
          {
            "text": "    startDate,",
            "lineNumber": 352
          },
          {
            "text": "    endDate",
            "lineNumber": 353
          },
          {
            "text": "  );",
            "lineNumber": 354
          },
          {
            "text": "  ",
            "lineNumber": 355
          },
          {
            "text": "  // 休暇申請を取得",
            "lineNumber": 356
          },
          {
            "text": "  const vacations = await applicationModel.getVacations(employeeId, startDate, endDate);",
            "lineNumber": 357
          },
          {
            "text": "  ",
            "lineNumber": 358
          },
          {
            "text": "  // 各勤怠記録に対して休憩時間、公用外出、工数実績を取得",
            "lineNumber": 359
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 360
          },
          {
            "text": "  for (const attendance of attendanceRows) {",
            "lineNumber": 361
          },
          {
            "text": "    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 362
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.5337781310081482
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 149,
            "column": 2
          },
          "endPosition": {
            "line": 195,
            "column": 3
          }
        },
        "contents": "/**\n * 休日出勤申請状態を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請状態\n */\nconst getHolidayWorkStatus = async (employeeId, targetDate) =&gt; {\n  const application = await applicationModel.getApplicationStatus(employeeId, 'HOLIDAY_WORK', targetDate);\n  \n  let applicationStatus = null;\n\n  if (application) {\n    applicationStatus = application.APPROVAL_STATUS;\n  }\n\n  // 代休の表示条件：過去の休日出勤申請（承認済みまたは申請中）も確認\n  // 対象日から過去1年間の休日出勤申請を確認\n  const oneYearAgo = new Date(targetDate);\n  oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);\n  const oneYearAgoStr = oneYearAgo.toISOString().split('T')[0];\n  \n  const pastApplications = await applicationModel.getApplicationsByType(\n    employeeId,\n    'HOLIDAY_WORK',\n    oneYearAgoStr,\n    targetDate\n  );\n\n  const hasPastHolidayWork = pastApplications.length &gt; 0;\n\n  return {\n    success: true,\n    hasHolidayWorkApplication: !!application || hasPastHolidayWork,\n    applicationStatus: applicationStatus,\n    hasPastHolidayWorkApplication: hasPastHolidayWork\n  };\n};\n\n/**\n * 月次承認履歴を取得\n * @param {string} employeeId - 従業員ID\n * @param {number} year - 年\n * @param {number} month - 月\n * @returns {Promise&lt;Object&gt;} 月次承認情報\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 152
          },
          {
            "text": " * 休日出勤申請状態を取得",
            "lineNumber": 153
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 154
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 155
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請状態",
            "lineNumber": 156
          },
          {
            "text": " */",
            "lineNumber": 157
          },
          {
            "text": "const getHolidayWorkStatus = async (employeeId, targetDate) =&gt; {",
            "lineNumber": 158
          },
          {
            "text": "  const application = await applicationModel.getApplicationStatus(employeeId, 'HOLIDAY_WORK', targetDate);",
            "lineNumber": 159
          },
          {
            "text": "  ",
            "lineNumber": 160
          },
          {
            "text": "  let applicationStatus = null;",
            "lineNumber": 161
          },
          {
            "lineNumber": 162
          },
          {
            "text": "  if (application) {",
            "lineNumber": 163
          },
          {
            "text": "    applicationStatus = application.APPROVAL_STATUS;",
            "lineNumber": 164
          },
          {
            "text": "  }",
            "lineNumber": 165
          },
          {
            "lineNumber": 166
          },
          {
            "text": "  // 代休の表示条件：過去の休日出勤申請（承認済みまたは申請中）も確認",
            "lineNumber": 167
          },
          {
            "text": "  // 対象日から過去1年間の休日出勤申請を確認",
            "lineNumber": 168
          },
          {
            "text": "  const oneYearAgo = new Date(targetDate);",
            "lineNumber": 169
          },
          {
            "text": "  oneYearAgo.setFullYear(oneYearAgo.getFullYear() - 1);",
            "lineNumber": 170
          },
          {
            "text": "  const oneYearAgoStr = oneYearAgo.toISOString().split('T')[0];",
            "lineNumber": 171
          },
          {
            "text": "  ",
            "lineNumber": 172
          },
          {
            "text": "  const pastApplications = await applicationModel.getApplicationsByType(",
            "lineNumber": 173
          },
          {
            "text": "    employeeId,",
            "lineNumber": 174
          },
          {
            "text": "    'HOLIDAY_WORK',",
            "lineNumber": 175
          },
          {
            "text": "    oneYearAgoStr,",
            "lineNumber": 176
          },
          {
            "text": "    targetDate",
            "lineNumber": 177
          },
          {
            "text": "  );",
            "lineNumber": 178
          },
          {
            "lineNumber": 179
          },
          {
            "text": "  const hasPastHolidayWork = pastApplications.length &gt; 0;",
            "lineNumber": 180
          },
          {
            "lineNumber": 181
          },
          {
            "text": "  return {",
            "lineNumber": 182
          },
          {
            "text": "    success: true,",
            "lineNumber": 183
          },
          {
            "text": "    hasHolidayWorkApplication: !!application || hasPastHolidayWork,",
            "lineNumber": 184
          },
          {
            "text": "    applicationStatus: applicationStatus,",
            "lineNumber": 185
          },
          {
            "text": "    hasPastHolidayWorkApplication: hasPastHolidayWork",
            "lineNumber": 186
          },
          {
            "text": "  };",
            "lineNumber": 187
          },
          {
            "text": "};",
            "lineNumber": 188
          },
          {
            "lineNumber": 189
          },
          {
            "text": "/**",
            "lineNumber": 190
          },
          {
            "text": " * 月次承認履歴を取得",
            "lineNumber": 191
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 192
          },
          {
            "text": " * @param {number} year - 年",
            "lineNumber": 193
          },
          {
            "text": " * @param {number} month - 月",
            "lineNumber": 194
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 月次承認情報",
            "lineNumber": 195
          },
          {
            "text": " */",
            "lineNumber": 196
          }
        ]
      },
      "score": 0.5295302867889404
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\applicationModel.js",
        "range": {
          "startPosition": {
            "line": 325,
            "column": 2
          },
          "endPosition": {
            "line": 357,
            "column": 3
          }
        },
        "contents": "/**\n * 申請種別と期間で申請を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} applicationType - 申請種別\n * @param {string} startDate - 開始日（YYYY-MM-DD形式）\n * @param {string} endDate - 終了日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Array&gt;} 申請の配列\n */\nconst getApplicationsByType = async (employeeId, applicationType, startDate, endDate) =&gt; {\n  const query = &#96;\n    SELECT APPLICATION_ID, EMPLOYEE_ID, APPLICATION_TYPE, TARGET_START_DATE, TARGET_END_DATE, \n           OVERTIME_HOURS, REASON, APPROVAL_STATUS, CREATED_AT, UPDATED_AT\n    FROM APPLICATION_HISTORY\n    WHERE EMPLOYEE_ID = ? \n      AND APPLICATION_TYPE = ?\n      AND TARGET_START_DATE &lt;= ?\n      AND TARGET_END_DATE &gt;= ?\n      AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')\n    ORDER BY TARGET_START_DATE\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, applicationType, endDate, startDate]);\n  return rows;\n};\n\n/**\n * 申請情報と承認履歴を取得（日次確定申請）\n * @param {string} employeeId - 従業員ID\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 328
          },
          {
            "text": " * 申請種別と期間で申請を取得",
            "lineNumber": 329
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 330
          },
          {
            "text": " * @param {string} applicationType - 申請種別",
            "lineNumber": 331
          },
          {
            "text": " * @param {string} startDate - 開始日（YYYY-MM-DD形式）",
            "lineNumber": 332
          },
          {
            "text": " * @param {string} endDate - 終了日（YYYY-MM-DD形式）",
            "lineNumber": 333
          },
          {
            "text": " * @returns {Promise&lt;Array&gt;} 申請の配列",
            "lineNumber": 334
          },
          {
            "text": " */",
            "lineNumber": 335
          },
          {
            "text": "const getApplicationsByType = async (employeeId, applicationType, startDate, endDate) =&gt; {",
            "lineNumber": 336
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 337
          },
          {
            "text": "    SELECT APPLICATION_ID, EMPLOYEE_ID, APPLICATION_TYPE, TARGET_START_DATE, TARGET_END_DATE, ",
            "lineNumber": 338
          },
          {
            "text": "           OVERTIME_HOURS, REASON, APPROVAL_STATUS, CREATED_AT, UPDATED_AT",
            "lineNumber": 339
          },
          {
            "text": "    FROM APPLICATION_HISTORY",
            "lineNumber": 340
          },
          {
            "text": "    WHERE EMPLOYEE_ID = ? ",
            "lineNumber": 341
          },
          {
            "text": "      AND APPLICATION_TYPE = ?",
            "lineNumber": 342
          },
          {
            "text": "      AND TARGET_START_DATE &lt;= ?",
            "lineNumber": 343
          },
          {
            "text": "      AND TARGET_END_DATE &gt;= ?",
            "lineNumber": 344
          },
          {
            "text": "      AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')",
            "lineNumber": 345
          },
          {
            "text": "    ORDER BY TARGET_START_DATE",
            "lineNumber": 346
          },
          {
            "text": "  &#96;;",
            "lineNumber": 347
          },
          {
            "text": "  ",
            "lineNumber": 348
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, applicationType, endDate, startDate]);",
            "lineNumber": 349
          },
          {
            "text": "  return rows;",
            "lineNumber": 350
          },
          {
            "text": "};",
            "lineNumber": 351
          },
          {
            "lineNumber": 352
          },
          {
            "text": "/**",
            "lineNumber": 353
          },
          {
            "text": " * 申請情報と承認履歴を取得（日次確定申請）",
            "lineNumber": 354
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 355
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 356
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴",
            "lineNumber": 357
          },
          {
            "text": " */",
            "lineNumber": 358
          }
        ]
      },
      "score": 0.4749324321746826
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 206,
            "column": 2
          },
          "endPosition": {
            "line": 270,
            "column": 3
          }
        },
        "contents": "/**\n * 申請状態を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} applicationType - 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請状態\n */\nconst getApplicationStatus = async (employeeId, applicationType, targetDate) =&gt; {\n  let status = 'NOT_SUBMITTED';\n  let applicationId = null;\n  \n  switch (applicationType) {\n    case 'DAILY_CONFIRMATION': {\n      // 日次確定申請の状態を取得\n      const attendanceModel = require('../models/attendanceModel');\n      const attendance = await attendanceModel.getAttendanceDetail(employeeId, targetDate);\n      if (attendance &amp;&amp; attendance.APPROVAL_STATUS) {\n        status = attendance.APPROVAL_STATUS;\n      }\n      break;\n    }\n    case 'VACATION': {\n      // 休暇申請の状態を取得\n      const vacations = await applicationModel.getVacations(employeeId, targetDate, targetDate);\n      if (vacations &amp;&amp; vacations.length &gt; 0) {\n        const vacation = vacations.find(v =&gt; \n          v.START_DATE &lt;= targetDate &amp;&amp; v.END_DATE &gt;= targetDate &amp;&amp;\n          (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED')\n        );\n        if (vacation) {\n          status = vacation.APPROVAL_STATUS;\n          applicationId = vacation.VACATION_ID;\n        }\n      }\n      break;\n    }\n    case 'HOLIDAY_WORK':\n    case 'OVERTIME':\n    case 'EARLY_WORK':\n    case 'TRANSFER': {\n      // APPLICATION_HISTORYから取得\n      const application = await applicationModel.getApplicationStatus(employeeId, applicationType, targetDate);\n      if (application) {\n        status = application.APPROVAL_STATUS;\n        applicationId = application.APPLICATION_ID;\n      }\n      break;\n    }\n  }\n  \n  return {\n    status,\n    applicationId\n  };\n};\n\n/**\n * 月次確定申請取消\n * @param {string} employeeId - 従業員ID\n * @param {number} year - 年\n * @param {number} month - 月\n * @returns {Promise&lt;void&gt;}\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 209
          },
          {
            "text": " * 申請状態を取得",
            "lineNumber": 210
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 211
          },
          {
            "text": " * @param {string} applicationType - 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 212
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 213
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請状態",
            "lineNumber": 214
          },
          {
            "text": " */",
            "lineNumber": 215
          },
          {
            "text": "const getApplicationStatus = async (employeeId, applicationType, targetDate) =&gt; {",
            "lineNumber": 216
          },
          {
            "text": "  let status = 'NOT_SUBMITTED';",
            "lineNumber": 217
          },
          {
            "text": "  let applicationId = null;",
            "lineNumber": 218
          },
          {
            "text": "  ",
            "lineNumber": 219
          },
          {
            "text": "  switch (applicationType) {",
            "lineNumber": 220
          },
          {
            "text": "    case 'DAILY_CONFIRMATION': {",
            "lineNumber": 221
          },
          {
            "text": "      // 日次確定申請の状態を取得",
            "lineNumber": 222
          },
          {
            "text": "      const attendanceModel = require('../models/attendanceModel');",
            "lineNumber": 223
          },
          {
            "text": "      const attendance = await attendanceModel.getAttendanceDetail(employeeId, targetDate);",
            "lineNumber": 224
          },
          {
            "text": "      if (attendance &amp;&amp; attendance.APPROVAL_STATUS) {",
            "lineNumber": 225
          },
          {
            "text": "        status = attendance.APPROVAL_STATUS;",
            "lineNumber": 226
          },
          {
            "text": "      }",
            "lineNumber": 227
          },
          {
            "text": "      break;",
            "lineNumber": 228
          },
          {
            "text": "    }",
            "lineNumber": 229
          },
          {
            "text": "    case 'VACATION': {",
            "lineNumber": 230
          },
          {
            "text": "      // 休暇申請の状態を取得",
            "lineNumber": 231
          },
          {
            "text": "      const vacations = await applicationModel.getVacations(employeeId, targetDate, targetDate);",
            "lineNumber": 232
          },
          {
            "text": "      if (vacations &amp;&amp; vacations.length &gt; 0) {",
            "lineNumber": 233
          },
          {
            "text": "        const vacation = vacations.find(v =&gt; ",
            "lineNumber": 234
          },
          {
            "text": "          v.START_DATE &lt;= targetDate &amp;&amp; v.END_DATE &gt;= targetDate &amp;&amp;",
            "lineNumber": 235
          },
          {
            "text": "          (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED')",
            "lineNumber": 236
          },
          {
            "text": "        );",
            "lineNumber": 237
          },
          {
            "text": "        if (vacation) {",
            "lineNumber": 238
          },
          {
            "text": "          status = vacation.APPROVAL_STATUS;",
            "lineNumber": 239
          },
          {
            "text": "          applicationId = vacation.VACATION_ID;",
            "lineNumber": 240
          },
          {
            "text": "        }",
            "lineNumber": 241
          },
          {
            "text": "      }",
            "lineNumber": 242
          },
          {
            "text": "      break;",
            "lineNumber": 243
          },
          {
            "text": "    }",
            "lineNumber": 244
          },
          {
            "text": "    case 'HOLIDAY_WORK':",
            "lineNumber": 245
          },
          {
            "text": "    case 'OVERTIME':",
            "lineNumber": 246
          },
          {
            "text": "    case 'EARLY_WORK':",
            "lineNumber": 247
          },
          {
            "text": "    case 'TRANSFER': {",
            "lineNumber": 248
          },
          {
            "text": "      // APPLICATION_HISTORYから取得",
            "lineNumber": 249
          },
          {
            "text": "      const application = await applicationModel.getApplicationStatus(employeeId, applicationType, targetDate);",
            "lineNumber": 250
          },
          {
            "text": "      if (application) {",
            "lineNumber": 251
          },
          {
            "text": "        status = application.APPROVAL_STATUS;",
            "lineNumber": 252
          },
          {
            "text": "        applicationId = application.APPLICATION_ID;",
            "lineNumber": 253
          },
          {
            "text": "      }",
            "lineNumber": 254
          },
          {
            "text": "      break;",
            "lineNumber": 255
          },
          {
            "text": "    }",
            "lineNumber": 256
          },
          {
            "text": "  }",
            "lineNumber": 257
          },
          {
            "text": "  ",
            "lineNumber": 258
          },
          {
            "text": "  return {",
            "lineNumber": 259
          },
          {
            "text": "    status,",
            "lineNumber": 260
          },
          {
            "text": "    applicationId",
            "lineNumber": 261
          },
          {
            "text": "  };",
            "lineNumber": 262
          },
          {
            "text": "};",
            "lineNumber": 263
          },
          {
            "lineNumber": 264
          },
          {
            "text": "/**",
            "lineNumber": 265
          },
          {
            "text": " * 月次確定申請取消",
            "lineNumber": 266
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 267
          },
          {
            "text": " * @param {number} year - 年",
            "lineNumber": 268
          },
          {
            "text": " * @param {number} month - 月",
            "lineNumber": 269
          },
          {
            "text": " * @returns {Promise&lt;void&gt;}",
            "lineNumber": 270
          },
          {
            "text": " */",
            "lineNumber": 271
          }
        ]
      },
      "score": 0.44806110858917236
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 460,
            "column": 2
          },
          "endPosition": {
            "line": 488,
            "column": 16
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} applicationType - 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴\n */\nconst getApplicationInfo = async (employeeId, applicationType, targetDate) =&gt; {\n  switch (applicationType) {\n    case 'DAILY_CONFIRMATION':\n      return await applicationModel.getDailyConfirmationApplicationInfo(employeeId, targetDate);\n    case 'VACATION':\n      return await applicationModel.getVacationApplicationInfo(employeeId, targetDate);\n    case 'HOLIDAY_WORK':\n    case 'OVERTIME':\n    case 'EARLY_WORK':\n    case 'TRANSFER':\n      return await applicationModel.getApplicationInfo(employeeId, applicationType, targetDate);\n    default:\n      throw new Error('無効な申請タイプです。');\n  }\n};\n\nmodule.exports = {\n  applyVacation,\n  applyHolidayWork,\n  applyOvertime,",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 463
          },
          {
            "text": " * 申請情報と承認履歴を取得",
            "lineNumber": 464
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 465
          },
          {
            "text": " * @param {string} applicationType - 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 466
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 467
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴",
            "lineNumber": 468
          },
          {
            "text": " */",
            "lineNumber": 469
          },
          {
            "text": "const getApplicationInfo = async (employeeId, applicationType, targetDate) =&gt; {",
            "lineNumber": 470
          },
          {
            "text": "  switch (applicationType) {",
            "lineNumber": 471
          },
          {
            "text": "    case 'DAILY_CONFIRMATION':",
            "lineNumber": 472
          },
          {
            "text": "      return await applicationModel.getDailyConfirmationApplicationInfo(employeeId, targetDate);",
            "lineNumber": 473
          },
          {
            "text": "    case 'VACATION':",
            "lineNumber": 474
          },
          {
            "text": "      return await applicationModel.getVacationApplicationInfo(employeeId, targetDate);",
            "lineNumber": 475
          },
          {
            "text": "    case 'HOLIDAY_WORK':",
            "lineNumber": 476
          },
          {
            "text": "    case 'OVERTIME':",
            "lineNumber": 477
          },
          {
            "text": "    case 'EARLY_WORK':",
            "lineNumber": 478
          },
          {
            "text": "    case 'TRANSFER':",
            "lineNumber": 479
          },
          {
            "text": "      return await applicationModel.getApplicationInfo(employeeId, applicationType, targetDate);",
            "lineNumber": 480
          },
          {
            "text": "    default:",
            "lineNumber": 481
          },
          {
            "text": "      throw new Error('無効な申請タイプです。');",
            "lineNumber": 482
          },
          {
            "text": "  }",
            "lineNumber": 483
          },
          {
            "text": "};",
            "lineNumber": 484
          },
          {
            "lineNumber": 485
          },
          {
            "text": "module.exports = {",
            "lineNumber": 486
          },
          {
            "text": "  applyVacation,",
            "lineNumber": 487
          },
          {
            "text": "  applyHolidayWork,",
            "lineNumber": 488
          },
          {
            "text": "  applyOvertime,",
            "lineNumber": 489
          }
        ]
      },
      "score": 0.44259119033813477
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 343
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "const getMonthlyAttendance = async \n\n  const dailyData = [];\n  for (const attendance of attendanceRows) {\n    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n    const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);\n    const workHours = await workHoursModel.getWorkHours(employeeId, normalizeDate(attendance.WORK_DATE));\n    \n    // 該当日の休日出勤申請を取得\n    const workDate = normalizeDate(attendance.WORK_DATE);\n    const holidayWorkApp = holidayWorkApplications.find(app =&gt; {\n      const appStartDate = normalizeDate(app.TARGET_START_DATE);\n      const appEndDate = normalizeDate(app.TARGET_END_DATE);\n      return workDate &gt;= appStartDate &amp;&amp; workDate &lt;= appEndDate &amp;&amp; \n             (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');\n    });\n    \n    // 該当日の休暇申請を取得\n    const vacation = vacations.find(v =&gt; {\n      const vStartDate = normalizeDate(v.START_DATE);\n      const vEndDate = normalizeDate(v.END_DATE);\n      return workDate &gt;= vStartDate &amp;&amp; workDate &lt;= vEndDate &amp;&amp; \n             (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');\n    });\n    \n    dailyData.push({\n      ...attendance,\n      WORK_DATE: normalizeDate(attendance.WORK_DATE),\n      breakTimes,\n      officialOutings,\n      workHours,\n      holidayWorkApplication: holidayWorkApp || null,\n      vacation: vacation || null\n    });\n  }\n  \n  // 勤怠記録がない日付にも休日出勤申請の情報を追加\n  const daysInMonth = new Date(year, month, 0).getDate();\n  const existingDates = new Set(dailyData.map(d =&gt; d.WORK_DATE));\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const dateStr = &#96;${year}&#96;;\n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 344,
                "column": 1
              },
              "endPosition": {
                "line": 344,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 344,
                "column": 7
              },
              "endPosition": {
                "line": 344,
                "column": 36
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlyAttendance = async ",
            "lineNumber": 344
          },
          {
            "lineNumber": 359
          },
          {
            "text": "  const dailyData = [];",
            "lineNumber": 360
          },
          {
            "text": "  for (const attendance of attendanceRows) {",
            "lineNumber": 361
          },
          {
            "text": "    const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 362
          },
          {
            "text": "    const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);",
            "lineNumber": 363
          },
          {
            "text": "    const workHours = await workHoursModel.getWorkHours(employeeId, normalizeDate(attendance.WORK_DATE));",
            "lineNumber": 364
          },
          {
            "text": "    ",
            "lineNumber": 365
          },
          {
            "text": "    // 該当日の休日出勤申請を取得",
            "lineNumber": 366
          },
          {
            "text": "    const workDate = normalizeDate(attendance.WORK_DATE);",
            "lineNumber": 367
          },
          {
            "text": "    const holidayWorkApp = holidayWorkApplications.find(app =&gt; {",
            "lineNumber": 368
          },
          {
            "text": "      const appStartDate = normalizeDate(app.TARGET_START_DATE);",
            "lineNumber": 369
          },
          {
            "text": "      const appEndDate = normalizeDate(app.TARGET_END_DATE);",
            "lineNumber": 370
          },
          {
            "text": "      return workDate &gt;= appStartDate &amp;&amp; workDate &lt;= appEndDate &amp;&amp; ",
            "lineNumber": 371
          },
          {
            "text": "             (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 372
          },
          {
            "text": "    });",
            "lineNumber": 373
          },
          {
            "text": "    ",
            "lineNumber": 374
          },
          {
            "text": "    // 該当日の休暇申請を取得",
            "lineNumber": 375
          },
          {
            "text": "    const vacation = vacations.find(v =&gt; {",
            "lineNumber": 376
          },
          {
            "text": "      const vStartDate = normalizeDate(v.START_DATE);",
            "lineNumber": 377
          },
          {
            "text": "      const vEndDate = normalizeDate(v.END_DATE);",
            "lineNumber": 378
          },
          {
            "text": "      return workDate &gt;= vStartDate &amp;&amp; workDate &lt;= vEndDate &amp;&amp; ",
            "lineNumber": 379
          },
          {
            "text": "             (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 380
          },
          {
            "text": "    });",
            "lineNumber": 381
          },
          {
            "text": "    ",
            "lineNumber": 382
          },
          {
            "text": "    dailyData.push({",
            "lineNumber": 383
          },
          {
            "text": "      ...attendance,",
            "lineNumber": 384
          },
          {
            "text": "      WORK_DATE: normalizeDate(attendance.WORK_DATE),",
            "lineNumber": 385
          },
          {
            "text": "      breakTimes,",
            "lineNumber": 386
          },
          {
            "text": "      officialOutings,",
            "lineNumber": 387
          },
          {
            "text": "      workHours,",
            "lineNumber": 388
          },
          {
            "text": "      holidayWorkApplication: holidayWorkApp || null,",
            "lineNumber": 389
          },
          {
            "text": "      vacation: vacation || null",
            "lineNumber": 390
          },
          {
            "text": "    });",
            "lineNumber": 391
          },
          {
            "text": "  }",
            "lineNumber": 392
          },
          {
            "text": "  ",
            "lineNumber": 393
          },
          {
            "text": "  // 勤怠記録がない日付にも休日出勤申請の情報を追加",
            "lineNumber": 394
          },
          {
            "text": "  const daysInMonth = new Date(year, month, 0).getDate();",
            "lineNumber": 395
          },
          {
            "text": "  const existingDates = new Set(dailyData.map(d =&gt; d.WORK_DATE));",
            "lineNumber": 396
          },
          {
            "text": "  ",
            "lineNumber": 397
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 398
          },
          {
            "text": "    const dateStr = &#96;${year}&#96;;",
            "lineNumber": 399
          },
          {
            "text": "  }",
            "lineNumber": 431
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.44247961044311523
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1203
          },
          "endPosition": {
            "line": 1261
          }
        },
        "contents": "    filteredVacationTypes() {\n      return this.vacationTypes.filter(type =&gt; {\n        // 代休（SUBSTITUTE_HOLIDAY）は休日出勤申請がある場合のみ表示\n        if (type.code === 'SUBSTITUTE_HOLIDAY') {\n          return this.hasHolidayWorkApplication\n        }\n        // その他の休暇種別は常に表示\n        return true\n      })\n    },\n    // 全メニュー項目の説明文\n    menuDescriptions() {\n      return {\n        dailyConfirmation: '日次確定を申請します。',\n        vacation: '休暇、代休、時間単位休暇を申請します。',\n        holidayWork: '休日出勤を申請します。',\n        overtime: '残業を申請します。',\n        earlyWork: '早朝勤務を申請します。',\n        transfer: '振替を申請します。'\n      }\n    },\n    // 申請中または承認済みかどうかを判定（各申請タイプごと）\n    isPendingOrApproved() {\n      return (applicationType) =&gt; {\n        const status = this.applicationStatuses[applicationType]\n        return status === 'PENDING' || status === 'APPROVED'\n      }\n    },\n    // 編集可能かどうかを判定（申請中または承認済みの場合は編集不可）\n    isEditable() {\n      return (applicationType) =&gt; {\n        const status = this.applicationStatuses[applicationType]\n        return status !== 'PENDING' &amp;&amp; status !== 'APPROVED'\n      }\n    },\n    // 対象日が休日かどうかを判定\n    isHoliday() {\n      if (!this.targetDate) return false\n      const date = new Date(this.targetDate)\n      const dayOfWeek = date.getDay() // 0=日曜日, 6=土曜日\n      \n      // 土曜日または日曜日の場合\n      if (dayOfWeek === 0 || dayOfWeek === 6) {\n        return true\n      }\n      \n      // 祝日判定（HolidayJpライブラリを使用）\n      try {\n        return HolidayJp.isHoliday(date)\n      } catch (error) {\n        console.error('祝日判定エラー:', error)\n        return false\n      }\n    },\n    // 対象日が平日かどうかを判定\n    isWeekday() {\n      return !this.isHoliday\n    },",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    filteredVacationTypes() {",
            "lineNumber": 1204
          },
          {
            "text": "      return this.vacationTypes.filter(type =&gt; {",
            "lineNumber": 1205
          },
          {
            "text": "        // 代休（SUBSTITUTE_HOLIDAY）は休日出勤申請がある場合のみ表示",
            "lineNumber": 1206
          },
          {
            "text": "        if (type.code === 'SUBSTITUTE_HOLIDAY') {",
            "lineNumber": 1207
          },
          {
            "text": "          return this.hasHolidayWorkApplication",
            "lineNumber": 1208
          },
          {
            "text": "        }",
            "lineNumber": 1209
          },
          {
            "text": "        // その他の休暇種別は常に表示",
            "lineNumber": 1210
          },
          {
            "text": "        return true",
            "lineNumber": 1211
          },
          {
            "text": "      })",
            "lineNumber": 1212
          },
          {
            "text": "    },",
            "lineNumber": 1213
          },
          {
            "text": "    // 全メニュー項目の説明文",
            "lineNumber": 1214
          },
          {
            "text": "    menuDescriptions() {",
            "lineNumber": 1215
          },
          {
            "text": "      return {",
            "lineNumber": 1216
          },
          {
            "text": "        dailyConfirmation: '日次確定を申請します。',",
            "lineNumber": 1217
          },
          {
            "text": "        vacation: '休暇、代休、時間単位休暇を申請します。',",
            "lineNumber": 1218
          },
          {
            "text": "        holidayWork: '休日出勤を申請します。',",
            "lineNumber": 1219
          },
          {
            "text": "        overtime: '残業を申請します。',",
            "lineNumber": 1220
          },
          {
            "text": "        earlyWork: '早朝勤務を申請します。',",
            "lineNumber": 1221
          },
          {
            "text": "        transfer: '振替を申請します。'",
            "lineNumber": 1222
          },
          {
            "text": "      }",
            "lineNumber": 1223
          },
          {
            "text": "    },",
            "lineNumber": 1224
          },
          {
            "text": "    // 申請中または承認済みかどうかを判定（各申請タイプごと）",
            "lineNumber": 1225
          },
          {
            "text": "    isPendingOrApproved() {",
            "lineNumber": 1226
          },
          {
            "text": "      return (applicationType) =&gt; {",
            "lineNumber": 1227
          },
          {
            "text": "        const status = this.applicationStatuses[applicationType]",
            "lineNumber": 1228
          },
          {
            "text": "        return status === 'PENDING' || status === 'APPROVED'",
            "lineNumber": 1229
          },
          {
            "text": "      }",
            "lineNumber": 1230
          },
          {
            "text": "    },",
            "lineNumber": 1231
          },
          {
            "text": "    // 編集可能かどうかを判定（申請中または承認済みの場合は編集不可）",
            "lineNumber": 1232
          },
          {
            "text": "    isEditable() {",
            "lineNumber": 1233
          },
          {
            "text": "      return (applicationType) =&gt; {",
            "lineNumber": 1234
          },
          {
            "text": "        const status = this.applicationStatuses[applicationType]",
            "lineNumber": 1235
          },
          {
            "text": "        return status !== 'PENDING' &amp;&amp; status !== 'APPROVED'",
            "lineNumber": 1236
          },
          {
            "text": "      }",
            "lineNumber": 1237
          },
          {
            "text": "    },",
            "lineNumber": 1238
          },
          {
            "text": "    // 対象日が休日かどうかを判定",
            "lineNumber": 1239
          },
          {
            "text": "    isHoliday() {",
            "lineNumber": 1240
          },
          {
            "text": "      if (!this.targetDate) return false",
            "lineNumber": 1241
          },
          {
            "text": "      const date = new Date(this.targetDate)",
            "lineNumber": 1242
          },
          {
            "text": "      const dayOfWeek = date.getDay() // 0=日曜日, 6=土曜日",
            "lineNumber": 1243
          },
          {
            "text": "      ",
            "lineNumber": 1244
          },
          {
            "text": "      // 土曜日または日曜日の場合",
            "lineNumber": 1245
          },
          {
            "text": "      if (dayOfWeek === 0 || dayOfWeek === 6) {",
            "lineNumber": 1246
          },
          {
            "text": "        return true",
            "lineNumber": 1247
          },
          {
            "text": "      }",
            "lineNumber": 1248
          },
          {
            "text": "      ",
            "lineNumber": 1249
          },
          {
            "text": "      // 祝日判定（HolidayJpライブラリを使用）",
            "lineNumber": 1250
          },
          {
            "text": "      try {",
            "lineNumber": 1251
          },
          {
            "text": "        return HolidayJp.isHoliday(date)",
            "lineNumber": 1252
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1253
          },
          {
            "text": "        console.error('祝日判定エラー:', error)",
            "lineNumber": 1254
          },
          {
            "text": "        return false",
            "lineNumber": 1255
          },
          {
            "text": "      }",
            "lineNumber": 1256
          },
          {
            "text": "    },",
            "lineNumber": 1257
          },
          {
            "text": "    // 対象日が平日かどうかを判定",
            "lineNumber": 1258
          },
          {
            "text": "    isWeekday() {",
            "lineNumber": 1259
          },
          {
            "text": "      return !this.isHoliday",
            "lineNumber": 1260
          },
          {
            "text": "    },",
            "lineNumber": 1261
          }
        ]
      },
      "score": 0.44100522994995117
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1889,
            "column": 8
          },
          "endPosition": {
            "line": 1918
          }
        },
        "contents": "await this.loadApplicationInfo('transfer')\n      }\n      \n      // 休日出勤申請タブを開いた場合、当月時間外残業を取得\n      if (applicationType === 'holidayWork') {\n        await this.loadMonthlyOvertime()\n        // 申請中または承認済みの場合、申請データを読み込む\n        if (this.isPendingOrApproved('holidayWork')) {\n          await this.loadHolidayWorkApplicationData()\n        }\n      }\n      \n      // その他の申請タイプで申請中または承認済みの場合、申請データを読み込む\n      if (applicationType === 'vacation' &amp;&amp; this.isPendingOrApproved('vacation')) {\n        await this.loadVacationApplicationData()\n      }\n      if (applicationType === 'overtime' &amp;&amp; this.isPendingOrApproved('overtime')) {\n        await this.loadOvertimeApplicationData()\n      }\n      if (applicationType === 'earlyWork' &amp;&amp; this.isPendingOrApproved('earlyWork')) {\n        await this.loadEarlyWorkApplicationData()\n      }\n      if (applicationType === 'transfer' &amp;&amp; this.isPendingOrApproved('transfer')) {\n        await this.loadTransferApplicationData()\n      }\n    },\n    \n    async loadApplicationStatus(applicationType) {\n      // 初期申請状態が指定されている場合は、APIを呼び出さずにそれを使用",
        "signatures": {},
        "detailedLines": [
          {
            "text": "await this.loadApplicationInfo('transfer')",
            "lineNumber": 1890
          },
          {
            "text": "      }",
            "lineNumber": 1891
          },
          {
            "text": "      ",
            "lineNumber": 1892
          },
          {
            "text": "      // 休日出勤申請タブを開いた場合、当月時間外残業を取得",
            "lineNumber": 1893
          },
          {
            "text": "      if (applicationType === 'holidayWork') {",
            "lineNumber": 1894
          },
          {
            "text": "        await this.loadMonthlyOvertime()",
            "lineNumber": 1895
          },
          {
            "text": "        // 申請中または承認済みの場合、申請データを読み込む",
            "lineNumber": 1896
          },
          {
            "text": "        if (this.isPendingOrApproved('holidayWork')) {",
            "lineNumber": 1897
          },
          {
            "text": "          await this.loadHolidayWorkApplicationData()",
            "lineNumber": 1898
          },
          {
            "text": "        }",
            "lineNumber": 1899
          },
          {
            "text": "      }",
            "lineNumber": 1900
          },
          {
            "text": "      ",
            "lineNumber": 1901
          },
          {
            "text": "      // その他の申請タイプで申請中または承認済みの場合、申請データを読み込む",
            "lineNumber": 1902
          },
          {
            "text": "      if (applicationType === 'vacation' &amp;&amp; this.isPendingOrApproved('vacation')) {",
            "lineNumber": 1903
          },
          {
            "text": "        await this.loadVacationApplicationData()",
            "lineNumber": 1904
          },
          {
            "text": "      }",
            "lineNumber": 1905
          },
          {
            "text": "      if (applicationType === 'overtime' &amp;&amp; this.isPendingOrApproved('overtime')) {",
            "lineNumber": 1906
          },
          {
            "text": "        await this.loadOvertimeApplicationData()",
            "lineNumber": 1907
          },
          {
            "text": "      }",
            "lineNumber": 1908
          },
          {
            "text": "      if (applicationType === 'earlyWork' &amp;&amp; this.isPendingOrApproved('earlyWork')) {",
            "lineNumber": 1909
          },
          {
            "text": "        await this.loadEarlyWorkApplicationData()",
            "lineNumber": 1910
          },
          {
            "text": "      }",
            "lineNumber": 1911
          },
          {
            "text": "      if (applicationType === 'transfer' &amp;&amp; this.isPendingOrApproved('transfer')) {",
            "lineNumber": 1912
          },
          {
            "text": "        await this.loadTransferApplicationData()",
            "lineNumber": 1913
          },
          {
            "text": "      }",
            "lineNumber": 1914
          },
          {
            "text": "    },",
            "lineNumber": 1915
          },
          {
            "text": "    ",
            "lineNumber": 1916
          },
          {
            "text": "    async loadApplicationStatus(applicationType) {",
            "lineNumber": 1917
          },
          {
            "text": "      // 初期申請状態が指定されている場合は、APIを呼び出さずにそれを使用",
            "lineNumber": 1918
          }
        ]
      },
      "score": 0.41421881318092346
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 50,
            "column": 2
          },
          "endPosition": {
            "line": 85,
            "column": 3
          }
        },
        "contents": "/**\n * 休日出勤申請\n * @param {Object} applicationData - 申請データ\n * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID\n */\nconst applyHolidayWork = async (applicationData) =&gt; {\n  const { employeeId, workDate, startTime, endTime, breakHours, reason } = applicationData;\n  const now = getNow();\n  \n  // REASONフィールドにJSON形式で時間情報を保存\n  const reasonData = {\n    text: reason || '',\n    startTime: startTime,\n    endTime: endTime,\n    breakHours: breakHours\n  };\n  \n  return await applicationModel.createApplication({\n    employeeId,\n    applicationType: 'HOLIDAY_WORK',\n    targetStartDate: workDate,\n    targetEndDate: workDate,\n    reason: JSON.stringify(reasonData),\n    approvalStatus: 'PENDING',\n    createdAt: now,\n    updatedAt: now\n  });\n};\n\n/**\n * 残業申請\n * @param {Object} applicationData - 申請データ\n * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 53
          },
          {
            "text": " * 休日出勤申請",
            "lineNumber": 54
          },
          {
            "text": " * @param {Object} applicationData - 申請データ",
            "lineNumber": 55
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID",
            "lineNumber": 56
          },
          {
            "text": " */",
            "lineNumber": 57
          },
          {
            "text": "const applyHolidayWork = async (applicationData) =&gt; {",
            "lineNumber": 58
          },
          {
            "text": "  const { employeeId, workDate, startTime, endTime, breakHours, reason } = applicationData;",
            "lineNumber": 59
          },
          {
            "text": "  const now = getNow();",
            "lineNumber": 60
          },
          {
            "text": "  ",
            "lineNumber": 61
          },
          {
            "text": "  // REASONフィールドにJSON形式で時間情報を保存",
            "lineNumber": 62
          },
          {
            "text": "  const reasonData = {",
            "lineNumber": 63
          },
          {
            "text": "    text: reason || '',",
            "lineNumber": 64
          },
          {
            "text": "    startTime: startTime,",
            "lineNumber": 65
          },
          {
            "text": "    endTime: endTime,",
            "lineNumber": 66
          },
          {
            "text": "    breakHours: breakHours",
            "lineNumber": 67
          },
          {
            "text": "  };",
            "lineNumber": 68
          },
          {
            "text": "  ",
            "lineNumber": 69
          },
          {
            "text": "  return await applicationModel.createApplication({",
            "lineNumber": 70
          },
          {
            "text": "    employeeId,",
            "lineNumber": 71
          },
          {
            "text": "    applicationType: 'HOLIDAY_WORK',",
            "lineNumber": 72
          },
          {
            "text": "    targetStartDate: workDate,",
            "lineNumber": 73
          },
          {
            "text": "    targetEndDate: workDate,",
            "lineNumber": 74
          },
          {
            "text": "    reason: JSON.stringify(reasonData),",
            "lineNumber": 75
          },
          {
            "text": "    approvalStatus: 'PENDING',",
            "lineNumber": 76
          },
          {
            "text": "    createdAt: now,",
            "lineNumber": 77
          },
          {
            "text": "    updatedAt: now",
            "lineNumber": 78
          },
          {
            "text": "  });",
            "lineNumber": 79
          },
          {
            "text": "};",
            "lineNumber": 80
          },
          {
            "lineNumber": 81
          },
          {
            "text": "/**",
            "lineNumber": 82
          },
          {
            "text": " * 残業申請",
            "lineNumber": 83
          },
          {
            "text": " * @param {Object} applicationData - 申請データ",
            "lineNumber": 84
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID",
            "lineNumber": 85
          },
          {
            "text": " */",
            "lineNumber": 86
          }
        ]
      },
      "score": 0.41280660033226013
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1952
          },
          "endPosition": {
            "line": 2000
          }
        },
        "contents": "    async loadHolidayWorkApplicationData() {\n      // 休日出勤申請データを読み込む（申請中または承認済みの場合）\n      try {\n        const response = await getHolidayWorkStatus(this.employeeId, this.targetDate)\n        if (response.success &amp;&amp; response.applicationStatus) {\n          // 申請データを取得してフォームに設定\n          // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定\n        }\n      } catch (error) {\n        console.error('休日出勤申請データ取得エラー:', error)\n      }\n    },\n    \n    async loadVacationApplicationData() {\n      // 休暇申請データを読み込む（申請中または承認済みの場合）\n      try {\n        const response = await getApplicationInfo(this.employeeId, 'VACATION', this.targetDate)\n        if (response.success &amp;&amp; response.applicationData) {\n          const data = response.applicationData\n          // フォームに申請データを設定\n          if (data.VACATION_TYPE_CODE) {\n            this.vacationForm.vacationType = data.VACATION_TYPE_CODE\n          }\n          if (data.START_DATE) {\n            this.vacationForm.startDate = data.START_DATE\n          }\n          if (data.END_DATE) {\n            this.vacationForm.endDate = data.END_DATE\n            this.vacationForm.enableEndDate = true\n          } else if (data.START_DATE) {\n            // 終了日がない場合は開始日と同じにする\n            this.vacationForm.endDate = data.START_DATE\n            this.vacationForm.enableEndDate = false\n          }\n          if (data.REASON) {\n            this.vacationForm.reason = data.REASON\n          }\n          if (data.CONTACT_INFO) {\n            this.vacationForm.contact = data.CONTACT_INFO\n          }\n        }\n      } catch (error) {\n        console.error('休暇申請データ取得エラー:', error)\n      }\n    },\n    \n    async loadOvertimeApplicationData() {\n      // 残業申請データを読み込む（申請中または承認済みの場合）",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    async loadHolidayWorkApplicationData() {",
            "lineNumber": 1953
          },
          {
            "text": "      // 休日出勤申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 1954
          },
          {
            "text": "      try {",
            "lineNumber": 1955
          },
          {
            "text": "        const response = await getHolidayWorkStatus(this.employeeId, this.targetDate)",
            "lineNumber": 1956
          },
          {
            "text": "        if (response.success &amp;&amp; response.applicationStatus) {",
            "lineNumber": 1957
          },
          {
            "text": "          // 申請データを取得してフォームに設定",
            "lineNumber": 1958
          },
          {
            "text": "          // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定",
            "lineNumber": 1959
          },
          {
            "text": "        }",
            "lineNumber": 1960
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1961
          },
          {
            "text": "        console.error('休日出勤申請データ取得エラー:', error)",
            "lineNumber": 1962
          },
          {
            "text": "      }",
            "lineNumber": 1963
          },
          {
            "text": "    },",
            "lineNumber": 1964
          },
          {
            "text": "    ",
            "lineNumber": 1965
          },
          {
            "text": "    async loadVacationApplicationData() {",
            "lineNumber": 1966
          },
          {
            "text": "      // 休暇申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 1967
          },
          {
            "text": "      try {",
            "lineNumber": 1968
          },
          {
            "text": "        const response = await getApplicationInfo(this.employeeId, 'VACATION', this.targetDate)",
            "lineNumber": 1969
          },
          {
            "text": "        if (response.success &amp;&amp; response.applicationData) {",
            "lineNumber": 1970
          },
          {
            "text": "          const data = response.applicationData",
            "lineNumber": 1971
          },
          {
            "text": "          // フォームに申請データを設定",
            "lineNumber": 1972
          },
          {
            "text": "          if (data.VACATION_TYPE_CODE) {",
            "lineNumber": 1973
          },
          {
            "text": "            this.vacationForm.vacationType = data.VACATION_TYPE_CODE",
            "lineNumber": 1974
          },
          {
            "text": "          }",
            "lineNumber": 1975
          },
          {
            "text": "          if (data.START_DATE) {",
            "lineNumber": 1976
          },
          {
            "text": "            this.vacationForm.startDate = data.START_DATE",
            "lineNumber": 1977
          },
          {
            "text": "          }",
            "lineNumber": 1978
          },
          {
            "text": "          if (data.END_DATE) {",
            "lineNumber": 1979
          },
          {
            "text": "            this.vacationForm.endDate = data.END_DATE",
            "lineNumber": 1980
          },
          {
            "text": "            this.vacationForm.enableEndDate = true",
            "lineNumber": 1981
          },
          {
            "text": "          } else if (data.START_DATE) {",
            "lineNumber": 1982
          },
          {
            "text": "            // 終了日がない場合は開始日と同じにする",
            "lineNumber": 1983
          },
          {
            "text": "            this.vacationForm.endDate = data.START_DATE",
            "lineNumber": 1984
          },
          {
            "text": "            this.vacationForm.enableEndDate = false",
            "lineNumber": 1985
          },
          {
            "text": "          }",
            "lineNumber": 1986
          },
          {
            "text": "          if (data.REASON) {",
            "lineNumber": 1987
          },
          {
            "text": "            this.vacationForm.reason = data.REASON",
            "lineNumber": 1988
          },
          {
            "text": "          }",
            "lineNumber": 1989
          },
          {
            "text": "          if (data.CONTACT_INFO) {",
            "lineNumber": 1990
          },
          {
            "text": "            this.vacationForm.contact = data.CONTACT_INFO",
            "lineNumber": 1991
          },
          {
            "text": "          }",
            "lineNumber": 1992
          },
          {
            "text": "        }",
            "lineNumber": 1993
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1994
          },
          {
            "text": "        console.error('休暇申請データ取得エラー:', error)",
            "lineNumber": 1995
          },
          {
            "text": "      }",
            "lineNumber": 1996
          },
          {
            "text": "    },",
            "lineNumber": 1997
          },
          {
            "text": "    ",
            "lineNumber": 1998
          },
          {
            "text": "    async loadOvertimeApplicationData() {",
            "lineNumber": 1999
          },
          {
            "text": "      // 残業申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 2000
          }
        ]
      },
      "score": 0.41022220253944397
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 343
          },
          "endPosition": {
            "line": 550,
            "column": 1
          }
        },
        "contents": "const getMonthlyAttendance = async \n\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const dateStr = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;\n    if (!existingDates.has(dateStr)) {\n      // 該当日の休日出勤申請を取得\n      const holidayWorkApp = holidayWorkApplications.find(app =&gt; {\n        const appStartDate = normalizeDate(app.TARGET_START_DATE);\n        const appEndDate = normalizeDate(app.TARGET_END_DATE);\n        return dateStr &gt;= appStartDate &amp;&amp; dateStr &lt;= appEndDate &amp;&amp; \n               (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');\n      });\n      \n      // 該当日の休暇申請を取得\n      const vacation = vacations.find(v =&gt; {\n        const vStartDate = normalizeDate(v.START_DATE);\n        const vEndDate = normalizeDate(v.END_DATE);\n        return dateStr &gt;= vStartDate &amp;&amp; dateStr &lt;= vEndDate &amp;&amp; \n               (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');\n      });\n      \n      if (holidayWorkApp || vacation) {\n        dailyData.push({\n          WORK_DATE: dateStr,\n          ATTENDANCE_ID: null,\n          CLOCK_IN_TIME: null,\n          CLOCK_OUT_TIME: null,\n          breakTimes: [],\n          officialOutings: [],\n          workHours: [],\n          holidayWorkApplication: holidayWorkApp || null,\n          vacation: vacation || null\n        });\n      }\n    }\n  }\n  \n  // 月次サマリーを計算\n  const todayStr = getTodayJST();\n  const isCurrentMonth = parseInt(year) === new Date().getFullYear() &amp;&amp; parseInt(month) === new Date().getMonth() + 1;\n  let cutoffDate = endDate;\n\n  if (isCurrentMonth) {\n    cutoffDate = todayStr;\n  }\n\n  // 当日退勤していない場合は前日までの過不足時間を計算\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 344,
                "column": 1
              },
              "endPosition": {
                "line": 344,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 344,
                "column": 7
              },
              "endPosition": {
                "line": 344,
                "column": 36
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlyAttendance = async ",
            "lineNumber": 344
          },
          {
            "lineNumber": 396
          },
          {
            "text": "  ",
            "lineNumber": 397
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 398
          },
          {
            "text": "    const dateStr = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;",
            "lineNumber": 399
          },
          {
            "text": "    if (!existingDates.has(dateStr)) {",
            "lineNumber": 400
          },
          {
            "text": "      // 該当日の休日出勤申請を取得",
            "lineNumber": 401
          },
          {
            "text": "      const holidayWorkApp = holidayWorkApplications.find(app =&gt; {",
            "lineNumber": 402
          },
          {
            "text": "        const appStartDate = normalizeDate(app.TARGET_START_DATE);",
            "lineNumber": 403
          },
          {
            "text": "        const appEndDate = normalizeDate(app.TARGET_END_DATE);",
            "lineNumber": 404
          },
          {
            "text": "        return dateStr &gt;= appStartDate &amp;&amp; dateStr &lt;= appEndDate &amp;&amp; ",
            "lineNumber": 405
          },
          {
            "text": "               (app.APPROVAL_STATUS === 'PENDING' || app.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 406
          },
          {
            "text": "      });",
            "lineNumber": 407
          },
          {
            "text": "      ",
            "lineNumber": 408
          },
          {
            "text": "      // 該当日の休暇申請を取得",
            "lineNumber": 409
          },
          {
            "text": "      const vacation = vacations.find(v =&gt; {",
            "lineNumber": 410
          },
          {
            "text": "        const vStartDate = normalizeDate(v.START_DATE);",
            "lineNumber": 411
          },
          {
            "text": "        const vEndDate = normalizeDate(v.END_DATE);",
            "lineNumber": 412
          },
          {
            "text": "        return dateStr &gt;= vStartDate &amp;&amp; dateStr &lt;= vEndDate &amp;&amp; ",
            "lineNumber": 413
          },
          {
            "text": "               (v.APPROVAL_STATUS === 'PENDING' || v.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 414
          },
          {
            "text": "      });",
            "lineNumber": 415
          },
          {
            "text": "      ",
            "lineNumber": 416
          },
          {
            "text": "      if (holidayWorkApp || vacation) {",
            "lineNumber": 417
          },
          {
            "text": "        dailyData.push({",
            "lineNumber": 418
          },
          {
            "text": "          WORK_DATE: dateStr,",
            "lineNumber": 419
          },
          {
            "text": "          ATTENDANCE_ID: null,",
            "lineNumber": 420
          },
          {
            "text": "          CLOCK_IN_TIME: null,",
            "lineNumber": 421
          },
          {
            "text": "          CLOCK_OUT_TIME: null,",
            "lineNumber": 422
          },
          {
            "text": "          breakTimes: [],",
            "lineNumber": 423
          },
          {
            "text": "          officialOutings: [],",
            "lineNumber": 424
          },
          {
            "text": "          workHours: [],",
            "lineNumber": 425
          },
          {
            "text": "          holidayWorkApplication: holidayWorkApp || null,",
            "lineNumber": 426
          },
          {
            "text": "          vacation: vacation || null",
            "lineNumber": 427
          },
          {
            "text": "        });",
            "lineNumber": 428
          },
          {
            "text": "      }",
            "lineNumber": 429
          },
          {
            "text": "    }",
            "lineNumber": 430
          },
          {
            "text": "  }",
            "lineNumber": 431
          },
          {
            "text": "  ",
            "lineNumber": 432
          },
          {
            "text": "  // 月次サマリーを計算",
            "lineNumber": 433
          },
          {
            "text": "  const todayStr = getTodayJST();",
            "lineNumber": 434
          },
          {
            "text": "  const isCurrentMonth = parseInt(year) === new Date().getFullYear() &amp;&amp; parseInt(month) === new Date().getMonth() + 1;",
            "lineNumber": 435
          },
          {
            "text": "  let cutoffDate = endDate;",
            "lineNumber": 436
          },
          {
            "lineNumber": 437
          },
          {
            "text": "  if (isCurrentMonth) {",
            "lineNumber": 438
          },
          {
            "text": "    cutoffDate = todayStr;",
            "lineNumber": 439
          },
          {
            "text": "  }",
            "lineNumber": 440
          },
          {
            "lineNumber": 441
          },
          {
            "text": "  // 当日退勤していない場合は前日までの過不足時間を計算",
            "lineNumber": 442
          },
          {
            "text": ";",
            "lineNumber": 551
          }
        ]
      },
      "score": 0.40961119532585144
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1515
          },
          "endPosition": {
            "line": 1551
          }
        },
        "contents": "    async loadApplicationStatuses() {\n      // 各申請タイプの申請状態を取得\n      const applicationTypes = [\n        { key: 'dailyConfirmation', apiType: 'DAILY_CONFIRMATION' },\n        { key: 'vacation', apiType: 'VACATION' },\n        { key: 'holidayWork', apiType: 'HOLIDAY_WORK' },\n        { key: 'overtime', apiType: 'OVERTIME' },\n        { key: 'earlyWork', apiType: 'EARLY_WORK' },\n        { key: 'transfer', apiType: 'TRANSFER' }\n      ]\n      \n      for (const appType of applicationTypes) {\n        // 初期申請状態が指定されている場合は、APIを呼び出さずにそれを使用\n        if (this.initialApplicationType === appType.key &amp;&amp; this.initialApplicationStatus) {\n          this.applicationStatuses[appType.key] = this.initialApplicationStatus\n          continue\n        }\n        \n        try {\n          const response = await getApplicationStatus(this.employeeId, appType.apiType, this.targetDate)\n          if (response.success) {\n            this.applicationStatuses[appType.key] = response.status || 'NOT_SUBMITTED'\n            this.applicationIds[appType.key] = response.applicationId || null\n          }\n        } catch (error) {\n          console.error(&#96;${appType.key}申請状態取得エラー:&#96;, error)\n          // エラー時はNOT_SUBMITTEDとして扱う\n          this.applicationStatuses[appType.key] = 'NOT_SUBMITTED'\n          this.applicationIds[appType.key] = null\n        }\n      }\n    },\n    \n    async loadCompensatoryLeaveBalance() {\n      try {\n        // 代休取得可能日数は、承認済みまたは申請中の休日出勤申請の日数をカウント",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    async loadApplicationStatuses() {",
            "lineNumber": 1516
          },
          {
            "text": "      // 各申請タイプの申請状態を取得",
            "lineNumber": 1517
          },
          {
            "text": "      const applicationTypes = [",
            "lineNumber": 1518
          },
          {
            "text": "        { key: 'dailyConfirmation', apiType: 'DAILY_CONFIRMATION' },",
            "lineNumber": 1519
          },
          {
            "text": "        { key: 'vacation', apiType: 'VACATION' },",
            "lineNumber": 1520
          },
          {
            "text": "        { key: 'holidayWork', apiType: 'HOLIDAY_WORK' },",
            "lineNumber": 1521
          },
          {
            "text": "        { key: 'overtime', apiType: 'OVERTIME' },",
            "lineNumber": 1522
          },
          {
            "text": "        { key: 'earlyWork', apiType: 'EARLY_WORK' },",
            "lineNumber": 1523
          },
          {
            "text": "        { key: 'transfer', apiType: 'TRANSFER' }",
            "lineNumber": 1524
          },
          {
            "text": "      ]",
            "lineNumber": 1525
          },
          {
            "text": "      ",
            "lineNumber": 1526
          },
          {
            "text": "      for (const appType of applicationTypes) {",
            "lineNumber": 1527
          },
          {
            "text": "        // 初期申請状態が指定されている場合は、APIを呼び出さずにそれを使用",
            "lineNumber": 1528
          },
          {
            "text": "        if (this.initialApplicationType === appType.key &amp;&amp; this.initialApplicationStatus) {",
            "lineNumber": 1529
          },
          {
            "text": "          this.applicationStatuses[appType.key] = this.initialApplicationStatus",
            "lineNumber": 1530
          },
          {
            "text": "          continue",
            "lineNumber": 1531
          },
          {
            "text": "        }",
            "lineNumber": 1532
          },
          {
            "text": "        ",
            "lineNumber": 1533
          },
          {
            "text": "        try {",
            "lineNumber": 1534
          },
          {
            "text": "          const response = await getApplicationStatus(this.employeeId, appType.apiType, this.targetDate)",
            "lineNumber": 1535
          },
          {
            "text": "          if (response.success) {",
            "lineNumber": 1536
          },
          {
            "text": "            this.applicationStatuses[appType.key] = response.status || 'NOT_SUBMITTED'",
            "lineNumber": 1537
          },
          {
            "text": "            this.applicationIds[appType.key] = response.applicationId || null",
            "lineNumber": 1538
          },
          {
            "text": "          }",
            "lineNumber": 1539
          },
          {
            "text": "        } catch (error) {",
            "lineNumber": 1540
          },
          {
            "text": "          console.error(&#96;${appType.key}申請状態取得エラー:&#96;, error)",
            "lineNumber": 1541
          },
          {
            "text": "          // エラー時はNOT_SUBMITTEDとして扱う",
            "lineNumber": 1542
          },
          {
            "text": "          this.applicationStatuses[appType.key] = 'NOT_SUBMITTED'",
            "lineNumber": 1543
          },
          {
            "text": "          this.applicationIds[appType.key] = null",
            "lineNumber": 1544
          },
          {
            "text": "        }",
            "lineNumber": 1545
          },
          {
            "text": "      }",
            "lineNumber": 1546
          },
          {
            "text": "    },",
            "lineNumber": 1547
          },
          {
            "text": "    ",
            "lineNumber": 1548
          },
          {
            "text": "    async loadCompensatoryLeaveBalance() {",
            "lineNumber": 1549
          },
          {
            "text": "      try {",
            "lineNumber": 1550
          },
          {
            "text": "        // 代休取得可能日数は、承認済みまたは申請中の休日出勤申請の日数をカウント",
            "lineNumber": 1551
          }
        ]
      },
      "score": 0.3930785059928894
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\monthlySummaryService.js",
        "range": {
          "startPosition": {
            "line": 25
          },
          "endPosition": {
            "line": 416,
            "column": 1
          }
        },
        "contents": "const getMonthlySummary = async \n\n  let previousCumulativeWorkHours = 0;\n  \n  for (let day = 1; day &lt;= daysInMonth; day++) {\n    const workDate = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;\n    const attendance = attendanceRows.find(row =&gt; normalizeDate(row.WORK_DATE) === workDate);\n    \n    // 祝日情報を取得\n    const dateObj = new Date(year, month - 1, day);\n    let holidayName = null;\n    try {\n      // isHolidayはbooleanを返すので、betweenで祝日情報を取得\n      const holidays = HolidayJp.between(dateObj, dateObj);\n      if (holidays &amp;&amp; holidays.length &gt; 0) {\n        holidayName = holidays[0].name || null;\n      }\n    } catch (error) {\n      console.error(&#96;祝日判定エラー (${workDate}):&#96;, error);\n      holidayName = null;\n    }\n    \n    // その日の休暇情報を取得（承認済みまたは申請中の休暇）\n    const dayVacation = vacations.find(v =&gt; {\n      const startDate = normalizeDate(v.START_DATE);\n      const endDate = normalizeDate(v.END_DATE);\n      return workDate &gt;= startDate &amp;&amp; workDate &lt;= endDate &amp;&amp; \n             (v.APPROVAL_STATUS === 'APPROVED' || v.APPROVAL_STATUS === 'PENDING');\n    });\n    let vacationTypeName = null;\n    if (dayVacation &amp;&amp; dayVacation.VACATION_TYPE_CODE) {\n      vacationTypeName = vacationTypeMap[dayVacation.VACATION_TYPE_CODE] || null;\n    }\n    \n    let breakTimeTotal = 0;\n    let actualWorkHours = 0;\n    let overtimeHours = 0;\n    // 日次の法定時間内残業・法定時間外残業（分単位）を保存\n    let withinLegalOvertimeMinutes = 0;\n    let overLegalOvertimeMinutes = 0;\n    \n    if (attendance) {\n      const breakTimes = await breakTimeModel.getBreakTimes;\n  }\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 26,
                "column": 1
              },
              "endPosition": {
                "line": 26,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 26,
                "column": 7
              },
              "endPosition": {
                "line": 26,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getMonthlySummary = async ",
            "lineNumber": 26
          },
          {
            "lineNumber": 56
          },
          {
            "text": "  let previousCumulativeWorkHours = 0;",
            "lineNumber": 57
          },
          {
            "text": "  ",
            "lineNumber": 58
          },
          {
            "text": "  for (let day = 1; day &lt;= daysInMonth; day++) {",
            "lineNumber": 59
          },
          {
            "text": "    const workDate = &#96;${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}&#96;;",
            "lineNumber": 60
          },
          {
            "text": "    const attendance = attendanceRows.find(row =&gt; normalizeDate(row.WORK_DATE) === workDate);",
            "lineNumber": 61
          },
          {
            "text": "    ",
            "lineNumber": 62
          },
          {
            "text": "    // 祝日情報を取得",
            "lineNumber": 63
          },
          {
            "text": "    const dateObj = new Date(year, month - 1, day);",
            "lineNumber": 64
          },
          {
            "text": "    let holidayName = null;",
            "lineNumber": 65
          },
          {
            "text": "    try {",
            "lineNumber": 66
          },
          {
            "text": "      // isHolidayはbooleanを返すので、betweenで祝日情報を取得",
            "lineNumber": 67
          },
          {
            "text": "      const holidays = HolidayJp.between(dateObj, dateObj);",
            "lineNumber": 68
          },
          {
            "text": "      if (holidays &amp;&amp; holidays.length &gt; 0) {",
            "lineNumber": 69
          },
          {
            "text": "        holidayName = holidays[0].name || null;",
            "lineNumber": 70
          },
          {
            "text": "      }",
            "lineNumber": 71
          },
          {
            "text": "    } catch (error) {",
            "lineNumber": 72
          },
          {
            "text": "      console.error(&#96;祝日判定エラー (${workDate}):&#96;, error);",
            "lineNumber": 73
          },
          {
            "text": "      holidayName = null;",
            "lineNumber": 74
          },
          {
            "text": "    }",
            "lineNumber": 75
          },
          {
            "text": "    ",
            "lineNumber": 76
          },
          {
            "text": "    // その日の休暇情報を取得（承認済みまたは申請中の休暇）",
            "lineNumber": 77
          },
          {
            "text": "    const dayVacation = vacations.find(v =&gt; {",
            "lineNumber": 78
          },
          {
            "text": "      const startDate = normalizeDate(v.START_DATE);",
            "lineNumber": 79
          },
          {
            "text": "      const endDate = normalizeDate(v.END_DATE);",
            "lineNumber": 80
          },
          {
            "text": "      return workDate &gt;= startDate &amp;&amp; workDate &lt;= endDate &amp;&amp; ",
            "lineNumber": 81
          },
          {
            "text": "             (v.APPROVAL_STATUS === 'APPROVED' || v.APPROVAL_STATUS === 'PENDING');",
            "lineNumber": 82
          },
          {
            "text": "    });",
            "lineNumber": 83
          },
          {
            "text": "    let vacationTypeName = null;",
            "lineNumber": 84
          },
          {
            "text": "    if (dayVacation &amp;&amp; dayVacation.VACATION_TYPE_CODE) {",
            "lineNumber": 85
          },
          {
            "text": "      vacationTypeName = vacationTypeMap[dayVacation.VACATION_TYPE_CODE] || null;",
            "lineNumber": 86
          },
          {
            "text": "    }",
            "lineNumber": 87
          },
          {
            "text": "    ",
            "lineNumber": 88
          },
          {
            "text": "    let breakTimeTotal = 0;",
            "lineNumber": 89
          },
          {
            "text": "    let actualWorkHours = 0;",
            "lineNumber": 90
          },
          {
            "text": "    let overtimeHours = 0;",
            "lineNumber": 91
          },
          {
            "text": "    // 日次の法定時間内残業・法定時間外残業（分単位）を保存",
            "lineNumber": 92
          },
          {
            "text": "    let withinLegalOvertimeMinutes = 0;",
            "lineNumber": 93
          },
          {
            "text": "    let overLegalOvertimeMinutes = 0;",
            "lineNumber": 94
          },
          {
            "text": "    ",
            "lineNumber": 95
          },
          {
            "text": "    if (attendance) {",
            "lineNumber": 96
          },
          {
            "text": "      const breakTimes = await breakTimeModel.getBreakTimes;",
            "lineNumber": 97
          },
          {
            "text": "  }",
            "lineNumber": 206
          },
          {
            "text": ";",
            "lineNumber": 417
          }
        ]
      },
      "score": 0.38722729682922363
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\applicationModel.js",
        "range": {
          "startPosition": {
            "line": 577,
            "column": 2
          },
          "endPosition": {
            "line": 672,
            "column": 1
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得（その他の申請：休日出勤、残業、早朝勤務、振替）\n * @param {string} employeeId - 従業員ID\n * @param {string} applicationType - 申請種別\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴\n */\nconst getApplicationInfo = async (employeeId, applicationType, targetDate) =&gt; {\n  // 全ての申請履歴を取得（PENDING, APPROVED, NOT_SUBMITTEDを含む）\n  const query = &#96;\n    SELECT \n      ah.APPLICATION_ID,\n      DATE_FORMAT(ah.CREATED_AT, '%Y/%m/%d %H:%i') AS APPLICATION_DATE,\n      ah.CREATED_AT,\n      ah.APPROVAL_STATUS,\n      DATE_FORMAT(ah.UPDATED_AT, '%Y/%m/%d %H:%i') AS UPDATED_DATE,\n      e.EMPLOYEE_NAME AS ACTOR_NAME\n    FROM APPLICATION_HISTORY ah\n    LEFT JOIN EMPLOYEE e ON ah.EMPLOYEE_ID = e.EMPLOYEE_ID\n    WHERE ah.EMPLOYEE_ID = ? \n      AND ah.APPLICATION_TYPE = ?\n      AND ah.TARGET_START_DATE &lt;= ?\n      AND ah.TARGET_END_DATE &gt;= ?\n      AND ah.APPROVAL_STATUS IN ('PENDING', 'APPROVED', 'NOT_SUBMITTED')\n    ORDER BY ah.CREATED_AT ASC\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, applicationType, targetDate, targetDate]);\n  if (rows.length === 0) {\n    return null;\n  }\n  \n  // 最新の申請（PENDINGまたはAPPROVED）を取得\n  // PENDINGまたはAPPROVEDの申請をフィルタして、CREATED_ATが最新のものを取得\n  const validApplications = rows.filter(r =&gt; r.APPROVAL_STATUS === 'PENDING' || r.APPROVAL_STATUS === 'APPROVED');\n  if (validApplications.length === 0) {\n    return null;\n  }\n  // CREATED_ATでソートして最新のものを取得\n  const latestApplication = validApplications.sort((a, b) =&gt; new Date(b.CREATED_AT) - new Date(a.CREATED_AT))[0];\n  if (!latestApplication) {\n    return null;\n  }\n  \n  // 承認履歴を構築（時系列順）\n  const history = [];\n  let seqNo = 1;\n  \n  for (let i = 0; i &lt; rows.length; i++) {\n    const app = rows[i];\n  }\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 580
          },
          {
            "text": " * 申請情報と承認履歴を取得（その他の申請：休日出勤、残業、早朝勤務、振替）",
            "lineNumber": 581
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 582
          },
          {
            "text": " * @param {string} applicationType - 申請種別",
            "lineNumber": 583
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 584
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴",
            "lineNumber": 585
          },
          {
            "text": " */",
            "lineNumber": 586
          },
          {
            "text": "const getApplicationInfo = async (employeeId, applicationType, targetDate) =&gt; {",
            "lineNumber": 587
          },
          {
            "text": "  // 全ての申請履歴を取得（PENDING, APPROVED, NOT_SUBMITTEDを含む）",
            "lineNumber": 588
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 589
          },
          {
            "text": "    SELECT ",
            "lineNumber": 590
          },
          {
            "text": "      ah.APPLICATION_ID,",
            "lineNumber": 591
          },
          {
            "text": "      DATE_FORMAT(ah.CREATED_AT, '%Y/%m/%d %H:%i') AS APPLICATION_DATE,",
            "lineNumber": 592
          },
          {
            "text": "      ah.CREATED_AT,",
            "lineNumber": 593
          },
          {
            "text": "      ah.APPROVAL_STATUS,",
            "lineNumber": 594
          },
          {
            "text": "      DATE_FORMAT(ah.UPDATED_AT, '%Y/%m/%d %H:%i') AS UPDATED_DATE,",
            "lineNumber": 595
          },
          {
            "text": "      e.EMPLOYEE_NAME AS ACTOR_NAME",
            "lineNumber": 596
          },
          {
            "text": "    FROM APPLICATION_HISTORY ah",
            "lineNumber": 597
          },
          {
            "text": "    LEFT JOIN EMPLOYEE e ON ah.EMPLOYEE_ID = e.EMPLOYEE_ID",
            "lineNumber": 598
          },
          {
            "text": "    WHERE ah.EMPLOYEE_ID = ? ",
            "lineNumber": 599
          },
          {
            "text": "      AND ah.APPLICATION_TYPE = ?",
            "lineNumber": 600
          },
          {
            "text": "      AND ah.TARGET_START_DATE &lt;= ?",
            "lineNumber": 601
          },
          {
            "text": "      AND ah.TARGET_END_DATE &gt;= ?",
            "lineNumber": 602
          },
          {
            "text": "      AND ah.APPROVAL_STATUS IN ('PENDING', 'APPROVED', 'NOT_SUBMITTED')",
            "lineNumber": 603
          },
          {
            "text": "    ORDER BY ah.CREATED_AT ASC",
            "lineNumber": 604
          },
          {
            "text": "  &#96;;",
            "lineNumber": 605
          },
          {
            "text": "  ",
            "lineNumber": 606
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, applicationType, targetDate, targetDate]);",
            "lineNumber": 607
          },
          {
            "text": "  if (rows.length === 0) {",
            "lineNumber": 608
          },
          {
            "text": "    return null;",
            "lineNumber": 609
          },
          {
            "text": "  }",
            "lineNumber": 610
          },
          {
            "text": "  ",
            "lineNumber": 611
          },
          {
            "text": "  // 最新の申請（PENDINGまたはAPPROVED）を取得",
            "lineNumber": 612
          },
          {
            "text": "  // PENDINGまたはAPPROVEDの申請をフィルタして、CREATED_ATが最新のものを取得",
            "lineNumber": 613
          },
          {
            "text": "  const validApplications = rows.filter(r =&gt; r.APPROVAL_STATUS === 'PENDING' || r.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 614
          },
          {
            "text": "  if (validApplications.length === 0) {",
            "lineNumber": 615
          },
          {
            "text": "    return null;",
            "lineNumber": 616
          },
          {
            "text": "  }",
            "lineNumber": 617
          },
          {
            "text": "  // CREATED_ATでソートして最新のものを取得",
            "lineNumber": 618
          },
          {
            "text": "  const latestApplication = validApplications.sort((a, b) =&gt; new Date(b.CREATED_AT) - new Date(a.CREATED_AT))[0];",
            "lineNumber": 619
          },
          {
            "text": "  if (!latestApplication) {",
            "lineNumber": 620
          },
          {
            "text": "    return null;",
            "lineNumber": 621
          },
          {
            "text": "  }",
            "lineNumber": 622
          },
          {
            "text": "  ",
            "lineNumber": 623
          },
          {
            "text": "  // 承認履歴を構築（時系列順）",
            "lineNumber": 624
          },
          {
            "text": "  const history = [];",
            "lineNumber": 625
          },
          {
            "text": "  let seqNo = 1;",
            "lineNumber": 626
          },
          {
            "text": "  ",
            "lineNumber": 627
          },
          {
            "text": "  for (let i = 0; i &lt; rows.length; i++) {",
            "lineNumber": 628
          },
          {
            "text": "    const app = rows[i];",
            "lineNumber": 629
          },
          {
            "text": "  }",
            "lineNumber": 665
          },
          {
            "text": ";",
            "lineNumber": 673
          }
        ]
      },
      "score": 0.3860825002193451
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1916
          },
          "endPosition": {
            "line": 1954
          }
        },
        "contents": "    async loadApplicationStatus(applicationType) {\n      // 初期申請状態が指定されている場合は、APIを呼び出さずにそれを使用\n      if (this.initialApplicationType === applicationType &amp;&amp; this.initialApplicationStatus) {\n        this.applicationStatuses[applicationType] = this.initialApplicationStatus\n        // applicationIdも設定する必要がある場合は、ここで設定\n        // ただし、initialApplicationStatusからはapplicationIdが取得できないため、\n        // 必要に応じてAPIを呼び出すか、TimesheetScreenから渡す必要がある\n        return\n      }\n      \n      // 申請タイプをAPIタイプに変換\n      const apiTypeMap = {\n        dailyConfirmation: 'DAILY_CONFIRMATION',\n        vacation: 'VACATION',\n        holidayWork: 'HOLIDAY_WORK',\n        overtime: 'OVERTIME',\n        earlyWork: 'EARLY_WORK',\n        transfer: 'TRANSFER'\n      }\n      \n      const apiType = apiTypeMap[applicationType]\n      if (!apiType) return\n      \n      try {\n        const response = await getApplicationStatus(this.employeeId, apiType, this.targetDate)\n        if (response.success) {\n          this.applicationStatuses[applicationType] = response.status || 'NOT_SUBMITTED'\n          this.applicationIds[applicationType] = response.applicationId || null\n        }\n      } catch (error) {\n        console.error(&#96;${applicationType}申請状態取得エラー:&#96;, error)\n        this.applicationStatuses[applicationType] = 'NOT_SUBMITTED'\n        this.applicationIds[applicationType] = null\n      }\n    },\n    \n    async loadHolidayWorkApplicationData() {\n      // 休日出勤申請データを読み込む（申請中または承認済みの場合）",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    async loadApplicationStatus(applicationType) {",
            "lineNumber": 1917
          },
          {
            "text": "      // 初期申請状態が指定されている場合は、APIを呼び出さずにそれを使用",
            "lineNumber": 1918
          },
          {
            "text": "      if (this.initialApplicationType === applicationType &amp;&amp; this.initialApplicationStatus) {",
            "lineNumber": 1919
          },
          {
            "text": "        this.applicationStatuses[applicationType] = this.initialApplicationStatus",
            "lineNumber": 1920
          },
          {
            "text": "        // applicationIdも設定する必要がある場合は、ここで設定",
            "lineNumber": 1921
          },
          {
            "text": "        // ただし、initialApplicationStatusからはapplicationIdが取得できないため、",
            "lineNumber": 1922
          },
          {
            "text": "        // 必要に応じてAPIを呼び出すか、TimesheetScreenから渡す必要がある",
            "lineNumber": 1923
          },
          {
            "text": "        return",
            "lineNumber": 1924
          },
          {
            "text": "      }",
            "lineNumber": 1925
          },
          {
            "text": "      ",
            "lineNumber": 1926
          },
          {
            "text": "      // 申請タイプをAPIタイプに変換",
            "lineNumber": 1927
          },
          {
            "text": "      const apiTypeMap = {",
            "lineNumber": 1928
          },
          {
            "text": "        dailyConfirmation: 'DAILY_CONFIRMATION',",
            "lineNumber": 1929
          },
          {
            "text": "        vacation: 'VACATION',",
            "lineNumber": 1930
          },
          {
            "text": "        holidayWork: 'HOLIDAY_WORK',",
            "lineNumber": 1931
          },
          {
            "text": "        overtime: 'OVERTIME',",
            "lineNumber": 1932
          },
          {
            "text": "        earlyWork: 'EARLY_WORK',",
            "lineNumber": 1933
          },
          {
            "text": "        transfer: 'TRANSFER'",
            "lineNumber": 1934
          },
          {
            "text": "      }",
            "lineNumber": 1935
          },
          {
            "text": "      ",
            "lineNumber": 1936
          },
          {
            "text": "      const apiType = apiTypeMap[applicationType]",
            "lineNumber": 1937
          },
          {
            "text": "      if (!apiType) return",
            "lineNumber": 1938
          },
          {
            "text": "      ",
            "lineNumber": 1939
          },
          {
            "text": "      try {",
            "lineNumber": 1940
          },
          {
            "text": "        const response = await getApplicationStatus(this.employeeId, apiType, this.targetDate)",
            "lineNumber": 1941
          },
          {
            "text": "        if (response.success) {",
            "lineNumber": 1942
          },
          {
            "text": "          this.applicationStatuses[applicationType] = response.status || 'NOT_SUBMITTED'",
            "lineNumber": 1943
          },
          {
            "text": "          this.applicationIds[applicationType] = response.applicationId || null",
            "lineNumber": 1944
          },
          {
            "text": "        }",
            "lineNumber": 1945
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1946
          },
          {
            "text": "        console.error(&#96;${applicationType}申請状態取得エラー:&#96;, error)",
            "lineNumber": 1947
          },
          {
            "text": "        this.applicationStatuses[applicationType] = 'NOT_SUBMITTED'",
            "lineNumber": 1948
          },
          {
            "text": "        this.applicationIds[applicationType] = null",
            "lineNumber": 1949
          },
          {
            "text": "      }",
            "lineNumber": 1950
          },
          {
            "text": "    },",
            "lineNumber": 1951
          },
          {
            "text": "    ",
            "lineNumber": 1952
          },
          {
            "text": "    async loadHolidayWorkApplicationData() {",
            "lineNumber": 1953
          },
          {
            "text": "      // 休日出勤申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 1954
          }
        ]
      },
      "score": 0.38062143325805664
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1480
          },
          "endPosition": {
            "line": 1517
          }
        },
        "contents": "      }\n    },\n    \n    async loadPaidLeaveBalance() {\n      try {\n        const response = await fetch(\n          &#96;http://localhost:3000/api/application/vacation/balance?employeeId=${this.employeeId}&amp;vacationTypeCode=PAID_LEAVE&#96;\n        )\n        const data = await response.json()\n        if (data.success) {\n          this.paidLeaveBalance = data.balance || 0\n        }\n      } catch (error) {\n        console.error('有給残日数取得エラー:', error)\n      }\n    },\n    \n    async loadHolidayWorkStatus() {\n      try {\n        const response = await getHolidayWorkStatus(this.employeeId, this.targetDate)\n        if (response.success) {\n          // 対象日の休日出勤申請または過去の休日出勤申請がある場合、代休を表示可能\n          this.hasHolidayWorkApplication = response.hasHolidayWorkApplication || false\n          // 休日出勤申請がある場合、代休取得可能日数を取得\n          if (this.hasHolidayWorkApplication) {\n            await this.loadCompensatoryLeaveBalance()\n          }\n        }\n      } catch (error) {\n        console.error('休日出勤申請状態取得エラー:', error)\n        // エラー時はfalseとして扱う\n        this.hasHolidayWorkApplication = false\n      }\n    },\n    \n    async loadApplicationStatuses() {\n      // 各申請タイプの申請状態を取得",
        "signatures": {},
        "detailedLines": [
          {
            "text": "      }",
            "lineNumber": 1481
          },
          {
            "text": "    },",
            "lineNumber": 1482
          },
          {
            "text": "    ",
            "lineNumber": 1483
          },
          {
            "text": "    async loadPaidLeaveBalance() {",
            "lineNumber": 1484
          },
          {
            "text": "      try {",
            "lineNumber": 1485
          },
          {
            "text": "        const response = await fetch(",
            "lineNumber": 1486
          },
          {
            "text": "          &#96;http://localhost:3000/api/application/vacation/balance?employeeId=${this.employeeId}&amp;vacationTypeCode=PAID_LEAVE&#96;",
            "lineNumber": 1487
          },
          {
            "text": "        )",
            "lineNumber": 1488
          },
          {
            "text": "        const data = await response.json()",
            "lineNumber": 1489
          },
          {
            "text": "        if (data.success) {",
            "lineNumber": 1490
          },
          {
            "text": "          this.paidLeaveBalance = data.balance || 0",
            "lineNumber": 1491
          },
          {
            "text": "        }",
            "lineNumber": 1492
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1493
          },
          {
            "text": "        console.error('有給残日数取得エラー:', error)",
            "lineNumber": 1494
          },
          {
            "text": "      }",
            "lineNumber": 1495
          },
          {
            "text": "    },",
            "lineNumber": 1496
          },
          {
            "text": "    ",
            "lineNumber": 1497
          },
          {
            "text": "    async loadHolidayWorkStatus() {",
            "lineNumber": 1498
          },
          {
            "text": "      try {",
            "lineNumber": 1499
          },
          {
            "text": "        const response = await getHolidayWorkStatus(this.employeeId, this.targetDate)",
            "lineNumber": 1500
          },
          {
            "text": "        if (response.success) {",
            "lineNumber": 1501
          },
          {
            "text": "          // 対象日の休日出勤申請または過去の休日出勤申請がある場合、代休を表示可能",
            "lineNumber": 1502
          },
          {
            "text": "          this.hasHolidayWorkApplication = response.hasHolidayWorkApplication || false",
            "lineNumber": 1503
          },
          {
            "text": "          // 休日出勤申請がある場合、代休取得可能日数を取得",
            "lineNumber": 1504
          },
          {
            "text": "          if (this.hasHolidayWorkApplication) {",
            "lineNumber": 1505
          },
          {
            "text": "            await this.loadCompensatoryLeaveBalance()",
            "lineNumber": 1506
          },
          {
            "text": "          }",
            "lineNumber": 1507
          },
          {
            "text": "        }",
            "lineNumber": 1508
          },
          {
            "text": "      } catch (error) {",
            "lineNumber": 1509
          },
          {
            "text": "        console.error('休日出勤申請状態取得エラー:', error)",
            "lineNumber": 1510
          },
          {
            "text": "        // エラー時はfalseとして扱う",
            "lineNumber": 1511
          },
          {
            "text": "        this.hasHolidayWorkApplication = false",
            "lineNumber": 1512
          },
          {
            "text": "      }",
            "lineNumber": 1513
          },
          {
            "text": "    },",
            "lineNumber": 1514
          },
          {
            "text": "    ",
            "lineNumber": 1515
          },
          {
            "text": "    async loadApplicationStatuses() {",
            "lineNumber": 1516
          },
          {
            "text": "      // 各申請タイプの申請状態を取得",
            "lineNumber": 1517
          }
        ]
      },
      "score": 0.37721145153045654
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1729
          },
          "endPosition": {
            "line": 1760,
            "column": 12
          }
        },
        "contents": "    getCancelButtonLabel(applicationType) {\n      const status = this.applicationStatuses[applicationType]\n      if (status === 'PENDING') {\n        return '申請取消'\n      } else if (status === 'APPROVED') {\n        return '承認取消'\n      }\n      return '取消'\n    },\n    \n    \n    // 申請情報を取得\n    async loadApplicationInfo(applicationType) {\n      try {\n        const apiTypeMap = {\n          dailyConfirmation: 'DAILY_CONFIRMATION',\n          vacation: 'VACATION',\n          holidayWork: 'HOLIDAY_WORK',\n          overtime: 'OVERTIME',\n          earlyWork: 'EARLY_WORK',\n          transfer: 'TRANSFER'\n        }\n        \n        const apiType = apiTypeMap[applicationType]\n        if (!apiType) return\n        \n        // 申請情報取得APIを呼び出し\n        const response = await getApplicationInfo(this.employeeId, apiType, this.targetDate)\n        \n        if (response.success) {\n          if (response.applicationDate) {\n            ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    getCancelButtonLabel(applicationType) {",
            "lineNumber": 1730
          },
          {
            "text": "      const status = this.applicationStatuses[applicationType]",
            "lineNumber": 1731
          },
          {
            "text": "      if (status === 'PENDING') {",
            "lineNumber": 1732
          },
          {
            "text": "        return '申請取消'",
            "lineNumber": 1733
          },
          {
            "text": "      } else if (status === 'APPROVED') {",
            "lineNumber": 1734
          },
          {
            "text": "        return '承認取消'",
            "lineNumber": 1735
          },
          {
            "text": "      }",
            "lineNumber": 1736
          },
          {
            "text": "      return '取消'",
            "lineNumber": 1737
          },
          {
            "text": "    },",
            "lineNumber": 1738
          },
          {
            "text": "    ",
            "lineNumber": 1739
          },
          {
            "text": "    ",
            "lineNumber": 1740
          },
          {
            "text": "    // 申請情報を取得",
            "lineNumber": 1741
          },
          {
            "text": "    async loadApplicationInfo(applicationType) {",
            "lineNumber": 1742
          },
          {
            "text": "      try {",
            "lineNumber": 1743
          },
          {
            "text": "        const apiTypeMap = {",
            "lineNumber": 1744
          },
          {
            "text": "          dailyConfirmation: 'DAILY_CONFIRMATION',",
            "lineNumber": 1745
          },
          {
            "text": "          vacation: 'VACATION',",
            "lineNumber": 1746
          },
          {
            "text": "          holidayWork: 'HOLIDAY_WORK',",
            "lineNumber": 1747
          },
          {
            "text": "          overtime: 'OVERTIME',",
            "lineNumber": 1748
          },
          {
            "text": "          earlyWork: 'EARLY_WORK',",
            "lineNumber": 1749
          },
          {
            "text": "          transfer: 'TRANSFER'",
            "lineNumber": 1750
          },
          {
            "text": "        }",
            "lineNumber": 1751
          },
          {
            "text": "        ",
            "lineNumber": 1752
          },
          {
            "text": "        const apiType = apiTypeMap[applicationType]",
            "lineNumber": 1753
          },
          {
            "text": "        if (!apiType) return",
            "lineNumber": 1754
          },
          {
            "text": "        ",
            "lineNumber": 1755
          },
          {
            "text": "        // 申請情報取得APIを呼び出し",
            "lineNumber": 1756
          },
          {
            "text": "        const response = await getApplicationInfo(this.employeeId, apiType, this.targetDate)",
            "lineNumber": 1757
          },
          {
            "text": "        ",
            "lineNumber": 1758
          },
          {
            "text": "        if (response.success) {",
            "lineNumber": 1759
          },
          {
            "text": "          if (response.applicationDate) {",
            "lineNumber": 1760
          },
          {
            "text": "            ",
            "lineNumber": 1761
          }
        ]
      },
      "score": 0.37360748648643494
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\services\\api.js",
        "range": {
          "startPosition": {
            "line": 207,
            "column": 1
          },
          "endPosition": {
            "line": 230,
            "column": 3
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string} targetDate 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object&gt;} 申請情報データ\n */\nexport async function getApplicationInfo(employeeId, applicationType, targetDate) {\n  const endpoint = &#96;/application/application-info?employeeId=${employeeId}&amp;applicationType=${applicationType}&amp;targetDate=${targetDate}&#96;\n  return await apiRequest(endpoint, { method: 'GET' })\n}\n\n/**\n * 申請を取り消す。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）\n * @param {string|number} applicationId 申請ID（日次確定の場合は不要）\n * @param {string} targetDate 対象日（YYYY-MM-DD形式、日次確定の場合のみ必要）\n * @returns {Promise&lt;Object&gt;} レスポンスデータ\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 210
          },
          {
            "text": " * 申請情報と承認履歴を取得する。",
            "lineNumber": 211
          },
          {
            "text": " *",
            "lineNumber": 212
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 213
          },
          {
            "text": " * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 214
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式）",
            "lineNumber": 215
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 申請情報データ",
            "lineNumber": 216
          },
          {
            "text": " */",
            "lineNumber": 217
          },
          {
            "text": "export async function getApplicationInfo(employeeId, applicationType, targetDate) {",
            "lineNumber": 218,
            "isSignature": true
          },
          {
            "text": "  const endpoint = &#96;/application/application-info?employeeId=${employeeId}&amp;applicationType=${applicationType}&amp;targetDate=${targetDate}&#96;",
            "lineNumber": 219
          },
          {
            "text": "  return await apiRequest(endpoint, { method: 'GET' })",
            "lineNumber": 220
          },
          {
            "text": "}",
            "lineNumber": 221,
            "isSignature": true
          },
          {
            "lineNumber": 222
          },
          {
            "text": "/**",
            "lineNumber": 223
          },
          {
            "text": " * 申請を取り消す。",
            "lineNumber": 224
          },
          {
            "text": " *",
            "lineNumber": 225
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 226
          },
          {
            "text": " * @param {string} applicationType 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）",
            "lineNumber": 227
          },
          {
            "text": " * @param {string|number} applicationId 申請ID（日次確定の場合は不要）",
            "lineNumber": 228
          },
          {
            "text": " * @param {string} targetDate 対象日（YYYY-MM-DD形式、日次確定の場合のみ必要）",
            "lineNumber": 229
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} レスポンスデータ",
            "lineNumber": 230
          },
          {
            "text": " */",
            "lineNumber": 231
          }
        ]
      },
      "score": 0.36999356746673584
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\applicationModel.js",
        "range": {
          "startPosition": {
            "line": 44,
            "column": 2
          },
          "endPosition": {
            "line": 73,
            "column": 3
          }
        },
        "contents": "/**\n * 休暇申請を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} startDate - 開始日（YYYY-MM-DD形式）\n * @param {string} endDate - 終了日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Array&gt;} 休暇申請の配列\n */\nconst getVacations = async (employeeId, startDate, endDate) =&gt; {\n  const query = &#96;\n    SELECT VACATION_ID, VACATION_TYPE_CODE, START_DATE, END_DATE, VACATION_DAYS, APPROVAL_STATUS, REASON, CONTACT_INFO, CREATED_AT, UPDATED_AT\n    FROM VACATION_HISTORY\n    WHERE EMPLOYEE_ID = ? \n      AND START_DATE &lt;= ? \n      AND END_DATE &gt;= ? \n      AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')\n    ORDER BY START_DATE\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, endDate, startDate]);\n  return rows;\n};\n\n/**\n * 休暇残日数を取得\n * @param {string} employeeId - 従業員ID\n * @param {string} vacationTypeCode - 休暇種別コード\n * @returns {Promise&lt;number&gt;} 残日数\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 47
          },
          {
            "text": " * 休暇申請を取得",
            "lineNumber": 48
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 49
          },
          {
            "text": " * @param {string} startDate - 開始日（YYYY-MM-DD形式）",
            "lineNumber": 50
          },
          {
            "text": " * @param {string} endDate - 終了日（YYYY-MM-DD形式）",
            "lineNumber": 51
          },
          {
            "text": " * @returns {Promise&lt;Array&gt;} 休暇申請の配列",
            "lineNumber": 52
          },
          {
            "text": " */",
            "lineNumber": 53
          },
          {
            "text": "const getVacations = async (employeeId, startDate, endDate) =&gt; {",
            "lineNumber": 54
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 55
          },
          {
            "text": "    SELECT VACATION_ID, VACATION_TYPE_CODE, START_DATE, END_DATE, VACATION_DAYS, APPROVAL_STATUS, REASON, CONTACT_INFO, CREATED_AT, UPDATED_AT",
            "lineNumber": 56
          },
          {
            "text": "    FROM VACATION_HISTORY",
            "lineNumber": 57
          },
          {
            "text": "    WHERE EMPLOYEE_ID = ? ",
            "lineNumber": 58
          },
          {
            "text": "      AND START_DATE &lt;= ? ",
            "lineNumber": 59
          },
          {
            "text": "      AND END_DATE &gt;= ? ",
            "lineNumber": 60
          },
          {
            "text": "      AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')",
            "lineNumber": 61
          },
          {
            "text": "    ORDER BY START_DATE",
            "lineNumber": 62
          },
          {
            "text": "  &#96;;",
            "lineNumber": 63
          },
          {
            "text": "  ",
            "lineNumber": 64
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, endDate, startDate]);",
            "lineNumber": 65
          },
          {
            "text": "  return rows;",
            "lineNumber": 66
          },
          {
            "text": "};",
            "lineNumber": 67
          },
          {
            "lineNumber": 68
          },
          {
            "text": "/**",
            "lineNumber": 69
          },
          {
            "text": " * 休暇残日数を取得",
            "lineNumber": 70
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 71
          },
          {
            "text": " * @param {string} vacationTypeCode - 休暇種別コード",
            "lineNumber": 72
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 残日数",
            "lineNumber": 73
          },
          {
            "text": " */",
            "lineNumber": 74
          }
        ]
      },
      "score": 0.3679358959197998
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceApplicationDialog.vue",
        "range": {
          "startPosition": {
            "line": 1995
          },
          "endPosition": {
            "line": 2053
          }
        },
        "contents": "      }\n    },\n    \n    async loadOvertimeApplicationData() {\n      // 残業申請データを読み込む（申請中または承認済みの場合）\n      // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定\n    },\n    \n    async loadEarlyWorkApplicationData() {\n      // 早朝勤務申請データを読み込む（申請中または承認済みの場合）\n      // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定\n    },\n    \n    async loadTransferApplicationData() {\n      // 振替申請データを読み込む（申請中または承認済みの場合）\n      // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定\n    },\n    \n    closeApplicationTab() {\n      this.activeApplicationTab = null\n      this.currentTab = 'menu'\n    },\n    \n    switchToMenu() {\n      // activeApplicationTabは保持したまま、表示だけメニューに切り替える\n      this.currentTab = 'menu'\n    },\n    \n    switchTab(tabName) {\n      this.currentTab = tabName\n    },\n    \n    getTabName(applicationType) {\n      const names = {\n        dailyConfirmation: '日次確定',\n        vacation: '休暇申請',\n        holidayWork: '休日出勤申請',\n        overtime: '残業申請',\n        earlyWork: '早朝勤務申請',\n        transfer: '振替申請'\n      }\n      return names[applicationType] || ''\n    },\n    \n    onVacationTypeChange() {\n      // 有給休暇が選択された場合のみ残日数を再取得\n      if (this.vacationForm.vacationType === 'PAID_LEAVE') {\n        this.loadPaidLeaveBalance()\n      }\n      // 代休が選択された場合、代休取得可能日数を取得\n      if (this.vacationForm.vacationType === 'SUBSTITUTE_HOLIDAY') {\n        this.loadCompensatoryLeaveBalance()\n      }\n    },\n    \n    async submitDailyConfirmation() {\n      // エラーメッセージをクリア\n      this.dailyConfirmationError = ''",
        "signatures": {},
        "detailedLines": [
          {
            "text": "      }",
            "lineNumber": 1996
          },
          {
            "text": "    },",
            "lineNumber": 1997
          },
          {
            "text": "    ",
            "lineNumber": 1998
          },
          {
            "text": "    async loadOvertimeApplicationData() {",
            "lineNumber": 1999
          },
          {
            "text": "      // 残業申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 2000
          },
          {
            "text": "      // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定",
            "lineNumber": 2001
          },
          {
            "text": "    },",
            "lineNumber": 2002
          },
          {
            "text": "    ",
            "lineNumber": 2003
          },
          {
            "text": "    async loadEarlyWorkApplicationData() {",
            "lineNumber": 2004
          },
          {
            "text": "      // 早朝勤務申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 2005
          },
          {
            "text": "      // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定",
            "lineNumber": 2006
          },
          {
            "text": "    },",
            "lineNumber": 2007
          },
          {
            "text": "    ",
            "lineNumber": 2008
          },
          {
            "text": "    async loadTransferApplicationData() {",
            "lineNumber": 2009
          },
          {
            "text": "      // 振替申請データを読み込む（申請中または承認済みの場合）",
            "lineNumber": 2010
          },
          {
            "text": "      // TODO: 申請データ取得APIを実装して、申請時の値をフォームに設定",
            "lineNumber": 2011
          },
          {
            "text": "    },",
            "lineNumber": 2012
          },
          {
            "text": "    ",
            "lineNumber": 2013
          },
          {
            "text": "    closeApplicationTab() {",
            "lineNumber": 2014
          },
          {
            "text": "      this.activeApplicationTab = null",
            "lineNumber": 2015
          },
          {
            "text": "      this.currentTab = 'menu'",
            "lineNumber": 2016
          },
          {
            "text": "    },",
            "lineNumber": 2017
          },
          {
            "text": "    ",
            "lineNumber": 2018
          },
          {
            "text": "    switchToMenu() {",
            "lineNumber": 2019
          },
          {
            "text": "      // activeApplicationTabは保持したまま、表示だけメニューに切り替える",
            "lineNumber": 2020
          },
          {
            "text": "      this.currentTab = 'menu'",
            "lineNumber": 2021
          },
          {
            "text": "    },",
            "lineNumber": 2022
          },
          {
            "text": "    ",
            "lineNumber": 2023
          },
          {
            "text": "    switchTab(tabName) {",
            "lineNumber": 2024
          },
          {
            "text": "      this.currentTab = tabName",
            "lineNumber": 2025
          },
          {
            "text": "    },",
            "lineNumber": 2026
          },
          {
            "text": "    ",
            "lineNumber": 2027
          },
          {
            "text": "    getTabName(applicationType) {",
            "lineNumber": 2028
          },
          {
            "text": "      const names = {",
            "lineNumber": 2029
          },
          {
            "text": "        dailyConfirmation: '日次確定',",
            "lineNumber": 2030
          },
          {
            "text": "        vacation: '休暇申請',",
            "lineNumber": 2031
          },
          {
            "text": "        holidayWork: '休日出勤申請',",
            "lineNumber": 2032
          },
          {
            "text": "        overtime: '残業申請',",
            "lineNumber": 2033
          },
          {
            "text": "        earlyWork: '早朝勤務申請',",
            "lineNumber": 2034
          },
          {
            "text": "        transfer: '振替申請'",
            "lineNumber": 2035
          },
          {
            "text": "      }",
            "lineNumber": 2036
          },
          {
            "text": "      return names[applicationType] || ''",
            "lineNumber": 2037
          },
          {
            "text": "    },",
            "lineNumber": 2038
          },
          {
            "text": "    ",
            "lineNumber": 2039
          },
          {
            "text": "    onVacationTypeChange() {",
            "lineNumber": 2040
          },
          {
            "text": "      // 有給休暇が選択された場合のみ残日数を再取得",
            "lineNumber": 2041
          },
          {
            "text": "      if (this.vacationForm.vacationType === 'PAID_LEAVE') {",
            "lineNumber": 2042
          },
          {
            "text": "        this.loadPaidLeaveBalance()",
            "lineNumber": 2043
          },
          {
            "text": "      }",
            "lineNumber": 2044
          },
          {
            "text": "      // 代休が選択された場合、代休取得可能日数を取得",
            "lineNumber": 2045
          },
          {
            "text": "      if (this.vacationForm.vacationType === 'SUBSTITUTE_HOLIDAY') {",
            "lineNumber": 2046
          },
          {
            "text": "        this.loadCompensatoryLeaveBalance()",
            "lineNumber": 2047
          },
          {
            "text": "      }",
            "lineNumber": 2048
          },
          {
            "text": "    },",
            "lineNumber": 2049
          },
          {
            "text": "    ",
            "lineNumber": 2050
          },
          {
            "text": "    async submitDailyConfirmation() {",
            "lineNumber": 2051
          },
          {
            "text": "      // エラーメッセージをクリア",
            "lineNumber": 2052
          },
          {
            "text": "      this.dailyConfirmationError = ''",
            "lineNumber": 2053
          }
        ]
      },
      "score": 0.3637951910495758
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\home-screen.md",
        "range": {
          "startPosition": {
            "line": 333
          },
          "endPosition": {
            "line": 373
          }
        },
        "contents": "| :--- | :--- | :--- | :--- | :--- | :--- |\n| 1 | APPLICATION_ID | 申請ID | EMPLOYEE_ID = ログインユーザーの従業員ID | - | ログインユーザーの申請 |\n| 2 | APPROVAL_STATUS | 承認状態 | APPLICATION_TYPE = 'HOLIDAY_WORK' | - | 休日出勤申請のみ |\n| 3 | TARGET_START_DATE | 対象開始日 | TARGET_START_DATE &lt;= システム日付 | - | 申請期間内 |\n| 4 | TARGET_END_DATE | 対象終了日 | TARGET_END_DATE &gt;= システム日付 | - | 申請期間内 |\n| 5 | - | - | APPROVAL_STATUS IN ('PENDING', 'APPROVED') | - | 申請中または承認済みのみ |\n\n**取得条件の詳細**:\n&#96;&#96;&#96;sql\nSELECT APPLICATION_ID, APPROVAL_STATUS\nFROM APPLICATION_HISTORY\nWHERE EMPLOYEE_ID = :employeeId\n  AND APPLICATION_TYPE = 'HOLIDAY_WORK'\n  AND TARGET_START_DATE &lt;= CURDATE()\n  AND TARGET_END_DATE &gt;= CURDATE()\n  AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')\nLIMIT 1;\n&#96;&#96;&#96;\n\n**備考**: \n- 当日が土日祝の場合のみ取得する\n- 土日祝の判定は、曜日（0=日曜日、6=土曜日）と祝日ライブラリ（HolidayJp）を使用する\n- 申請が存在しない、または申請中（PENDING）・承認済み（APPROVED）でない場合、打刻ボタンは非活性化される\n- 申請中（PENDING）の場合でも打刻が可能になる\n\n## テーブル更新仕様\n\n### No.1\n- テーブル更新仕様名：出勤打刻登録\n- 対象テーブル：ATTENDANCE_RECORD\n- 更新タイミング：出勤ボタン押下時\n\n| No | 更新項目 | 項目名（論理名） | 設定値 | 条件 | 備考 |\n| :--- | :--- | :--- | :--- | :--- | :--- |\n| 1 | EMPLOYEE_ID | 従業員ID | ログインユーザーの従業員ID | 新規レコード作成時 | - |\n| 2 | WORK_DATE | 勤務日 | システム日付 | 新規レコード作成時 | - |\n| 3 | CLOCK_IN_TIME | 出勤時刻 | システム日時 | - | 現在時刻を設定 |\n| 4 | CLOCK_IN_TYPE | 出勤打刻種別 | 'STAMP' | - | 打刻による出勤 |\n| 5 | WORK_LOCATION_CODE | 勤務場所コード | 選択された勤務場所コード | - | - |\n| 6 | CREATED_AT | 作成日時 | システム日時 | 新規レコード作成時 | - |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| :--- | :--- | :--- | :--- | :--- | :--- |",
            "lineNumber": 334
          },
          {
            "text": "| 1 | APPLICATION_ID | 申請ID | EMPLOYEE_ID = ログインユーザーの従業員ID | - | ログインユーザーの申請 |",
            "lineNumber": 335
          },
          {
            "text": "| 2 | APPROVAL_STATUS | 承認状態 | APPLICATION_TYPE = 'HOLIDAY_WORK' | - | 休日出勤申請のみ |",
            "lineNumber": 336
          },
          {
            "text": "| 3 | TARGET_START_DATE | 対象開始日 | TARGET_START_DATE &lt;= システム日付 | - | 申請期間内 |",
            "lineNumber": 337
          },
          {
            "text": "| 4 | TARGET_END_DATE | 対象終了日 | TARGET_END_DATE &gt;= システム日付 | - | 申請期間内 |",
            "lineNumber": 338
          },
          {
            "text": "| 5 | - | - | APPROVAL_STATUS IN ('PENDING', 'APPROVED') | - | 申請中または承認済みのみ |",
            "lineNumber": 339
          },
          {
            "lineNumber": 340
          },
          {
            "text": "**取得条件の詳細**:",
            "lineNumber": 341
          },
          {
            "text": "&#96;&#96;&#96;sql",
            "lineNumber": 342
          },
          {
            "text": "SELECT APPLICATION_ID, APPROVAL_STATUS",
            "lineNumber": 343
          },
          {
            "text": "FROM APPLICATION_HISTORY",
            "lineNumber": 344
          },
          {
            "text": "WHERE EMPLOYEE_ID = :employeeId",
            "lineNumber": 345
          },
          {
            "text": "  AND APPLICATION_TYPE = 'HOLIDAY_WORK'",
            "lineNumber": 346
          },
          {
            "text": "  AND TARGET_START_DATE &lt;= CURDATE()",
            "lineNumber": 347
          },
          {
            "text": "  AND TARGET_END_DATE &gt;= CURDATE()",
            "lineNumber": 348
          },
          {
            "text": "  AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')",
            "lineNumber": 349
          },
          {
            "text": "LIMIT 1;",
            "lineNumber": 350
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 351
          },
          {
            "lineNumber": 352
          },
          {
            "text": "**備考**: ",
            "lineNumber": 353
          },
          {
            "text": "- 当日が土日祝の場合のみ取得する",
            "lineNumber": 354
          },
          {
            "text": "- 土日祝の判定は、曜日（0=日曜日、6=土曜日）と祝日ライブラリ（HolidayJp）を使用する",
            "lineNumber": 355
          },
          {
            "text": "- 申請が存在しない、または申請中（PENDING）・承認済み（APPROVED）でない場合、打刻ボタンは非活性化される",
            "lineNumber": 356
          },
          {
            "text": "- 申請中（PENDING）の場合でも打刻が可能になる",
            "lineNumber": 357
          },
          {
            "lineNumber": 358
          },
          {
            "text": "## テーブル更新仕様",
            "lineNumber": 359
          },
          {
            "lineNumber": 360
          },
          {
            "text": "### No.1",
            "lineNumber": 361
          },
          {
            "text": "- テーブル更新仕様名：出勤打刻登録",
            "lineNumber": 362
          },
          {
            "text": "- 対象テーブル：ATTENDANCE_RECORD",
            "lineNumber": 363
          },
          {
            "text": "- 更新タイミング：出勤ボタン押下時",
            "lineNumber": 364
          },
          {
            "lineNumber": 365
          },
          {
            "text": "| No | 更新項目 | 項目名（論理名） | 設定値 | 条件 | 備考 |",
            "lineNumber": 366
          },
          {
            "text": "| :--- | :--- | :--- | :--- | :--- | :--- |",
            "lineNumber": 367
          },
          {
            "text": "| 1 | EMPLOYEE_ID | 従業員ID | ログインユーザーの従業員ID | 新規レコード作成時 | - |",
            "lineNumber": 368
          },
          {
            "text": "| 2 | WORK_DATE | 勤務日 | システム日付 | 新規レコード作成時 | - |",
            "lineNumber": 369
          },
          {
            "text": "| 3 | CLOCK_IN_TIME | 出勤時刻 | システム日時 | - | 現在時刻を設定 |",
            "lineNumber": 370
          },
          {
            "text": "| 4 | CLOCK_IN_TYPE | 出勤打刻種別 | 'STAMP' | - | 打刻による出勤 |",
            "lineNumber": 371
          },
          {
            "text": "| 5 | WORK_LOCATION_CODE | 勤務場所コード | 選択された勤務場所コード | - | - |",
            "lineNumber": 372
          },
          {
            "text": "| 6 | CREATED_AT | 作成日時 | システム日時 | 新規レコード作成時 | - |",
            "lineNumber": 373
          }
        ]
      },
      "score": 0.36334508657455444
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\applicationModel.js",
        "range": {
          "startPosition": {
            "line": 472,
            "column": 2
          },
          "endPosition": {
            "line": 577,
            "column": 1
          }
        },
        "contents": "/**\n * 申請情報と承認履歴を取得（休暇申請）\n * @param {string} employeeId - 従業員ID\n * @param {string} targetDate - 対象日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴\n */\nconst getVacationApplicationInfo = async (employeeId, targetDate) =&gt; {\n  // 全ての申請履歴を取得（PENDING, APPROVED, NOT_SUBMITTEDを含む）\n  const query = &#96;\n    SELECT \n      vh.VACATION_ID,\n      vh.VACATION_TYPE_CODE,\n      vh.START_DATE,\n      vh.END_DATE,\n      vh.REASON,\n      vh.CONTACT_INFO,\n      DATE_FORMAT(vh.CREATED_AT, '%Y/%m/%d %H:%i') AS APPLICATION_DATE,\n      vh.CREATED_AT,\n      vh.APPROVAL_STATUS,\n      DATE_FORMAT(vh.UPDATED_AT, '%Y/%m/%d %H:%i') AS UPDATED_DATE,\n      e.EMPLOYEE_NAME AS ACTOR_NAME\n    FROM VACATION_HISTORY vh\n    LEFT JOIN EMPLOYEE e ON vh.EMPLOYEE_ID = e.EMPLOYEE_ID\n    WHERE vh.EMPLOYEE_ID = ? \n      AND vh.START_DATE &lt;= ?\n      AND vh.END_DATE &gt;= ?\n      AND vh.APPROVAL_STATUS IN ('PENDING', 'APPROVED', 'NOT_SUBMITTED')\n    ORDER BY vh.CREATED_AT ASC\n  &#96;;\n  \n  const [rows] = await db.execute(query, [employeeId, targetDate, targetDate]);\n  if (rows.length === 0) {\n    return null;\n  }\n  \n  // 最新の申請（PENDINGまたはAPPROVED）を取得\n  // PENDINGまたはAPPROVEDの申請をフィルタして、CREATED_ATが最新のものを取得\n  const validApplications = rows.filter(r =&gt; r.APPROVAL_STATUS === 'PENDING' || r.APPROVAL_STATUS === 'APPROVED');\n  if (validApplications.length === 0) {\n    return null;\n  }\n  // CREATED_ATでソートして最新のものを取得\n  const latestApplication = validApplications.sort((a, b) =&gt; new Date(b.CREATED_AT) - new Date(a.CREATED_AT))[0];\n  if (!latestApplication) {\n    return null;\n  }\n  \n  // 承認履歴を構築（時系列順）\n  const history = [];\n  let seqNo = 1;\n  \n  for (let i = 0; i &lt; rows.length; i++) {\n    const app = rows[i];\n  }\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 475
          },
          {
            "text": " * 申請情報と承認履歴を取得（休暇申請）",
            "lineNumber": 476
          },
          {
            "text": " * @param {string} employeeId - 従業員ID",
            "lineNumber": 477
          },
          {
            "text": " * @param {string} targetDate - 対象日（YYYY-MM-DD形式）",
            "lineNumber": 478
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 申請情報と承認履歴",
            "lineNumber": 479
          },
          {
            "text": " */",
            "lineNumber": 480
          },
          {
            "text": "const getVacationApplicationInfo = async (employeeId, targetDate) =&gt; {",
            "lineNumber": 481
          },
          {
            "text": "  // 全ての申請履歴を取得（PENDING, APPROVED, NOT_SUBMITTEDを含む）",
            "lineNumber": 482
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 483
          },
          {
            "text": "    SELECT ",
            "lineNumber": 484
          },
          {
            "text": "      vh.VACATION_ID,",
            "lineNumber": 485
          },
          {
            "text": "      vh.VACATION_TYPE_CODE,",
            "lineNumber": 486
          },
          {
            "text": "      vh.START_DATE,",
            "lineNumber": 487
          },
          {
            "text": "      vh.END_DATE,",
            "lineNumber": 488
          },
          {
            "text": "      vh.REASON,",
            "lineNumber": 489
          },
          {
            "text": "      vh.CONTACT_INFO,",
            "lineNumber": 490
          },
          {
            "text": "      DATE_FORMAT(vh.CREATED_AT, '%Y/%m/%d %H:%i') AS APPLICATION_DATE,",
            "lineNumber": 491
          },
          {
            "text": "      vh.CREATED_AT,",
            "lineNumber": 492
          },
          {
            "text": "      vh.APPROVAL_STATUS,",
            "lineNumber": 493
          },
          {
            "text": "      DATE_FORMAT(vh.UPDATED_AT, '%Y/%m/%d %H:%i') AS UPDATED_DATE,",
            "lineNumber": 494
          },
          {
            "text": "      e.EMPLOYEE_NAME AS ACTOR_NAME",
            "lineNumber": 495
          },
          {
            "text": "    FROM VACATION_HISTORY vh",
            "lineNumber": 496
          },
          {
            "text": "    LEFT JOIN EMPLOYEE e ON vh.EMPLOYEE_ID = e.EMPLOYEE_ID",
            "lineNumber": 497
          },
          {
            "text": "    WHERE vh.EMPLOYEE_ID = ? ",
            "lineNumber": 498
          },
          {
            "text": "      AND vh.START_DATE &lt;= ?",
            "lineNumber": 499
          },
          {
            "text": "      AND vh.END_DATE &gt;= ?",
            "lineNumber": 500
          },
          {
            "text": "      AND vh.APPROVAL_STATUS IN ('PENDING', 'APPROVED', 'NOT_SUBMITTED')",
            "lineNumber": 501
          },
          {
            "text": "    ORDER BY vh.CREATED_AT ASC",
            "lineNumber": 502
          },
          {
            "text": "  &#96;;",
            "lineNumber": 503
          },
          {
            "text": "  ",
            "lineNumber": 504
          },
          {
            "text": "  const [rows] = await db.execute(query, [employeeId, targetDate, targetDate]);",
            "lineNumber": 505
          },
          {
            "text": "  if (rows.length === 0) {",
            "lineNumber": 506
          },
          {
            "text": "    return null;",
            "lineNumber": 507
          },
          {
            "text": "  }",
            "lineNumber": 508
          },
          {
            "text": "  ",
            "lineNumber": 509
          },
          {
            "text": "  // 最新の申請（PENDINGまたはAPPROVED）を取得",
            "lineNumber": 510
          },
          {
            "text": "  // PENDINGまたはAPPROVEDの申請をフィルタして、CREATED_ATが最新のものを取得",
            "lineNumber": 511
          },
          {
            "text": "  const validApplications = rows.filter(r =&gt; r.APPROVAL_STATUS === 'PENDING' || r.APPROVAL_STATUS === 'APPROVED');",
            "lineNumber": 512
          },
          {
            "text": "  if (validApplications.length === 0) {",
            "lineNumber": 513
          },
          {
            "text": "    return null;",
            "lineNumber": 514
          },
          {
            "text": "  }",
            "lineNumber": 515
          },
          {
            "text": "  // CREATED_ATでソートして最新のものを取得",
            "lineNumber": 516
          },
          {
            "text": "  const latestApplication = validApplications.sort((a, b) =&gt; new Date(b.CREATED_AT) - new Date(a.CREATED_AT))[0];",
            "lineNumber": 517
          },
          {
            "text": "  if (!latestApplication) {",
            "lineNumber": 518
          },
          {
            "text": "    return null;",
            "lineNumber": 519
          },
          {
            "text": "  }",
            "lineNumber": 520
          },
          {
            "text": "  ",
            "lineNumber": 521
          },
          {
            "text": "  // 承認履歴を構築（時系列順）",
            "lineNumber": 522
          },
          {
            "text": "  const history = [];",
            "lineNumber": 523
          },
          {
            "text": "  let seqNo = 1;",
            "lineNumber": 524
          },
          {
            "text": "  ",
            "lineNumber": 525
          },
          {
            "text": "  for (let i = 0; i &lt; rows.length; i++) {",
            "lineNumber": 526
          },
          {
            "text": "    const app = rows[i];",
            "lineNumber": 527
          },
          {
            "text": "  }",
            "lineNumber": 563
          },
          {
            "text": ";",
            "lineNumber": 578
          }
        ]
      },
      "score": 0.36204320192337036
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\TimesheetScreen.vue",
        "range": {
          "startPosition": {
            "line": 2071
          },
          "endPosition": {
            "line": 2116
          }
        },
        "contents": "    \n      // 勤怠関連申請ダイアログを開く（申請欄の+アイコン押下時）\n      openApplicationDialog(day) {\n        this.selectedDayForApplication = day\n        this.selectedApplicationType = null\n        this.showApplicationDialog = true\n      },\n      \n      // 勤怠関連申請ダイアログを開く（申請中または承認済みのアイコン押下時）\n      openApplicationDialogWithType(day) {\n        this.selectedDayForApplication = day\n        \n        // どの申請タイプが申請中または承認済みかを判定\n        // 優先順位: 日次確定 &gt; 休日出勤 &gt; 休暇 &gt; 残業 &gt; 早朝勤務 &gt; 振替\n        if (day.approvalStatus === 'PENDING' || day.approvalStatus === 'APPROVED') {\n          this.selectedApplicationType = 'dailyConfirmation'\n          this.selectedApplicationStatus = day.approvalStatus\n        } else if (day.holidayWorkApplicationStatus === 'PENDING' || day.holidayWorkApplicationStatus === 'APPROVED') {\n          this.selectedApplicationType = 'holidayWork'\n          this.selectedApplicationStatus = day.holidayWorkApplicationStatus\n        } else if (day.vacationApplicationStatus === 'PENDING' || day.vacationApplicationStatus === 'APPROVED') {\n          this.selectedApplicationType = 'vacation'\n          this.selectedApplicationStatus = day.vacationApplicationStatus\n        } else {\n          // その他の申請タイプはAPIで取得する必要があるが、とりあえずnull\n          this.selectedApplicationType = null\n          this.selectedApplicationStatus = null\n        }\n        \n        this.showApplicationDialog = true\n      },\n      \n      // 勤怠関連申請ダイアログを閉じる\n      closeApplicationDialog() {\n        this.showApplicationDialog = false\n        this.selectedDayForApplication = null\n        this.selectedApplicationType = null\n        this.selectedApplicationStatus = null\n      },\n      \n      // 申請完了時の処理\n      async handleApplicationSubmitted() {\n        // データを再読み込み\n        await this.loadAttendanceData()\n      },",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    ",
            "lineNumber": 2072
          },
          {
            "text": "      // 勤怠関連申請ダイアログを開く（申請欄の+アイコン押下時）",
            "lineNumber": 2073
          },
          {
            "text": "      openApplicationDialog(day) {",
            "lineNumber": 2074
          },
          {
            "text": "        this.selectedDayForApplication = day",
            "lineNumber": 2075
          },
          {
            "text": "        this.selectedApplicationType = null",
            "lineNumber": 2076
          },
          {
            "text": "        this.showApplicationDialog = true",
            "lineNumber": 2077
          },
          {
            "text": "      },",
            "lineNumber": 2078
          },
          {
            "text": "      ",
            "lineNumber": 2079
          },
          {
            "text": "      // 勤怠関連申請ダイアログを開く（申請中または承認済みのアイコン押下時）",
            "lineNumber": 2080
          },
          {
            "text": "      openApplicationDialogWithType(day) {",
            "lineNumber": 2081
          },
          {
            "text": "        this.selectedDayForApplication = day",
            "lineNumber": 2082
          },
          {
            "text": "        ",
            "lineNumber": 2083
          },
          {
            "text": "        // どの申請タイプが申請中または承認済みかを判定",
            "lineNumber": 2084
          },
          {
            "text": "        // 優先順位: 日次確定 &gt; 休日出勤 &gt; 休暇 &gt; 残業 &gt; 早朝勤務 &gt; 振替",
            "lineNumber": 2085
          },
          {
            "text": "        if (day.approvalStatus === 'PENDING' || day.approvalStatus === 'APPROVED') {",
            "lineNumber": 2086
          },
          {
            "text": "          this.selectedApplicationType = 'dailyConfirmation'",
            "lineNumber": 2087
          },
          {
            "text": "          this.selectedApplicationStatus = day.approvalStatus",
            "lineNumber": 2088
          },
          {
            "text": "        } else if (day.holidayWorkApplicationStatus === 'PENDING' || day.holidayWorkApplicationStatus === 'APPROVED') {",
            "lineNumber": 2089
          },
          {
            "text": "          this.selectedApplicationType = 'holidayWork'",
            "lineNumber": 2090
          },
          {
            "text": "          this.selectedApplicationStatus = day.holidayWorkApplicationStatus",
            "lineNumber": 2091
          },
          {
            "text": "        } else if (day.vacationApplicationStatus === 'PENDING' || day.vacationApplicationStatus === 'APPROVED') {",
            "lineNumber": 2092
          },
          {
            "text": "          this.selectedApplicationType = 'vacation'",
            "lineNumber": 2093
          },
          {
            "text": "          this.selectedApplicationStatus = day.vacationApplicationStatus",
            "lineNumber": 2094
          },
          {
            "text": "        } else {",
            "lineNumber": 2095
          },
          {
            "text": "          // その他の申請タイプはAPIで取得する必要があるが、とりあえずnull",
            "lineNumber": 2096
          },
          {
            "text": "          this.selectedApplicationType = null",
            "lineNumber": 2097
          },
          {
            "text": "          this.selectedApplicationStatus = null",
            "lineNumber": 2098
          },
          {
            "text": "        }",
            "lineNumber": 2099
          },
          {
            "text": "        ",
            "lineNumber": 2100
          },
          {
            "text": "        this.showApplicationDialog = true",
            "lineNumber": 2101
          },
          {
            "text": "      },",
            "lineNumber": 2102
          },
          {
            "text": "      ",
            "lineNumber": 2103
          },
          {
            "text": "      // 勤怠関連申請ダイアログを閉じる",
            "lineNumber": 2104
          },
          {
            "text": "      closeApplicationDialog() {",
            "lineNumber": 2105
          },
          {
            "text": "        this.showApplicationDialog = false",
            "lineNumber": 2106
          },
          {
            "text": "        this.selectedDayForApplication = null",
            "lineNumber": 2107
          },
          {
            "text": "        this.selectedApplicationType = null",
            "lineNumber": 2108
          },
          {
            "text": "        this.selectedApplicationStatus = null",
            "lineNumber": 2109
          },
          {
            "text": "      },",
            "lineNumber": 2110
          },
          {
            "text": "      ",
            "lineNumber": 2111
          },
          {
            "text": "      // 申請完了時の処理",
            "lineNumber": 2112
          },
          {
            "text": "      async handleApplicationSubmitted() {",
            "lineNumber": 2113
          },
          {
            "text": "        // データを再読み込み",
            "lineNumber": 2114
          },
          {
            "text": "        await this.loadAttendanceData()",
            "lineNumber": 2115
          },
          {
            "text": "      },",
            "lineNumber": 2116
          }
        ]
      },
      "score": 0.3618195652961731
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\controllers\\applicationController.js",
        "range": {
          "startPosition": {
            "line": 170,
            "column": 2
          },
          "endPosition": {
            "line": 224,
            "column": 1
          }
        },
        "contents": "/**\n * 休日出勤申請状態取得\n */\nconst getHolidayWorkStatus = async (req, res, next) =&gt; {\n  try {\n    const { employeeId, targetDate } = req.query;\n    \n    if (!employeeId || !targetDate) {\n      return res.status(400).json({\n        success: false,\n        message: '従業員IDと対象日が必要です。'\n      });\n    }\n    \n    const result = await applicationService.getHolidayWorkStatus(employeeId, targetDate);\n    \n    res.json({\n      success: true,\n      ...result\n    });\n  } catch (error) {\n    next(error);\n  }\n};\n\n/**\n * 月次承認履歴取得\n */\nconst getMonthlyApprovalHistory = async (req, res, next)\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 173
          },
          {
            "text": " * 休日出勤申請状態取得",
            "lineNumber": 174
          },
          {
            "text": " */",
            "lineNumber": 175
          },
          {
            "text": "const getHolidayWorkStatus = async (req, res, next) =&gt; {",
            "lineNumber": 176
          },
          {
            "text": "  try {",
            "lineNumber": 177
          },
          {
            "text": "    const { employeeId, targetDate } = req.query;",
            "lineNumber": 178
          },
          {
            "text": "    ",
            "lineNumber": 179
          },
          {
            "text": "    if (!employeeId || !targetDate) {",
            "lineNumber": 180
          },
          {
            "text": "      return res.status(400).json({",
            "lineNumber": 181
          },
          {
            "text": "        success: false,",
            "lineNumber": 182
          },
          {
            "text": "        message: '従業員IDと対象日が必要です。'",
            "lineNumber": 183
          },
          {
            "text": "      });",
            "lineNumber": 184
          },
          {
            "text": "    }",
            "lineNumber": 185
          },
          {
            "text": "    ",
            "lineNumber": 186
          },
          {
            "text": "    const result = await applicationService.getHolidayWorkStatus(employeeId, targetDate);",
            "lineNumber": 187
          },
          {
            "text": "    ",
            "lineNumber": 188
          },
          {
            "text": "    res.json({",
            "lineNumber": 189
          },
          {
            "text": "      success: true,",
            "lineNumber": 190
          },
          {
            "text": "      ...result",
            "lineNumber": 191
          },
          {
            "text": "    });",
            "lineNumber": 192
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 193
          },
          {
            "text": "    next(error);",
            "lineNumber": 194
          },
          {
            "text": "  }",
            "lineNumber": 195
          },
          {
            "text": "};",
            "lineNumber": 196
          },
          {
            "lineNumber": 197
          },
          {
            "text": "/**",
            "lineNumber": 198
          },
          {
            "text": " * 月次承認履歴取得",
            "lineNumber": 199
          },
          {
            "text": " */",
            "lineNumber": 200
          },
          {
            "text": "const getMonthlyApprovalHistory = async (req, res, next)",
            "lineNumber": 201
          },
          {
            "text": ";",
            "lineNumber": 225
          }
        ]
      },
      "score": 0.3598363399505615
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---



---


休日出勤申請のテーブル構造を確認し、必要な情報を取得します。


---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "HOLIDAY_WORK_APPLICATION テーブル構造 WORK_LOCATION_CODE",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 289
          },
          "endPosition": {
            "line": 326
          }
        },
        "contents": "CREATE TABLE VACATION_HISTORY (\n    VACATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '休暇取得ID',\n    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID',\n    VACATION_TYPE_CODE VARCHAR(20) NOT NULL COMMENT '休暇種別コード',\n    START_DATE DATE NOT NULL COMMENT '開始日',\n    END_DATE DATE NOT NULL COMMENT '終了日',\n    VACATION_DAYS DECIMAL(4,1) NOT NULL COMMENT '取得日数',\n    HALF_DAY_TYPE VARCHAR(20) COMMENT '半休種別(午前/午後)',\n    REASON TEXT COMMENT '取得理由',\n    CONTACT_INFO TEXT COMMENT '連絡先',\n    APPROVAL_STATUS VARCHAR(20) DEFAULT 'PENDING' COMMENT '承認状態(申請中/承認済/却下)',\n    APPROVED_BY VARCHAR(50) COMMENT '承認者',\n    APPROVED_AT DATETIME COMMENT '承認日時',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',\n    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',\n    PRIMARY KEY (VACATION_ID),\n    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID) ON DELETE CASCADE,\n    FOREIGN KEY (VACATION_TYPE_CODE) REFERENCES VACATION_TYPE(VACATION_TYPE_CODE),\n    INDEX IDX_EMP_DATE (EMPLOYEE_ID, START_DATE, END_DATE),\n    INDEX IDX_APPROVAL (APPROVAL_STATUS)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='休暇取得履歴';\n\n-- ====================================================================\n-- マスタデータの投入\n-- ====================================================================\n\n-- 1. 勤務場所マスタの初期データ\nINSERT INTO WORK_LOCATION (LOCATION_CODE, LOCATION_NAME, DISPLAY_ORDER, IS_ACTIVE) VALUES\n('COMMUTE', '通勤', 1, TRUE),\n('REMOTE', '在宅', 2, TRUE),\n('DIRECT', '直行、直帰、直行直帰', 3, TRUE),\n('BUSINESS_TRIP', '出張', 4, TRUE);\n\n-- 2. 休暇種別マスタの初期データ\nINSERT INTO VACATION_TYPE (VACATION_TYPE_CODE, VACATION_TYPE_NAME, VACATION_CATEGORY, IS_PAID, ANNUAL_GRANT_DAYS, DISPLAY_ORDER, IS_ACTIVE) VALUES\n('PAID_LEAVE', '有給休暇', '有給', TRUE, 20.0, 1, TRUE),\n('SUMMER_LEAVE', '夏季休暇', '特別', TRUE, 3.0, 2, TRUE),",
        "signatures": {},
        "detailedLines": [
          {
            "text": "CREATE TABLE VACATION_HISTORY (",
            "lineNumber": 290
          },
          {
            "text": "    VACATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '休暇取得ID',",
            "lineNumber": 291
          },
          {
            "text": "    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID',",
            "lineNumber": 292
          },
          {
            "text": "    VACATION_TYPE_CODE VARCHAR(20) NOT NULL COMMENT '休暇種別コード',",
            "lineNumber": 293
          },
          {
            "text": "    START_DATE DATE NOT NULL COMMENT '開始日',",
            "lineNumber": 294
          },
          {
            "text": "    END_DATE DATE NOT NULL COMMENT '終了日',",
            "lineNumber": 295
          },
          {
            "text": "    VACATION_DAYS DECIMAL(4,1) NOT NULL COMMENT '取得日数',",
            "lineNumber": 296
          },
          {
            "text": "    HALF_DAY_TYPE VARCHAR(20) COMMENT '半休種別(午前/午後)',",
            "lineNumber": 297
          },
          {
            "text": "    REASON TEXT COMMENT '取得理由',",
            "lineNumber": 298
          },
          {
            "text": "    CONTACT_INFO TEXT COMMENT '連絡先',",
            "lineNumber": 299
          },
          {
            "text": "    APPROVAL_STATUS VARCHAR(20) DEFAULT 'PENDING' COMMENT '承認状態(申請中/承認済/却下)',",
            "lineNumber": 300
          },
          {
            "text": "    APPROVED_BY VARCHAR(50) COMMENT '承認者',",
            "lineNumber": 301
          },
          {
            "text": "    APPROVED_AT DATETIME COMMENT '承認日時',",
            "lineNumber": 302
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',",
            "lineNumber": 303
          },
          {
            "text": "    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',",
            "lineNumber": 304
          },
          {
            "text": "    PRIMARY KEY (VACATION_ID),",
            "lineNumber": 305
          },
          {
            "text": "    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID) ON DELETE CASCADE,",
            "lineNumber": 306
          },
          {
            "text": "    FOREIGN KEY (VACATION_TYPE_CODE) REFERENCES VACATION_TYPE(VACATION_TYPE_CODE),",
            "lineNumber": 307
          },
          {
            "text": "    INDEX IDX_EMP_DATE (EMPLOYEE_ID, START_DATE, END_DATE),",
            "lineNumber": 308
          },
          {
            "text": "    INDEX IDX_APPROVAL (APPROVAL_STATUS)",
            "lineNumber": 309
          },
          {
            "text": ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='休暇取得履歴';",
            "lineNumber": 310
          },
          {
            "lineNumber": 311
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 312
          },
          {
            "text": "-- マスタデータの投入",
            "lineNumber": 313
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 314
          },
          {
            "lineNumber": 315
          },
          {
            "text": "-- 1. 勤務場所マスタの初期データ",
            "lineNumber": 316
          },
          {
            "text": "INSERT INTO WORK_LOCATION (LOCATION_CODE, LOCATION_NAME, DISPLAY_ORDER, IS_ACTIVE) VALUES",
            "lineNumber": 317
          },
          {
            "text": "('COMMUTE', '通勤', 1, TRUE),",
            "lineNumber": 318
          },
          {
            "text": "('REMOTE', '在宅', 2, TRUE),",
            "lineNumber": 319
          },
          {
            "text": "('DIRECT', '直行、直帰、直行直帰', 3, TRUE),",
            "lineNumber": 320
          },
          {
            "text": "('BUSINESS_TRIP', '出張', 4, TRUE);",
            "lineNumber": 321
          },
          {
            "lineNumber": 322
          },
          {
            "text": "-- 2. 休暇種別マスタの初期データ",
            "lineNumber": 323
          },
          {
            "text": "INSERT INTO VACATION_TYPE (VACATION_TYPE_CODE, VACATION_TYPE_NAME, VACATION_CATEGORY, IS_PAID, ANNUAL_GRANT_DAYS, DISPLAY_ORDER, IS_ACTIVE) VALUES",
            "lineNumber": 324
          },
          {
            "text": "('PAID_LEAVE', '有給休暇', '有給', TRUE, 20.0, 1, TRUE),",
            "lineNumber": 325
          },
          {
            "text": "('SUMMER_LEAVE', '夏季休暇', '特別', TRUE, 3.0, 2, TRUE),",
            "lineNumber": 326
          }
        ]
      },
      "score": 0.4836852550506592
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\home-screen.md",
        "range": {
          "startPosition": {
            "line": 497
          },
          "endPosition": {
            "line": 534
          }
        },
        "contents": "6. **休日出勤申請の制約**\n   - 土日祝に打刻する場合は、事前に休日出勤申請を行い、申請中（PENDING）または承認済み（APPROVED）である必要がある\n   - 休日出勤申請が申請中（PENDING）または承認済み（APPROVED）でない場合、すべての打刻ボタン（出勤、定時出勤、退勤、定時退勤）は非活性化される\n   - 土日祝の判定は、曜日（0=日曜日、6=土曜日）と祝日ライブラリ（HolidayJp）を使用する\n   - APPLICATION_HISTORYテーブルのAPPLICATION_TYPE='HOLIDAY_WORK'で、APPROVAL_STATUSが'PENDING'または'APPROVED'の申請が存在する場合のみ打刻可能\n   - **重要**: 休日出勤申請の承認申請ボタンを押下した時点（申請中（PENDING））から、打刻が可能になる\n\n## データベース設計との対応\n\n### 使用テーブル\n\n1. **EMPLOYEE（従業員マスタ）**\n   - ログイン認証後の従業員情報取得に使用\n   - EMPLOYEE_ID、EMPLOYEE_NAME、DEPARTMENTを参照\n\n2. **NOTIFICATION（お知らせマスタ）**\n   - お知らせ情報の表示に使用\n   - TARGET_TYPE（対象種別）、TARGET_ID（対象ID）で絞り込み\n   - DISPLAY_START_DATE、DISPLAY_END_DATEで表示期間を制御\n\n3. **ATTENDANCE_RECORD（勤怠記録）**\n   - 出退勤打刻の記録に使用\n   - EMPLOYEE_ID + WORK_DATEでユニーク制約\n   - CLOCK_IN_TIME、CLOCK_OUT_TIME、CLOCK_IN_TYPE、CLOCK_OUT_TYPE、WORK_LOCATION_CODEを更新\n\n4. **WORK_LOCATION（勤務場所マスタ）**\n   - 勤務場所の選択肢表示に使用\n   - LOCATION_CODE、LOCATION_NAMEを参照\n\n5. **BREAK_TIME（休憩時間）**\n   - 中断・再開時の休憩時間記録に使用\n   - ATTENDANCE_IDで勤怠記録と紐付け\n   - BREAK_SEQで複数の休憩時間帯に対応\n\n6. **APPLICATION_HISTORY（申請履歴）**\n   - 休日出勤申請の承認状態確認に使用",
        "signatures": {},
        "detailedLines": [
          {
            "text": "6. **休日出勤申請の制約**",
            "lineNumber": 499
          },
          {
            "text": "   - 土日祝に打刻する場合は、事前に休日出勤申請を行い、申請中（PENDING）または承認済み（APPROVED）である必要がある",
            "lineNumber": 500
          },
          {
            "text": "   - 休日出勤申請が申請中（PENDING）または承認済み（APPROVED）でない場合、すべての打刻ボタン（出勤、定時出勤、退勤、定時退勤）は非活性化される",
            "lineNumber": 501
          },
          {
            "text": "   - 土日祝の判定は、曜日（0=日曜日、6=土曜日）と祝日ライブラリ（HolidayJp）を使用する",
            "lineNumber": 502
          },
          {
            "text": "   - APPLICATION_HISTORYテーブルのAPPLICATION_TYPE='HOLIDAY_WORK'で、APPROVAL_STATUSが'PENDING'または'APPROVED'の申請が存在する場合のみ打刻可能",
            "lineNumber": 503
          },
          {
            "text": "   - **重要**: 休日出勤申請の承認申請ボタンを押下した時点（申請中（PENDING））から、打刻が可能になる",
            "lineNumber": 504
          },
          {
            "lineNumber": 505
          },
          {
            "text": "## データベース設計との対応",
            "lineNumber": 506
          },
          {
            "lineNumber": 507
          },
          {
            "text": "### 使用テーブル",
            "lineNumber": 508
          },
          {
            "lineNumber": 509
          },
          {
            "text": "1. **EMPLOYEE（従業員マスタ）**",
            "lineNumber": 510
          },
          {
            "text": "   - ログイン認証後の従業員情報取得に使用",
            "lineNumber": 511
          },
          {
            "text": "   - EMPLOYEE_ID、EMPLOYEE_NAME、DEPARTMENTを参照",
            "lineNumber": 512
          },
          {
            "lineNumber": 513
          },
          {
            "text": "2. **NOTIFICATION（お知らせマスタ）**",
            "lineNumber": 514
          },
          {
            "text": "   - お知らせ情報の表示に使用",
            "lineNumber": 515
          },
          {
            "text": "   - TARGET_TYPE（対象種別）、TARGET_ID（対象ID）で絞り込み",
            "lineNumber": 516
          },
          {
            "text": "   - DISPLAY_START_DATE、DISPLAY_END_DATEで表示期間を制御",
            "lineNumber": 517
          },
          {
            "lineNumber": 518
          },
          {
            "text": "3. **ATTENDANCE_RECORD（勤怠記録）**",
            "lineNumber": 519
          },
          {
            "text": "   - 出退勤打刻の記録に使用",
            "lineNumber": 520
          },
          {
            "text": "   - EMPLOYEE_ID + WORK_DATEでユニーク制約",
            "lineNumber": 521
          },
          {
            "text": "   - CLOCK_IN_TIME、CLOCK_OUT_TIME、CLOCK_IN_TYPE、CLOCK_OUT_TYPE、WORK_LOCATION_CODEを更新",
            "lineNumber": 522
          },
          {
            "lineNumber": 523
          },
          {
            "text": "4. **WORK_LOCATION（勤務場所マスタ）**",
            "lineNumber": 524
          },
          {
            "text": "   - 勤務場所の選択肢表示に使用",
            "lineNumber": 525
          },
          {
            "text": "   - LOCATION_CODE、LOCATION_NAMEを参照",
            "lineNumber": 526
          },
          {
            "lineNumber": 527
          },
          {
            "text": "5. **BREAK_TIME（休憩時間）**",
            "lineNumber": 528
          },
          {
            "text": "   - 中断・再開時の休憩時間記録に使用",
            "lineNumber": 529
          },
          {
            "text": "   - ATTENDANCE_IDで勤怠記録と紐付け",
            "lineNumber": 530
          },
          {
            "text": "   - BREAK_SEQで複数の休憩時間帯に対応",
            "lineNumber": 531
          },
          {
            "lineNumber": 532
          },
          {
            "text": "6. **APPLICATION_HISTORY（申請履歴）**",
            "lineNumber": 533
          },
          {
            "text": "   - 休日出勤申請の承認状態確認に使用",
            "lineNumber": 534
          }
        ]
      },
      "score": 0.4766033887863159
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\er-diagram.md",
        "range": {
          "startPosition": {
            "line": 128
          },
          "endPosition": {
            "line": 205
          }
        },
        "contents": "        datetime UPDATED_AT\n    }\n\n    OFFICIAL_OUTING {\n        int OUTING_ID PK\n        int ATTENDANCE_ID FK\n        int OUTING_SEQ\n        datetime OUTING_START_TIME\n        datetime OUTING_END_TIME\n        int OUTING_DURATION_MINUTES\n        string OUTING_PURPOSE\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    WORK_HOURS {\n        int WORK_HOURS_ID PK\n        int ATTENDANCE_ID FK\n        string EMPLOYEE_ID FK\n        date WORK_DATE\n        string JOB_CODE FK\n        string WORK_CODE\n        float WORK_HOURS_VALUE\n        int WORK_VOLUME\n        string INPUT_TYPE\n        text REMARKS\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    VACATION_BALANCE {\n        int BALANCE_ID PK\n        string EMPLOYEE_ID FK\n        string VACATION_TYPE_CODE FK\n        int FISCAL_YEAR\n        float GRANTED_DAYS\n        float USED_DAYS\n        float REMAINING_DAYS\n        date GRANT_DATE\n        date EXPIRATION_DATE\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    VACATION_HISTORY {\n        int VACATION_ID PK\n        string EMPLOYEE_ID FK\n        string VACATION_TYPE_CODE FK\n        date START_DATE\n        date END_DATE\n        float VACATION_DAYS\n        string HALF_DAY_TYPE\n        text REASON\n        text CONTACT_INFO\n        string APPROVAL_STATUS\n        string APPROVED_BY\n        datetime APPROVED_AT\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    APPLICATION_HISTORY {\n        int APPLICATION_ID PK\n        string EMPLOYEE_ID FK\n        string APPLICATION_TYPE\n        date TARGET_START_DATE\n        date TARGET_END_DATE\n        float OVERTIME_HOURS\n        text REASON\n        string APPROVAL_STATUS\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    MONTHLY_ATTENDANCE {\n        int MONTHLY_ATTENDANCE_ID PK\n        string EMPLOYEE_ID FK",
        "signatures": {},
        "detailedLines": [
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 129
          },
          {
            "text": "    }",
            "lineNumber": 130
          },
          {
            "lineNumber": 131
          },
          {
            "text": "    OFFICIAL_OUTING {",
            "lineNumber": 132
          },
          {
            "text": "        int OUTING_ID PK",
            "lineNumber": 133
          },
          {
            "text": "        int ATTENDANCE_ID FK",
            "lineNumber": 134
          },
          {
            "text": "        int OUTING_SEQ",
            "lineNumber": 135
          },
          {
            "text": "        datetime OUTING_START_TIME",
            "lineNumber": 136
          },
          {
            "text": "        datetime OUTING_END_TIME",
            "lineNumber": 137
          },
          {
            "text": "        int OUTING_DURATION_MINUTES",
            "lineNumber": 138
          },
          {
            "text": "        string OUTING_PURPOSE",
            "lineNumber": 139
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 140
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 141
          },
          {
            "text": "    }",
            "lineNumber": 142
          },
          {
            "lineNumber": 143
          },
          {
            "text": "    WORK_HOURS {",
            "lineNumber": 144
          },
          {
            "text": "        int WORK_HOURS_ID PK",
            "lineNumber": 145
          },
          {
            "text": "        int ATTENDANCE_ID FK",
            "lineNumber": 146
          },
          {
            "text": "        string EMPLOYEE_ID FK",
            "lineNumber": 147
          },
          {
            "text": "        date WORK_DATE",
            "lineNumber": 148
          },
          {
            "text": "        string JOB_CODE FK",
            "lineNumber": 149
          },
          {
            "text": "        string WORK_CODE",
            "lineNumber": 150
          },
          {
            "text": "        float WORK_HOURS_VALUE",
            "lineNumber": 151
          },
          {
            "text": "        int WORK_VOLUME",
            "lineNumber": 152
          },
          {
            "text": "        string INPUT_TYPE",
            "lineNumber": 153
          },
          {
            "text": "        text REMARKS",
            "lineNumber": 154
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 155
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 156
          },
          {
            "text": "    }",
            "lineNumber": 157
          },
          {
            "lineNumber": 158
          },
          {
            "text": "    VACATION_BALANCE {",
            "lineNumber": 159
          },
          {
            "text": "        int BALANCE_ID PK",
            "lineNumber": 160
          },
          {
            "text": "        string EMPLOYEE_ID FK",
            "lineNumber": 161
          },
          {
            "text": "        string VACATION_TYPE_CODE FK",
            "lineNumber": 162
          },
          {
            "text": "        int FISCAL_YEAR",
            "lineNumber": 163
          },
          {
            "text": "        float GRANTED_DAYS",
            "lineNumber": 164
          },
          {
            "text": "        float USED_DAYS",
            "lineNumber": 165
          },
          {
            "text": "        float REMAINING_DAYS",
            "lineNumber": 166
          },
          {
            "text": "        date GRANT_DATE",
            "lineNumber": 167
          },
          {
            "text": "        date EXPIRATION_DATE",
            "lineNumber": 168
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 169
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 170
          },
          {
            "text": "    }",
            "lineNumber": 171
          },
          {
            "lineNumber": 172
          },
          {
            "text": "    VACATION_HISTORY {",
            "lineNumber": 173
          },
          {
            "text": "        int VACATION_ID PK",
            "lineNumber": 174
          },
          {
            "text": "        string EMPLOYEE_ID FK",
            "lineNumber": 175
          },
          {
            "text": "        string VACATION_TYPE_CODE FK",
            "lineNumber": 176
          },
          {
            "text": "        date START_DATE",
            "lineNumber": 177
          },
          {
            "text": "        date END_DATE",
            "lineNumber": 178
          },
          {
            "text": "        float VACATION_DAYS",
            "lineNumber": 179
          },
          {
            "text": "        string HALF_DAY_TYPE",
            "lineNumber": 180
          },
          {
            "text": "        text REASON",
            "lineNumber": 181
          },
          {
            "text": "        text CONTACT_INFO",
            "lineNumber": 182
          },
          {
            "text": "        string APPROVAL_STATUS",
            "lineNumber": 183
          },
          {
            "text": "        string APPROVED_BY",
            "lineNumber": 184
          },
          {
            "text": "        datetime APPROVED_AT",
            "lineNumber": 185
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 186
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 187
          },
          {
            "text": "    }",
            "lineNumber": 188
          },
          {
            "lineNumber": 189
          },
          {
            "text": "    APPLICATION_HISTORY {",
            "lineNumber": 190
          },
          {
            "text": "        int APPLICATION_ID PK",
            "lineNumber": 191
          },
          {
            "text": "        string EMPLOYEE_ID FK",
            "lineNumber": 192
          },
          {
            "text": "        string APPLICATION_TYPE",
            "lineNumber": 193
          },
          {
            "text": "        date TARGET_START_DATE",
            "lineNumber": 194
          },
          {
            "text": "        date TARGET_END_DATE",
            "lineNumber": 195
          },
          {
            "text": "        float OVERTIME_HOURS",
            "lineNumber": 196
          },
          {
            "text": "        text REASON",
            "lineNumber": 197
          },
          {
            "text": "        string APPROVAL_STATUS",
            "lineNumber": 198
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 199
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 200
          },
          {
            "text": "    }",
            "lineNumber": 201
          },
          {
            "lineNumber": 202
          },
          {
            "text": "    MONTHLY_ATTENDANCE {",
            "lineNumber": 203
          },
          {
            "text": "        int MONTHLY_ATTENDANCE_ID PK",
            "lineNumber": 204
          },
          {
            "text": "        string EMPLOYEE_ID FK",
            "lineNumber": 205
          }
        ]
      },
      "score": 0.4735715985298157
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 270
          },
          "endPosition": {
            "line": 291
          }
        },
        "contents": "CREATE TABLE APPLICATION_HISTORY (\n    APPLICATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '申請ID: 主キー。申請履歴を一意に識別するID（自動採番）',\n    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID: 外部キー。どの従業員の申請か。EMPLOYEEテーブルを参照',\n    APPLICATION_TYPE VARCHAR(20) NOT NULL COMMENT '申請種別: HOLIDAY_WORK=休日出勤申請、OVERTIME=残業申請、EARLY_WORK=早朝勤務申請、TRANSFER=振替申請',\n    TARGET_START_DATE DATE NOT NULL COMMENT '対象開始日: 申請対象期間の開始日。形式YYYY-MM-DD',\n    TARGET_END_DATE DATE NOT NULL COMMENT '対象終了日: 申請対象期間の終了日。形式YYYY-MM-DD',\n    OVERTIME_HOURS DECIMAL(5,2) COMMENT '残業時間: 残業申請の場合の残業時間（時間単位）。例: 2.00=2時間',\n    REASON TEXT COMMENT '申請理由: 申請の理由や詳細',\n    APPROVAL_STATUS VARCHAR(20) DEFAULT 'PENDING' COMMENT '承認状態: PENDING=申請中、APPROVED=承認済、REJECTED=却下',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時: レコード作成日時（自動設定）',\n    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時: レコード更新日時（自動更新）',\n    PRIMARY KEY (APPLICATION_ID),\n    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID) ON DELETE CASCADE,\n    INDEX IDX_EMP_TYPE (EMPLOYEE_ID, APPLICATION_TYPE),\n    INDEX IDX_TARGET_DATE (TARGET_START_DATE, TARGET_END_DATE),\n    INDEX IDX_APPROVAL (APPROVAL_STATUS)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='申請履歴';\n\n-- 14. 休暇取得履歴 (VACATION_HISTORY)\nCREATE TABLE VACATION_HISTORY (\n    VACATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '休暇取得ID',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "CREATE TABLE APPLICATION_HISTORY (",
            "lineNumber": 271
          },
          {
            "text": "    APPLICATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '申請ID: 主キー。申請履歴を一意に識別するID（自動採番）',",
            "lineNumber": 272
          },
          {
            "text": "    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID: 外部キー。どの従業員の申請か。EMPLOYEEテーブルを参照',",
            "lineNumber": 273
          },
          {
            "text": "    APPLICATION_TYPE VARCHAR(20) NOT NULL COMMENT '申請種別: HOLIDAY_WORK=休日出勤申請、OVERTIME=残業申請、EARLY_WORK=早朝勤務申請、TRANSFER=振替申請',",
            "lineNumber": 274
          },
          {
            "text": "    TARGET_START_DATE DATE NOT NULL COMMENT '対象開始日: 申請対象期間の開始日。形式YYYY-MM-DD',",
            "lineNumber": 275
          },
          {
            "text": "    TARGET_END_DATE DATE NOT NULL COMMENT '対象終了日: 申請対象期間の終了日。形式YYYY-MM-DD',",
            "lineNumber": 276
          },
          {
            "text": "    OVERTIME_HOURS DECIMAL(5,2) COMMENT '残業時間: 残業申請の場合の残業時間（時間単位）。例: 2.00=2時間',",
            "lineNumber": 277
          },
          {
            "text": "    REASON TEXT COMMENT '申請理由: 申請の理由や詳細',",
            "lineNumber": 278
          },
          {
            "text": "    APPROVAL_STATUS VARCHAR(20) DEFAULT 'PENDING' COMMENT '承認状態: PENDING=申請中、APPROVED=承認済、REJECTED=却下',",
            "lineNumber": 279
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時: レコード作成日時（自動設定）',",
            "lineNumber": 280
          },
          {
            "text": "    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時: レコード更新日時（自動更新）',",
            "lineNumber": 281
          },
          {
            "text": "    PRIMARY KEY (APPLICATION_ID),",
            "lineNumber": 282
          },
          {
            "text": "    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID) ON DELETE CASCADE,",
            "lineNumber": 283
          },
          {
            "text": "    INDEX IDX_EMP_TYPE (EMPLOYEE_ID, APPLICATION_TYPE),",
            "lineNumber": 284
          },
          {
            "text": "    INDEX IDX_TARGET_DATE (TARGET_START_DATE, TARGET_END_DATE),",
            "lineNumber": 285
          },
          {
            "text": "    INDEX IDX_APPROVAL (APPROVAL_STATUS)",
            "lineNumber": 286
          },
          {
            "text": ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='申請履歴';",
            "lineNumber": 287
          },
          {
            "lineNumber": 288
          },
          {
            "text": "-- 14. 休暇取得履歴 (VACATION_HISTORY)",
            "lineNumber": 289
          },
          {
            "text": "CREATE TABLE VACATION_HISTORY (",
            "lineNumber": 290
          },
          {
            "text": "    VACATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '休暇取得ID',",
            "lineNumber": 291
          }
        ]
      },
      "score": 0.44096270203590393
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\create_application_history_table.sql",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 25
          }
        },
        "contents": "-- ====================================================================\n-- APPLICATION_HISTORYテーブル作成スクリプト\n-- 申請履歴テーブル（休日出勤申請、残業申請、早朝勤務申請、振替申請など）\n-- ====================================================================\n\nUSE teamspirit_db;\n\n-- APPLICATION_HISTORYテーブルが存在しない場合のみ作成\nCREATE TABLE IF NOT EXISTS APPLICATION_HISTORY (\n    APPLICATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '申請ID: 主キー。申請履歴を一意に識別するID（自動採番）',\n    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID: 外部キー。どの従業員の申請か。EMPLOYEEテーブルを参照',\n    APPLICATION_TYPE VARCHAR(20) NOT NULL COMMENT '申請種別: HOLIDAY_WORK=休日出勤申請、OVERTIME=残業申請、EARLY_WORK=早朝勤務申請、TRANSFER=振替申請',\n    TARGET_START_DATE DATE NOT NULL COMMENT '対象開始日: 申請対象期間の開始日。形式YYYY-MM-DD',\n    TARGET_END_DATE DATE NOT NULL COMMENT '対象終了日: 申請対象期間の終了日。形式YYYY-MM-DD',\n    OVERTIME_HOURS DECIMAL(5,2) COMMENT '残業時間: 残業申請の場合の残業時間（時間単位）。例: 2.00=2時間',\n    REASON TEXT COMMENT '申請理由: 申請の理由や詳細',\n    APPROVAL_STATUS VARCHAR(20) DEFAULT 'PENDING' COMMENT '承認状態: PENDING=申請中、APPROVED=承認済、REJECTED=却下',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時: レコード作成日時（自動設定）',\n    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時: レコード更新日時（自動更新）',\n    PRIMARY KEY (APPLICATION_ID),\n    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID) ON DELETE CASCADE,\n    INDEX IDX_EMP_TYPE (EMPLOYEE_ID, APPLICATION_TYPE),\n    INDEX IDX_TARGET_DATE (TARGET_START_DATE, TARGET_END_DATE),\n    INDEX IDX_APPROVAL (APPROVAL_STATUS)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='申請履歴';",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- ====================================================================",
            "lineNumber": 1
          },
          {
            "text": "-- APPLICATION_HISTORYテーブル作成スクリプト",
            "lineNumber": 2
          },
          {
            "text": "-- 申請履歴テーブル（休日出勤申請、残業申請、早朝勤務申請、振替申請など）",
            "lineNumber": 3
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 4
          },
          {
            "lineNumber": 5
          },
          {
            "text": "USE teamspirit_db;",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "-- APPLICATION_HISTORYテーブルが存在しない場合のみ作成",
            "lineNumber": 8
          },
          {
            "text": "CREATE TABLE IF NOT EXISTS APPLICATION_HISTORY (",
            "lineNumber": 9
          },
          {
            "text": "    APPLICATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '申請ID: 主キー。申請履歴を一意に識別するID（自動採番）',",
            "lineNumber": 10
          },
          {
            "text": "    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID: 外部キー。どの従業員の申請か。EMPLOYEEテーブルを参照',",
            "lineNumber": 11
          },
          {
            "text": "    APPLICATION_TYPE VARCHAR(20) NOT NULL COMMENT '申請種別: HOLIDAY_WORK=休日出勤申請、OVERTIME=残業申請、EARLY_WORK=早朝勤務申請、TRANSFER=振替申請',",
            "lineNumber": 12
          },
          {
            "text": "    TARGET_START_DATE DATE NOT NULL COMMENT '対象開始日: 申請対象期間の開始日。形式YYYY-MM-DD',",
            "lineNumber": 13
          },
          {
            "text": "    TARGET_END_DATE DATE NOT NULL COMMENT '対象終了日: 申請対象期間の終了日。形式YYYY-MM-DD',",
            "lineNumber": 14
          },
          {
            "text": "    OVERTIME_HOURS DECIMAL(5,2) COMMENT '残業時間: 残業申請の場合の残業時間（時間単位）。例: 2.00=2時間',",
            "lineNumber": 15
          },
          {
            "text": "    REASON TEXT COMMENT '申請理由: 申請の理由や詳細',",
            "lineNumber": 16
          },
          {
            "text": "    APPROVAL_STATUS VARCHAR(20) DEFAULT 'PENDING' COMMENT '承認状態: PENDING=申請中、APPROVED=承認済、REJECTED=却下',",
            "lineNumber": 17
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時: レコード作成日時（自動設定）',",
            "lineNumber": 18
          },
          {
            "text": "    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時: レコード更新日時（自動更新）',",
            "lineNumber": 19
          },
          {
            "text": "    PRIMARY KEY (APPLICATION_ID),",
            "lineNumber": 20
          },
          {
            "text": "    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID) ON DELETE CASCADE,",
            "lineNumber": 21
          },
          {
            "text": "    INDEX IDX_EMP_TYPE (EMPLOYEE_ID, APPLICATION_TYPE),",
            "lineNumber": 22
          },
          {
            "text": "    INDEX IDX_TARGET_DATE (TARGET_START_DATE, TARGET_END_DATE),",
            "lineNumber": 23
          },
          {
            "text": "    INDEX IDX_APPROVAL (APPROVAL_STATUS)",
            "lineNumber": 24
          },
          {
            "text": ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='申請履歴';",
            "lineNumber": 25
          }
        ]
      },
      "score": 0.43728309869766235
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 188
          },
          "endPosition": {
            "line": 213
          }
        },
        "contents": "-- 9. 工数実績 (WORK_HOURS)\nCREATE TABLE WORK_HOURS (\n    WORK_HOURS_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '工数実績ID',\n    ATTENDANCE_ID BIGINT NOT NULL COMMENT '勤怠ID',\n    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID',\n    WORK_DATE DATE NOT NULL COMMENT '作業日',\n    JOB_CODE VARCHAR(50) NOT NULL COMMENT 'ジョブコード',\n    WORK_CODE VARCHAR(50) COMMENT '作業コード',\n    WORK_HOURS_VALUE DECIMAL(5,2) NOT NULL COMMENT '工数時間',\n    WORK_VOLUME INT COMMENT '作業ボリューム(0-10)',\n    INPUT_TYPE VARCHAR(20) DEFAULT 'TIME' COMMENT '入力種別(時間/ボリューム)',\n    REMARKS TEXT COMMENT '備考',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',\n    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',\n    PRIMARY KEY (WORK_HOURS_ID),\n    FOREIGN KEY (ATTENDANCE_ID) REFERENCES ATTENDANCE_RECORD(ATTENDANCE_ID) ON DELETE CASCADE,\n    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID),\n    FOREIGN KEY (JOB_CODE) REFERENCES JOB_MASTER(JOB_CODE),\n    INDEX IDX_EMP_DATE (EMPLOYEE_ID, WORK_DATE),\n    INDEX IDX_JOB (JOB_CODE)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工数実績';\n\n-- 10. 休暇残日数 (VACATION_BALANCE)\nCREATE TABLE VACATION_BALANCE (\n    BALANCE_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '休暇残日数ID',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- 9. 工数実績 (WORK_HOURS)",
            "lineNumber": 189
          },
          {
            "text": "CREATE TABLE WORK_HOURS (",
            "lineNumber": 190
          },
          {
            "text": "    WORK_HOURS_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '工数実績ID',",
            "lineNumber": 191
          },
          {
            "text": "    ATTENDANCE_ID BIGINT NOT NULL COMMENT '勤怠ID',",
            "lineNumber": 192
          },
          {
            "text": "    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID',",
            "lineNumber": 193
          },
          {
            "text": "    WORK_DATE DATE NOT NULL COMMENT '作業日',",
            "lineNumber": 194
          },
          {
            "text": "    JOB_CODE VARCHAR(50) NOT NULL COMMENT 'ジョブコード',",
            "lineNumber": 195
          },
          {
            "text": "    WORK_CODE VARCHAR(50) COMMENT '作業コード',",
            "lineNumber": 196
          },
          {
            "text": "    WORK_HOURS_VALUE DECIMAL(5,2) NOT NULL COMMENT '工数時間',",
            "lineNumber": 197
          },
          {
            "text": "    WORK_VOLUME INT COMMENT '作業ボリューム(0-10)',",
            "lineNumber": 198
          },
          {
            "text": "    INPUT_TYPE VARCHAR(20) DEFAULT 'TIME' COMMENT '入力種別(時間/ボリューム)',",
            "lineNumber": 199
          },
          {
            "text": "    REMARKS TEXT COMMENT '備考',",
            "lineNumber": 200
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',",
            "lineNumber": 201
          },
          {
            "text": "    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',",
            "lineNumber": 202
          },
          {
            "text": "    PRIMARY KEY (WORK_HOURS_ID),",
            "lineNumber": 203
          },
          {
            "text": "    FOREIGN KEY (ATTENDANCE_ID) REFERENCES ATTENDANCE_RECORD(ATTENDANCE_ID) ON DELETE CASCADE,",
            "lineNumber": 204
          },
          {
            "text": "    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEE(EMPLOYEE_ID),",
            "lineNumber": 205
          },
          {
            "text": "    FOREIGN KEY (JOB_CODE) REFERENCES JOB_MASTER(JOB_CODE),",
            "lineNumber": 206
          },
          {
            "text": "    INDEX IDX_EMP_DATE (EMPLOYEE_ID, WORK_DATE),",
            "lineNumber": 207
          },
          {
            "text": "    INDEX IDX_JOB (JOB_CODE)",
            "lineNumber": 208
          },
          {
            "text": ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='工数実績';",
            "lineNumber": 209
          },
          {
            "lineNumber": 210
          },
          {
            "text": "-- 10. 休暇残日数 (VACATION_BALANCE)",
            "lineNumber": 211
          },
          {
            "text": "CREATE TABLE VACATION_BALANCE (",
            "lineNumber": 212
          },
          {
            "text": "    BALANCE_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '休暇残日数ID',",
            "lineNumber": 213
          }
        ]
      },
      "score": 0.4226885139942169
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\er-diagram.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 64
          }
        },
        "contents": "# TeamSpirit勤怠管理システム\n\n## ER図\n\n&#96;&#96;&#96;mermaid\nerDiagram\n\n    EMPLOYEE ||--o{ ATTENDANCE_RECORD : \"勤怠記録を持つ\"\n    EMPLOYEE ||--o{ WORK_HOURS : \"工数実績を持つ\"\n    EMPLOYEE ||--o{ VACATION_BALANCE : \"休暇残日数を持つ\"\n    EMPLOYEE ||--o{ VACATION_HISTORY : \"休暇取得履歴を持つ\"\n    EMPLOYEE ||--o{ APPLICATION_HISTORY : \"申請履歴を持つ\"\n    EMPLOYEE ||--o{ MONTHLY_ATTENDANCE : \"月次勤怠を持つ\"\n    EMPLOYEE ||--o{ MONTHLY_APPROVAL_HISTORY : \"月次承認履歴を持つ\"\n    \n    WORK_LOCATION ||--o{ ATTENDANCE_RECORD : \"勤務場所として使用される\"\n    \n    JOB_MASTER ||--o{ WORK_HOURS : \"工数入力に使用される\"\n    \n    VACATION_TYPE ||--o{ VACATION_BALANCE : \"休暇種別を分類する\"\n    VACATION_TYPE ||--o{ VACATION_HISTORY : \"休暇種別を分類する\"\n    \n    ATTENDANCE_RECORD ||--o{ BREAK_TIME : \"休憩時間を持つ\"\n    ATTENDANCE_RECORD ||--o{ OFFICIAL_OUTING : \"公用外出を持つ\"\n    ATTENDANCE_RECORD ||--o{ WORK_HOURS : \"工数実績を持つ\"\n\n    EMPLOYEE {\n        string EMPLOYEE_ID PK\n        string EMPLOYEE_NAME\n        string PASSWORD\n        string EMAIL_ADDRESS\n        string DEPARTMENT\n        string POSITION\n        date HIRE_DATE\n        time STANDARD_WORK_START_TIME\n        time STANDARD_WORK_END_TIME\n        boolean IS_ACTIVE\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    WORK_LOCATION {\n        string LOCATION_CODE PK\n        string LOCATION_NAME\n        int DISPLAY_ORDER\n        boolean IS_ACTIVE\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    JOB_MASTER {\n        string JOB_CODE PK\n        string JOB_NAME\n        string JOB_CATEGORY\n        string PROJECT_CODE\n        boolean IS_ACTIVE\n        date START_DATE\n        date END_DATE\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    VACATION_TYPE {\n        string VACATION_TYPE_CODE PK",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# TeamSpirit勤怠管理システム",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "## ER図",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "&#96;&#96;&#96;mermaid",
            "lineNumber": 5
          },
          {
            "text": "erDiagram",
            "lineNumber": 6
          },
          {
            "lineNumber": 7
          },
          {
            "text": "    EMPLOYEE ||--o{ ATTENDANCE_RECORD : \"勤怠記録を持つ\"",
            "lineNumber": 8
          },
          {
            "text": "    EMPLOYEE ||--o{ WORK_HOURS : \"工数実績を持つ\"",
            "lineNumber": 9
          },
          {
            "text": "    EMPLOYEE ||--o{ VACATION_BALANCE : \"休暇残日数を持つ\"",
            "lineNumber": 10
          },
          {
            "text": "    EMPLOYEE ||--o{ VACATION_HISTORY : \"休暇取得履歴を持つ\"",
            "lineNumber": 11
          },
          {
            "text": "    EMPLOYEE ||--o{ APPLICATION_HISTORY : \"申請履歴を持つ\"",
            "lineNumber": 12
          },
          {
            "text": "    EMPLOYEE ||--o{ MONTHLY_ATTENDANCE : \"月次勤怠を持つ\"",
            "lineNumber": 13
          },
          {
            "text": "    EMPLOYEE ||--o{ MONTHLY_APPROVAL_HISTORY : \"月次承認履歴を持つ\"",
            "lineNumber": 14
          },
          {
            "text": "    ",
            "lineNumber": 15
          },
          {
            "text": "    WORK_LOCATION ||--o{ ATTENDANCE_RECORD : \"勤務場所として使用される\"",
            "lineNumber": 16
          },
          {
            "text": "    ",
            "lineNumber": 17
          },
          {
            "text": "    JOB_MASTER ||--o{ WORK_HOURS : \"工数入力に使用される\"",
            "lineNumber": 18
          },
          {
            "text": "    ",
            "lineNumber": 19
          },
          {
            "text": "    VACATION_TYPE ||--o{ VACATION_BALANCE : \"休暇種別を分類する\"",
            "lineNumber": 20
          },
          {
            "text": "    VACATION_TYPE ||--o{ VACATION_HISTORY : \"休暇種別を分類する\"",
            "lineNumber": 21
          },
          {
            "text": "    ",
            "lineNumber": 22
          },
          {
            "text": "    ATTENDANCE_RECORD ||--o{ BREAK_TIME : \"休憩時間を持つ\"",
            "lineNumber": 23
          },
          {
            "text": "    ATTENDANCE_RECORD ||--o{ OFFICIAL_OUTING : \"公用外出を持つ\"",
            "lineNumber": 24
          },
          {
            "text": "    ATTENDANCE_RECORD ||--o{ WORK_HOURS : \"工数実績を持つ\"",
            "lineNumber": 25
          },
          {
            "lineNumber": 26
          },
          {
            "text": "    EMPLOYEE {",
            "lineNumber": 27
          },
          {
            "text": "        string EMPLOYEE_ID PK",
            "lineNumber": 28
          },
          {
            "text": "        string EMPLOYEE_NAME",
            "lineNumber": 29
          },
          {
            "text": "        string PASSWORD",
            "lineNumber": 30
          },
          {
            "text": "        string EMAIL_ADDRESS",
            "lineNumber": 31
          },
          {
            "text": "        string DEPARTMENT",
            "lineNumber": 32
          },
          {
            "text": "        string POSITION",
            "lineNumber": 33
          },
          {
            "text": "        date HIRE_DATE",
            "lineNumber": 34
          },
          {
            "text": "        time STANDARD_WORK_START_TIME",
            "lineNumber": 35
          },
          {
            "text": "        time STANDARD_WORK_END_TIME",
            "lineNumber": 36
          },
          {
            "text": "        boolean IS_ACTIVE",
            "lineNumber": 37
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 38
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 39
          },
          {
            "text": "    }",
            "lineNumber": 40
          },
          {
            "lineNumber": 41
          },
          {
            "text": "    WORK_LOCATION {",
            "lineNumber": 42
          },
          {
            "text": "        string LOCATION_CODE PK",
            "lineNumber": 43
          },
          {
            "text": "        string LOCATION_NAME",
            "lineNumber": 44
          },
          {
            "text": "        int DISPLAY_ORDER",
            "lineNumber": 45
          },
          {
            "text": "        boolean IS_ACTIVE",
            "lineNumber": 46
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 47
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 48
          },
          {
            "text": "    }",
            "lineNumber": 49
          },
          {
            "lineNumber": 50
          },
          {
            "text": "    JOB_MASTER {",
            "lineNumber": 51
          },
          {
            "text": "        string JOB_CODE PK",
            "lineNumber": 52
          },
          {
            "text": "        string JOB_NAME",
            "lineNumber": 53
          },
          {
            "text": "        string JOB_CATEGORY",
            "lineNumber": 54
          },
          {
            "text": "        string PROJECT_CODE",
            "lineNumber": 55
          },
          {
            "text": "        boolean IS_ACTIVE",
            "lineNumber": 56
          },
          {
            "text": "        date START_DATE",
            "lineNumber": 57
          },
          {
            "text": "        date END_DATE",
            "lineNumber": 58
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 59
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 60
          },
          {
            "text": "    }",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "    VACATION_TYPE {",
            "lineNumber": 63
          },
          {
            "text": "        string VACATION_TYPE_CODE PK",
            "lineNumber": 64
          }
        ]
      },
      "score": 0.4155782461166382
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 130
          },
          "endPosition": {
            "line": 145
          }
        },
        "contents": "    ACTUAL_WORK_HOURS DECIMAL(5,2) COMMENT '実労働時間: 出退勤時刻と休憩時間から自動計算される実際の労働時間（時間単位）。例: 8.50=8時間30分',\n    SCHEDULED_WORK_HOURS DECIMAL(5,2) DEFAULT 7.50 COMMENT '所定労働時間: 標準勤務時間（9:00-17:30）から休憩1時間を除いた7.5時間。例: 7.50=7時間30分',\n    OVERTIME_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '残業時間: 実労働時間が所定労働時間を超えた分（時間単位）。例: 0.50=30分残業',\n    WITHIN_LEGAL_OVERTIME_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '法定時間内残業: 1日8時間以内の残業時間（時間単位）。例: 0.50=30分',\n    OVER_LEGAL_OVERTIME_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '法定時間外残業: 1日8時間を超える残業時間（時間単位）。例: 2.00=2時間',\n    NIGHT_WORK_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '深夜労働時間: 22時〜5時の労働時間（時間単位）。例: 2.00=2時間',\n    LEGAL_HOLIDAY_WORK_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '法定休日労働: 法定休日に働いた時間（時間単位）。例: 8.00=8時間',\n    HOLIDAY_WORK_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '休日労働時間: 休日に働いた時間（時間単位）。例: 8.00=8時間',\n    IS_DAILY_CONFIRMED BOOLEAN DEFAULT FALSE COMMENT '日次確定フラグ: TRUE=その日の勤怠を確定申請済み。日次確定ボタンで変更される',\n    DAILY_CONFIRMED_AT DATETIME COMMENT '日次確定日時: いつ確定申請したか。形式YYYY-MM-DD HH:MM:SS',\n    IS_MONTHLY_CONFIRMED BOOLEAN DEFAULT FALSE COMMENT '月次確定フラグ: TRUE=月次の勤怠を確定申請済み',\n    MONTHLY_CONFIRMED_AT DATETIME COMMENT '月次確定日時: いつ月次確定申請したか。形式YYYY-MM-DD HH:MM:SS',\n    APPROVAL_STATUS VARCHAR(20) DEFAULT 'NOT_SUBMITTED' COMMENT '承認状態: NOT_SUBMITTED=未申請、PENDING=申請中、APPROVED=承認済、REJECTED=却下',\n    REMARK_TEXT TEXT COMMENT '備考内容: 打刻できなかった理由やその他の備考。手入力の場合は必須入力',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時: レコード作成日時（自動設定）',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    ACTUAL_WORK_HOURS DECIMAL(5,2) COMMENT '実労働時間: 出退勤時刻と休憩時間から自動計算される実際の労働時間（時間単位）。例: 8.50=8時間30分',",
            "lineNumber": 131
          },
          {
            "text": "    SCHEDULED_WORK_HOURS DECIMAL(5,2) DEFAULT 7.50 COMMENT '所定労働時間: 標準勤務時間（9:00-17:30）から休憩1時間を除いた7.5時間。例: 7.50=7時間30分',",
            "lineNumber": 132
          },
          {
            "text": "    OVERTIME_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '残業時間: 実労働時間が所定労働時間を超えた分（時間単位）。例: 0.50=30分残業',",
            "lineNumber": 133
          },
          {
            "text": "    WITHIN_LEGAL_OVERTIME_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '法定時間内残業: 1日8時間以内の残業時間（時間単位）。例: 0.50=30分',",
            "lineNumber": 134
          },
          {
            "text": "    OVER_LEGAL_OVERTIME_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '法定時間外残業: 1日8時間を超える残業時間（時間単位）。例: 2.00=2時間',",
            "lineNumber": 135
          },
          {
            "text": "    NIGHT_WORK_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '深夜労働時間: 22時〜5時の労働時間（時間単位）。例: 2.00=2時間',",
            "lineNumber": 136
          },
          {
            "text": "    LEGAL_HOLIDAY_WORK_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '法定休日労働: 法定休日に働いた時間（時間単位）。例: 8.00=8時間',",
            "lineNumber": 137
          },
          {
            "text": "    HOLIDAY_WORK_HOURS DECIMAL(5,2) DEFAULT 0 COMMENT '休日労働時間: 休日に働いた時間（時間単位）。例: 8.00=8時間',",
            "lineNumber": 138
          },
          {
            "text": "    IS_DAILY_CONFIRMED BOOLEAN DEFAULT FALSE COMMENT '日次確定フラグ: TRUE=その日の勤怠を確定申請済み。日次確定ボタンで変更される',",
            "lineNumber": 139
          },
          {
            "text": "    DAILY_CONFIRMED_AT DATETIME COMMENT '日次確定日時: いつ確定申請したか。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 140
          },
          {
            "text": "    IS_MONTHLY_CONFIRMED BOOLEAN DEFAULT FALSE COMMENT '月次確定フラグ: TRUE=月次の勤怠を確定申請済み',",
            "lineNumber": 141
          },
          {
            "text": "    MONTHLY_CONFIRMED_AT DATETIME COMMENT '月次確定日時: いつ月次確定申請したか。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 142
          },
          {
            "text": "    APPROVAL_STATUS VARCHAR(20) DEFAULT 'NOT_SUBMITTED' COMMENT '承認状態: NOT_SUBMITTED=未申請、PENDING=申請中、APPROVED=承認済、REJECTED=却下',",
            "lineNumber": 143
          },
          {
            "text": "    REMARK_TEXT TEXT COMMENT '備考内容: 打刻できなかった理由やその他の備考。手入力の場合は必須入力',",
            "lineNumber": 144
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時: レコード作成日時（自動設定）',",
            "lineNumber": 145
          }
        ]
      },
      "score": 0.3952573537826538
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 117
          },
          "endPosition": {
            "line": 132
          }
        },
        "contents": "-- - OVER_LEGAL_OVERTIME_HOURS: 8h超の残業（即座に法定時間外残業として扱う）\n-- - 割増賃金: 所定の割増率に基づき算定\nCREATE TABLE ATTENDANCE_RECORD (\n    ATTENDANCE_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '勤怠ID: 主キー。勤怠記録を一意に識別するID（自動採番）',\n    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID: 外部キー。どの従業員の勤怠記録か。EMPLOYEEテーブルを参照',\n    WORK_DATE DATE NOT NULL COMMENT '勤務日: どの日の勤怠記録か。形式YYYY-MM-DD。従業員IDと勤務日の組み合わせでユニーク',\n    CLOCK_IN_TIME DATETIME COMMENT '出勤時刻: WEBタイムレコーダーで打刻した時刻、または手入力した時刻。形式YYYY-MM-DD HH:MM:SS',\n    CLOCK_OUT_TIME DATETIME COMMENT '退勤時刻: WEBタイムレコーダーで打刻した時刻、または手入力した時刻。形式YYYY-MM-DD HH:MM:SS',\n    CLOCK_IN_TYPE VARCHAR(20) COMMENT '出勤打刻種別: STAMP=打刻、MANUAL=手入力、SCHEDULED=定時出勤。画面で背景色を変えるために使用',\n    CLOCK_OUT_TYPE VARCHAR(20) COMMENT '退勤打刻種別: STAMP=打刻、MANUAL=手入力、SCHEDULED=定時退勤。画面で背景色を変えるために使用',\n    ORIGINAL_CLOCK_IN_TIME DATETIME COMMENT '出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS',\n    ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS',\n    WORK_LOCATION_CODE VARCHAR(20) COMMENT '勤務場所コード: 外部キー。COMMUTE=通勤、REMOTE=在宅など。WORK_LOCATIONテーブルを参照。日次確定申請には必須',\n    ACTUAL_WORK_HOURS DECIMAL(5,2) COMMENT '実労働時間: 出退勤時刻と休憩時間から自動計算される実際の労働時間（時間単位）。例: 8.50=8時間30分',\n    SCHEDULED_WORK_HOURS DECIMAL(5,2) DEFAULT 7.50 COMMENT '所定労働時間: 標準勤務時間（9:00-17:30）から休憩1時間を除いた7.5時間。例: 7.50=7時間30分',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- - OVER_LEGAL_OVERTIME_HOURS: 8h超の残業（即座に法定時間外残業として扱う）",
            "lineNumber": 118
          },
          {
            "text": "-- - 割増賃金: 所定の割増率に基づき算定",
            "lineNumber": 119
          },
          {
            "text": "CREATE TABLE ATTENDANCE_RECORD (",
            "lineNumber": 120
          },
          {
            "text": "    ATTENDANCE_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '勤怠ID: 主キー。勤怠記録を一意に識別するID（自動採番）',",
            "lineNumber": 121
          },
          {
            "text": "    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID: 外部キー。どの従業員の勤怠記録か。EMPLOYEEテーブルを参照',",
            "lineNumber": 122
          },
          {
            "text": "    WORK_DATE DATE NOT NULL COMMENT '勤務日: どの日の勤怠記録か。形式YYYY-MM-DD。従業員IDと勤務日の組み合わせでユニーク',",
            "lineNumber": 123
          },
          {
            "text": "    CLOCK_IN_TIME DATETIME COMMENT '出勤時刻: WEBタイムレコーダーで打刻した時刻、または手入力した時刻。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 124
          },
          {
            "text": "    CLOCK_OUT_TIME DATETIME COMMENT '退勤時刻: WEBタイムレコーダーで打刻した時刻、または手入力した時刻。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 125
          },
          {
            "text": "    CLOCK_IN_TYPE VARCHAR(20) COMMENT '出勤打刻種別: STAMP=打刻、MANUAL=手入力、SCHEDULED=定時出勤。画面で背景色を変えるために使用',",
            "lineNumber": 126
          },
          {
            "text": "    CLOCK_OUT_TYPE VARCHAR(20) COMMENT '退勤打刻種別: STAMP=打刻、MANUAL=手入力、SCHEDULED=定時退勤。画面で背景色を変えるために使用',",
            "lineNumber": 127
          },
          {
            "text": "    ORIGINAL_CLOCK_IN_TIME DATETIME COMMENT '出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 128
          },
          {
            "text": "    ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 129
          },
          {
            "text": "    WORK_LOCATION_CODE VARCHAR(20) COMMENT '勤務場所コード: 外部キー。COMMUTE=通勤、REMOTE=在宅など。WORK_LOCATIONテーブルを参照。日次確定申請には必須',",
            "lineNumber": 130
          },
          {
            "text": "    ACTUAL_WORK_HOURS DECIMAL(5,2) COMMENT '実労働時間: 出退勤時刻と休憩時間から自動計算される実際の労働時間（時間単位）。例: 8.50=8時間30分',",
            "lineNumber": 131
          },
          {
            "text": "    SCHEDULED_WORK_HOURS DECIMAL(5,2) DEFAULT 7.50 COMMENT '所定労働時間: 標準勤務時間（9:00-17:30）から休憩1時間を除いた7.5時間。例: 7.50=7時間30分',",
            "lineNumber": 132
          }
        ]
      },
      "score": 0.3885059356689453
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 22
          },
          "endPosition": {
            "line": 56
          }
        },
        "contents": "-- 1. 従業員マスタ (EMPLOYEE)\nCREATE TABLE EMPLOYEE (\n    EMPLOYEE_ID CHAR(6) NOT NULL COMMENT '従業員ID（社員コード: 数字6桁 例: 000001）',\n    EMPLOYEE_NAME VARCHAR(100) NOT NULL COMMENT '従業員名',\n    PASSWORD VARCHAR(255) NOT NULL COMMENT 'パスワード（ハッシュ化推奨）',\n    EMAIL_ADDRESS VARCHAR(256) NOT NULL COMMENT 'メールアドレス',\n    DEPARTMENT VARCHAR(100) COMMENT '部署',\n    POSITION VARCHAR(100) COMMENT '役職',\n    HIRE_DATE DATE COMMENT '入社日',\n    STANDARD_WORK_START_TIME TIME DEFAULT '09:00:00' COMMENT '定時出勤時刻',\n    STANDARD_WORK_END_TIME TIME DEFAULT '17:30:00' COMMENT '定時退勤時刻',\n    IS_ACTIVE BOOLEAN DEFAULT TRUE COMMENT '有効フラグ',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',\n    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',\n    PRIMARY KEY (EMPLOYEE_ID),\n    CONSTRAINT CK_EMPLOYEE_ID_FORMAT CHECK (EMPLOYEE_ID REGEXP '^[0-9]{6}$'),\n    UNIQUE KEY UK_EMAIL (EMAIL_ADDRESS(191))\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='従業員マスタ';\n\n-- 2. 勤務場所マスタ (WORK_LOCATION)\nCREATE TABLE WORK_LOCATION (\n    LOCATION_CODE VARCHAR(20) NOT NULL COMMENT '勤務場所コード',\n    LOCATION_NAME VARCHAR(50) NOT NULL COMMENT '勤務場所名',\n    DISPLAY_ORDER INT NOT NULL COMMENT '表示順',\n    IS_ACTIVE BOOLEAN DEFAULT TRUE COMMENT '有効フラグ',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',\n    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',\n    PRIMARY KEY (LOCATION_CODE)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='勤務場所マスタ';\n\n-- 3. ジョブマスタ (JOB_MASTER)\nCREATE TABLE JOB_MASTER (\n    JOB_CODE VARCHAR(50) NOT NULL COMMENT 'ジョブコード',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- 1. 従業員マスタ (EMPLOYEE)",
            "lineNumber": 24
          },
          {
            "text": "CREATE TABLE EMPLOYEE (",
            "lineNumber": 25
          },
          {
            "text": "    EMPLOYEE_ID CHAR(6) NOT NULL COMMENT '従業員ID（社員コード: 数字6桁 例: 000001）',",
            "lineNumber": 26
          },
          {
            "text": "    EMPLOYEE_NAME VARCHAR(100) NOT NULL COMMENT '従業員名',",
            "lineNumber": 27
          },
          {
            "text": "    PASSWORD VARCHAR(255) NOT NULL COMMENT 'パスワード（ハッシュ化推奨）',",
            "lineNumber": 28
          },
          {
            "text": "    EMAIL_ADDRESS VARCHAR(256) NOT NULL COMMENT 'メールアドレス',",
            "lineNumber": 29
          },
          {
            "text": "    DEPARTMENT VARCHAR(100) COMMENT '部署',",
            "lineNumber": 30
          },
          {
            "text": "    POSITION VARCHAR(100) COMMENT '役職',",
            "lineNumber": 31
          },
          {
            "text": "    HIRE_DATE DATE COMMENT '入社日',",
            "lineNumber": 32
          },
          {
            "text": "    STANDARD_WORK_START_TIME TIME DEFAULT '09:00:00' COMMENT '定時出勤時刻',",
            "lineNumber": 33
          },
          {
            "text": "    STANDARD_WORK_END_TIME TIME DEFAULT '17:30:00' COMMENT '定時退勤時刻',",
            "lineNumber": 34
          },
          {
            "text": "    IS_ACTIVE BOOLEAN DEFAULT TRUE COMMENT '有効フラグ',",
            "lineNumber": 35
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',",
            "lineNumber": 36
          },
          {
            "text": "    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',",
            "lineNumber": 37
          },
          {
            "text": "    PRIMARY KEY (EMPLOYEE_ID),",
            "lineNumber": 38
          },
          {
            "text": "    CONSTRAINT CK_EMPLOYEE_ID_FORMAT CHECK (EMPLOYEE_ID REGEXP '^[0-9]{6}$'),",
            "lineNumber": 39
          },
          {
            "text": "    UNIQUE KEY UK_EMAIL (EMAIL_ADDRESS(191))",
            "lineNumber": 40
          },
          {
            "text": ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='従業員マスタ';",
            "lineNumber": 41
          },
          {
            "lineNumber": 42
          },
          {
            "text": "-- 2. 勤務場所マスタ (WORK_LOCATION)",
            "lineNumber": 43
          },
          {
            "text": "CREATE TABLE WORK_LOCATION (",
            "lineNumber": 44
          },
          {
            "text": "    LOCATION_CODE VARCHAR(20) NOT NULL COMMENT '勤務場所コード',",
            "lineNumber": 45
          },
          {
            "text": "    LOCATION_NAME VARCHAR(50) NOT NULL COMMENT '勤務場所名',",
            "lineNumber": 46
          },
          {
            "text": "    DISPLAY_ORDER INT NOT NULL COMMENT '表示順',",
            "lineNumber": 47
          },
          {
            "text": "    IS_ACTIVE BOOLEAN DEFAULT TRUE COMMENT '有効フラグ',",
            "lineNumber": 48
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',",
            "lineNumber": 49
          },
          {
            "text": "    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',",
            "lineNumber": 50
          },
          {
            "text": "    PRIMARY KEY (LOCATION_CODE)",
            "lineNumber": 51
          },
          {
            "text": ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='勤務場所マスタ';",
            "lineNumber": 52
          },
          {
            "lineNumber": 53
          },
          {
            "text": "-- 3. ジョブマスタ (JOB_MASTER)",
            "lineNumber": 54
          },
          {
            "text": "CREATE TABLE JOB_MASTER (",
            "lineNumber": 55
          },
          {
            "text": "    JOB_CODE VARCHAR(50) NOT NULL COMMENT 'ジョブコード',",
            "lineNumber": 56
          }
        ]
      },
      "score": 0.3872978985309601
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\home-screen.md",
        "range": {
          "startPosition": {
            "line": 333
          },
          "endPosition": {
            "line": 373
          }
        },
        "contents": "| :--- | :--- | :--- | :--- | :--- | :--- |\n| 1 | APPLICATION_ID | 申請ID | EMPLOYEE_ID = ログインユーザーの従業員ID | - | ログインユーザーの申請 |\n| 2 | APPROVAL_STATUS | 承認状態 | APPLICATION_TYPE = 'HOLIDAY_WORK' | - | 休日出勤申請のみ |\n| 3 | TARGET_START_DATE | 対象開始日 | TARGET_START_DATE &lt;= システム日付 | - | 申請期間内 |\n| 4 | TARGET_END_DATE | 対象終了日 | TARGET_END_DATE &gt;= システム日付 | - | 申請期間内 |\n| 5 | - | - | APPROVAL_STATUS IN ('PENDING', 'APPROVED') | - | 申請中または承認済みのみ |\n\n**取得条件の詳細**:\n&#96;&#96;&#96;sql\nSELECT APPLICATION_ID, APPROVAL_STATUS\nFROM APPLICATION_HISTORY\nWHERE EMPLOYEE_ID = :employeeId\n  AND APPLICATION_TYPE = 'HOLIDAY_WORK'\n  AND TARGET_START_DATE &lt;= CURDATE()\n  AND TARGET_END_DATE &gt;= CURDATE()\n  AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')\nLIMIT 1;\n&#96;&#96;&#96;\n\n**備考**: \n- 当日が土日祝の場合のみ取得する\n- 土日祝の判定は、曜日（0=日曜日、6=土曜日）と祝日ライブラリ（HolidayJp）を使用する\n- 申請が存在しない、または申請中（PENDING）・承認済み（APPROVED）でない場合、打刻ボタンは非活性化される\n- 申請中（PENDING）の場合でも打刻が可能になる\n\n## テーブル更新仕様\n\n### No.1\n- テーブル更新仕様名：出勤打刻登録\n- 対象テーブル：ATTENDANCE_RECORD\n- 更新タイミング：出勤ボタン押下時\n\n| No | 更新項目 | 項目名（論理名） | 設定値 | 条件 | 備考 |\n| :--- | :--- | :--- | :--- | :--- | :--- |\n| 1 | EMPLOYEE_ID | 従業員ID | ログインユーザーの従業員ID | 新規レコード作成時 | - |\n| 2 | WORK_DATE | 勤務日 | システム日付 | 新規レコード作成時 | - |\n| 3 | CLOCK_IN_TIME | 出勤時刻 | システム日時 | - | 現在時刻を設定 |\n| 4 | CLOCK_IN_TYPE | 出勤打刻種別 | 'STAMP' | - | 打刻による出勤 |\n| 5 | WORK_LOCATION_CODE | 勤務場所コード | 選択された勤務場所コード | - | - |\n| 6 | CREATED_AT | 作成日時 | システム日時 | 新規レコード作成時 | - |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| :--- | :--- | :--- | :--- | :--- | :--- |",
            "lineNumber": 334
          },
          {
            "text": "| 1 | APPLICATION_ID | 申請ID | EMPLOYEE_ID = ログインユーザーの従業員ID | - | ログインユーザーの申請 |",
            "lineNumber": 335
          },
          {
            "text": "| 2 | APPROVAL_STATUS | 承認状態 | APPLICATION_TYPE = 'HOLIDAY_WORK' | - | 休日出勤申請のみ |",
            "lineNumber": 336
          },
          {
            "text": "| 3 | TARGET_START_DATE | 対象開始日 | TARGET_START_DATE &lt;= システム日付 | - | 申請期間内 |",
            "lineNumber": 337
          },
          {
            "text": "| 4 | TARGET_END_DATE | 対象終了日 | TARGET_END_DATE &gt;= システム日付 | - | 申請期間内 |",
            "lineNumber": 338
          },
          {
            "text": "| 5 | - | - | APPROVAL_STATUS IN ('PENDING', 'APPROVED') | - | 申請中または承認済みのみ |",
            "lineNumber": 339
          },
          {
            "lineNumber": 340
          },
          {
            "text": "**取得条件の詳細**:",
            "lineNumber": 341
          },
          {
            "text": "&#96;&#96;&#96;sql",
            "lineNumber": 342
          },
          {
            "text": "SELECT APPLICATION_ID, APPROVAL_STATUS",
            "lineNumber": 343
          },
          {
            "text": "FROM APPLICATION_HISTORY",
            "lineNumber": 344
          },
          {
            "text": "WHERE EMPLOYEE_ID = :employeeId",
            "lineNumber": 345
          },
          {
            "text": "  AND APPLICATION_TYPE = 'HOLIDAY_WORK'",
            "lineNumber": 346
          },
          {
            "text": "  AND TARGET_START_DATE &lt;= CURDATE()",
            "lineNumber": 347
          },
          {
            "text": "  AND TARGET_END_DATE &gt;= CURDATE()",
            "lineNumber": 348
          },
          {
            "text": "  AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')",
            "lineNumber": 349
          },
          {
            "text": "LIMIT 1;",
            "lineNumber": 350
          },
          {
            "text": "&#96;&#96;&#96;",
            "lineNumber": 351
          },
          {
            "lineNumber": 352
          },
          {
            "text": "**備考**: ",
            "lineNumber": 353
          },
          {
            "text": "- 当日が土日祝の場合のみ取得する",
            "lineNumber": 354
          },
          {
            "text": "- 土日祝の判定は、曜日（0=日曜日、6=土曜日）と祝日ライブラリ（HolidayJp）を使用する",
            "lineNumber": 355
          },
          {
            "text": "- 申請が存在しない、または申請中（PENDING）・承認済み（APPROVED）でない場合、打刻ボタンは非活性化される",
            "lineNumber": 356
          },
          {
            "text": "- 申請中（PENDING）の場合でも打刻が可能になる",
            "lineNumber": 357
          },
          {
            "lineNumber": 358
          },
          {
            "text": "## テーブル更新仕様",
            "lineNumber": 359
          },
          {
            "lineNumber": 360
          },
          {
            "text": "### No.1",
            "lineNumber": 361
          },
          {
            "text": "- テーブル更新仕様名：出勤打刻登録",
            "lineNumber": 362
          },
          {
            "text": "- 対象テーブル：ATTENDANCE_RECORD",
            "lineNumber": 363
          },
          {
            "text": "- 更新タイミング：出勤ボタン押下時",
            "lineNumber": 364
          },
          {
            "lineNumber": 365
          },
          {
            "text": "| No | 更新項目 | 項目名（論理名） | 設定値 | 条件 | 備考 |",
            "lineNumber": 366
          },
          {
            "text": "| :--- | :--- | :--- | :--- | :--- | :--- |",
            "lineNumber": 367
          },
          {
            "text": "| 1 | EMPLOYEE_ID | 従業員ID | ログインユーザーの従業員ID | 新規レコード作成時 | - |",
            "lineNumber": 368
          },
          {
            "text": "| 2 | WORK_DATE | 勤務日 | システム日付 | 新規レコード作成時 | - |",
            "lineNumber": 369
          },
          {
            "text": "| 3 | CLOCK_IN_TIME | 出勤時刻 | システム日時 | - | 現在時刻を設定 |",
            "lineNumber": 370
          },
          {
            "text": "| 4 | CLOCK_IN_TYPE | 出勤打刻種別 | 'STAMP' | - | 打刻による出勤 |",
            "lineNumber": 371
          },
          {
            "text": "| 5 | WORK_LOCATION_CODE | 勤務場所コード | 選択された勤務場所コード | - | - |",
            "lineNumber": 372
          },
          {
            "text": "| 6 | CREATED_AT | 作成日時 | システム日時 | 新規レコード作成時 | - |",
            "lineNumber": 373
          }
        ]
      },
      "score": 0.3867100477218628
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-table-screen.md",
        "range": {
          "startPosition": {
            "line": 182
          },
          "endPosition": {
            "line": 202
          }
        },
        "contents": "| 17 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;日次確定日時 | 日時 | 正常 | | DAILY_CONFIRMED_AT |\n| 18 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;承認状態 | 文字 | 正常 | NOT_SUBMITTED | APPROVAL_STATUS (NOT_SUBMITTED/PENDING/APPROVED/REJECTED) |\n| 19 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;備考 | 文字 | 正常 | | REMARK_TEXT |\n| 20 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩時間リスト | リスト | 正常 | | BREAK_TIME |\n| 21 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;公用外出リスト | リスト | 正常 | | OFFICIAL_OUTING |\n| 22 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;工数実績リスト | リスト | 正常 | | WORK_HOURS |\n| 23 | 月次サマリーデータ | オブジェクト | 正常 | | 月間集計データ |\n| 24 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;所定出勤日数 | 整数 | 正常 | | SCHEDULED_WORK_DAYS |\n| 25 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実出勤日数 | 整数 | 正常 | | ACTUAL_WORK_DAYS（出勤時刻と退勤時刻が両方記録されている日数） |\n| 26 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;所定労働時間 | 文字 | 正常 | | SCHEDULED_WORK_HOURS |\n| 27 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;総労働時間 | 文字 | 正常 | | TOTAL_WORK_HOURS |\n| 28 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;過不足時間 | 文字 | 正常 | | OVER_UNDER_TIME |\n| 29 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定休日労働 | 文字 | 正常 | | LEGAL_HOLIDAY_WORK_HOURS |\n| 30 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定時間内残業 | 文字 | 正常 | | WITHIN_LEGAL_OVERTIME_HOURS |\n| 31 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定時間外残業 | 文字 | 正常 | | OVER_LEGAL_OVERTIME_HOURS |\n| 32 | 勤務場所マスタ | リスト | 正常 | | WORK_LOCATION |\n| 33 | 休暇申請データ | リスト | 正常 | | VACATION_HISTORY（該当月の休暇申請情報） |\n| 34 | 月次承認状態 | 文字 | 正常 | NOT_SUBMITTED | MONTHLY_APPROVAL_STATUS (NOT_SUBMITTED/PENDING/APPROVED/REJECTED) |\n| 35 | 月次承認履歴 | リスト | 正常 | | MONTHLY_APPROVAL_HISTORY（月次確定の承認履歴） |\n| 36 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;履歴ID | 整数 | 正常 | | HISTORY_ID |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| 17 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;日次確定日時 | 日時 | 正常 | | DAILY_CONFIRMED_AT |",
            "lineNumber": 183
          },
          {
            "text": "| 18 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;承認状態 | 文字 | 正常 | NOT_SUBMITTED | APPROVAL_STATUS (NOT_SUBMITTED/PENDING/APPROVED/REJECTED) |",
            "lineNumber": 184
          },
          {
            "text": "| 19 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;備考 | 文字 | 正常 | | REMARK_TEXT |",
            "lineNumber": 185
          },
          {
            "text": "| 20 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩時間リスト | リスト | 正常 | | BREAK_TIME |",
            "lineNumber": 186
          },
          {
            "text": "| 21 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;公用外出リスト | リスト | 正常 | | OFFICIAL_OUTING |",
            "lineNumber": 187
          },
          {
            "text": "| 22 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;工数実績リスト | リスト | 正常 | | WORK_HOURS |",
            "lineNumber": 188
          },
          {
            "text": "| 23 | 月次サマリーデータ | オブジェクト | 正常 | | 月間集計データ |",
            "lineNumber": 189
          },
          {
            "text": "| 24 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;所定出勤日数 | 整数 | 正常 | | SCHEDULED_WORK_DAYS |",
            "lineNumber": 190
          },
          {
            "text": "| 25 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実出勤日数 | 整数 | 正常 | | ACTUAL_WORK_DAYS（出勤時刻と退勤時刻が両方記録されている日数） |",
            "lineNumber": 191
          },
          {
            "text": "| 26 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;所定労働時間 | 文字 | 正常 | | SCHEDULED_WORK_HOURS |",
            "lineNumber": 192
          },
          {
            "text": "| 27 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;総労働時間 | 文字 | 正常 | | TOTAL_WORK_HOURS |",
            "lineNumber": 193
          },
          {
            "text": "| 28 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;過不足時間 | 文字 | 正常 | | OVER_UNDER_TIME |",
            "lineNumber": 194
          },
          {
            "text": "| 29 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定休日労働 | 文字 | 正常 | | LEGAL_HOLIDAY_WORK_HOURS |",
            "lineNumber": 195
          },
          {
            "text": "| 30 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定時間内残業 | 文字 | 正常 | | WITHIN_LEGAL_OVERTIME_HOURS |",
            "lineNumber": 196
          },
          {
            "text": "| 31 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;法定時間外残業 | 文字 | 正常 | | OVER_LEGAL_OVERTIME_HOURS |",
            "lineNumber": 197
          },
          {
            "text": "| 32 | 勤務場所マスタ | リスト | 正常 | | WORK_LOCATION |",
            "lineNumber": 198
          },
          {
            "text": "| 33 | 休暇申請データ | リスト | 正常 | | VACATION_HISTORY（該当月の休暇申請情報） |",
            "lineNumber": 199
          },
          {
            "text": "| 34 | 月次承認状態 | 文字 | 正常 | NOT_SUBMITTED | MONTHLY_APPROVAL_STATUS (NOT_SUBMITTED/PENDING/APPROVED/REJECTED) |",
            "lineNumber": 200
          },
          {
            "text": "| 35 | 月次承認履歴 | リスト | 正常 | | MONTHLY_APPROVAL_HISTORY（月次確定の承認履歴） |",
            "lineNumber": 201
          },
          {
            "text": "| 36 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;履歴ID | 整数 | 正常 | | HISTORY_ID |",
            "lineNumber": 202
          }
        ]
      },
      "score": 0.3849904537200928
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 50,
            "column": 2
          },
          "endPosition": {
            "line": 85,
            "column": 3
          }
        },
        "contents": "/**\n * 休日出勤申請\n * @param {Object} applicationData - 申請データ\n * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID\n */\nconst applyHolidayWork = async (applicationData) =&gt; {\n  const { employeeId, workDate, startTime, endTime, breakHours, reason } = applicationData;\n  const now = getNow();\n  \n  // REASONフィールドにJSON形式で時間情報を保存\n  const reasonData = {\n    text: reason || '',\n    startTime: startTime,\n    endTime: endTime,\n    breakHours: breakHours\n  };\n  \n  return await applicationModel.createApplication({\n    employeeId,\n    applicationType: 'HOLIDAY_WORK',\n    targetStartDate: workDate,\n    targetEndDate: workDate,\n    reason: JSON.stringify(reasonData),\n    approvalStatus: 'PENDING',\n    createdAt: now,\n    updatedAt: now\n  });\n};\n\n/**\n * 残業申請\n * @param {Object} applicationData - 申請データ\n * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 53
          },
          {
            "text": " * 休日出勤申請",
            "lineNumber": 54
          },
          {
            "text": " * @param {Object} applicationData - 申請データ",
            "lineNumber": 55
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID",
            "lineNumber": 56
          },
          {
            "text": " */",
            "lineNumber": 57
          },
          {
            "text": "const applyHolidayWork = async (applicationData) =&gt; {",
            "lineNumber": 58
          },
          {
            "text": "  const { employeeId, workDate, startTime, endTime, breakHours, reason } = applicationData;",
            "lineNumber": 59
          },
          {
            "text": "  const now = getNow();",
            "lineNumber": 60
          },
          {
            "text": "  ",
            "lineNumber": 61
          },
          {
            "text": "  // REASONフィールドにJSON形式で時間情報を保存",
            "lineNumber": 62
          },
          {
            "text": "  const reasonData = {",
            "lineNumber": 63
          },
          {
            "text": "    text: reason || '',",
            "lineNumber": 64
          },
          {
            "text": "    startTime: startTime,",
            "lineNumber": 65
          },
          {
            "text": "    endTime: endTime,",
            "lineNumber": 66
          },
          {
            "text": "    breakHours: breakHours",
            "lineNumber": 67
          },
          {
            "text": "  };",
            "lineNumber": 68
          },
          {
            "text": "  ",
            "lineNumber": 69
          },
          {
            "text": "  return await applicationModel.createApplication({",
            "lineNumber": 70
          },
          {
            "text": "    employeeId,",
            "lineNumber": 71
          },
          {
            "text": "    applicationType: 'HOLIDAY_WORK',",
            "lineNumber": 72
          },
          {
            "text": "    targetStartDate: workDate,",
            "lineNumber": 73
          },
          {
            "text": "    targetEndDate: workDate,",
            "lineNumber": 74
          },
          {
            "text": "    reason: JSON.stringify(reasonData),",
            "lineNumber": 75
          },
          {
            "text": "    approvalStatus: 'PENDING',",
            "lineNumber": 76
          },
          {
            "text": "    createdAt: now,",
            "lineNumber": 77
          },
          {
            "text": "    updatedAt: now",
            "lineNumber": 78
          },
          {
            "text": "  });",
            "lineNumber": 79
          },
          {
            "text": "};",
            "lineNumber": 80
          },
          {
            "lineNumber": 81
          },
          {
            "text": "/**",
            "lineNumber": 82
          },
          {
            "text": " * 残業申請",
            "lineNumber": 83
          },
          {
            "text": " * @param {Object} applicationData - 申請データ",
            "lineNumber": 84
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたAPPLICATION_ID",
            "lineNumber": 85
          },
          {
            "text": " */",
            "lineNumber": 86
          }
        ]
      },
      "score": 0.38450896739959717
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\er-diagram.md",
        "range": {
          "startPosition": {
            "line": 60
          },
          "endPosition": {
            "line": 135
          }
        },
        "contents": "    }\n\n    VACATION_TYPE {\n        string VACATION_TYPE_CODE PK\n        string VACATION_TYPE_NAME\n        string VACATION_CATEGORY\n        boolean IS_PAID\n        float ANNUAL_GRANT_DAYS\n        int DISPLAY_ORDER\n        boolean IS_ACTIVE\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    NOTIFICATION {\n        int NOTIFICATION_ID PK\n        string NOTIFICATION_TYPE\n        string TARGET_TYPE\n        string TARGET_ID\n        string TITLE\n        text CONTENT\n        datetime DISPLAY_START_DATE\n        datetime DISPLAY_END_DATE\n        boolean IS_IMPORTANT\n        boolean IS_ACTIVE\n        string CREATED_BY\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    ATTENDANCE_RECORD {\n        int ATTENDANCE_ID PK\n        string EMPLOYEE_ID FK\n        date WORK_DATE\n        datetime CLOCK_IN_TIME\n        datetime CLOCK_OUT_TIME\n        string CLOCK_IN_TYPE\n        string CLOCK_OUT_TYPE\n        datetime ORIGINAL_CLOCK_IN_TIME\n        datetime ORIGINAL_CLOCK_OUT_TIME\n        string WORK_LOCATION_CODE FK\n        float ACTUAL_WORK_HOURS\n        float SCHEDULED_WORK_HOURS\n        float OVERTIME_HOURS\n        float WITHIN_LEGAL_OVERTIME_HOURS\n        float OVER_LEGAL_OVERTIME_HOURS\n        float NIGHT_WORK_HOURS\n        float LEGAL_HOLIDAY_WORK_HOURS\n        float HOLIDAY_WORK_HOURS\n        boolean IS_DAILY_CONFIRMED\n        datetime DAILY_CONFIRMED_AT\n        boolean IS_MONTHLY_CONFIRMED\n        datetime MONTHLY_CONFIRMED_AT\n        string APPROVAL_STATUS\n        text REMARK_TEXT\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    BREAK_TIME {\n        int BREAK_ID PK\n        int ATTENDANCE_ID FK\n        int BREAK_SEQ\n        datetime BREAK_START_TIME\n        datetime BREAK_END_TIME\n        int BREAK_DURATION_MINUTES\n        string BREAK_TYPE\n        datetime CREATED_AT\n        datetime UPDATED_AT\n    }\n\n    OFFICIAL_OUTING {\n        int OUTING_ID PK\n        int ATTENDANCE_ID FK\n        int OUTING_SEQ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    }",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "    VACATION_TYPE {",
            "lineNumber": 63
          },
          {
            "text": "        string VACATION_TYPE_CODE PK",
            "lineNumber": 64
          },
          {
            "text": "        string VACATION_TYPE_NAME",
            "lineNumber": 65
          },
          {
            "text": "        string VACATION_CATEGORY",
            "lineNumber": 66
          },
          {
            "text": "        boolean IS_PAID",
            "lineNumber": 67
          },
          {
            "text": "        float ANNUAL_GRANT_DAYS",
            "lineNumber": 68
          },
          {
            "text": "        int DISPLAY_ORDER",
            "lineNumber": 69
          },
          {
            "text": "        boolean IS_ACTIVE",
            "lineNumber": 70
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 71
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 72
          },
          {
            "text": "    }",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "    NOTIFICATION {",
            "lineNumber": 75
          },
          {
            "text": "        int NOTIFICATION_ID PK",
            "lineNumber": 76
          },
          {
            "text": "        string NOTIFICATION_TYPE",
            "lineNumber": 77
          },
          {
            "text": "        string TARGET_TYPE",
            "lineNumber": 78
          },
          {
            "text": "        string TARGET_ID",
            "lineNumber": 79
          },
          {
            "text": "        string TITLE",
            "lineNumber": 80
          },
          {
            "text": "        text CONTENT",
            "lineNumber": 81
          },
          {
            "text": "        datetime DISPLAY_START_DATE",
            "lineNumber": 82
          },
          {
            "text": "        datetime DISPLAY_END_DATE",
            "lineNumber": 83
          },
          {
            "text": "        boolean IS_IMPORTANT",
            "lineNumber": 84
          },
          {
            "text": "        boolean IS_ACTIVE",
            "lineNumber": 85
          },
          {
            "text": "        string CREATED_BY",
            "lineNumber": 86
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 87
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 88
          },
          {
            "text": "    }",
            "lineNumber": 89
          },
          {
            "lineNumber": 90
          },
          {
            "text": "    ATTENDANCE_RECORD {",
            "lineNumber": 91
          },
          {
            "text": "        int ATTENDANCE_ID PK",
            "lineNumber": 92
          },
          {
            "text": "        string EMPLOYEE_ID FK",
            "lineNumber": 93
          },
          {
            "text": "        date WORK_DATE",
            "lineNumber": 94
          },
          {
            "text": "        datetime CLOCK_IN_TIME",
            "lineNumber": 95
          },
          {
            "text": "        datetime CLOCK_OUT_TIME",
            "lineNumber": 96
          },
          {
            "text": "        string CLOCK_IN_TYPE",
            "lineNumber": 97
          },
          {
            "text": "        string CLOCK_OUT_TYPE",
            "lineNumber": 98
          },
          {
            "text": "        datetime ORIGINAL_CLOCK_IN_TIME",
            "lineNumber": 99
          },
          {
            "text": "        datetime ORIGINAL_CLOCK_OUT_TIME",
            "lineNumber": 100
          },
          {
            "text": "        string WORK_LOCATION_CODE FK",
            "lineNumber": 101
          },
          {
            "text": "        float ACTUAL_WORK_HOURS",
            "lineNumber": 102
          },
          {
            "text": "        float SCHEDULED_WORK_HOURS",
            "lineNumber": 103
          },
          {
            "text": "        float OVERTIME_HOURS",
            "lineNumber": 104
          },
          {
            "text": "        float WITHIN_LEGAL_OVERTIME_HOURS",
            "lineNumber": 105
          },
          {
            "text": "        float OVER_LEGAL_OVERTIME_HOURS",
            "lineNumber": 106
          },
          {
            "text": "        float NIGHT_WORK_HOURS",
            "lineNumber": 107
          },
          {
            "text": "        float LEGAL_HOLIDAY_WORK_HOURS",
            "lineNumber": 108
          },
          {
            "text": "        float HOLIDAY_WORK_HOURS",
            "lineNumber": 109
          },
          {
            "text": "        boolean IS_DAILY_CONFIRMED",
            "lineNumber": 110
          },
          {
            "text": "        datetime DAILY_CONFIRMED_AT",
            "lineNumber": 111
          },
          {
            "text": "        boolean IS_MONTHLY_CONFIRMED",
            "lineNumber": 112
          },
          {
            "text": "        datetime MONTHLY_CONFIRMED_AT",
            "lineNumber": 113
          },
          {
            "text": "        string APPROVAL_STATUS",
            "lineNumber": 114
          },
          {
            "text": "        text REMARK_TEXT",
            "lineNumber": 115
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 116
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 117
          },
          {
            "text": "    }",
            "lineNumber": 118
          },
          {
            "lineNumber": 119
          },
          {
            "text": "    BREAK_TIME {",
            "lineNumber": 120
          },
          {
            "text": "        int BREAK_ID PK",
            "lineNumber": 121
          },
          {
            "text": "        int ATTENDANCE_ID FK",
            "lineNumber": 122
          },
          {
            "text": "        int BREAK_SEQ",
            "lineNumber": 123
          },
          {
            "text": "        datetime BREAK_START_TIME",
            "lineNumber": 124
          },
          {
            "text": "        datetime BREAK_END_TIME",
            "lineNumber": 125
          },
          {
            "text": "        int BREAK_DURATION_MINUTES",
            "lineNumber": 126
          },
          {
            "text": "        string BREAK_TYPE",
            "lineNumber": 127
          },
          {
            "text": "        datetime CREATED_AT",
            "lineNumber": 128
          },
          {
            "text": "        datetime UPDATED_AT",
            "lineNumber": 129
          },
          {
            "text": "    }",
            "lineNumber": 130
          },
          {
            "lineNumber": 131
          },
          {
            "text": "    OFFICIAL_OUTING {",
            "lineNumber": 132
          },
          {
            "text": "        int OUTING_ID PK",
            "lineNumber": 133
          },
          {
            "text": "        int ATTENDANCE_ID FK",
            "lineNumber": 134
          },
          {
            "text": "        int OUTING_SEQ",
            "lineNumber": 135
          }
        ]
      },
      "score": 0.3832330107688904
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\README_MySQL.md",
        "range": {
          "startPosition": {
            "line": 279
          },
          "endPosition": {
            "line": 306
          }
        },
        "contents": "| **EMPLOYEE_ID** | VARCHAR(50) | NOT NULL | - | **外部キー**。どの従業員の工数か。&#96;EMPLOYEE&#96;テーブルを参照。集計時に使用します。 |\n| **WORK_DATE** | DATE | NOT NULL | - | 作業日。どの日に作業したか。形式: &#96;YYYY-MM-DD&#96; 例: &#96;2025-11-25&#96; |\n| **JOB_CODE** | VARCHAR(50) | NOT NULL | - | **外部キー**。どのジョブ（プロジェクト・タスク）に工数を投入したか。&#96;JOB_MASTER&#96;テーブルを参照。 |\n| **WORK_CODE** | VARCHAR(50) | NULL | - | 作業コード。具体的な作業内容を識別するコード。例: &#96;DEV001&#96;、&#96;TRN001&#96; |\n| **WORK_HOURS_VALUE** | DECIMAL(5,2) | NOT NULL | - | 工数時間（時間単位）。スライダーまたは数値入力で入力します。例: &#96;5.00&#96;=5時間、&#96;3.50&#96;=3時間30分 |\n| **WORK_VOLUME** | INT | NULL | - | 作業ボリューム（0-10の段階）。時間入力の代わりにボリューム入力も可能。例: &#96;5&#96;=中程度の作業量 |\n| **INPUT_TYPE** | VARCHAR(20) | NULL | &#96;TIME&#96; | 入力種別。&#96;TIME&#96;=時間入力、&#96;VOLUME&#96;=ボリューム入力。 |\n| **REMARKS** | TEXT | NULL | - | 備考。工数に関する補足情報。 |\n| **CREATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード作成日時。 |\n| **UPDATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード更新日時。 |\n\n**重要な制約:**\n- 1日の工数の合計が実労働時間と一致する必要があります（日次確定申請の条件）\n\n**使用例:**\n- ジョブAに5時間、ジョブBに3時間 → 合計8時間（実労働時間と一致）\n\n---\n\n### 10. 休暇残日数 (VACATION_BALANCE)\n\n従業員ごとの休暇種別別の付与日数、使用日数、残日数を管理するテーブルです。年度ごとに管理されます。\n\n| カラム名 | 型 | NULL | デフォルト | 説明 |\n|---------|-----|------|-----------|------|\n| **BALANCE_ID** | BIGINT | NOT NULL | AUTO_INCREMENT | **主キー**。休暇残日数を一意に識別するID。自動採番されます。 |\n| **EMPLOYEE_ID** | VARCHAR(50) | NOT NULL | - | **外部キー**。どの従業員の休暇残日数か。&#96;EMPLOYEE&#96;テーブルを参照。 |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| **EMPLOYEE_ID** | VARCHAR(50) | NOT NULL | - | **外部キー**。どの従業員の工数か。&#96;EMPLOYEE&#96;テーブルを参照。集計時に使用します。 |",
            "lineNumber": 280
          },
          {
            "text": "| **WORK_DATE** | DATE | NOT NULL | - | 作業日。どの日に作業したか。形式: &#96;YYYY-MM-DD&#96; 例: &#96;2025-11-25&#96; |",
            "lineNumber": 281
          },
          {
            "text": "| **JOB_CODE** | VARCHAR(50) | NOT NULL | - | **外部キー**。どのジョブ（プロジェクト・タスク）に工数を投入したか。&#96;JOB_MASTER&#96;テーブルを参照。 |",
            "lineNumber": 282
          },
          {
            "text": "| **WORK_CODE** | VARCHAR(50) | NULL | - | 作業コード。具体的な作業内容を識別するコード。例: &#96;DEV001&#96;、&#96;TRN001&#96; |",
            "lineNumber": 283
          },
          {
            "text": "| **WORK_HOURS_VALUE** | DECIMAL(5,2) | NOT NULL | - | 工数時間（時間単位）。スライダーまたは数値入力で入力します。例: &#96;5.00&#96;=5時間、&#96;3.50&#96;=3時間30分 |",
            "lineNumber": 284
          },
          {
            "text": "| **WORK_VOLUME** | INT | NULL | - | 作業ボリューム（0-10の段階）。時間入力の代わりにボリューム入力も可能。例: &#96;5&#96;=中程度の作業量 |",
            "lineNumber": 285
          },
          {
            "text": "| **INPUT_TYPE** | VARCHAR(20) | NULL | &#96;TIME&#96; | 入力種別。&#96;TIME&#96;=時間入力、&#96;VOLUME&#96;=ボリューム入力。 |",
            "lineNumber": 286
          },
          {
            "text": "| **REMARKS** | TEXT | NULL | - | 備考。工数に関する補足情報。 |",
            "lineNumber": 287
          },
          {
            "text": "| **CREATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード作成日時。 |",
            "lineNumber": 288
          },
          {
            "text": "| **UPDATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード更新日時。 |",
            "lineNumber": 289
          },
          {
            "lineNumber": 290
          },
          {
            "text": "**重要な制約:**",
            "lineNumber": 291
          },
          {
            "text": "- 1日の工数の合計が実労働時間と一致する必要があります（日次確定申請の条件）",
            "lineNumber": 292
          },
          {
            "lineNumber": 293
          },
          {
            "text": "**使用例:**",
            "lineNumber": 294
          },
          {
            "text": "- ジョブAに5時間、ジョブBに3時間 → 合計8時間（実労働時間と一致）",
            "lineNumber": 295
          },
          {
            "lineNumber": 296
          },
          {
            "text": "---",
            "lineNumber": 297
          },
          {
            "lineNumber": 298
          },
          {
            "text": "### 10. 休暇残日数 (VACATION_BALANCE)",
            "lineNumber": 299
          },
          {
            "lineNumber": 300
          },
          {
            "text": "従業員ごとの休暇種別別の付与日数、使用日数、残日数を管理するテーブルです。年度ごとに管理されます。",
            "lineNumber": 301
          },
          {
            "lineNumber": 302
          },
          {
            "text": "| カラム名 | 型 | NULL | デフォルト | 説明 |",
            "lineNumber": 303
          },
          {
            "text": "|---------|-----|------|-----------|------|",
            "lineNumber": 304
          },
          {
            "text": "| **BALANCE_ID** | BIGINT | NOT NULL | AUTO_INCREMENT | **主キー**。休暇残日数を一意に識別するID。自動採番されます。 |",
            "lineNumber": 305
          },
          {
            "text": "| **EMPLOYEE_ID** | VARCHAR(50) | NOT NULL | - | **外部キー**。どの従業員の休暇残日数か。&#96;EMPLOYEE&#96;テーブルを参照。 |",
            "lineNumber": 306
          }
        ]
      },
      "score": 0.3794521987438202
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\README_MySQL.md",
        "range": {
          "startPosition": {
            "line": 64
          },
          "endPosition": {
            "line": 99
          }
        },
        "contents": "| No | テーブル名 | 英名 | 説明 |\n|----|-----------|------|------|\n| 1 | 従業員マスタ | EMPLOYEE | 従業員の基本情報 |\n| 2 | 勤務場所マスタ | WORK_LOCATION | 勤務場所（通勤、在宅など） |\n| 3 | ジョブマスタ | JOB_MASTER | プロジェクト・タスク情報 |\n| 4 | 休暇種別マスタ | VACATION_TYPE | 休暇種別（有給、夏季など） |\n| 5 | お知らせマスタ | NOTIFICATION | システムお知らせ情報 |\n\n### トランザクションテーブル（8テーブル）\n\n| No | テーブル名 | 英名 | 説明 |\n|----|-----------|------|------|\n| 6 | 勤怠記録 | ATTENDANCE_RECORD | 日次の出退勤記録 |\n| 7 | 休憩時間 | BREAK_TIME | 複数の休憩時間帯 |\n| 8 | 公用外出 | OFFICIAL_OUTING | 公用外出の記録 |\n| 9 | 工数実績 | WORK_HOURS | ジョブに対する工数入力 |\n| 10 | 休暇残日数 | VACATION_BALANCE | 休暇の残日数管理 |\n| 11 | 休暇取得履歴 | VACATION_HISTORY | 休暇取得の履歴 |\n| 12 | 月次勤怠 | MONTHLY_ATTENDANCE | 月次の勤怠集計と承認状態 |\n| 13 | 月次承認履歴 | MONTHLY_APPROVAL_HISTORY | 月次確定の承認履歴 |\n\n---\n\n## テーブル詳細（全カラム説明）\n\n### 1. 従業員マスタ (EMPLOYEE)\n\n従業員の基本情報とログイン認証情報を管理するテーブルです。\n\n| カラム名 | 型 | NULL | デフォルト | 説明 |\n|---------|-----|------|-----------|------|\n| **EMPLOYEE_ID** | CHAR(6) | NOT NULL | - | **主キー**。従業員を一意に識別するID（社員コード）。数字6桁で管理します。例: &#96;000001&#96; |\n| **EMPLOYEE_NAME** | VARCHAR(100) | NOT NULL | - | 従業員の氏名。画面表示やレポートで使用します。例: &#96;山田 太郎&#96; |\n| **PASSWORD** | VARCHAR(255) | NOT NULL | - | ログイン用パスワード。本番環境ではハッシュ化（bcrypt等）を推奨します。テスト用: &#96;Password@1234&#96;（平文）または &#96;$2b$10$...&#96;（ハッシュ） |\n| **EMAIL_ADDRESS** | VARCHAR(256) | NOT NULL | - | メールアドレス。ユニーク制約あり。通知や連絡先として使用します。例: &#96;yamada.taro@example.com&#96; |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| No | テーブル名 | 英名 | 説明 |",
            "lineNumber": 65
          },
          {
            "text": "|----|-----------|------|------|",
            "lineNumber": 66
          },
          {
            "text": "| 1 | 従業員マスタ | EMPLOYEE | 従業員の基本情報 |",
            "lineNumber": 67
          },
          {
            "text": "| 2 | 勤務場所マスタ | WORK_LOCATION | 勤務場所（通勤、在宅など） |",
            "lineNumber": 68
          },
          {
            "text": "| 3 | ジョブマスタ | JOB_MASTER | プロジェクト・タスク情報 |",
            "lineNumber": 69
          },
          {
            "text": "| 4 | 休暇種別マスタ | VACATION_TYPE | 休暇種別（有給、夏季など） |",
            "lineNumber": 70
          },
          {
            "text": "| 5 | お知らせマスタ | NOTIFICATION | システムお知らせ情報 |",
            "lineNumber": 71
          },
          {
            "lineNumber": 72
          },
          {
            "text": "### トランザクションテーブル（8テーブル）",
            "lineNumber": 73
          },
          {
            "lineNumber": 74
          },
          {
            "text": "| No | テーブル名 | 英名 | 説明 |",
            "lineNumber": 75
          },
          {
            "text": "|----|-----------|------|------|",
            "lineNumber": 76
          },
          {
            "text": "| 6 | 勤怠記録 | ATTENDANCE_RECORD | 日次の出退勤記録 |",
            "lineNumber": 77
          },
          {
            "text": "| 7 | 休憩時間 | BREAK_TIME | 複数の休憩時間帯 |",
            "lineNumber": 78
          },
          {
            "text": "| 8 | 公用外出 | OFFICIAL_OUTING | 公用外出の記録 |",
            "lineNumber": 79
          },
          {
            "text": "| 9 | 工数実績 | WORK_HOURS | ジョブに対する工数入力 |",
            "lineNumber": 80
          },
          {
            "text": "| 10 | 休暇残日数 | VACATION_BALANCE | 休暇の残日数管理 |",
            "lineNumber": 81
          },
          {
            "text": "| 11 | 休暇取得履歴 | VACATION_HISTORY | 休暇取得の履歴 |",
            "lineNumber": 82
          },
          {
            "text": "| 12 | 月次勤怠 | MONTHLY_ATTENDANCE | 月次の勤怠集計と承認状態 |",
            "lineNumber": 83
          },
          {
            "text": "| 13 | 月次承認履歴 | MONTHLY_APPROVAL_HISTORY | 月次確定の承認履歴 |",
            "lineNumber": 84
          },
          {
            "lineNumber": 85
          },
          {
            "text": "---",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "## テーブル詳細（全カラム説明）",
            "lineNumber": 88
          },
          {
            "lineNumber": 89
          },
          {
            "text": "### 1. 従業員マスタ (EMPLOYEE)",
            "lineNumber": 90
          },
          {
            "lineNumber": 91
          },
          {
            "text": "従業員の基本情報とログイン認証情報を管理するテーブルです。",
            "lineNumber": 92
          },
          {
            "lineNumber": 93
          },
          {
            "text": "| カラム名 | 型 | NULL | デフォルト | 説明 |",
            "lineNumber": 94
          },
          {
            "text": "|---------|-----|------|-----------|------|",
            "lineNumber": 95
          },
          {
            "text": "| **EMPLOYEE_ID** | CHAR(6) | NOT NULL | - | **主キー**。従業員を一意に識別するID（社員コード）。数字6桁で管理します。例: &#96;000001&#96; |",
            "lineNumber": 96
          },
          {
            "text": "| **EMPLOYEE_NAME** | VARCHAR(100) | NOT NULL | - | 従業員の氏名。画面表示やレポートで使用します。例: &#96;山田 太郎&#96; |",
            "lineNumber": 97
          },
          {
            "text": "| **PASSWORD** | VARCHAR(255) | NOT NULL | - | ログイン用パスワード。本番環境ではハッシュ化（bcrypt等）を推奨します。テスト用: &#96;Password@1234&#96;（平文）または &#96;$2b$10$...&#96;（ハッシュ） |",
            "lineNumber": 98
          },
          {
            "text": "| **EMAIL_ADDRESS** | VARCHAR(256) | NOT NULL | - | メールアドレス。ユニーク制約あり。通知や連絡先として使用します。例: &#96;yamada.taro@example.com&#96; |",
            "lineNumber": 99
          }
        ]
      },
      "score": 0.3782021105289459
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\README_MySQL.md",
        "range": {
          "startPosition": {
            "line": 211
          },
          "endPosition": {
            "line": 235
          }
        },
        "contents": "| **SCHEDULED_WORK_HOURS** | DECIMAL(5,2) | NULL | &#96;8.00&#96; | 所定労働時間（時間単位）。通常は8時間。例: &#96;8.00&#96;=8時間 |\n| **OVERTIME_HOURS** | DECIMAL(5,2) | NULL | &#96;0&#96; | 残業時間（時間単位）。実労働時間が所定労働時間を超えた分。例: &#96;0.50&#96;=30分残業 |\n| **NIGHT_WORK_HOURS** | DECIMAL(5,2) | NULL | &#96;0&#96; | 深夜労働時間（時間単位）。22時〜5時の労働時間。例: &#96;2.00&#96;=2時間 |\n| **HOLIDAY_WORK_HOURS** | DECIMAL(5,2) | NULL | &#96;0&#96; | 休日労働時間（時間単位）。法定休日に働いた時間。例: &#96;8.00&#96;=8時間 |\n| **IS_DAILY_CONFIRMED** | BOOLEAN | NULL | &#96;FALSE&#96; | 日次確定フラグ。&#96;TRUE&#96;=その日の勤怠を確定申請済み。日次確定ボタンで変更されます。 |\n| **DAILY_CONFIRMED_AT** | DATETIME | NULL | - | 日次確定日時。いつ確定申請したか。形式: &#96;YYYY-MM-DD HH:MM:SS&#96; |\n| **IS_MONTHLY_CONFIRMED** | BOOLEAN | NULL | &#96;FALSE&#96; | 月次確定フラグ。&#96;TRUE&#96;=月次の勤怠を確定申請済み。 |\n| **MONTHLY_CONFIRMED_AT** | DATETIME | NULL | - | 月次確定日時。いつ月次確定申請したか。形式: &#96;YYYY-MM-DD HH:MM:SS&#96; |\n| **APPROVAL_STATUS** | VARCHAR(20) | NULL | &#96;NOT_SUBMITTED&#96; | 承認状態。&#96;NOT_SUBMITTED&#96;=未申請、&#96;PENDING&#96;=申請中、&#96;APPROVED&#96;=承認済、&#96;REJECTED&#96;=却下 |\n| **REMARK_TEXT** | TEXT | NULL | - | 備考内容。打刻できなかった理由やその他の備考を記入します。手入力の場合は必須入力。 |\n| **CREATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード作成日時。 |\n| **UPDATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード更新日時。 |\n\n**重要な制約:**\n- 1人の従業員は1日1レコードのみ（&#96;EMPLOYEE_ID&#96; + &#96;WORK_DATE&#96;でユニーク）\n- 日次確定申請には勤務場所の入力が必須\n\n---\n\n### 7. 休憩時間 (BREAK_TIME)\n\n1日の勤怠記録に紐づく複数の休憩時間帯を記録するテーブルです。1つの勤怠記録に対して複数レコード（休憩1、休憩2、休憩3など）が存在します。\n\n| カラム名 | 型 | NULL | デフォルト | 説明 |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| **SCHEDULED_WORK_HOURS** | DECIMAL(5,2) | NULL | &#96;8.00&#96; | 所定労働時間（時間単位）。通常は8時間。例: &#96;8.00&#96;=8時間 |",
            "lineNumber": 212
          },
          {
            "text": "| **OVERTIME_HOURS** | DECIMAL(5,2) | NULL | &#96;0&#96; | 残業時間（時間単位）。実労働時間が所定労働時間を超えた分。例: &#96;0.50&#96;=30分残業 |",
            "lineNumber": 213
          },
          {
            "text": "| **NIGHT_WORK_HOURS** | DECIMAL(5,2) | NULL | &#96;0&#96; | 深夜労働時間（時間単位）。22時〜5時の労働時間。例: &#96;2.00&#96;=2時間 |",
            "lineNumber": 214
          },
          {
            "text": "| **HOLIDAY_WORK_HOURS** | DECIMAL(5,2) | NULL | &#96;0&#96; | 休日労働時間（時間単位）。法定休日に働いた時間。例: &#96;8.00&#96;=8時間 |",
            "lineNumber": 215
          },
          {
            "text": "| **IS_DAILY_CONFIRMED** | BOOLEAN | NULL | &#96;FALSE&#96; | 日次確定フラグ。&#96;TRUE&#96;=その日の勤怠を確定申請済み。日次確定ボタンで変更されます。 |",
            "lineNumber": 216
          },
          {
            "text": "| **DAILY_CONFIRMED_AT** | DATETIME | NULL | - | 日次確定日時。いつ確定申請したか。形式: &#96;YYYY-MM-DD HH:MM:SS&#96; |",
            "lineNumber": 217
          },
          {
            "text": "| **IS_MONTHLY_CONFIRMED** | BOOLEAN | NULL | &#96;FALSE&#96; | 月次確定フラグ。&#96;TRUE&#96;=月次の勤怠を確定申請済み。 |",
            "lineNumber": 218
          },
          {
            "text": "| **MONTHLY_CONFIRMED_AT** | DATETIME | NULL | - | 月次確定日時。いつ月次確定申請したか。形式: &#96;YYYY-MM-DD HH:MM:SS&#96; |",
            "lineNumber": 219
          },
          {
            "text": "| **APPROVAL_STATUS** | VARCHAR(20) | NULL | &#96;NOT_SUBMITTED&#96; | 承認状態。&#96;NOT_SUBMITTED&#96;=未申請、&#96;PENDING&#96;=申請中、&#96;APPROVED&#96;=承認済、&#96;REJECTED&#96;=却下 |",
            "lineNumber": 220
          },
          {
            "text": "| **REMARK_TEXT** | TEXT | NULL | - | 備考内容。打刻できなかった理由やその他の備考を記入します。手入力の場合は必須入力。 |",
            "lineNumber": 221
          },
          {
            "text": "| **CREATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード作成日時。 |",
            "lineNumber": 222
          },
          {
            "text": "| **UPDATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード更新日時。 |",
            "lineNumber": 223
          },
          {
            "lineNumber": 224
          },
          {
            "text": "**重要な制約:**",
            "lineNumber": 225
          },
          {
            "text": "- 1人の従業員は1日1レコードのみ（&#96;EMPLOYEE_ID&#96; + &#96;WORK_DATE&#96;でユニーク）",
            "lineNumber": 226
          },
          {
            "text": "- 日次確定申請には勤務場所の入力が必須",
            "lineNumber": 227
          },
          {
            "lineNumber": 228
          },
          {
            "text": "---",
            "lineNumber": 229
          },
          {
            "lineNumber": 230
          },
          {
            "text": "### 7. 休憩時間 (BREAK_TIME)",
            "lineNumber": 231
          },
          {
            "lineNumber": 232
          },
          {
            "text": "1日の勤怠記録に紐づく複数の休憩時間帯を記録するテーブルです。1つの勤怠記録に対して複数レコード（休憩1、休憩2、休憩3など）が存在します。",
            "lineNumber": 233
          },
          {
            "lineNumber": 234
          },
          {
            "text": "| カラム名 | 型 | NULL | デフォルト | 説明 |",
            "lineNumber": 235
          }
        ]
      },
      "score": 0.3772800862789154
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\applicationService.js",
        "range": {
          "startPosition": {
            "line": 304
          },
          "endPosition": {
            "line": 435,
            "column": 1
          }
        },
        "contents": "const cancelApplication = async \n\n    case 'HOLIDAY_WORK': {\n      // 休日出勤申請の取り消し\n      // APPLICATION_HISTORYから削除（実際には状態をNOT_SUBMITTEDに更新し、備考もクリア）\n      const db = require('../config/database');\n      const query = &#96;\n        UPDATE APPLICATION_HISTORY\n        SET APPROVAL_STATUS = 'NOT_SUBMITTED',\n            REASON = NULL,\n            UPDATED_AT = NOW()\n        WHERE APPLICATION_ID = ? AND EMPLOYEE_ID = ?\n          AND APPLICATION_TYPE = ?\n          AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')\n      &#96;;\n      await db.execute(query, [applicationId, employeeId, applicationType]);\n      \n      // 申請情報から対象日を取得\n      const applicationInfoQuery = &#96;\n        SELECT TARGET_START_DATE\n        FROM APPLICATION_HISTORY\n        WHERE APPLICATION_ID = ? AND EMPLOYEE_ID = ?\n      &#96;;\n      const [applicationRows] = await db.execute(applicationInfoQuery, [applicationId, employeeId]);\n      \n      if (applicationRows.length &gt; 0)\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 305,
                "column": 1
              },
              "endPosition": {
                "line": 305,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 305,
                "column": 7
              },
              "endPosition": {
                "line": 305,
                "column": 33
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const cancelApplication = async ",
            "lineNumber": 305
          },
          {
            "lineNumber": 362
          },
          {
            "text": "    case 'HOLIDAY_WORK': {",
            "lineNumber": 363
          },
          {
            "text": "      // 休日出勤申請の取り消し",
            "lineNumber": 364
          },
          {
            "text": "      // APPLICATION_HISTORYから削除（実際には状態をNOT_SUBMITTEDに更新し、備考もクリア）",
            "lineNumber": 365
          },
          {
            "text": "      const db = require('../config/database');",
            "lineNumber": 366
          },
          {
            "text": "      const query = &#96;",
            "lineNumber": 367
          },
          {
            "text": "        UPDATE APPLICATION_HISTORY",
            "lineNumber": 368
          },
          {
            "text": "        SET APPROVAL_STATUS = 'NOT_SUBMITTED',",
            "lineNumber": 369
          },
          {
            "text": "            REASON = NULL,",
            "lineNumber": 370
          },
          {
            "text": "            UPDATED_AT = NOW()",
            "lineNumber": 371
          },
          {
            "text": "        WHERE APPLICATION_ID = ? AND EMPLOYEE_ID = ?",
            "lineNumber": 372
          },
          {
            "text": "          AND APPLICATION_TYPE = ?",
            "lineNumber": 373
          },
          {
            "text": "          AND APPROVAL_STATUS IN ('PENDING', 'APPROVED')",
            "lineNumber": 374
          },
          {
            "text": "      &#96;;",
            "lineNumber": 375
          },
          {
            "text": "      await db.execute(query, [applicationId, employeeId, applicationType]);",
            "lineNumber": 376
          },
          {
            "text": "      ",
            "lineNumber": 377
          },
          {
            "text": "      // 申請情報から対象日を取得",
            "lineNumber": 378
          },
          {
            "text": "      const applicationInfoQuery = &#96;",
            "lineNumber": 379
          },
          {
            "text": "        SELECT TARGET_START_DATE",
            "lineNumber": 380
          },
          {
            "text": "        FROM APPLICATION_HISTORY",
            "lineNumber": 381
          },
          {
            "text": "        WHERE APPLICATION_ID = ? AND EMPLOYEE_ID = ?",
            "lineNumber": 382
          },
          {
            "text": "      &#96;;",
            "lineNumber": 383
          },
          {
            "text": "      const [applicationRows] = await db.execute(applicationInfoQuery, [applicationId, employeeId]);",
            "lineNumber": 384
          },
          {
            "text": "      ",
            "lineNumber": 385
          },
          {
            "text": "      if (applicationRows.length &gt; 0)",
            "lineNumber": 386
          },
          {
            "text": ";",
            "lineNumber": 436
          }
        ]
      },
      "score": 0.37522995471954346
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\README_MySQL.md",
        "range": {
          "startPosition": {
            "line": 119
          },
          "endPosition": {
            "line": 149
          }
        },
        "contents": "勤務場所の種類を管理するマスタテーブルです。ドロップダウン選択肢として使用します。\n\n| カラム名 | 型 | NULL | デフォルト | 説明 |\n|---------|-----|------|-----------|------|\n| **LOCATION_CODE** | VARCHAR(20) | NOT NULL | - | **主キー**。勤務場所を識別するコード。例: &#96;COMMUTE&#96;（通勤）、&#96;REMOTE&#96;（在宅） |\n| **LOCATION_NAME** | VARCHAR(50) | NOT NULL | - | 勤務場所の表示名。画面に表示されます。例: &#96;通勤&#96;、&#96;在宅&#96;、&#96;出張&#96; |\n| **DISPLAY_ORDER** | INT | NOT NULL | - | 表示順序。小さい順に表示されます。例: &#96;1&#96;=最初に表示、&#96;2&#96;=2番目に表示 |\n| **IS_ACTIVE** | BOOLEAN | NULL | &#96;TRUE&#96; | 有効フラグ。&#96;FALSE&#96;にすると選択肢から非表示になります。 |\n| **CREATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード作成日時。 |\n| **UPDATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード更新日時。 |\n\n**登録済みデータ:**\n- &#96;COMMUTE&#96; - 通勤（表示順: 1）\n- &#96;REMOTE&#96; - 在宅（表示順: 2）\n- &#96;DIRECT_BOTH&#96; - 直行直帰（表示順: 3）\n- &#96;BUSINESS_TRIP&#96; - 出張（表示順: 4）\n\n---\n\n### 3. ジョブマスタ (JOB_MASTER)\n\n工数入力で使用するプロジェクトやタスクの情報を管理するマスタテーブルです。\n\n| カラム名 | 型 | NULL | デフォルト | 説明 |\n|---------|-----|------|-----------|------|\n| **JOB_CODE** | VARCHAR(50) | NOT NULL | - | **主キー**。ジョブ（プロジェクト・タスク）を識別するコード。工数入力時に選択します。例: &#96;ZXXXA2506B&#96; |\n| **JOB_NAME** | VARCHAR(200) | NOT NULL | - | ジョブの正式名称。画面に表示されます。例: &#96;ZXXXA2506B 人推_育成活動実施25152025-300／00X100 00X収益&#96; |\n| **JOB_CATEGORY** | VARCHAR(50) | NULL | - | ジョブのカテゴリ。分類に使用します。例: &#96;プロジェクト&#96;、&#96;間接作業&#96; |\n| **PROJECT_CODE** | VARCHAR(50) | NULL | - | プロジェクトコード。関連プロジェクトを識別します。例: &#96;25152025-300&#96; |\n| **IS_ACTIVE** | BOOLEAN | NULL | &#96;TRUE&#96; | 有効フラグ。&#96;FALSE&#96;にすると工数入力の選択肢から除外されます。 |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "勤務場所の種類を管理するマスタテーブルです。ドロップダウン選択肢として使用します。",
            "lineNumber": 120
          },
          {
            "lineNumber": 121
          },
          {
            "text": "| カラム名 | 型 | NULL | デフォルト | 説明 |",
            "lineNumber": 122
          },
          {
            "text": "|---------|-----|------|-----------|------|",
            "lineNumber": 123
          },
          {
            "text": "| **LOCATION_CODE** | VARCHAR(20) | NOT NULL | - | **主キー**。勤務場所を識別するコード。例: &#96;COMMUTE&#96;（通勤）、&#96;REMOTE&#96;（在宅） |",
            "lineNumber": 124
          },
          {
            "text": "| **LOCATION_NAME** | VARCHAR(50) | NOT NULL | - | 勤務場所の表示名。画面に表示されます。例: &#96;通勤&#96;、&#96;在宅&#96;、&#96;出張&#96; |",
            "lineNumber": 125
          },
          {
            "text": "| **DISPLAY_ORDER** | INT | NOT NULL | - | 表示順序。小さい順に表示されます。例: &#96;1&#96;=最初に表示、&#96;2&#96;=2番目に表示 |",
            "lineNumber": 126
          },
          {
            "text": "| **IS_ACTIVE** | BOOLEAN | NULL | &#96;TRUE&#96; | 有効フラグ。&#96;FALSE&#96;にすると選択肢から非表示になります。 |",
            "lineNumber": 127
          },
          {
            "text": "| **CREATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード作成日時。 |",
            "lineNumber": 128
          },
          {
            "text": "| **UPDATED_AT** | TIMESTAMP | NULL | CURRENT_TIMESTAMP | レコード更新日時。 |",
            "lineNumber": 129
          },
          {
            "lineNumber": 130
          },
          {
            "text": "**登録済みデータ:**",
            "lineNumber": 131
          },
          {
            "text": "- &#96;COMMUTE&#96; - 通勤（表示順: 1）",
            "lineNumber": 132
          },
          {
            "text": "- &#96;REMOTE&#96; - 在宅（表示順: 2）",
            "lineNumber": 133
          },
          {
            "text": "- &#96;DIRECT_BOTH&#96; - 直行直帰（表示順: 3）",
            "lineNumber": 134
          },
          {
            "text": "- &#96;BUSINESS_TRIP&#96; - 出張（表示順: 4）",
            "lineNumber": 135
          },
          {
            "lineNumber": 136
          },
          {
            "text": "---",
            "lineNumber": 137
          },
          {
            "lineNumber": 138
          },
          {
            "text": "### 3. ジョブマスタ (JOB_MASTER)",
            "lineNumber": 139
          },
          {
            "lineNumber": 140
          },
          {
            "text": "工数入力で使用するプロジェクトやタスクの情報を管理するマスタテーブルです。",
            "lineNumber": 141
          },
          {
            "lineNumber": 142
          },
          {
            "text": "| カラム名 | 型 | NULL | デフォルト | 説明 |",
            "lineNumber": 143
          },
          {
            "text": "|---------|-----|------|-----------|------|",
            "lineNumber": 144
          },
          {
            "text": "| **JOB_CODE** | VARCHAR(50) | NOT NULL | - | **主キー**。ジョブ（プロジェクト・タスク）を識別するコード。工数入力時に選択します。例: &#96;ZXXXA2506B&#96; |",
            "lineNumber": 145
          },
          {
            "text": "| **JOB_NAME** | VARCHAR(200) | NOT NULL | - | ジョブの正式名称。画面に表示されます。例: &#96;ZXXXA2506B 人推_育成活動実施25152025-300／00X100 00X収益&#96; |",
            "lineNumber": 146
          },
          {
            "text": "| **JOB_CATEGORY** | VARCHAR(50) | NULL | - | ジョブのカテゴリ。分類に使用します。例: &#96;プロジェクト&#96;、&#96;間接作業&#96; |",
            "lineNumber": 147
          },
          {
            "text": "| **PROJECT_CODE** | VARCHAR(50) | NULL | - | プロジェクトコード。関連プロジェクトを識別します。例: &#96;25152025-300&#96; |",
            "lineNumber": 148
          },
          {
            "text": "| **IS_ACTIVE** | BOOLEAN | NULL | &#96;TRUE&#96; | 有効フラグ。&#96;FALSE&#96;にすると工数入力の選択肢から除外されます。 |",
            "lineNumber": 149
          }
        ]
      },
      "score": 0.3706575930118561
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 52
          },
          "endPosition": {
            "line": 84
          }
        },
        "contents": "-- 3. ジョブマスタ (JOB_MASTER)\nCREATE TABLE JOB_MASTER (\n    JOB_CODE VARCHAR(50) NOT NULL COMMENT 'ジョブコード',\n    JOB_NAME VARCHAR(200) NOT NULL COMMENT 'ジョブ名',\n    JOB_CATEGORY VARCHAR(50) COMMENT 'ジョブカテゴリ',\n    PROJECT_CODE VARCHAR(50) COMMENT 'プロジェクトコード',\n    IS_ACTIVE BOOLEAN DEFAULT TRUE COMMENT '有効フラグ',\n    START_DATE DATE COMMENT '開始日',\n    END_DATE DATE COMMENT '終了日',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',\n    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',\n    PRIMARY KEY (JOB_CODE)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ジョブマスタ';\n\n-- 4. 休暇種別マスタ (VACATION_TYPE)\nCREATE TABLE VACATION_TYPE (\n    VACATION_TYPE_CODE VARCHAR(20) NOT NULL COMMENT '休暇種別コード',\n    VACATION_TYPE_NAME VARCHAR(50) NOT NULL COMMENT '休暇種別名',\n    VACATION_CATEGORY VARCHAR(20) NOT NULL COMMENT '休暇カテゴリ(有給/特別/etc)',\n    IS_PAID BOOLEAN DEFAULT FALSE COMMENT '有給フラグ',\n    ANNUAL_GRANT_DAYS DECIMAL(4,1) DEFAULT 0 COMMENT '年間付与日数',\n    DISPLAY_ORDER INT NOT NULL COMMENT '表示順',\n    IS_ACTIVE BOOLEAN DEFAULT TRUE COMMENT '有効フラグ',\n    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',\n    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',\n    PRIMARY KEY (VACATION_TYPE_CODE)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='休暇種別マスタ';\n\n-- 5. お知らせマスタ (NOTIFICATION)\nCREATE TABLE NOTIFICATION (\n    NOTIFICATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT 'お知らせID',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- 3. ジョブマスタ (JOB_MASTER)",
            "lineNumber": 54
          },
          {
            "text": "CREATE TABLE JOB_MASTER (",
            "lineNumber": 55
          },
          {
            "text": "    JOB_CODE VARCHAR(50) NOT NULL COMMENT 'ジョブコード',",
            "lineNumber": 56
          },
          {
            "text": "    JOB_NAME VARCHAR(200) NOT NULL COMMENT 'ジョブ名',",
            "lineNumber": 57
          },
          {
            "text": "    JOB_CATEGORY VARCHAR(50) COMMENT 'ジョブカテゴリ',",
            "lineNumber": 58
          },
          {
            "text": "    PROJECT_CODE VARCHAR(50) COMMENT 'プロジェクトコード',",
            "lineNumber": 59
          },
          {
            "text": "    IS_ACTIVE BOOLEAN DEFAULT TRUE COMMENT '有効フラグ',",
            "lineNumber": 60
          },
          {
            "text": "    START_DATE DATE COMMENT '開始日',",
            "lineNumber": 61
          },
          {
            "text": "    END_DATE DATE COMMENT '終了日',",
            "lineNumber": 62
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',",
            "lineNumber": 63
          },
          {
            "text": "    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',",
            "lineNumber": 64
          },
          {
            "text": "    PRIMARY KEY (JOB_CODE)",
            "lineNumber": 65
          },
          {
            "text": ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='ジョブマスタ';",
            "lineNumber": 66
          },
          {
            "lineNumber": 67
          },
          {
            "text": "-- 4. 休暇種別マスタ (VACATION_TYPE)",
            "lineNumber": 68
          },
          {
            "text": "CREATE TABLE VACATION_TYPE (",
            "lineNumber": 69
          },
          {
            "text": "    VACATION_TYPE_CODE VARCHAR(20) NOT NULL COMMENT '休暇種別コード',",
            "lineNumber": 70
          },
          {
            "text": "    VACATION_TYPE_NAME VARCHAR(50) NOT NULL COMMENT '休暇種別名',",
            "lineNumber": 71
          },
          {
            "text": "    VACATION_CATEGORY VARCHAR(20) NOT NULL COMMENT '休暇カテゴリ(有給/特別/etc)',",
            "lineNumber": 72
          },
          {
            "text": "    IS_PAID BOOLEAN DEFAULT FALSE COMMENT '有給フラグ',",
            "lineNumber": 73
          },
          {
            "text": "    ANNUAL_GRANT_DAYS DECIMAL(4,1) DEFAULT 0 COMMENT '年間付与日数',",
            "lineNumber": 74
          },
          {
            "text": "    DISPLAY_ORDER INT NOT NULL COMMENT '表示順',",
            "lineNumber": 75
          },
          {
            "text": "    IS_ACTIVE BOOLEAN DEFAULT TRUE COMMENT '有効フラグ',",
            "lineNumber": 76
          },
          {
            "text": "    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP COMMENT '作成日時',",
            "lineNumber": 77
          },
          {
            "text": "    UPDATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '更新日時',",
            "lineNumber": 78
          },
          {
            "text": "    PRIMARY KEY (VACATION_TYPE_CODE)",
            "lineNumber": 79
          },
          {
            "text": ") ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='休暇種別マスタ';",
            "lineNumber": 80
          },
          {
            "lineNumber": 81
          },
          {
            "text": "-- 5. お知らせマスタ (NOTIFICATION)",
            "lineNumber": 82
          },
          {
            "text": "CREATE TABLE NOTIFICATION (",
            "lineNumber": 83
          },
          {
            "text": "    NOTIFICATION_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT 'お知らせID',",
            "lineNumber": 84
          }
        ]
      },
      "score": 0.3704310655593872
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\entity-list.md",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 24
          }
        },
        "contents": "# TeamSpirit勤怠管理システム\n\n## エンティティ一覧\n\n| No | エンティティ名 | 正式英名 | 説明 |\n| --- | --- | --- | --- |\n| 1 | 従業員マスタ | EMPLOYEE | システムを利用する従業員の基本情報を管理するエンティティです。社員コードは数字6桁（例: 000001）として管理します。 |\n| 2 | 勤務場所マスタ | WORK_LOCATION | 勤務場所（通勤、在宅、直行、直帰など）の情報を管理します。 |\n| 3 | ジョブマスタ | JOB_MASTER | 工数入力に使用するプロジェクトやタスクの情報を保持します。 |\n| 4 | 休暇種別マスタ | VACATION_TYPE | 有給休暇、特別休暇などの休暇種別と付与日数を管理します。 |\n| 5 | お知らせマスタ | NOTIFICATION | システムからユーザーやグループへのお知らせ情報を管理します。 |\n| 6 | 勤怠記録 | ATTENDANCE_RECORD | 日次の出退勤時刻、勤務時間、承認状態、備考などを記録・管理します。 |\n| 7 | 休憩時間 | BREAK_TIME | 勤怠記録に紐づく複数の休憩時間帯を記録します。 |\n| 8 | 公用外出 | OFFICIAL_OUTING | 勤怠記録に紐づく公用外出の時間帯と目的を記録します。 |\n| 9 | 工数実績 | WORK_HOURS | 従業員が各ジョブに対して投入した工数の実績を記録します。 |\n| 10 | 休暇残日数 | VACATION_BALANCE | 従業員ごとの休暇種別別の付与日数、使用日数、残日数を管理します。 |\n| 11 | 休暇取得履歴 | VACATION_HISTORY | 従業員の休暇取得履歴と承認状態を記録します。 |\n| 12 | 申請履歴 | APPLICATION_HISTORY | 休日出勤申請、残業申請、早朝勤務申請、振替申請などの申請履歴と承認状態を記録します。 |\n| 13 | 月次勤怠 | MONTHLY_ATTENDANCE | 月次の勤怠集計と承認状態を管理します。従業員ごと、年月ごとに1レコードです。 |\n| 14 | 月次承認履歴 | MONTHLY_APPROVAL_HISTORY | 月次確定の承認履歴（申請、承認、却下、取消）を記録します。ステータスダイアログで表示されます。 |\n\n## 変更履歴\n\n| 日付 | 変更内容 | 変更者 |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "# TeamSpirit勤怠管理システム",
            "lineNumber": 1
          },
          {
            "lineNumber": 2
          },
          {
            "text": "## エンティティ一覧",
            "lineNumber": 3
          },
          {
            "lineNumber": 4
          },
          {
            "text": "| No | エンティティ名 | 正式英名 | 説明 |",
            "lineNumber": 5
          },
          {
            "text": "| --- | --- | --- | --- |",
            "lineNumber": 6
          },
          {
            "text": "| 1 | 従業員マスタ | EMPLOYEE | システムを利用する従業員の基本情報を管理するエンティティです。社員コードは数字6桁（例: 000001）として管理します。 |",
            "lineNumber": 7
          },
          {
            "text": "| 2 | 勤務場所マスタ | WORK_LOCATION | 勤務場所（通勤、在宅、直行、直帰など）の情報を管理します。 |",
            "lineNumber": 8
          },
          {
            "text": "| 3 | ジョブマスタ | JOB_MASTER | 工数入力に使用するプロジェクトやタスクの情報を保持します。 |",
            "lineNumber": 9
          },
          {
            "text": "| 4 | 休暇種別マスタ | VACATION_TYPE | 有給休暇、特別休暇などの休暇種別と付与日数を管理します。 |",
            "lineNumber": 10
          },
          {
            "text": "| 5 | お知らせマスタ | NOTIFICATION | システムからユーザーやグループへのお知らせ情報を管理します。 |",
            "lineNumber": 11
          },
          {
            "text": "| 6 | 勤怠記録 | ATTENDANCE_RECORD | 日次の出退勤時刻、勤務時間、承認状態、備考などを記録・管理します。 |",
            "lineNumber": 12
          },
          {
            "text": "| 7 | 休憩時間 | BREAK_TIME | 勤怠記録に紐づく複数の休憩時間帯を記録します。 |",
            "lineNumber": 13
          },
          {
            "text": "| 8 | 公用外出 | OFFICIAL_OUTING | 勤怠記録に紐づく公用外出の時間帯と目的を記録します。 |",
            "lineNumber": 14
          },
          {
            "text": "| 9 | 工数実績 | WORK_HOURS | 従業員が各ジョブに対して投入した工数の実績を記録します。 |",
            "lineNumber": 15
          },
          {
            "text": "| 10 | 休暇残日数 | VACATION_BALANCE | 従業員ごとの休暇種別別の付与日数、使用日数、残日数を管理します。 |",
            "lineNumber": 16
          },
          {
            "text": "| 11 | 休暇取得履歴 | VACATION_HISTORY | 従業員の休暇取得履歴と承認状態を記録します。 |",
            "lineNumber": 17
          },
          {
            "text": "| 12 | 申請履歴 | APPLICATION_HISTORY | 休日出勤申請、残業申請、早朝勤務申請、振替申請などの申請履歴と承認状態を記録します。 |",
            "lineNumber": 18
          },
          {
            "text": "| 13 | 月次勤怠 | MONTHLY_ATTENDANCE | 月次の勤怠集計と承認状態を管理します。従業員ごと、年月ごとに1レコードです。 |",
            "lineNumber": 19
          },
          {
            "text": "| 14 | 月次承認履歴 | MONTHLY_APPROVAL_HISTORY | 月次確定の承認履歴（申請、承認、却下、取消）を記録します。ステータスダイアログで表示されます。 |",
            "lineNumber": 20
          },
          {
            "lineNumber": 21
          },
          {
            "text": "## 変更履歴",
            "lineNumber": 22
          },
          {
            "lineNumber": 23
          },
          {
            "text": "| 日付 | 変更内容 | 変更者 |",
            "lineNumber": 24
          }
        ]
      },
      "score": 0.3594104051589966
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-application-screen.md",
        "range": {
          "startPosition": {
            "line": 202
          },
          "endPosition": {
            "line": 220
          }
        },
        "contents": "| 3 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;申請タイプ | 文字 | 正常 | | 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）。未選択時はNULL |\n| 4 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;申請データ | オブジェクト | 正常 | | 各申請タイプの入力データ |\n| 6 | 休暇種別マスタ | リスト | 正常 | | VACATION_TYPEテーブルから取得した休暇種別マスタ |\n| 7 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別情報 | オブジェクト | 正常 | | 1つの休暇種別の情報 |\n| 8 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別コード | 文字 | 正常 | | VACATION_TYPE.VACATION_TYPE_CODE |\n| 9 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別名 | 文字 | 正常 | | VACATION_TYPE.VACATION_TYPE_NAME |\n| 10 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;有給フラグ | フラグ | 正常 | | VACATION_TYPE.IS_PAID |\n| 11 | 有給残日数 | 整数 | 正常 | | 年次有給休暇の残日数 |\n| 12 | 日次勤務データ | オブジェクト | 正常 | | 対象日付の勤務データ |\n| 13 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤時刻 | 日時 | 正常 | | ATTENDANCE_RECORD.CLOCK_IN_TIME |\n| 14 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤時刻 | 日時 | 正常 | | ATTENDANCE_RECORD.CLOCK_OUT_TIME |\n| 15 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実労働時間 | 小数 | 正常 | | ATTENDANCE_RECORD.ACTUAL_WORK_HOURS |\n| 16 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;備考 | 文字 | 正常 | | ATTENDANCE_RECORD.REMARK_TEXT |\n| 17 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩時間リスト | リスト | 正常 | | BREAK_TIMEテーブルから取得 |\n| 18 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩開始時刻 | 時間 | 正常 | | BREAK_TIME.BREAK_START_TIME |\n| 19 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩終了時刻 | 時間 | 正常 | | BREAK_TIME.BREAK_END_TIME |\n| 20 | 申請状態 | 文字 | 正常 | | 各申請タイプの申請状態（NOT_SUBMITTED/PENDING/APPROVED/REJECTED）。申請中または承認済みの場合に申請取消ボタンを表示 |\n| 21 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;日次確定申請状態 | 文字 | 正常 | | ATTENDANCE_RECORD.APPROVAL_STATUS |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| 3 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;申請タイプ | 文字 | 正常 | | 申請タイプ（DAILY_CONFIRMATION/VACATION/HOLIDAY_WORK/OVERTIME/EARLY_WORK/TRANSFER）。未選択時はNULL |",
            "lineNumber": 203
          },
          {
            "text": "| 4 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;申請データ | オブジェクト | 正常 | | 各申請タイプの入力データ |",
            "lineNumber": 204
          },
          {
            "text": "| 6 | 休暇種別マスタ | リスト | 正常 | | VACATION_TYPEテーブルから取得した休暇種別マスタ |",
            "lineNumber": 205
          },
          {
            "text": "| 7 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別情報 | オブジェクト | 正常 | | 1つの休暇種別の情報 |",
            "lineNumber": 206
          },
          {
            "text": "| 8 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別コード | 文字 | 正常 | | VACATION_TYPE.VACATION_TYPE_CODE |",
            "lineNumber": 207
          },
          {
            "text": "| 9 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休暇種別名 | 文字 | 正常 | | VACATION_TYPE.VACATION_TYPE_NAME |",
            "lineNumber": 208
          },
          {
            "text": "| 10 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;有給フラグ | フラグ | 正常 | | VACATION_TYPE.IS_PAID |",
            "lineNumber": 209
          },
          {
            "text": "| 11 | 有給残日数 | 整数 | 正常 | | 年次有給休暇の残日数 |",
            "lineNumber": 210
          },
          {
            "text": "| 12 | 日次勤務データ | オブジェクト | 正常 | | 対象日付の勤務データ |",
            "lineNumber": 211
          },
          {
            "text": "| 13 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤時刻 | 日時 | 正常 | | ATTENDANCE_RECORD.CLOCK_IN_TIME |",
            "lineNumber": 212
          },
          {
            "text": "| 14 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤時刻 | 日時 | 正常 | | ATTENDANCE_RECORD.CLOCK_OUT_TIME |",
            "lineNumber": 213
          },
          {
            "text": "| 15 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;実労働時間 | 小数 | 正常 | | ATTENDANCE_RECORD.ACTUAL_WORK_HOURS |",
            "lineNumber": 214
          },
          {
            "text": "| 16 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;備考 | 文字 | 正常 | | ATTENDANCE_RECORD.REMARK_TEXT |",
            "lineNumber": 215
          },
          {
            "text": "| 17 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩時間リスト | リスト | 正常 | | BREAK_TIMEテーブルから取得 |",
            "lineNumber": 216
          },
          {
            "text": "| 18 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩開始時刻 | 時間 | 正常 | | BREAK_TIME.BREAK_START_TIME |",
            "lineNumber": 217
          },
          {
            "text": "| 19 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;休憩終了時刻 | 時間 | 正常 | | BREAK_TIME.BREAK_END_TIME |",
            "lineNumber": 218
          },
          {
            "text": "| 20 | 申請状態 | 文字 | 正常 | | 各申請タイプの申請状態（NOT_SUBMITTED/PENDING/APPROVED/REJECTED）。申請中または承認済みの場合に申請取消ボタンを表示 |",
            "lineNumber": 219
          },
          {
            "text": "| 21 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;日次確定申請状態 | 文字 | 正常 | | ATTENDANCE_RECORD.APPROVAL_STATUS |",
            "lineNumber": 220
          }
        ]
      },
      "score": 0.35930559039115906
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="unknown" data-tool-name="ripgrep_raw_search">
<details>
<summary>Tool use: **ripgrep_raw_search**</summary>


Parameters:

```json
{
  "pattern": "HOLIDAY_WORK_APPLICATION|WORK_LOCATION_CODE",
  "path": "backend/models",
  "caseInsensitive": false
}
```
Result:

```json
{
  "success": {
    "pattern": "HOLIDAY_WORK_APPLICATION|WORK_LOCATION_CODE",
    "path": "backend/models",
    "outputMode": "content",
    "workspaceResults": {
      "c:\\TeamSpirit\\CodeCommit\\TeamSpirit再現企画": {
        "content": {
          "matches": [
            {
              "file": "backend\\models\\attendanceModel.js",
              "matches": [
                {
                  "lineNumber": 15,
                  "content": "    SELECT ATTENDANCE_ID, CLOCK_IN_TIME, CLOCK_OUT_TIME, WORK_LOCATION_CODE"
                },
                {
                  "lineNumber": 49,
                  "content": "      WORK_LOCATION_CODE,"
                },
                {
                  "lineNumber": 91,
                  "content": "      ar.WORK_LOCATION_CODE,"
                },
                {
                  "lineNumber": 103,
                  "content": "    LEFT JOIN WORK_LOCATION wl ON ar.WORK_LOCATION_CODE = wl.LOCATION_CODE"
                },
                {
                  "lineNumber": 136,
                  "content": "    (EMPLOYEE_ID, WORK_DATE, CLOCK_IN_TIME, CLOCK_OUT_TIME, CLOCK_IN_TYPE, CLOCK_OUT_TYPE, ORIGINAL_CLOCK_IN_TIME, ORIGINAL_CLOCK_OUT_TIME, WORK_LOCATION_CODE, REMARK_TEXT, CREATED_AT, UPDATED_AT)"
                },
                {
                  "lineNumber": 194,
                  "content": "    updateFields.push('WORK_LOCATION_CODE = ?');"
                }
              ]
            },
            {
              "file": "backend\\models\\masterModel.js",
              "matches": [
                {
                  "lineNumber": 12,
                  "content": "    SELECT LOCATION_CODE AS WORK_LOCATION_CODE, LOCATION_NAME AS WORK_LOCATION_NAME, DISPLAY_ORDER"
                }
              ]
            }
          ],
          "totalLines": 7,
          "totalMatchedLines": 7
        }
      }
    }
  }
}
```
Status: **completed**


</details>
</tool-use>

---



---


バックエンドの実装を開始します。休日出勤申請の情報を取得し、dailyDataに含めます。


---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [-] バックエンドのmonthlySummaryService.jsで休日出勤申請の情報を取得してdailyDataに含める
- [ ] フロントエンドのMonthlySummaryScreen.vueのgetEventTextメソッドを修正して休日出勤申請の表示を追加

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: backend/services/monthlySummaryService.js</summary>

</details>
</tool-use>

---



---


バックエンドの実装を進めます。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "7f09ecb1-9f2a-4d3d-a012-d03fe2fbcbf5"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: backend/services/monthlySummaryService.js</summary>

</details>
</tool-use>

---



---


休日出勤申請の情報をdailyDataに追加します。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "002d6eef-e8ba-4b70-b420-f74405d5d575"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: backend/services/monthlySummaryService.js</summary>

</details>
</tool-use>

---



---


dailyDataに休日出勤申請の情報を追加します。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "b081b9ba-a32d-4f2f-a673-2b5d1285315e"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] バックエンドのmonthlySummaryService.jsで休日出勤申請の情報を取得してdailyDataに含める
- [-] フロントエンドのMonthlySummaryScreen.vueのgetEventTextメソッドを修正して休日出勤申請の表示を追加

</details>
</tool-use>

---



---


フロントエンドの実装を進めます。`getEventText`メソッドを修正して休日出勤申請の表示を追加します。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "d62881f2-cd21-4ece-9d31-168602d53218"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="task" data-tool-name="todo_write">
<details><summary>Tool use: **todo_write** • Todo List</summary>

- [x] バックエンドのmonthlySummaryService.jsで休日出勤申請の情報を取得してdailyDataに含める
- [x] フロントエンドのMonthlySummaryScreen.vueのgetEventTextメソッドを修正して休日出勤申請の表示を追加

</details>
</tool-use>

---



---


実装を完了しました。変更点は以下の通りです。

## 実装内容

### 1. バックエンド（`backend/services/monthlySummaryService.js`）

- 休日出勤申請の取得を追加
  - `applicationModel.getApplicationsByType`を使用して、承認済みまたは申請中の休日出勤申請を取得
- dailyDataに休日出勤申請情報を追加
  - 各日のデータに`holidayWorkApplication`を追加

### 2. フロントエンド（`frontend/src/views/MonthlySummaryScreen.vue`）

- `getEventText`メソッドを修正
  - 優先順位3として休日出勤申請の表示を追加
  - 表示形式：
    - 日次確定あり + 勤務場所あり：「休日出勤、日次確定、在宅」
    - 日次確定なし + 勤務場所あり：「休日出勤、在宅」
    - 勤務場所なし：「休日出勤」

## 表示優先順位

1. 祝日名（最優先）
2. 休暇種別名（例：休暇(年次有給休暇)）
3. 休日出勤申請（例：休日出勤、日次確定、在宅）
4. 日時確定（例：日時確定,在宅）
5. 通常勤務（例：在宅）

実装は完了しました。動作確認をお願いします。問題があればお知らせください。

---

_**User**_

(退社打刻なし)となっていますが、こういう打刻なし系は打刻のし忘れなどで手入力で入力した際に表示させたい。

---

_**Agent (model composer-1, mode Agent)**_



---


打刻なしの表示ロジックを確認し、必要に応じて修正します。まず、現在の実装を確認します。


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: frontend/src/views/MonthlySummaryScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---



---


打刻なしの表示ロジックを確認し、手入力時の表示条件を明確化します。


---

<tool-use data-tool-type="unknown" data-tool-name="semantic_search_full">
<details>
<summary>Tool use: **semantic_search_full**</summary>


Parameters:

```json
{
  "query": "打刻種別 MANUAL 手入力 打刻漏れ ORIGINAL_CLOCK_IN_TIME",
  "topK": 10,
  "explanation": ""
}
```
Result:

```json
{
  "codeResults": [
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\check_original_clock_time.sql",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 48
          }
        },
        "contents": "-- ====================================================================\n-- TeamSpirit勤怠管理システム\n-- ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEの状態確認スクリプト\n-- 作成日: 2025-12-09\n-- \n-- データベース内の打刻時刻データの状態を確認するためのスクリプト\n-- ====================================================================\n\nUSE teamspirit_db;\n\n-- 出社時刻の状態を確認\nSELECT \n    ATTENDANCE_ID,\n    EMPLOYEE_ID,\n    WORK_DATE,\n    CLOCK_IN_TIME,\n    CLOCK_IN_TYPE,\n    ORIGINAL_CLOCK_IN_TIME,\n    CASE \n        WHEN CLOCK_IN_TYPE = 'MANUAL' AND ORIGINAL_CLOCK_IN_TIME IS NOT NULL THEN '手入力（元の打刻時刻あり）'\n        WHEN CLOCK_IN_TYPE = 'MANUAL' AND ORIGINAL_CLOCK_IN_TIME IS NULL THEN '手入力（元の打刻時刻なし）'\n        WHEN CLOCK_IN_TYPE = 'STAMP' THEN '打刻'\n        ELSE 'その他'\n    END AS STATUS_IN\nFROM ATTENDANCE_RECORD\nWHERE CLOCK_IN_TIME IS NOT NULL\nORDER BY WORK_DATE DESC\nLIMIT 10;\n\n-- 退社時刻の状態を確認\nSELECT \n    ATTENDANCE_ID,\n    EMPLOYEE_ID,\n    WORK_DATE,\n    CLOCK_OUT_TIME,\n    CLOCK_OUT_TYPE,\n    ORIGINAL_CLOCK_OUT_TIME,\n    CASE \n        WHEN CLOCK_OUT_TYPE = 'MANUAL' AND ORIGINAL_CLOCK_OUT_TIME IS NOT NULL THEN '手入力（元の打刻時刻あり）'\n        WHEN CLOCK_OUT_TYPE = 'MANUAL' AND ORIGINAL_CLOCK_OUT_TIME IS NULL THEN '手入力（元の打刻時刻なし）'\n        WHEN CLOCK_OUT_TYPE = 'STAMP' THEN '打刻'\n        ELSE 'その他'\n    END AS STATUS_OUT\nFROM ATTENDANCE_RECORD\nWHERE CLOCK_OUT_TIME IS NOT NULL\nORDER BY WORK_DATE DESC\nLIMIT 10;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- ====================================================================",
            "lineNumber": 1
          },
          {
            "text": "-- TeamSpirit勤怠管理システム",
            "lineNumber": 2
          },
          {
            "text": "-- ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEの状態確認スクリプト",
            "lineNumber": 3
          },
          {
            "text": "-- 作成日: 2025-12-09",
            "lineNumber": 4
          },
          {
            "text": "-- ",
            "lineNumber": 5
          },
          {
            "text": "-- データベース内の打刻時刻データの状態を確認するためのスクリプト",
            "lineNumber": 6
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "USE teamspirit_db;",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "-- 出社時刻の状態を確認",
            "lineNumber": 11
          },
          {
            "text": "SELECT ",
            "lineNumber": 12
          },
          {
            "text": "    ATTENDANCE_ID,",
            "lineNumber": 13
          },
          {
            "text": "    EMPLOYEE_ID,",
            "lineNumber": 14
          },
          {
            "text": "    WORK_DATE,",
            "lineNumber": 15
          },
          {
            "text": "    CLOCK_IN_TIME,",
            "lineNumber": 16
          },
          {
            "text": "    CLOCK_IN_TYPE,",
            "lineNumber": 17
          },
          {
            "text": "    ORIGINAL_CLOCK_IN_TIME,",
            "lineNumber": 18
          },
          {
            "text": "    CASE ",
            "lineNumber": 19
          },
          {
            "text": "        WHEN CLOCK_IN_TYPE = 'MANUAL' AND ORIGINAL_CLOCK_IN_TIME IS NOT NULL THEN '手入力（元の打刻時刻あり）'",
            "lineNumber": 20
          },
          {
            "text": "        WHEN CLOCK_IN_TYPE = 'MANUAL' AND ORIGINAL_CLOCK_IN_TIME IS NULL THEN '手入力（元の打刻時刻なし）'",
            "lineNumber": 21
          },
          {
            "text": "        WHEN CLOCK_IN_TYPE = 'STAMP' THEN '打刻'",
            "lineNumber": 22
          },
          {
            "text": "        ELSE 'その他'",
            "lineNumber": 23
          },
          {
            "text": "    END AS STATUS_IN",
            "lineNumber": 24
          },
          {
            "text": "FROM ATTENDANCE_RECORD",
            "lineNumber": 25
          },
          {
            "text": "WHERE CLOCK_IN_TIME IS NOT NULL",
            "lineNumber": 26
          },
          {
            "text": "ORDER BY WORK_DATE DESC",
            "lineNumber": 27
          },
          {
            "text": "LIMIT 10;",
            "lineNumber": 28
          },
          {
            "lineNumber": 29
          },
          {
            "text": "-- 退社時刻の状態を確認",
            "lineNumber": 30
          },
          {
            "text": "SELECT ",
            "lineNumber": 31
          },
          {
            "text": "    ATTENDANCE_ID,",
            "lineNumber": 32
          },
          {
            "text": "    EMPLOYEE_ID,",
            "lineNumber": 33
          },
          {
            "text": "    WORK_DATE,",
            "lineNumber": 34
          },
          {
            "text": "    CLOCK_OUT_TIME,",
            "lineNumber": 35
          },
          {
            "text": "    CLOCK_OUT_TYPE,",
            "lineNumber": 36
          },
          {
            "text": "    ORIGINAL_CLOCK_OUT_TIME,",
            "lineNumber": 37
          },
          {
            "text": "    CASE ",
            "lineNumber": 38
          },
          {
            "text": "        WHEN CLOCK_OUT_TYPE = 'MANUAL' AND ORIGINAL_CLOCK_OUT_TIME IS NOT NULL THEN '手入力（元の打刻時刻あり）'",
            "lineNumber": 39
          },
          {
            "text": "        WHEN CLOCK_OUT_TYPE = 'MANUAL' AND ORIGINAL_CLOCK_OUT_TIME IS NULL THEN '手入力（元の打刻時刻なし）'",
            "lineNumber": 40
          },
          {
            "text": "        WHEN CLOCK_OUT_TYPE = 'STAMP' THEN '打刻'",
            "lineNumber": 41
          },
          {
            "text": "        ELSE 'その他'",
            "lineNumber": 42
          },
          {
            "text": "    END AS STATUS_OUT",
            "lineNumber": 43
          },
          {
            "text": "FROM ATTENDANCE_RECORD",
            "lineNumber": 44
          },
          {
            "text": "WHERE CLOCK_OUT_TIME IS NOT NULL",
            "lineNumber": 45
          },
          {
            "text": "ORDER BY WORK_DATE DESC",
            "lineNumber": 46
          },
          {
            "text": "LIMIT 10;",
            "lineNumber": 47
          }
        ]
      },
      "score": 0.4557138681411743
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\MonthlySummaryScreen.vue",
        "range": {
          "startPosition": {
            "line": 769
          },
          "endPosition": {
            "line": 802
          }
        },
        "contents": "    getRemarkText(day) {\n      // 打刻漏れや手入力修正の情報と既存の備考を結合\n      const remarks = []\n      \n      // 打刻漏れの判定（勤務表画面の背景色が黄色の場合）\n      // 打刻種別がMANUALで、かつ元の打刻時刻がない場合\n      // または、打刻種別がMANUALで、出社時刻または退社時刻が存在しない場合\n      const hasClockInMissing = (day.clockInType === 'MANUAL' &amp;&amp; !day.originalClockInTime) || \n                                 (day.clockInType === 'MANUAL' &amp;&amp; !day.clockInTime &amp;&amp; day.clockOutTime)\n      const hasClockOutMissing = (day.clockOutType === 'MANUAL' &amp;&amp; !day.originalClockOutTime) || \n                                  (day.clockOutType === 'MANUAL' &amp;&amp; !day.clockOutTime &amp;&amp; day.clockInTime)\n      \n      if (hasClockInMissing &amp;&amp; hasClockOutMissing) {\n        remarks.push({ text: '(出退打刻なし)', color: '#7955D5' })\n      } else if (hasClockInMissing) {\n        remarks.push({ text: '(出社打刻なし)', color: '#7955D5' })\n      } else if (hasClockOutMissing) {\n        remarks.push({ text: '(退社打刻なし)', color: '#7955D5' })\n      }\n      \n      // 打刻時刻の手入力修正の判定\n      // 1. 打刻種別がSTAMPまたはSCHEDULEDで、かつ元の打刻時刻が存在し、かつ現在の時刻と異なる場合\n      // 2. 打刻種別がMANUALで、かつ元の打刻時刻が存在し、かつ現在の時刻と異なる場合（打刻後に手入力で修正）\n      if (day.clockInType &amp;&amp; day.originalClockInTime &amp;&amp; day.clockInTime) {\n        const originalTime = this.formatTime(day.originalClockInTime)\n        const currentTime = this.formatTime(day.clockInTime)\n        if (originalTime !== currentTime) {\n          remarks.push({ text: &#96;(出社打刻 ${currentTime})&#96;, color: '#7955D5' })\n        }\n      }\n      \n      if (day.clockOutType &amp;&amp; day.originalClockOutTime &amp;&amp; day.clockOutTime) {\n        const originalTime = this.formatTime(day.originalClockOutTime)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    getRemarkText(day) {",
            "lineNumber": 770
          },
          {
            "text": "      // 打刻漏れや手入力修正の情報と既存の備考を結合",
            "lineNumber": 771
          },
          {
            "text": "      const remarks = []",
            "lineNumber": 772
          },
          {
            "text": "      ",
            "lineNumber": 773
          },
          {
            "text": "      // 打刻漏れの判定（勤務表画面の背景色が黄色の場合）",
            "lineNumber": 774
          },
          {
            "text": "      // 打刻種別がMANUALで、かつ元の打刻時刻がない場合",
            "lineNumber": 775
          },
          {
            "text": "      // または、打刻種別がMANUALで、出社時刻または退社時刻が存在しない場合",
            "lineNumber": 776
          },
          {
            "text": "      const hasClockInMissing = (day.clockInType === 'MANUAL' &amp;&amp; !day.originalClockInTime) || ",
            "lineNumber": 777
          },
          {
            "text": "                                 (day.clockInType === 'MANUAL' &amp;&amp; !day.clockInTime &amp;&amp; day.clockOutTime)",
            "lineNumber": 778
          },
          {
            "text": "      const hasClockOutMissing = (day.clockOutType === 'MANUAL' &amp;&amp; !day.originalClockOutTime) || ",
            "lineNumber": 779
          },
          {
            "text": "                                  (day.clockOutType === 'MANUAL' &amp;&amp; !day.clockOutTime &amp;&amp; day.clockInTime)",
            "lineNumber": 780
          },
          {
            "text": "      ",
            "lineNumber": 781
          },
          {
            "text": "      if (hasClockInMissing &amp;&amp; hasClockOutMissing) {",
            "lineNumber": 782
          },
          {
            "text": "        remarks.push({ text: '(出退打刻なし)', color: '#7955D5' })",
            "lineNumber": 783
          },
          {
            "text": "      } else if (hasClockInMissing) {",
            "lineNumber": 784
          },
          {
            "text": "        remarks.push({ text: '(出社打刻なし)', color: '#7955D5' })",
            "lineNumber": 785
          },
          {
            "text": "      } else if (hasClockOutMissing) {",
            "lineNumber": 786
          },
          {
            "text": "        remarks.push({ text: '(退社打刻なし)', color: '#7955D5' })",
            "lineNumber": 787
          },
          {
            "text": "      }",
            "lineNumber": 788
          },
          {
            "text": "      ",
            "lineNumber": 789
          },
          {
            "text": "      // 打刻時刻の手入力修正の判定",
            "lineNumber": 790
          },
          {
            "text": "      // 1. 打刻種別がSTAMPまたはSCHEDULEDで、かつ元の打刻時刻が存在し、かつ現在の時刻と異なる場合",
            "lineNumber": 791
          },
          {
            "text": "      // 2. 打刻種別がMANUALで、かつ元の打刻時刻が存在し、かつ現在の時刻と異なる場合（打刻後に手入力で修正）",
            "lineNumber": 792
          },
          {
            "text": "      if (day.clockInType &amp;&amp; day.originalClockInTime &amp;&amp; day.clockInTime) {",
            "lineNumber": 793
          },
          {
            "text": "        const originalTime = this.formatTime(day.originalClockInTime)",
            "lineNumber": 794
          },
          {
            "text": "        const currentTime = this.formatTime(day.clockInTime)",
            "lineNumber": 795
          },
          {
            "text": "        if (originalTime !== currentTime) {",
            "lineNumber": 796
          },
          {
            "text": "          remarks.push({ text: &#96;(出社打刻 ${currentTime})&#96;, color: '#7955D5' })",
            "lineNumber": 797
          },
          {
            "text": "        }",
            "lineNumber": 798
          },
          {
            "text": "      }",
            "lineNumber": 799
          },
          {
            "text": "      ",
            "lineNumber": 800
          },
          {
            "text": "      if (day.clockOutType &amp;&amp; day.originalClockOutTime &amp;&amp; day.clockOutTime) {",
            "lineNumber": 801
          },
          {
            "text": "        const originalTime = this.formatTime(day.originalClockOutTime)",
            "lineNumber": 802
          }
        ]
      },
      "score": 0.44306421279907227
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\add_original_clock_time_columns_execute.sql",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 30
          }
        },
        "contents": "-- ====================================================================\n-- TeamSpirit勤怠管理システム\n-- ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEカラム追加スクリプト\n-- 作成日: 2025-12-09\n-- \n-- 打刻時刻を手入力で変更した場合でも、元の打刻時刻を保持するためのカラムを追加\n-- ====================================================================\n\nUSE teamspirit_db;\n\n-- ATTENDANCE_RECORDテーブルにORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEカラムを追加\n-- カラムが既に存在する場合はエラーになりますが、無視して続行します\nALTER TABLE ATTENDANCE_RECORD \nADD COLUMN IF NOT EXISTS ORIGINAL_CLOCK_IN_TIME DATETIME COMMENT '出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER CLOCK_OUT_TYPE,\nADD COLUMN IF NOT EXISTS ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER ORIGINAL_CLOCK_IN_TIME;\n\n-- 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）\n-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める\nUPDATE ATTENDANCE_RECORD \nSET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME \nWHERE ATTENDANCE_ID &gt; 0 \n  AND CLOCK_IN_TYPE = 'STAMP' \n  AND (ORIGINAL_CLOCK_IN_TIME IS NULL OR ORIGINAL_CLOCK_IN_TIME = '0000-00-00 00:00:00');\n\n-- 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）\n-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める\nUPDATE ATTENDANCE_RECORD \nSET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME \nWHERE ATTENDANCE_ID &gt; 0 \n  AND CLOCK_OUT_TYPE = 'STAMP' ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- ====================================================================",
            "lineNumber": 1
          },
          {
            "text": "-- TeamSpirit勤怠管理システム",
            "lineNumber": 2
          },
          {
            "text": "-- ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEカラム追加スクリプト",
            "lineNumber": 3
          },
          {
            "text": "-- 作成日: 2025-12-09",
            "lineNumber": 4
          },
          {
            "text": "-- ",
            "lineNumber": 5
          },
          {
            "text": "-- 打刻時刻を手入力で変更した場合でも、元の打刻時刻を保持するためのカラムを追加",
            "lineNumber": 6
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "USE teamspirit_db;",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "-- ATTENDANCE_RECORDテーブルにORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEカラムを追加",
            "lineNumber": 11
          },
          {
            "text": "-- カラムが既に存在する場合はエラーになりますが、無視して続行します",
            "lineNumber": 12
          },
          {
            "text": "ALTER TABLE ATTENDANCE_RECORD ",
            "lineNumber": 13
          },
          {
            "text": "ADD COLUMN IF NOT EXISTS ORIGINAL_CLOCK_IN_TIME DATETIME COMMENT '出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER CLOCK_OUT_TYPE,",
            "lineNumber": 14
          },
          {
            "text": "ADD COLUMN IF NOT EXISTS ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER ORIGINAL_CLOCK_IN_TIME;",
            "lineNumber": 15
          },
          {
            "lineNumber": 16
          },
          {
            "text": "-- 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）",
            "lineNumber": 17
          },
          {
            "text": "-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める",
            "lineNumber": 18
          },
          {
            "text": "UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 19
          },
          {
            "text": "SET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME ",
            "lineNumber": 20
          },
          {
            "text": "WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 21
          },
          {
            "text": "  AND CLOCK_IN_TYPE = 'STAMP' ",
            "lineNumber": 22
          },
          {
            "text": "  AND (ORIGINAL_CLOCK_IN_TIME IS NULL OR ORIGINAL_CLOCK_IN_TIME = '0000-00-00 00:00:00');",
            "lineNumber": 23
          },
          {
            "lineNumber": 24
          },
          {
            "text": "-- 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）",
            "lineNumber": 25
          },
          {
            "text": "-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める",
            "lineNumber": 26
          },
          {
            "text": "UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 27
          },
          {
            "text": "SET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME ",
            "lineNumber": 28
          },
          {
            "text": "WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 29
          },
          {
            "text": "  AND CLOCK_OUT_TYPE = 'STAMP' ",
            "lineNumber": 30
          }
        ]
      },
      "score": 0.44165003299713135
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\add_original_clock_time_columns.sql",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 37,
            "column": 8
          }
        },
        "contents": "-- ====================================================================\n-- TeamSpirit勤怠管理システム\n-- ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEカラム追加スクリプト\n-- 作成日: 2025-12-09\n-- \n-- 打刻時刻を手入力で変更した場合でも、元の打刻時刻を保持するためのカラムを追加\n-- ====================================================================\n\nUSE teamspirit_db;\n\n-- ATTENDANCE_RECORDテーブルにORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEカラムを追加\n-- カラムが既に存在する場合は自動的にスキップされます。\n\n-- カラムが存在しない場合のみ追加する（エラーハンドリング付き）\nSET @dbname = DATABASE();\nSET @tablename = 'ATTENDANCE_RECORD';\nSET @columnname1 = 'ORIGINAL_CLOCK_IN_TIME';\nSET @columnname2 = 'ORIGINAL_CLOCK_OUT_TIME';\n\nSET @preparedStatement = (\n    SELECT IF(\n        (\n            SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS\n            WHERE TABLE_SCHEMA = @dbname\n            AND TABLE_NAME = @tablename\n            AND COLUMN_NAME = @columnname1\n        ) = 0,\n        CONCAT('ALTER TABLE ', @tablename, ' ADD COLUMN ', @columnname1, ' DATETIME COMMENT ''出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS'' AFTER CLOCK_OUT_TYPE'),\n        'SELECT ''Column ORIGINAL_CLOCK_IN_TIME already exists'' AS message'\n    )\n);\nPREPARE alterIfNotExists FROM @preparedStatement;\nEXECUTE alterIfNotExists;\nDEALLOCATE PREPARE alterIfNotExists;\n\nSET @preparedStatement = (\n    SELECT IF(\n        ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- ====================================================================",
            "lineNumber": 1
          },
          {
            "text": "-- TeamSpirit勤怠管理システム",
            "lineNumber": 2
          },
          {
            "text": "-- ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEカラム追加スクリプト",
            "lineNumber": 3
          },
          {
            "text": "-- 作成日: 2025-12-09",
            "lineNumber": 4
          },
          {
            "text": "-- ",
            "lineNumber": 5
          },
          {
            "text": "-- 打刻時刻を手入力で変更した場合でも、元の打刻時刻を保持するためのカラムを追加",
            "lineNumber": 6
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "USE teamspirit_db;",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "-- ATTENDANCE_RECORDテーブルにORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEカラムを追加",
            "lineNumber": 11
          },
          {
            "text": "-- カラムが既に存在する場合は自動的にスキップされます。",
            "lineNumber": 12
          },
          {
            "lineNumber": 13
          },
          {
            "text": "-- カラムが存在しない場合のみ追加する（エラーハンドリング付き）",
            "lineNumber": 14
          },
          {
            "text": "SET @dbname = DATABASE();",
            "lineNumber": 15
          },
          {
            "text": "SET @tablename = 'ATTENDANCE_RECORD';",
            "lineNumber": 16
          },
          {
            "text": "SET @columnname1 = 'ORIGINAL_CLOCK_IN_TIME';",
            "lineNumber": 17
          },
          {
            "text": "SET @columnname2 = 'ORIGINAL_CLOCK_OUT_TIME';",
            "lineNumber": 18
          },
          {
            "lineNumber": 19
          },
          {
            "text": "SET @preparedStatement = (",
            "lineNumber": 20
          },
          {
            "text": "    SELECT IF(",
            "lineNumber": 21
          },
          {
            "text": "        (",
            "lineNumber": 22
          },
          {
            "text": "            SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS",
            "lineNumber": 23
          },
          {
            "text": "            WHERE TABLE_SCHEMA = @dbname",
            "lineNumber": 24
          },
          {
            "text": "            AND TABLE_NAME = @tablename",
            "lineNumber": 25
          },
          {
            "text": "            AND COLUMN_NAME = @columnname1",
            "lineNumber": 26
          },
          {
            "text": "        ) = 0,",
            "lineNumber": 27
          },
          {
            "text": "        CONCAT('ALTER TABLE ', @tablename, ' ADD COLUMN ', @columnname1, ' DATETIME COMMENT ''出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS'' AFTER CLOCK_OUT_TYPE'),",
            "lineNumber": 28
          },
          {
            "text": "        'SELECT ''Column ORIGINAL_CLOCK_IN_TIME already exists'' AS message'",
            "lineNumber": 29
          },
          {
            "text": "    )",
            "lineNumber": 30
          },
          {
            "text": ");",
            "lineNumber": 31
          },
          {
            "text": "PREPARE alterIfNotExists FROM @preparedStatement;",
            "lineNumber": 32
          },
          {
            "text": "EXECUTE alterIfNotExists;",
            "lineNumber": 33
          },
          {
            "text": "DEALLOCATE PREPARE alterIfNotExists;",
            "lineNumber": 34
          },
          {
            "lineNumber": 35
          },
          {
            "text": "SET @preparedStatement = (",
            "lineNumber": 36
          },
          {
            "text": "    SELECT IF(",
            "lineNumber": 37
          },
          {
            "text": "        ",
            "lineNumber": 38
          }
        ]
      },
      "score": 0.4238508939743042
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\TimesheetScreen.vue",
        "range": {
          "startPosition": {
            "line": 2340
          },
          "endPosition": {
            "line": 2378
          }
        },
        "contents": "    getRemarksInfoText(record) {\n      if (!record) return ''\n      \n      const info = []\n      \n      // APIレコードから情報を取得（優先）\n      const clockInType = record.CLOCK_IN_TYPE || record.clockInType\n      const clockOutType = record.CLOCK_OUT_TYPE || record.clockOutType\n      const originalClockInTime = record.ORIGINAL_CLOCK_IN_TIME || record.originalClockInTime\n      const originalClockOutTime = record.ORIGINAL_CLOCK_OUT_TIME || record.originalClockOutTime\n      const clockInTime = record.CLOCK_IN_TIME || record.clockInTime\n      const clockOutTime = record.CLOCK_OUT_TIME || record.clockOutTime\n      \n      // 打刻漏れの判定（勤務表画面の背景色が黄色の場合）\n      const hasClockInMissing = (clockInType === 'MANUAL' &amp;&amp; !originalClockInTime) || \n                                 (clockInType === 'MANUAL' &amp;&amp; !clockInTime &amp;&amp; clockOutTime)\n      const hasClockOutMissing = (clockOutType === 'MANUAL' &amp;&amp; !originalClockOutTime) || \n                                  (clockOutType === 'MANUAL' &amp;&amp; !clockOutTime &amp;&amp; clockInTime)\n      \n      if (hasClockInMissing &amp;&amp; hasClockOutMissing) {\n        info.push('出退打刻なし')\n      } else if (hasClockInMissing) {\n        info.push('出社打刻なし')\n      } else if (hasClockOutMissing) {\n        info.push('退社打刻なし')\n      }\n      \n      // 打刻時刻の手入力修正の判定\n      if (clockInType &amp;&amp; originalClockInTime &amp;&amp; clockInTime) {\n        const originalTime = this.formatTimeForRemarks(originalClockInTime)\n        const currentTime = this.formatTimeForRemarks(clockInTime)\n        if (originalTime !== currentTime) {\n          info.push(&#96;(出社打刻 ${currentTime})&#96;)\n        }\n      }\n      \n      if (clockOutType &amp;&amp; originalClockOutTime &amp;&amp; clockOutTime) {\n        const originalTime = this.formatTimeForRemarks(originalClockOutTime)",
        "signatures": {},
        "detailedLines": [
          {
            "text": "    getRemarksInfoText(record) {",
            "lineNumber": 2341
          },
          {
            "text": "      if (!record) return ''",
            "lineNumber": 2342
          },
          {
            "text": "      ",
            "lineNumber": 2343
          },
          {
            "text": "      const info = []",
            "lineNumber": 2344
          },
          {
            "text": "      ",
            "lineNumber": 2345
          },
          {
            "text": "      // APIレコードから情報を取得（優先）",
            "lineNumber": 2346
          },
          {
            "text": "      const clockInType = record.CLOCK_IN_TYPE || record.clockInType",
            "lineNumber": 2347
          },
          {
            "text": "      const clockOutType = record.CLOCK_OUT_TYPE || record.clockOutType",
            "lineNumber": 2348
          },
          {
            "text": "      const originalClockInTime = record.ORIGINAL_CLOCK_IN_TIME || record.originalClockInTime",
            "lineNumber": 2349
          },
          {
            "text": "      const originalClockOutTime = record.ORIGINAL_CLOCK_OUT_TIME || record.originalClockOutTime",
            "lineNumber": 2350
          },
          {
            "text": "      const clockInTime = record.CLOCK_IN_TIME || record.clockInTime",
            "lineNumber": 2351
          },
          {
            "text": "      const clockOutTime = record.CLOCK_OUT_TIME || record.clockOutTime",
            "lineNumber": 2352
          },
          {
            "text": "      ",
            "lineNumber": 2353
          },
          {
            "text": "      // 打刻漏れの判定（勤務表画面の背景色が黄色の場合）",
            "lineNumber": 2354
          },
          {
            "text": "      const hasClockInMissing = (clockInType === 'MANUAL' &amp;&amp; !originalClockInTime) || ",
            "lineNumber": 2355
          },
          {
            "text": "                                 (clockInType === 'MANUAL' &amp;&amp; !clockInTime &amp;&amp; clockOutTime)",
            "lineNumber": 2356
          },
          {
            "text": "      const hasClockOutMissing = (clockOutType === 'MANUAL' &amp;&amp; !originalClockOutTime) || ",
            "lineNumber": 2357
          },
          {
            "text": "                                  (clockOutType === 'MANUAL' &amp;&amp; !clockOutTime &amp;&amp; clockInTime)",
            "lineNumber": 2358
          },
          {
            "text": "      ",
            "lineNumber": 2359
          },
          {
            "text": "      if (hasClockInMissing &amp;&amp; hasClockOutMissing) {",
            "lineNumber": 2360
          },
          {
            "text": "        info.push('出退打刻なし')",
            "lineNumber": 2361
          },
          {
            "text": "      } else if (hasClockInMissing) {",
            "lineNumber": 2362
          },
          {
            "text": "        info.push('出社打刻なし')",
            "lineNumber": 2363
          },
          {
            "text": "      } else if (hasClockOutMissing) {",
            "lineNumber": 2364
          },
          {
            "text": "        info.push('退社打刻なし')",
            "lineNumber": 2365
          },
          {
            "text": "      }",
            "lineNumber": 2366
          },
          {
            "text": "      ",
            "lineNumber": 2367
          },
          {
            "text": "      // 打刻時刻の手入力修正の判定",
            "lineNumber": 2368
          },
          {
            "text": "      if (clockInType &amp;&amp; originalClockInTime &amp;&amp; clockInTime) {",
            "lineNumber": 2369
          },
          {
            "text": "        const originalTime = this.formatTimeForRemarks(originalClockInTime)",
            "lineNumber": 2370
          },
          {
            "text": "        const currentTime = this.formatTimeForRemarks(clockInTime)",
            "lineNumber": 2371
          },
          {
            "text": "        if (originalTime !== currentTime) {",
            "lineNumber": 2372
          },
          {
            "text": "          info.push(&#96;(出社打刻 ${currentTime})&#96;)",
            "lineNumber": 2373
          },
          {
            "text": "        }",
            "lineNumber": 2374
          },
          {
            "text": "      }",
            "lineNumber": 2375
          },
          {
            "text": "      ",
            "lineNumber": 2376
          },
          {
            "text": "      if (clockOutType &amp;&amp; originalClockOutTime &amp;&amp; clockOutTime) {",
            "lineNumber": 2377
          },
          {
            "text": "        const originalTime = this.formatTimeForRemarks(originalClockOutTime)",
            "lineNumber": 2378
          }
        ]
      },
      "score": 0.41448819637298584
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 117
          },
          "endPosition": {
            "line": 132
          }
        },
        "contents": "-- - OVER_LEGAL_OVERTIME_HOURS: 8h超の残業（即座に法定時間外残業として扱う）\n-- - 割増賃金: 所定の割増率に基づき算定\nCREATE TABLE ATTENDANCE_RECORD (\n    ATTENDANCE_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '勤怠ID: 主キー。勤怠記録を一意に識別するID（自動採番）',\n    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID: 外部キー。どの従業員の勤怠記録か。EMPLOYEEテーブルを参照',\n    WORK_DATE DATE NOT NULL COMMENT '勤務日: どの日の勤怠記録か。形式YYYY-MM-DD。従業員IDと勤務日の組み合わせでユニーク',\n    CLOCK_IN_TIME DATETIME COMMENT '出勤時刻: WEBタイムレコーダーで打刻した時刻、または手入力した時刻。形式YYYY-MM-DD HH:MM:SS',\n    CLOCK_OUT_TIME DATETIME COMMENT '退勤時刻: WEBタイムレコーダーで打刻した時刻、または手入力した時刻。形式YYYY-MM-DD HH:MM:SS',\n    CLOCK_IN_TYPE VARCHAR(20) COMMENT '出勤打刻種別: STAMP=打刻、MANUAL=手入力、SCHEDULED=定時出勤。画面で背景色を変えるために使用',\n    CLOCK_OUT_TYPE VARCHAR(20) COMMENT '退勤打刻種別: STAMP=打刻、MANUAL=手入力、SCHEDULED=定時退勤。画面で背景色を変えるために使用',\n    ORIGINAL_CLOCK_IN_TIME DATETIME COMMENT '出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS',\n    ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS',\n    WORK_LOCATION_CODE VARCHAR(20) COMMENT '勤務場所コード: 外部キー。COMMUTE=通勤、REMOTE=在宅など。WORK_LOCATIONテーブルを参照。日次確定申請には必須',\n    ACTUAL_WORK_HOURS DECIMAL(5,2) COMMENT '実労働時間: 出退勤時刻と休憩時間から自動計算される実際の労働時間（時間単位）。例: 8.50=8時間30分',\n    SCHEDULED_WORK_HOURS DECIMAL(5,2) DEFAULT 7.50 COMMENT '所定労働時間: 標準勤務時間（9:00-17:30）から休憩1時間を除いた7.5時間。例: 7.50=7時間30分',",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- - OVER_LEGAL_OVERTIME_HOURS: 8h超の残業（即座に法定時間外残業として扱う）",
            "lineNumber": 118
          },
          {
            "text": "-- - 割増賃金: 所定の割増率に基づき算定",
            "lineNumber": 119
          },
          {
            "text": "CREATE TABLE ATTENDANCE_RECORD (",
            "lineNumber": 120
          },
          {
            "text": "    ATTENDANCE_ID BIGINT AUTO_INCREMENT NOT NULL COMMENT '勤怠ID: 主キー。勤怠記録を一意に識別するID（自動採番）',",
            "lineNumber": 121
          },
          {
            "text": "    EMPLOYEE_ID VARCHAR(50) NOT NULL COMMENT '従業員ID: 外部キー。どの従業員の勤怠記録か。EMPLOYEEテーブルを参照',",
            "lineNumber": 122
          },
          {
            "text": "    WORK_DATE DATE NOT NULL COMMENT '勤務日: どの日の勤怠記録か。形式YYYY-MM-DD。従業員IDと勤務日の組み合わせでユニーク',",
            "lineNumber": 123
          },
          {
            "text": "    CLOCK_IN_TIME DATETIME COMMENT '出勤時刻: WEBタイムレコーダーで打刻した時刻、または手入力した時刻。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 124
          },
          {
            "text": "    CLOCK_OUT_TIME DATETIME COMMENT '退勤時刻: WEBタイムレコーダーで打刻した時刻、または手入力した時刻。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 125
          },
          {
            "text": "    CLOCK_IN_TYPE VARCHAR(20) COMMENT '出勤打刻種別: STAMP=打刻、MANUAL=手入力、SCHEDULED=定時出勤。画面で背景色を変えるために使用',",
            "lineNumber": 126
          },
          {
            "text": "    CLOCK_OUT_TYPE VARCHAR(20) COMMENT '退勤打刻種別: STAMP=打刻、MANUAL=手入力、SCHEDULED=定時退勤。画面で背景色を変えるために使用',",
            "lineNumber": 127
          },
          {
            "text": "    ORIGINAL_CLOCK_IN_TIME DATETIME COMMENT '出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 128
          },
          {
            "text": "    ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS',",
            "lineNumber": 129
          },
          {
            "text": "    WORK_LOCATION_CODE VARCHAR(20) COMMENT '勤務場所コード: 外部キー。COMMUTE=通勤、REMOTE=在宅など。WORK_LOCATIONテーブルを参照。日次確定申請には必須',",
            "lineNumber": 130
          },
          {
            "text": "    ACTUAL_WORK_HOURS DECIMAL(5,2) COMMENT '実労働時間: 出退勤時刻と休憩時間から自動計算される実際の労働時間（時間単位）。例: 8.50=8時間30分',",
            "lineNumber": 131
          },
          {
            "text": "    SCHEDULED_WORK_HOURS DECIMAL(5,2) DEFAULT 7.50 COMMENT '所定労働時間: 標準勤務時間（9:00-17:30）から休憩1時間を除いた7.5時間。例: 7.50=7時間30分',",
            "lineNumber": 132
          }
        ]
      },
      "score": 0.4115748107433319
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceInputDialog.vue",
        "range": {
          "startPosition": {
            "line": 613
          },
          "endPosition": {
            "line": 645,
            "column": 14
          }
        },
        "contents": "          console.log('勤怠データ:', {\n            CLOCK_IN_TIME: data.CLOCK_IN_TIME,\n            CLOCK_IN_TYPE: data.CLOCK_IN_TYPE,\n            ORIGINAL_CLOCK_IN_TIME: data.ORIGINAL_CLOCK_IN_TIME,\n            IS_CLOCK_IN_MANUAL: data.IS_CLOCK_IN_MANUAL,\n            originalClockIn: this.originalClockIn,\n            isClockInManual: data.IS_CLOCK_IN_MANUAL,\n            CLOCK_OUT_TIME: data.CLOCK_OUT_TIME,\n            CLOCK_OUT_TYPE: data.CLOCK_OUT_TYPE,\n            ORIGINAL_CLOCK_OUT_TIME: data.ORIGINAL_CLOCK_OUT_TIME,\n            IS_CLOCK_OUT_MANUAL: data.IS_CLOCK_OUT_MANUAL,\n            originalClockOut: this.originalClockOut,\n            isClockOutManual: data.IS_CLOCK_OUT_MANUAL\n          })\n          \n          // 手入力フラグ（既存の値から設定）\n          this.isClockInManual = data.IS_CLOCK_IN_MANUAL || false\n          this.isClockOutManual = data.IS_CLOCK_OUT_MANUAL || false\n          // リセット用に元の値を保存\n          this.originalIsClockInManual = data.IS_CLOCK_IN_MANUAL || false\n          this.originalIsClockOutManual = data.IS_CLOCK_OUT_MANUAL || false\n          \n          // 既存の打刻種別を保存（バックエンドで既存の打刻種別を保持するため）\n          this.clockInType = data.CLOCK_IN_TYPE || ''\n          this.clockOutType = data.CLOCK_OUT_TYPE || ''\n          \n          // 元の打刻種別を保存（打刻時刻に戻した場合に使用）\n          // ORIGINAL_CLOCK_IN_TIMEが存在する場合、元の打刻種別はSTAMP（打刻機による記録）\n          // CLOCK_IN_TYPEがMANUALの場合、元の打刻種別はSTAMPと仮定\n          // CLOCK_IN_TYPEがSTAMPまたはSCHEDULEDの場合、そのまま使用\n          if (data.ORIGINAL_CLOCK_IN_TIME) {\n            if (data.CLOCK_IN_TYPE === 'MANUAL') {\n              ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "          console.log('勤怠データ:', {",
            "lineNumber": 614
          },
          {
            "text": "            CLOCK_IN_TIME: data.CLOCK_IN_TIME,",
            "lineNumber": 615
          },
          {
            "text": "            CLOCK_IN_TYPE: data.CLOCK_IN_TYPE,",
            "lineNumber": 616
          },
          {
            "text": "            ORIGINAL_CLOCK_IN_TIME: data.ORIGINAL_CLOCK_IN_TIME,",
            "lineNumber": 617
          },
          {
            "text": "            IS_CLOCK_IN_MANUAL: data.IS_CLOCK_IN_MANUAL,",
            "lineNumber": 618
          },
          {
            "text": "            originalClockIn: this.originalClockIn,",
            "lineNumber": 619
          },
          {
            "text": "            isClockInManual: data.IS_CLOCK_IN_MANUAL,",
            "lineNumber": 620
          },
          {
            "text": "            CLOCK_OUT_TIME: data.CLOCK_OUT_TIME,",
            "lineNumber": 621
          },
          {
            "text": "            CLOCK_OUT_TYPE: data.CLOCK_OUT_TYPE,",
            "lineNumber": 622
          },
          {
            "text": "            ORIGINAL_CLOCK_OUT_TIME: data.ORIGINAL_CLOCK_OUT_TIME,",
            "lineNumber": 623
          },
          {
            "text": "            IS_CLOCK_OUT_MANUAL: data.IS_CLOCK_OUT_MANUAL,",
            "lineNumber": 624
          },
          {
            "text": "            originalClockOut: this.originalClockOut,",
            "lineNumber": 625
          },
          {
            "text": "            isClockOutManual: data.IS_CLOCK_OUT_MANUAL",
            "lineNumber": 626
          },
          {
            "text": "          })",
            "lineNumber": 627
          },
          {
            "text": "          ",
            "lineNumber": 628
          },
          {
            "text": "          // 手入力フラグ（既存の値から設定）",
            "lineNumber": 629
          },
          {
            "text": "          this.isClockInManual = data.IS_CLOCK_IN_MANUAL || false",
            "lineNumber": 630
          },
          {
            "text": "          this.isClockOutManual = data.IS_CLOCK_OUT_MANUAL || false",
            "lineNumber": 631
          },
          {
            "text": "          // リセット用に元の値を保存",
            "lineNumber": 632
          },
          {
            "text": "          this.originalIsClockInManual = data.IS_CLOCK_IN_MANUAL || false",
            "lineNumber": 633
          },
          {
            "text": "          this.originalIsClockOutManual = data.IS_CLOCK_OUT_MANUAL || false",
            "lineNumber": 634
          },
          {
            "text": "          ",
            "lineNumber": 635
          },
          {
            "text": "          // 既存の打刻種別を保存（バックエンドで既存の打刻種別を保持するため）",
            "lineNumber": 636
          },
          {
            "text": "          this.clockInType = data.CLOCK_IN_TYPE || ''",
            "lineNumber": 637
          },
          {
            "text": "          this.clockOutType = data.CLOCK_OUT_TYPE || ''",
            "lineNumber": 638
          },
          {
            "text": "          ",
            "lineNumber": 639
          },
          {
            "text": "          // 元の打刻種別を保存（打刻時刻に戻した場合に使用）",
            "lineNumber": 640
          },
          {
            "text": "          // ORIGINAL_CLOCK_IN_TIMEが存在する場合、元の打刻種別はSTAMP（打刻機による記録）",
            "lineNumber": 641
          },
          {
            "text": "          // CLOCK_IN_TYPEがMANUALの場合、元の打刻種別はSTAMPと仮定",
            "lineNumber": 642
          },
          {
            "text": "          // CLOCK_IN_TYPEがSTAMPまたはSCHEDULEDの場合、そのまま使用",
            "lineNumber": 643
          },
          {
            "text": "          if (data.ORIGINAL_CLOCK_IN_TIME) {",
            "lineNumber": 644
          },
          {
            "text": "            if (data.CLOCK_IN_TYPE === 'MANUAL') {",
            "lineNumber": 645
          },
          {
            "text": "              ",
            "lineNumber": 646
          }
        ]
      },
      "score": 0.3968208432197571
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceInputDialog.vue",
        "range": {
          "startPosition": {
            "line": 892
          },
          "endPosition": {
            "line": 932,
            "column": 10
          }
        },
        "contents": "      this.loading = true\n      try {\n        // 勤怠データ更新\n        const breakTimes = this.buildBreakTimes()\n        \n        // 登録時に打刻時刻と入力時刻を比較して手入力フラグを判定\n        // 空欄に戻した場合はfalseに設定\n        let isClockInManualForSave = false\n        if (this.form.clockIn &amp;&amp; this.form.clockIn.trim() !== '') {\n          if (this.originalClockIn &amp;&amp; this.form.clockIn !== this.originalClockIn) {\n            // 打刻時刻と異なる場合: 手入力として扱う\n            isClockInManualForSave = true\n          } else if (!this.originalClockIn) {\n            // 元の打刻時刻が存在しない場合（新規入力）も手入力として扱う\n            isClockInManualForSave = true\n          } else {\n            // 打刻時刻と同じ時刻に戻した場合: 手入力を解除\n            isClockInManualForSave = false\n          }\n        }\n        \n        let isClockOutManualForSave = false\n        if (this.form.clockOut &amp;&amp; this.form.clockOut.trim() !== '') {\n          if (this.originalClockOut &amp;&amp; this.form.clockOut !== this.originalClockOut) {\n            // 打刻時刻と異なる場合: 手入力として扱う\n            isClockOutManualForSave = true\n          } else if (!this.originalClockOut) {\n            // 元の打刻時刻が存在しない場合（新規入力）も手入力として扱う\n            isClockOutManualForSave = true\n          } else {\n            // 打刻時刻と同じ時刻に戻した場合: 手入力を解除\n            isClockOutManualForSave = false\n          }\n        }\n        \n        // 空欄の場合はclockInType/clockOutTypeを空文字列に設定（背景色を付けないため）\n        // 打刻時刻と同じ時刻に戻した場合、元の打刻種別（STAMPまたはSCHEDULED）に戻す\n        let clockInType = ''\n\n        if (this.form.clockIn &amp;&amp; this.form.clockIn.trim() !== '') {\n          ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "      this.loading = true",
            "lineNumber": 893
          },
          {
            "text": "      try {",
            "lineNumber": 894
          },
          {
            "text": "        // 勤怠データ更新",
            "lineNumber": 895
          },
          {
            "text": "        const breakTimes = this.buildBreakTimes()",
            "lineNumber": 896
          },
          {
            "text": "        ",
            "lineNumber": 897
          },
          {
            "text": "        // 登録時に打刻時刻と入力時刻を比較して手入力フラグを判定",
            "lineNumber": 898
          },
          {
            "text": "        // 空欄に戻した場合はfalseに設定",
            "lineNumber": 899
          },
          {
            "text": "        let isClockInManualForSave = false",
            "lineNumber": 900
          },
          {
            "text": "        if (this.form.clockIn &amp;&amp; this.form.clockIn.trim() !== '') {",
            "lineNumber": 901
          },
          {
            "text": "          if (this.originalClockIn &amp;&amp; this.form.clockIn !== this.originalClockIn) {",
            "lineNumber": 902
          },
          {
            "text": "            // 打刻時刻と異なる場合: 手入力として扱う",
            "lineNumber": 903
          },
          {
            "text": "            isClockInManualForSave = true",
            "lineNumber": 904
          },
          {
            "text": "          } else if (!this.originalClockIn) {",
            "lineNumber": 905
          },
          {
            "text": "            // 元の打刻時刻が存在しない場合（新規入力）も手入力として扱う",
            "lineNumber": 906
          },
          {
            "text": "            isClockInManualForSave = true",
            "lineNumber": 907
          },
          {
            "text": "          } else {",
            "lineNumber": 908
          },
          {
            "text": "            // 打刻時刻と同じ時刻に戻した場合: 手入力を解除",
            "lineNumber": 909
          },
          {
            "text": "            isClockInManualForSave = false",
            "lineNumber": 910
          },
          {
            "text": "          }",
            "lineNumber": 911
          },
          {
            "text": "        }",
            "lineNumber": 912
          },
          {
            "text": "        ",
            "lineNumber": 913
          },
          {
            "text": "        let isClockOutManualForSave = false",
            "lineNumber": 914
          },
          {
            "text": "        if (this.form.clockOut &amp;&amp; this.form.clockOut.trim() !== '') {",
            "lineNumber": 915
          },
          {
            "text": "          if (this.originalClockOut &amp;&amp; this.form.clockOut !== this.originalClockOut) {",
            "lineNumber": 916
          },
          {
            "text": "            // 打刻時刻と異なる場合: 手入力として扱う",
            "lineNumber": 917
          },
          {
            "text": "            isClockOutManualForSave = true",
            "lineNumber": 918
          },
          {
            "text": "          } else if (!this.originalClockOut) {",
            "lineNumber": 919
          },
          {
            "text": "            // 元の打刻時刻が存在しない場合（新規入力）も手入力として扱う",
            "lineNumber": 920
          },
          {
            "text": "            isClockOutManualForSave = true",
            "lineNumber": 921
          },
          {
            "text": "          } else {",
            "lineNumber": 922
          },
          {
            "text": "            // 打刻時刻と同じ時刻に戻した場合: 手入力を解除",
            "lineNumber": 923
          },
          {
            "text": "            isClockOutManualForSave = false",
            "lineNumber": 924
          },
          {
            "text": "          }",
            "lineNumber": 925
          },
          {
            "text": "        }",
            "lineNumber": 926
          },
          {
            "text": "        ",
            "lineNumber": 927
          },
          {
            "text": "        // 空欄の場合はclockInType/clockOutTypeを空文字列に設定（背景色を付けないため）",
            "lineNumber": 928
          },
          {
            "text": "        // 打刻時刻と同じ時刻に戻した場合、元の打刻種別（STAMPまたはSCHEDULED）に戻す",
            "lineNumber": 929
          },
          {
            "text": "        let clockInType = ''",
            "lineNumber": 930
          },
          {
            "lineNumber": 931
          },
          {
            "text": "        if (this.form.clockIn &amp;&amp; this.form.clockIn.trim() !== '') {",
            "lineNumber": 932
          },
          {
            "text": "          ",
            "lineNumber": 933
          }
        ]
      },
      "score": 0.3917425870895386
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\components\\dialog\\AttendanceInputDialog.vue",
        "range": {
          "startPosition": {
            "line": 643
          },
          "endPosition": {
            "line": 670
          }
        },
        "contents": "          if (data.ORIGINAL_CLOCK_IN_TIME) {\n            if (data.CLOCK_IN_TYPE === 'MANUAL') {\n              // 手入力の場合、元の打刻種別はSTAMPと仮定\n              this.originalClockInType = 'STAMP'\n            } else {\n              // 打刻または定時の場合、そのまま使用\n              this.originalClockInType = data.CLOCK_IN_TYPE || 'STAMP'\n            }\n          } else {\n            this.originalClockInType = ''\n          }\n          if (data.ORIGINAL_CLOCK_OUT_TIME) {\n            if (data.CLOCK_OUT_TYPE === 'MANUAL') {\n              // 手入力の場合、元の打刻種別はSTAMPと仮定\n              this.originalClockOutType = 'STAMP'\n            } else {\n              // 打刻または定時の場合、そのまま使用\n              this.originalClockOutType = data.CLOCK_OUT_TYPE || 'STAMP'\n            }\n          } else {\n            this.originalClockOutType = ''\n          }\n          \n          // 休憩時間の設定\n          // 仕様書: 休憩時間リストからBREAKタイプとOFFICIAL_OUTINGタイプを分けて設定\n          if (data.breakTimes &amp;&amp; data.breakTimes.length &gt; 0) {\n            // BREAKタイプの休憩時間を取得（BREAK_SEQ順にソート済み）",
        "signatures": {},
        "detailedLines": [
          {
            "text": "          if (data.ORIGINAL_CLOCK_IN_TIME) {",
            "lineNumber": 644
          },
          {
            "text": "            if (data.CLOCK_IN_TYPE === 'MANUAL') {",
            "lineNumber": 645
          },
          {
            "text": "              // 手入力の場合、元の打刻種別はSTAMPと仮定",
            "lineNumber": 646
          },
          {
            "text": "              this.originalClockInType = 'STAMP'",
            "lineNumber": 647
          },
          {
            "text": "            } else {",
            "lineNumber": 648
          },
          {
            "text": "              // 打刻または定時の場合、そのまま使用",
            "lineNumber": 649
          },
          {
            "text": "              this.originalClockInType = data.CLOCK_IN_TYPE || 'STAMP'",
            "lineNumber": 650
          },
          {
            "text": "            }",
            "lineNumber": 651
          },
          {
            "text": "          } else {",
            "lineNumber": 652
          },
          {
            "text": "            this.originalClockInType = ''",
            "lineNumber": 653
          },
          {
            "text": "          }",
            "lineNumber": 654
          },
          {
            "text": "          if (data.ORIGINAL_CLOCK_OUT_TIME) {",
            "lineNumber": 655
          },
          {
            "text": "            if (data.CLOCK_OUT_TYPE === 'MANUAL') {",
            "lineNumber": 656
          },
          {
            "text": "              // 手入力の場合、元の打刻種別はSTAMPと仮定",
            "lineNumber": 657
          },
          {
            "text": "              this.originalClockOutType = 'STAMP'",
            "lineNumber": 658
          },
          {
            "text": "            } else {",
            "lineNumber": 659
          },
          {
            "text": "              // 打刻または定時の場合、そのまま使用",
            "lineNumber": 660
          },
          {
            "text": "              this.originalClockOutType = data.CLOCK_OUT_TYPE || 'STAMP'",
            "lineNumber": 661
          },
          {
            "text": "            }",
            "lineNumber": 662
          },
          {
            "text": "          } else {",
            "lineNumber": 663
          },
          {
            "text": "            this.originalClockOutType = ''",
            "lineNumber": 664
          },
          {
            "text": "          }",
            "lineNumber": 665
          },
          {
            "text": "          ",
            "lineNumber": 666
          },
          {
            "text": "          // 休憩時間の設定",
            "lineNumber": 667
          },
          {
            "text": "          // 仕様書: 休憩時間リストからBREAKタイプとOFFICIAL_OUTINGタイプを分けて設定",
            "lineNumber": 668
          },
          {
            "text": "          if (data.breakTimes &amp;&amp; data.breakTimes.length &gt; 0) {",
            "lineNumber": 669
          },
          {
            "text": "            // BREAKタイプの休憩時間を取得（BREAK_SEQ順にソート済み）",
            "lineNumber": 670
          }
        ]
      },
      "score": 0.38641613721847534
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 85,
            "column": 2
          },
          "endPosition": {
            "line": 333,
            "column": 1
          }
        },
        "contents": "/**\n * 勤怠記録を更新する。\n *\n * @param {Object} updateData 更新データ\n * @returns {Promise&lt;Object&gt;} 更新後の勤怠記録\n */\nconst updateAttendanceRecord = async (updateData) =&gt; {\n  const connection = await db.getConnection();\n  \n  try {\n    await connection.beginTransaction();\n    const now = getNow();\n    \n    const {\n      attendanceId,\n      employeeId,\n      workDate,\n      clockInTime,\n      clockOutTime,\n      clockInType,\n      clockOutType,\n      workLocationCode,\n      remarkText,\n      isClockInManual,\n      isClockOutManual,\n      breakTimes\n    } = updateData;\n    \n    // 時刻文字列をDateTimeに変換\n    let clockInDateTime = null;\n\n    if (clockInTime) {\n      clockInDateTime = toDateTime(clockInTime, workDate);\n    }\n\n    let clockOutDateTime = null;\n\n    if (clockOutTime) {\n      clockOutDateTime = toDateTime(clockOutTime, workDate);\n    }\n    \n    // 既存レコードを取得（打刻種別を保持するため）\n    let existingAttendance = null;\n\n    if (attendanceId) {\n      existingAttendance = await attendanceModel.getAttendanceById(attendanceId);\n    } else {\n      existingAttendance = await attendanceModel.getAttendanceByDate(employeeId, workDate);\n    }\n    \n    // 打刻種別を判定\n    // 出社時刻が手入力の場合、または既存レコードがない場合はMANUAL\n    let finalClockInType;\n\n    if (isClockInManual) {\n      finalClockInType = 'MANUAL';\n    } else if (clockInType &amp;&amp; clockInType !== '') {\n      // clockInTypeが指定されている場合（空文字列でない場合）\n      finalClockInType = clockInType;\n    } else if (existingAttendance &amp;&amp; existingAttendance.CLOCK_IN_TYPE) {\n      // 既存レコードがある場合は既存の打刻種別を保持\n      finalClockInType = existingAttendance.CLOCK_IN_TYPE;\n    } else {\n      // 新規レコードの場合はMANUAL\n      finalClockInType = 'MANUAL';\n    }\n    \n    // 退社時刻が手入力の場合、または既存レコードがない場合はMANUAL\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 88
          },
          {
            "text": " * 勤怠記録を更新する。",
            "lineNumber": 89
          },
          {
            "text": " *",
            "lineNumber": 90
          },
          {
            "text": " * @param {Object} updateData 更新データ",
            "lineNumber": 91
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 更新後の勤怠記録",
            "lineNumber": 92
          },
          {
            "text": " */",
            "lineNumber": 93
          },
          {
            "text": "const updateAttendanceRecord = async (updateData) =&gt; {",
            "lineNumber": 94
          },
          {
            "text": "  const connection = await db.getConnection();",
            "lineNumber": 95
          },
          {
            "text": "  ",
            "lineNumber": 96
          },
          {
            "text": "  try {",
            "lineNumber": 97
          },
          {
            "text": "    await connection.beginTransaction();",
            "lineNumber": 98
          },
          {
            "text": "    const now = getNow();",
            "lineNumber": 99
          },
          {
            "text": "    ",
            "lineNumber": 100
          },
          {
            "text": "    const {",
            "lineNumber": 101
          },
          {
            "text": "      attendanceId,",
            "lineNumber": 102
          },
          {
            "text": "      employeeId,",
            "lineNumber": 103
          },
          {
            "text": "      workDate,",
            "lineNumber": 104
          },
          {
            "text": "      clockInTime,",
            "lineNumber": 105
          },
          {
            "text": "      clockOutTime,",
            "lineNumber": 106
          },
          {
            "text": "      clockInType,",
            "lineNumber": 107
          },
          {
            "text": "      clockOutType,",
            "lineNumber": 108
          },
          {
            "text": "      workLocationCode,",
            "lineNumber": 109
          },
          {
            "text": "      remarkText,",
            "lineNumber": 110
          },
          {
            "text": "      isClockInManual,",
            "lineNumber": 111
          },
          {
            "text": "      isClockOutManual,",
            "lineNumber": 112
          },
          {
            "text": "      breakTimes",
            "lineNumber": 113
          },
          {
            "text": "    } = updateData;",
            "lineNumber": 114
          },
          {
            "text": "    ",
            "lineNumber": 115
          },
          {
            "text": "    // 時刻文字列をDateTimeに変換",
            "lineNumber": 116
          },
          {
            "text": "    let clockInDateTime = null;",
            "lineNumber": 117
          },
          {
            "lineNumber": 118
          },
          {
            "text": "    if (clockInTime) {",
            "lineNumber": 119
          },
          {
            "text": "      clockInDateTime = toDateTime(clockInTime, workDate);",
            "lineNumber": 120
          },
          {
            "text": "    }",
            "lineNumber": 121
          },
          {
            "lineNumber": 122
          },
          {
            "text": "    let clockOutDateTime = null;",
            "lineNumber": 123
          },
          {
            "lineNumber": 124
          },
          {
            "text": "    if (clockOutTime) {",
            "lineNumber": 125
          },
          {
            "text": "      clockOutDateTime = toDateTime(clockOutTime, workDate);",
            "lineNumber": 126
          },
          {
            "text": "    }",
            "lineNumber": 127
          },
          {
            "text": "    ",
            "lineNumber": 128
          },
          {
            "text": "    // 既存レコードを取得（打刻種別を保持するため）",
            "lineNumber": 129
          },
          {
            "text": "    let existingAttendance = null;",
            "lineNumber": 130
          },
          {
            "lineNumber": 131
          },
          {
            "text": "    if (attendanceId) {",
            "lineNumber": 132
          },
          {
            "text": "      existingAttendance = await attendanceModel.getAttendanceById(attendanceId);",
            "lineNumber": 133
          },
          {
            "text": "    } else {",
            "lineNumber": 134
          },
          {
            "text": "      existingAttendance = await attendanceModel.getAttendanceByDate(employeeId, workDate);",
            "lineNumber": 135
          },
          {
            "text": "    }",
            "lineNumber": 136
          },
          {
            "text": "    ",
            "lineNumber": 137
          },
          {
            "text": "    // 打刻種別を判定",
            "lineNumber": 138
          },
          {
            "text": "    // 出社時刻が手入力の場合、または既存レコードがない場合はMANUAL",
            "lineNumber": 139
          },
          {
            "text": "    let finalClockInType;",
            "lineNumber": 140
          },
          {
            "lineNumber": 141
          },
          {
            "text": "    if (isClockInManual) {",
            "lineNumber": 142
          },
          {
            "text": "      finalClockInType = 'MANUAL';",
            "lineNumber": 143
          },
          {
            "text": "    } else if (clockInType &amp;&amp; clockInType !== '') {",
            "lineNumber": 144
          },
          {
            "text": "      // clockInTypeが指定されている場合（空文字列でない場合）",
            "lineNumber": 145
          },
          {
            "text": "      finalClockInType = clockInType;",
            "lineNumber": 146
          },
          {
            "text": "    } else if (existingAttendance &amp;&amp; existingAttendance.CLOCK_IN_TYPE) {",
            "lineNumber": 147
          },
          {
            "text": "      // 既存レコードがある場合は既存の打刻種別を保持",
            "lineNumber": 148
          },
          {
            "text": "      finalClockInType = existingAttendance.CLOCK_IN_TYPE;",
            "lineNumber": 149
          },
          {
            "text": "    } else {",
            "lineNumber": 150
          },
          {
            "text": "      // 新規レコードの場合はMANUAL",
            "lineNumber": 151
          },
          {
            "text": "      finalClockInType = 'MANUAL';",
            "lineNumber": 152
          },
          {
            "text": "    }",
            "lineNumber": 153
          },
          {
            "text": "    ",
            "lineNumber": 154
          },
          {
            "text": "    // 退社時刻が手入力の場合、または既存レコードがない場合はMANUAL",
            "lineNumber": 155
          },
          {
            "text": ";",
            "lineNumber": 334
          }
        ]
      },
      "score": 0.3849615454673767
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-table-screen.md",
        "range": {
          "startPosition": {
            "line": 1361
          },
          "endPosition": {
            "line": 1392
          }
        },
        "contents": "- **ボタン**:\n  - 「閉じる」ボタンのみ表示（青色リンク）\n  - 押下するとダイアログを閉じる\n- **説明**: 日次確定申請済み（承認申請後）のため、備考の編集はできません\n\n##### 2. 未申請（APPROVAL_STATUS = NOT_SUBMITTED または REJECTED）の場合\n- **備考入力欄**:\n  - 白色背景\n  - 編集可能\n  - 現在の備考内容を表示（編集可）\n- **ボタン**:\n  - 「登録」ボタン（青色）: 押下すると備考を保存してダイアログを閉じる\n  - 「キャンセル」ボタン: 押下すると保存せずダイアログを閉じる\n- **説明**: 日次確定申請前のため、備考の編集が可能です\n\n#### 打刻漏れ・手入力修正情報の表示\n\n備考ダイアログでは、該当日の勤怠データに基づいて打刻漏れや手入力修正の情報を黄色背景で表示します。\n\n##### 表示条件と内容\n\n1. **打刻漏れの判定**\n   - 出勤打刻種別（CLOCK_IN_TYPE）が'MANUAL'で、元の出勤打刻時刻（ORIGINAL_CLOCK_IN_TIME）が存在しない場合、または出勤時刻（CLOCK_IN_TIME）が存在せず退勤時刻が存在する場合\n   - 退勤打刻種別（CLOCK_OUT_TYPE）が'MANUAL'で、元の退勤打刻時刻（ORIGINAL_CLOCK_OUT_TIME）が存在しない場合、または退勤時刻（CLOCK_OUT_TIME）が存在せず出勤時刻が存在する場合\n   - 表示内容:\n     - 出勤・退勤両方漏れ: 「出退打刻なし」\n     - 出勤のみ漏れ: 「出社打刻なし」\n     - 退勤のみ漏れ: 「退社打刻なし」\n\n2. **手入力修正の判定**\n   - 元の出勤打刻時刻（ORIGINAL_CLOCK_IN_TIME）が存在し、現在の出勤時刻（CLOCK_IN_TIME）と異なる場合",
        "signatures": {},
        "detailedLines": [
          {
            "text": "- **ボタン**:",
            "lineNumber": 1362
          },
          {
            "text": "  - 「閉じる」ボタンのみ表示（青色リンク）",
            "lineNumber": 1363
          },
          {
            "text": "  - 押下するとダイアログを閉じる",
            "lineNumber": 1364
          },
          {
            "text": "- **説明**: 日次確定申請済み（承認申請後）のため、備考の編集はできません",
            "lineNumber": 1365
          },
          {
            "lineNumber": 1366
          },
          {
            "text": "##### 2. 未申請（APPROVAL_STATUS = NOT_SUBMITTED または REJECTED）の場合",
            "lineNumber": 1367
          },
          {
            "text": "- **備考入力欄**:",
            "lineNumber": 1368
          },
          {
            "text": "  - 白色背景",
            "lineNumber": 1369
          },
          {
            "text": "  - 編集可能",
            "lineNumber": 1370
          },
          {
            "text": "  - 現在の備考内容を表示（編集可）",
            "lineNumber": 1371
          },
          {
            "text": "- **ボタン**:",
            "lineNumber": 1372
          },
          {
            "text": "  - 「登録」ボタン（青色）: 押下すると備考を保存してダイアログを閉じる",
            "lineNumber": 1373
          },
          {
            "text": "  - 「キャンセル」ボタン: 押下すると保存せずダイアログを閉じる",
            "lineNumber": 1374
          },
          {
            "text": "- **説明**: 日次確定申請前のため、備考の編集が可能です",
            "lineNumber": 1375
          },
          {
            "lineNumber": 1376
          },
          {
            "text": "#### 打刻漏れ・手入力修正情報の表示",
            "lineNumber": 1377
          },
          {
            "lineNumber": 1378
          },
          {
            "text": "備考ダイアログでは、該当日の勤怠データに基づいて打刻漏れや手入力修正の情報を黄色背景で表示します。",
            "lineNumber": 1379
          },
          {
            "lineNumber": 1380
          },
          {
            "text": "##### 表示条件と内容",
            "lineNumber": 1381
          },
          {
            "lineNumber": 1382
          },
          {
            "text": "1. **打刻漏れの判定**",
            "lineNumber": 1383
          },
          {
            "text": "   - 出勤打刻種別（CLOCK_IN_TYPE）が'MANUAL'で、元の出勤打刻時刻（ORIGINAL_CLOCK_IN_TIME）が存在しない場合、または出勤時刻（CLOCK_IN_TIME）が存在せず退勤時刻が存在する場合",
            "lineNumber": 1384
          },
          {
            "text": "   - 退勤打刻種別（CLOCK_OUT_TYPE）が'MANUAL'で、元の退勤打刻時刻（ORIGINAL_CLOCK_OUT_TIME）が存在しない場合、または退勤時刻（CLOCK_OUT_TIME）が存在せず出勤時刻が存在する場合",
            "lineNumber": 1385
          },
          {
            "text": "   - 表示内容:",
            "lineNumber": 1386
          },
          {
            "text": "     - 出勤・退勤両方漏れ: 「出退打刻なし」",
            "lineNumber": 1387
          },
          {
            "text": "     - 出勤のみ漏れ: 「出社打刻なし」",
            "lineNumber": 1388
          },
          {
            "text": "     - 退勤のみ漏れ: 「退社打刻なし」",
            "lineNumber": 1389
          },
          {
            "lineNumber": 1390
          },
          {
            "text": "2. **手入力修正の判定**",
            "lineNumber": 1391
          },
          {
            "text": "   - 元の出勤打刻時刻（ORIGINAL_CLOCK_IN_TIME）が存在し、現在の出勤時刻（CLOCK_IN_TIME）と異なる場合",
            "lineNumber": 1392
          }
        ]
      },
      "score": 0.38488030433654785
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\frontend\\src\\views\\TimesheetScreen.vue",
        "range": {
          "startPosition": {
            "line": 1476
          },
          "endPosition": {
            "line": 1517,
            "column": 10
          }
        },
        "contents": "        let clockOutType = ''\n\n        if (clockOut) {\n          clockOutType = apiRecord?.CLOCK_OUT_TYPE || ''\n        }\n        \n        // 打刻時刻と入力時刻が異なる場合の判定\n        // 打刻時刻（ORIGINAL_CLOCK_IN_TIME/ORIGINAL_CLOCK_OUT_TIME）が存在し、\n        // かつ入力時刻（CLOCK_IN_TIME/CLOCK_OUT_TIME）と異なる場合にtrue\n        // または、打刻種別がMANUALで、かつ打刻時刻が存在する場合\n        const hasClockInMismatch = originalClockIn &amp;&amp; clockIn &amp;&amp; originalClockIn !== clockIn\n        const hasClockOutMismatch = originalClockOut &amp;&amp; clockOut &amp;&amp; originalClockOut !== clockOut\n        const hasStampManualMismatch = hasClockInMismatch || hasClockOutMismatch || \n          (clockInType === 'MANUAL' &amp;&amp; originalClockIn &amp;&amp; clockIn) || \n          (clockOutType === 'MANUAL' &amp;&amp; originalClockOut &amp;&amp; clockOut)\n        \n        // 休日出勤申請の情報を取得\n        const holidayWorkApp = apiRecord?.holidayWorkApplication\n        const hasHolidayWorkApplication = !!(holidayWorkApp &amp;&amp; \n          (holidayWorkApp.APPROVAL_STATUS === 'PENDING' || holidayWorkApp.APPROVAL_STATUS === 'APPROVED'))\n        const holidayWorkApplicationStatus = holidayWorkApp?.APPROVAL_STATUS || null\n        \n        // 休日出勤申請の時間情報を取得（REASONフィールドからJSON形式で取得）\n        let holidayWorkStartTime = null\n        let holidayWorkEndTime = null\n        let holidayWorkBreakHours = null\n        if (holidayWorkApp &amp;&amp; holidayWorkApp.REASON) {\n          try {\n            const reasonData = JSON.parse(holidayWorkApp.REASON)\n            if (reasonData.startTime &amp;&amp; reasonData.endTime) {\n              holidayWorkStartTime = reasonData.startTime\n              holidayWorkEndTime = reasonData.endTime\n              holidayWorkBreakHours = reasonData.breakHours || 1.0\n            }\n          } catch (e) {\n            // JSON解析エラーの場合は無視\n          }\n        }\n        \n        // 休日出勤申請が申請中または承認済みの場合、休憩時間が設定されていない場合はデフォルト値を設定\n        if (hasHolidayWorkApplication &amp;&amp; holidayWorkBreakHours === null) {\n          ",
        "signatures": {},
        "detailedLines": [
          {
            "text": "        let clockOutType = ''",
            "lineNumber": 1477
          },
          {
            "lineNumber": 1478
          },
          {
            "text": "        if (clockOut) {",
            "lineNumber": 1479
          },
          {
            "text": "          clockOutType = apiRecord?.CLOCK_OUT_TYPE || ''",
            "lineNumber": 1480
          },
          {
            "text": "        }",
            "lineNumber": 1481
          },
          {
            "text": "        ",
            "lineNumber": 1482
          },
          {
            "text": "        // 打刻時刻と入力時刻が異なる場合の判定",
            "lineNumber": 1483
          },
          {
            "text": "        // 打刻時刻（ORIGINAL_CLOCK_IN_TIME/ORIGINAL_CLOCK_OUT_TIME）が存在し、",
            "lineNumber": 1484
          },
          {
            "text": "        // かつ入力時刻（CLOCK_IN_TIME/CLOCK_OUT_TIME）と異なる場合にtrue",
            "lineNumber": 1485
          },
          {
            "text": "        // または、打刻種別がMANUALで、かつ打刻時刻が存在する場合",
            "lineNumber": 1486
          },
          {
            "text": "        const hasClockInMismatch = originalClockIn &amp;&amp; clockIn &amp;&amp; originalClockIn !== clockIn",
            "lineNumber": 1487
          },
          {
            "text": "        const hasClockOutMismatch = originalClockOut &amp;&amp; clockOut &amp;&amp; originalClockOut !== clockOut",
            "lineNumber": 1488
          },
          {
            "text": "        const hasStampManualMismatch = hasClockInMismatch || hasClockOutMismatch || ",
            "lineNumber": 1489
          },
          {
            "text": "          (clockInType === 'MANUAL' &amp;&amp; originalClockIn &amp;&amp; clockIn) || ",
            "lineNumber": 1490
          },
          {
            "text": "          (clockOutType === 'MANUAL' &amp;&amp; originalClockOut &amp;&amp; clockOut)",
            "lineNumber": 1491
          },
          {
            "text": "        ",
            "lineNumber": 1492
          },
          {
            "text": "        // 休日出勤申請の情報を取得",
            "lineNumber": 1493
          },
          {
            "text": "        const holidayWorkApp = apiRecord?.holidayWorkApplication",
            "lineNumber": 1494
          },
          {
            "text": "        const hasHolidayWorkApplication = !!(holidayWorkApp &amp;&amp; ",
            "lineNumber": 1495
          },
          {
            "text": "          (holidayWorkApp.APPROVAL_STATUS === 'PENDING' || holidayWorkApp.APPROVAL_STATUS === 'APPROVED'))",
            "lineNumber": 1496
          },
          {
            "text": "        const holidayWorkApplicationStatus = holidayWorkApp?.APPROVAL_STATUS || null",
            "lineNumber": 1497
          },
          {
            "text": "        ",
            "lineNumber": 1498
          },
          {
            "text": "        // 休日出勤申請の時間情報を取得（REASONフィールドからJSON形式で取得）",
            "lineNumber": 1499
          },
          {
            "text": "        let holidayWorkStartTime = null",
            "lineNumber": 1500
          },
          {
            "text": "        let holidayWorkEndTime = null",
            "lineNumber": 1501
          },
          {
            "text": "        let holidayWorkBreakHours = null",
            "lineNumber": 1502
          },
          {
            "text": "        if (holidayWorkApp &amp;&amp; holidayWorkApp.REASON) {",
            "lineNumber": 1503
          },
          {
            "text": "          try {",
            "lineNumber": 1504
          },
          {
            "text": "            const reasonData = JSON.parse(holidayWorkApp.REASON)",
            "lineNumber": 1505
          },
          {
            "text": "            if (reasonData.startTime &amp;&amp; reasonData.endTime) {",
            "lineNumber": 1506
          },
          {
            "text": "              holidayWorkStartTime = reasonData.startTime",
            "lineNumber": 1507
          },
          {
            "text": "              holidayWorkEndTime = reasonData.endTime",
            "lineNumber": 1508
          },
          {
            "text": "              holidayWorkBreakHours = reasonData.breakHours || 1.0",
            "lineNumber": 1509
          },
          {
            "text": "            }",
            "lineNumber": 1510
          },
          {
            "text": "          } catch (e) {",
            "lineNumber": 1511
          },
          {
            "text": "            // JSON解析エラーの場合は無視",
            "lineNumber": 1512
          },
          {
            "text": "          }",
            "lineNumber": 1513
          },
          {
            "text": "        }",
            "lineNumber": 1514
          },
          {
            "text": "        ",
            "lineNumber": 1515
          },
          {
            "text": "        // 休日出勤申請が申請中または承認済みの場合、休憩時間が設定されていない場合はデフォルト値を設定",
            "lineNumber": 1516
          },
          {
            "text": "        if (hasHolidayWorkApplication &amp;&amp; holidayWorkBreakHours === null) {",
            "lineNumber": 1517
          },
          {
            "text": "          ",
            "lineNumber": 1518
          }
        ]
      },
      "score": 0.37647610902786255
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\add_original_clock_time_columns.sql",
        "range": {
          "startPosition": {
            "line": 35
          },
          "endPosition": {
            "line": 67
          }
        },
        "contents": "SET @preparedStatement = (\n    SELECT IF(\n        (\n            SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS\n            WHERE TABLE_SCHEMA = @dbname\n            AND TABLE_NAME = @tablename\n            AND COLUMN_NAME = @columnname2\n        ) = 0,\n        CONCAT('ALTER TABLE ', @tablename, ' ADD COLUMN ', @columnname2, ' DATETIME COMMENT ''退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS'' AFTER ORIGINAL_CLOCK_IN_TIME'),\n        'SELECT ''Column ORIGINAL_CLOCK_OUT_TIME already exists'' AS message'\n    )\n);\nPREPARE alterIfNotExists FROM @preparedStatement;\nEXECUTE alterIfNotExists;\nDEALLOCATE PREPARE alterIfNotExists;\n\n-- 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）\n-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める\nUPDATE ATTENDANCE_RECORD \nSET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME \nWHERE ATTENDANCE_ID &gt; 0 \n  AND CLOCK_IN_TYPE = 'STAMP' \n  AND ORIGINAL_CLOCK_IN_TIME IS NULL;\n\n-- 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）\n-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める\nUPDATE ATTENDANCE_RECORD \nSET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME \nWHERE ATTENDANCE_ID &gt; 0 \n  AND CLOCK_OUT_TYPE = 'STAMP' \n  AND ORIGINAL_CLOCK_OUT_TIME IS NULL;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "SET @preparedStatement = (",
            "lineNumber": 36
          },
          {
            "text": "    SELECT IF(",
            "lineNumber": 37
          },
          {
            "text": "        (",
            "lineNumber": 38
          },
          {
            "text": "            SELECT COUNT(*) FROM INFORMATION_SCHEMA.COLUMNS",
            "lineNumber": 39
          },
          {
            "text": "            WHERE TABLE_SCHEMA = @dbname",
            "lineNumber": 40
          },
          {
            "text": "            AND TABLE_NAME = @tablename",
            "lineNumber": 41
          },
          {
            "text": "            AND COLUMN_NAME = @columnname2",
            "lineNumber": 42
          },
          {
            "text": "        ) = 0,",
            "lineNumber": 43
          },
          {
            "text": "        CONCAT('ALTER TABLE ', @tablename, ' ADD COLUMN ', @columnname2, ' DATETIME COMMENT ''退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS'' AFTER ORIGINAL_CLOCK_IN_TIME'),",
            "lineNumber": 44
          },
          {
            "text": "        'SELECT ''Column ORIGINAL_CLOCK_OUT_TIME already exists'' AS message'",
            "lineNumber": 45
          },
          {
            "text": "    )",
            "lineNumber": 46
          },
          {
            "text": ");",
            "lineNumber": 47
          },
          {
            "text": "PREPARE alterIfNotExists FROM @preparedStatement;",
            "lineNumber": 48
          },
          {
            "text": "EXECUTE alterIfNotExists;",
            "lineNumber": 49
          },
          {
            "text": "DEALLOCATE PREPARE alterIfNotExists;",
            "lineNumber": 50
          },
          {
            "lineNumber": 51
          },
          {
            "text": "-- 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）",
            "lineNumber": 52
          },
          {
            "text": "-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める",
            "lineNumber": 53
          },
          {
            "text": "UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 54
          },
          {
            "text": "SET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME ",
            "lineNumber": 55
          },
          {
            "text": "WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 56
          },
          {
            "text": "  AND CLOCK_IN_TYPE = 'STAMP' ",
            "lineNumber": 57
          },
          {
            "text": "  AND ORIGINAL_CLOCK_IN_TIME IS NULL;",
            "lineNumber": 58
          },
          {
            "lineNumber": 59
          },
          {
            "text": "-- 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）",
            "lineNumber": 60
          },
          {
            "text": "-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める",
            "lineNumber": 61
          },
          {
            "text": "UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 62
          },
          {
            "text": "SET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME ",
            "lineNumber": 63
          },
          {
            "text": "WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 64
          },
          {
            "text": "  AND CLOCK_OUT_TYPE = 'STAMP' ",
            "lineNumber": 65
          },
          {
            "text": "  AND ORIGINAL_CLOCK_OUT_TIME IS NULL;",
            "lineNumber": 66
          }
        ]
      },
      "score": 0.3763490915298462
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\models\\attendanceModel.js",
        "range": {
          "startPosition": {
            "line": 109,
            "column": 2
          },
          "endPosition": {
            "line": 163,
            "column": 3
          }
        },
        "contents": "/**\n * 勤怠記録を作成する。\n *\n * @param {Object} attendanceData 勤怠記録データ\n * @returns {Promise&lt;number&gt;} 作成されたATTENDANCE_ID\n */\nconst createAttendance = async (attendanceData) =&gt; {\n  const {\n    employeeId,\n    workDate,\n    clockInTime,\n    clockOutTime,\n    clockInType,\n    clockOutType,\n    originalClockInTime,\n    originalClockOutTime,\n    workLocationCode,\n    remarkText,\n    createdAt,\n    updatedAt\n  } = attendanceData;\n  \n  const query = &#96;\n    INSERT INTO ATTENDANCE_RECORD \n    (EMPLOYEE_ID, WORK_DATE, CLOCK_IN_TIME, CLOCK_OUT_TIME, CLOCK_IN_TYPE, CLOCK_OUT_TYPE, ORIGINAL_CLOCK_IN_TIME, ORIGINAL_CLOCK_OUT_TIME, WORK_LOCATION_CODE, REMARK_TEXT, CREATED_AT, UPDATED_AT)\n    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\n  &#96;;\n  \n  const [result] = await db.execute(query, [\n    employeeId,\n    workDate,\n    clockInTime,\n    clockOutTime ?? null,\n    clockInType || 'MANUAL',\n    clockOutType || 'MANUAL',\n    originalClockInTime ?? null,\n    originalClockOutTime ?? null,\n    workLocationCode ?? null,\n    remarkText ?? null,\n    createdAt,\n    updatedAt\n  ]);\n  \n  return result.insertId;\n};\n\n/**\n * 勤怠記録を更新する。\n *\n * @param {number} attendanceId 勤怠記録ID\n * @param {Object} updateData 更新データ\n * @returns {Promise&lt;void&gt;}\n */",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 112
          },
          {
            "text": " * 勤怠記録を作成する。",
            "lineNumber": 113
          },
          {
            "text": " *",
            "lineNumber": 114
          },
          {
            "text": " * @param {Object} attendanceData 勤怠記録データ",
            "lineNumber": 115
          },
          {
            "text": " * @returns {Promise&lt;number&gt;} 作成されたATTENDANCE_ID",
            "lineNumber": 116
          },
          {
            "text": " */",
            "lineNumber": 117
          },
          {
            "text": "const createAttendance = async (attendanceData) =&gt; {",
            "lineNumber": 118
          },
          {
            "text": "  const {",
            "lineNumber": 119
          },
          {
            "text": "    employeeId,",
            "lineNumber": 120
          },
          {
            "text": "    workDate,",
            "lineNumber": 121
          },
          {
            "text": "    clockInTime,",
            "lineNumber": 122
          },
          {
            "text": "    clockOutTime,",
            "lineNumber": 123
          },
          {
            "text": "    clockInType,",
            "lineNumber": 124
          },
          {
            "text": "    clockOutType,",
            "lineNumber": 125
          },
          {
            "text": "    originalClockInTime,",
            "lineNumber": 126
          },
          {
            "text": "    originalClockOutTime,",
            "lineNumber": 127
          },
          {
            "text": "    workLocationCode,",
            "lineNumber": 128
          },
          {
            "text": "    remarkText,",
            "lineNumber": 129
          },
          {
            "text": "    createdAt,",
            "lineNumber": 130
          },
          {
            "text": "    updatedAt",
            "lineNumber": 131
          },
          {
            "text": "  } = attendanceData;",
            "lineNumber": 132
          },
          {
            "text": "  ",
            "lineNumber": 133
          },
          {
            "text": "  const query = &#96;",
            "lineNumber": 134
          },
          {
            "text": "    INSERT INTO ATTENDANCE_RECORD ",
            "lineNumber": 135
          },
          {
            "text": "    (EMPLOYEE_ID, WORK_DATE, CLOCK_IN_TIME, CLOCK_OUT_TIME, CLOCK_IN_TYPE, CLOCK_OUT_TYPE, ORIGINAL_CLOCK_IN_TIME, ORIGINAL_CLOCK_OUT_TIME, WORK_LOCATION_CODE, REMARK_TEXT, CREATED_AT, UPDATED_AT)",
            "lineNumber": 136
          },
          {
            "text": "    VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)",
            "lineNumber": 137
          },
          {
            "text": "  &#96;;",
            "lineNumber": 138
          },
          {
            "text": "  ",
            "lineNumber": 139
          },
          {
            "text": "  const [result] = await db.execute(query, [",
            "lineNumber": 140
          },
          {
            "text": "    employeeId,",
            "lineNumber": 141
          },
          {
            "text": "    workDate,",
            "lineNumber": 142
          },
          {
            "text": "    clockInTime,",
            "lineNumber": 143
          },
          {
            "text": "    clockOutTime ?? null,",
            "lineNumber": 144
          },
          {
            "text": "    clockInType || 'MANUAL',",
            "lineNumber": 145
          },
          {
            "text": "    clockOutType || 'MANUAL',",
            "lineNumber": 146
          },
          {
            "text": "    originalClockInTime ?? null,",
            "lineNumber": 147
          },
          {
            "text": "    originalClockOutTime ?? null,",
            "lineNumber": 148
          },
          {
            "text": "    workLocationCode ?? null,",
            "lineNumber": 149
          },
          {
            "text": "    remarkText ?? null,",
            "lineNumber": 150
          },
          {
            "text": "    createdAt,",
            "lineNumber": 151
          },
          {
            "text": "    updatedAt",
            "lineNumber": 152
          },
          {
            "text": "  ]);",
            "lineNumber": 153
          },
          {
            "text": "  ",
            "lineNumber": 154
          },
          {
            "text": "  return result.insertId;",
            "lineNumber": 155
          },
          {
            "text": "};",
            "lineNumber": 156
          },
          {
            "lineNumber": 157
          },
          {
            "text": "/**",
            "lineNumber": 158
          },
          {
            "text": " * 勤怠記録を更新する。",
            "lineNumber": 159
          },
          {
            "text": " *",
            "lineNumber": 160
          },
          {
            "text": " * @param {number} attendanceId 勤怠記録ID",
            "lineNumber": 161
          },
          {
            "text": " * @param {Object} updateData 更新データ",
            "lineNumber": 162
          },
          {
            "text": " * @returns {Promise&lt;void&gt;}",
            "lineNumber": 163
          },
          {
            "text": " */",
            "lineNumber": 164
          }
        ]
      },
      "score": 0.3757810890674591
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-input-dialog.md",
        "range": {
          "startPosition": {
            "line": 83
          },
          "endPosition": {
            "line": 103
          }
        },
        "contents": "| 5 | 更新完了フラグ | 出力 | 勤務表画面 | フラグ | 必須 | FALSE | 登録ボタン押下で更新が完了した場合にTRUE |\n| 6 | 手入力フラグ | 出力 | 勤務表画面 | オブジェクト | 必須 | | 手入力で変更された項目を示すフラグ（出社・退社のみ対象。勤務場所は背景色変更対象外） |\n| 7 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出社手入力フラグ | 出力 | 勤務表画面 | フラグ | 必須 | FALSE | 出社時刻が手入力で変更された場合にTRUE |\n| 8 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退社手入力フラグ | 出力 | 勤務表画面 | フラグ | 必須 | FALSE | 退社時刻が手入力で変更された場合にTRUE |\n\n## その他の項目定義\n\n| No | 項目名 | ドメイン | 正常異常区分 | デフォルト値 | 備考 |\n| :----- | :----- | :----- | :----- | :----- | :----- |\n| 1 | 日次勤務データ | オブジェクト | 正常 | | 対象日付の勤務データ |\n| 2 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤怠ID | 文字 | 正常 | | ATTENDANCE_RECORD.ATTENDANCE_ID |\n| 3 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤時刻 | 時間 | 正常 | | ATTENDANCE_RECORD.CLOCK_IN_TIME |\n| 4 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤時刻 | 時間 | 正常 | | ATTENDANCE_RECORD.CLOCK_OUT_TIME |\n| 5 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤打刻時刻 | 時間 | 正常 | | ATTENDANCE_RECORD.ORIGINAL_CLOCK_IN_TIME（打刻機による元の時刻） |\n| 6 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤打刻時刻 | 時間 | 正常 | | ATTENDANCE_RECORD.ORIGINAL_CLOCK_OUT_TIME（打刻機による元の時刻） |\n| 7 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤務場所コード | 文字 | 正常 | | ATTENDANCE_RECORD.WORK_LOCATION_CODE |\n| 8 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤手入力フラグ | フラグ | 正常 | FALSE | ATTENDANCE_RECORD.IS_CLOCK_IN_MANUAL |\n| 9 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤手入力フラグ | フラグ | 正常 | FALSE | ATTENDANCE_RECORD.IS_CLOCK_OUT_MANUAL |\n| 10 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤務場所手入力フラグ | フラグ | 正常 | FALSE | ATTENDANCE_RECORD.IS_LOCATION_MANUAL |\n| 11 | 休憩時間リスト | リスト | 正常 | | BREAK_TIMEテーブルから取得 |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "| 5 | 更新完了フラグ | 出力 | 勤務表画面 | フラグ | 必須 | FALSE | 登録ボタン押下で更新が完了した場合にTRUE |",
            "lineNumber": 84
          },
          {
            "text": "| 6 | 手入力フラグ | 出力 | 勤務表画面 | オブジェクト | 必須 | | 手入力で変更された項目を示すフラグ（出社・退社のみ対象。勤務場所は背景色変更対象外） |",
            "lineNumber": 85
          },
          {
            "text": "| 7 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出社手入力フラグ | 出力 | 勤務表画面 | フラグ | 必須 | FALSE | 出社時刻が手入力で変更された場合にTRUE |",
            "lineNumber": 86
          },
          {
            "text": "| 8 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退社手入力フラグ | 出力 | 勤務表画面 | フラグ | 必須 | FALSE | 退社時刻が手入力で変更された場合にTRUE |",
            "lineNumber": 87
          },
          {
            "lineNumber": 88
          },
          {
            "text": "## その他の項目定義",
            "lineNumber": 89
          },
          {
            "lineNumber": 90
          },
          {
            "text": "| No | 項目名 | ドメイン | 正常異常区分 | デフォルト値 | 備考 |",
            "lineNumber": 91
          },
          {
            "text": "| :----- | :----- | :----- | :----- | :----- | :----- |",
            "lineNumber": 92
          },
          {
            "text": "| 1 | 日次勤務データ | オブジェクト | 正常 | | 対象日付の勤務データ |",
            "lineNumber": 93
          },
          {
            "text": "| 2 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤怠ID | 文字 | 正常 | | ATTENDANCE_RECORD.ATTENDANCE_ID |",
            "lineNumber": 94
          },
          {
            "text": "| 3 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤時刻 | 時間 | 正常 | | ATTENDANCE_RECORD.CLOCK_IN_TIME |",
            "lineNumber": 95
          },
          {
            "text": "| 4 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤時刻 | 時間 | 正常 | | ATTENDANCE_RECORD.CLOCK_OUT_TIME |",
            "lineNumber": 96
          },
          {
            "text": "| 5 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤打刻時刻 | 時間 | 正常 | | ATTENDANCE_RECORD.ORIGINAL_CLOCK_IN_TIME（打刻機による元の時刻） |",
            "lineNumber": 97
          },
          {
            "text": "| 6 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤打刻時刻 | 時間 | 正常 | | ATTENDANCE_RECORD.ORIGINAL_CLOCK_OUT_TIME（打刻機による元の時刻） |",
            "lineNumber": 98
          },
          {
            "text": "| 7 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤務場所コード | 文字 | 正常 | | ATTENDANCE_RECORD.WORK_LOCATION_CODE |",
            "lineNumber": 99
          },
          {
            "text": "| 8 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;出勤手入力フラグ | フラグ | 正常 | FALSE | ATTENDANCE_RECORD.IS_CLOCK_IN_MANUAL |",
            "lineNumber": 100
          },
          {
            "text": "| 9 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;退勤手入力フラグ | フラグ | 正常 | FALSE | ATTENDANCE_RECORD.IS_CLOCK_OUT_MANUAL |",
            "lineNumber": 101
          },
          {
            "text": "| 10 | &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;勤務場所手入力フラグ | フラグ | 正常 | FALSE | ATTENDANCE_RECORD.IS_LOCATION_MANUAL |",
            "lineNumber": 102
          },
          {
            "text": "| 11 | 休憩時間リスト | リスト | 正常 | | BREAK_TIMEテーブルから取得 |",
            "lineNumber": 103
          }
        ]
      },
      "score": 0.3750503957271576
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\scripts\\add_original_clock_time_columns.js",
        "range": {
          "startPosition": {
            "line": 8
          },
          "endPosition": {
            "line": 89,
            "column": 1
          }
        },
        "contents": "async function addColumns() {\n');\n    }\n    \n    // ORIGINAL_CLOCK_OUT_TIMEカラムを追加\n    if (!existingColumns.includes('ORIGINAL_CLOCK_OUT_TIME')) {\n      await connection.execute(&#96;\n        ALTER TABLE ATTENDANCE_RECORD \n        ADD COLUMN ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER ORIGINAL_CLOCK_IN_TIME\n      &#96;);\n      console.log('✓ ORIGINAL_CLOCK_OUT_TIMEカラムを追加しました');\n    } else {\n      console.log('✓ ORIGINAL_CLOCK_OUT_TIMEカラムは既に存在します');\n    }\n    \n    // 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）\n    const [result1] = await connection.execute(&#96;\n      UPDATE ATTENDANCE_RECORD \n      SET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME \n      WHERE ATTENDANCE_ID &gt; 0 \n        AND CLOCK_IN_TYPE = 'STAMP' \n        AND (ORIGINAL_CLOCK_IN_TIME IS NULL OR ORIGINAL_CLOCK_IN_TIME = '0000-00-00 00:00:00')\n    &#96;);\n    console.log(&#96;✓ 出社時刻の移行: ${result1.affectedRows}件のレコードを更新しました&#96;);\n    \n    // 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）\n    const [result2] = await connection.execute(&#96;\n      UPDATE ATTENDANCE_RECORD \n      SET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME \n      WHERE ATTENDANCE_ID &gt; 0 \n        AND CLOCK_OUT_TYPE = 'STAMP' \n        AND (ORIGINAL_CLOCK_OUT_TIME IS NULL OR ORIGINAL_CLOCK_OUT_TIME = '0000-00-00 00:00:00')\n    &#96;);\n    console.log(&#96;✓ 退社時刻の移行: ${result2.affectedRows}件のレコードを更新しました&#96;);\n    \n    console.log('\\n✓ カラム追加が完了しました！');\n    \n  } catch (error) {\n    console.error('エラーが発生しました:', error.message);\n    console.error('エラー詳細:', error);\n    process.exit(1);\n  } finally {\n    if (connection) {\n      await connection.end();\n}",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 9,
                "column": 1
              },
              "endPosition": {
                "line": 10,
                "column": 3
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "async function addColumns() {",
            "lineNumber": 9,
            "isSignature": true
          },
          {
            "text": "');",
            "lineNumber": 44
          },
          {
            "text": "    }",
            "lineNumber": 45
          },
          {
            "text": "    ",
            "lineNumber": 46
          },
          {
            "text": "    // ORIGINAL_CLOCK_OUT_TIMEカラムを追加",
            "lineNumber": 47
          },
          {
            "text": "    if (!existingColumns.includes('ORIGINAL_CLOCK_OUT_TIME')) {",
            "lineNumber": 48
          },
          {
            "text": "      await connection.execute(&#96;",
            "lineNumber": 49
          },
          {
            "text": "        ALTER TABLE ATTENDANCE_RECORD ",
            "lineNumber": 50
          },
          {
            "text": "        ADD COLUMN ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER ORIGINAL_CLOCK_IN_TIME",
            "lineNumber": 51
          },
          {
            "text": "      &#96;);",
            "lineNumber": 52
          },
          {
            "text": "      console.log('✓ ORIGINAL_CLOCK_OUT_TIMEカラムを追加しました');",
            "lineNumber": 53
          },
          {
            "text": "    } else {",
            "lineNumber": 54
          },
          {
            "text": "      console.log('✓ ORIGINAL_CLOCK_OUT_TIMEカラムは既に存在します');",
            "lineNumber": 55
          },
          {
            "text": "    }",
            "lineNumber": 56
          },
          {
            "text": "    ",
            "lineNumber": 57
          },
          {
            "text": "    // 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）",
            "lineNumber": 58
          },
          {
            "text": "    const [result1] = await connection.execute(&#96;",
            "lineNumber": 59
          },
          {
            "text": "      UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 60
          },
          {
            "text": "      SET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME ",
            "lineNumber": 61
          },
          {
            "text": "      WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 62
          },
          {
            "text": "        AND CLOCK_IN_TYPE = 'STAMP' ",
            "lineNumber": 63
          },
          {
            "text": "        AND (ORIGINAL_CLOCK_IN_TIME IS NULL OR ORIGINAL_CLOCK_IN_TIME = '0000-00-00 00:00:00')",
            "lineNumber": 64
          },
          {
            "text": "    &#96;);",
            "lineNumber": 65
          },
          {
            "text": "    console.log(&#96;✓ 出社時刻の移行: ${result1.affectedRows}件のレコードを更新しました&#96;);",
            "lineNumber": 66
          },
          {
            "text": "    ",
            "lineNumber": 67
          },
          {
            "text": "    // 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）",
            "lineNumber": 68
          },
          {
            "text": "    const [result2] = await connection.execute(&#96;",
            "lineNumber": 69
          },
          {
            "text": "      UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 70
          },
          {
            "text": "      SET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME ",
            "lineNumber": 71
          },
          {
            "text": "      WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 72
          },
          {
            "text": "        AND CLOCK_OUT_TYPE = 'STAMP' ",
            "lineNumber": 73
          },
          {
            "text": "        AND (ORIGINAL_CLOCK_OUT_TIME IS NULL OR ORIGINAL_CLOCK_OUT_TIME = '0000-00-00 00:00:00')",
            "lineNumber": 74
          },
          {
            "text": "    &#96;);",
            "lineNumber": 75
          },
          {
            "text": "    console.log(&#96;✓ 退社時刻の移行: ${result2.affectedRows}件のレコードを更新しました&#96;);",
            "lineNumber": 76
          },
          {
            "text": "    ",
            "lineNumber": 77
          },
          {
            "text": "    console.log('\\n✓ カラム追加が完了しました！');",
            "lineNumber": 78
          },
          {
            "text": "    ",
            "lineNumber": 79
          },
          {
            "text": "  } catch (error) {",
            "lineNumber": 80
          },
          {
            "text": "    console.error('エラーが発生しました:', error.message);",
            "lineNumber": 81
          },
          {
            "text": "    console.error('エラー詳細:', error);",
            "lineNumber": 82
          },
          {
            "text": "    process.exit(1);",
            "lineNumber": 83
          },
          {
            "text": "  } finally {",
            "lineNumber": 84
          },
          {
            "text": "    if (connection) {",
            "lineNumber": 85
          },
          {
            "text": "      await connection.end();",
            "lineNumber": 86
          },
          {
            "text": "}",
            "lineNumber": 90,
            "isSignature": true
          }
        ]
      },
      "score": 0.3732728064060211
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-table-screen.md",
        "range": {
          "startPosition": {
            "line": 1157
          },
          "endPosition": {
            "line": 1194
          }
        },
        "contents": "7. **法定時間内残業**: 所定労働時間（7.5h/日）を超えて法定労働時間（8h/日）以内の残業時間（例: 0:00）\n   - 実作業時間が所定労働時間を超えている場合、その超過分のうち法定労働時間（所定出勤日数 * 8:00）以内の部分\n   - 計算方法: max(0, min(実作業時間 - 所定労働時間, (所定出勤日数 * 8:00) - 所定労働時間))\n8. **法定時間外残業**: 法定労働時間（8h/日）を超えた残業時間（例: 0:00）\n   - 実作業時間が法定労働時間（所定出勤日数 * 8:00）を超えた部分\n   - 計算方法: max(0, 実作業時間 - (所定出勤日数 * 8:00))\n\n### 欠勤・休暇の扱い\n\n#### 欠勤\n- 就業日に勤務をしない場合は欠勤とし、事前または事後速やかに届出が必要\n- フレックスタイム制では、欠勤日は消滅時効の対象期間において確定労働時間数を計算した時に控除される\n- 副業従事は定期休暇、子の看護休暇、介護休暇を取得した場合に管理される\n\n#### 有給休暇\n- 有給休暇の取得日は標準労働時間（7.5時間）を勤務したものとみなす\n- 清算期間の所定労働時間に算入される\n\n#### 振替休暇\n- 振替休暇の取得日は標準労働時間（7.5時間）を勤務したものとみなす\n\n### 打刻と手入力の区別\n\n#### 背景色による区別\n- **手入力（MANUAL）**: 黄色背景で表示\n  - 従業員が手動で時刻を入力した場合\n  - 打刻忘れなどで後から入力した場合\n- **打刻（STAMP）または定時打刻（SCHEDULED）**: 白色背景で表示\n  - 打刻ボタンで記録された場合（STAMP）\n  - 定時出勤/定時退勤ボタンで記録された場合（SCHEDULED）\n\n#### 出社・退社列の表示形式と押下動作\n\n##### 表示形式（承認状態と曜日による切り替え）\n| 曜日 | 承認状態 | 休日出勤申請 | 表示形式 | 編集可否 |\n| --- | --- | --- | --- | --- |\n| 土日祝 | すべて | 未申請または未承認 | テキストボックスなし（表示しない） | - |",
        "signatures": {},
        "detailedLines": [
          {
            "text": "7. **法定時間内残業**: 所定労働時間（7.5h/日）を超えて法定労働時間（8h/日）以内の残業時間（例: 0:00）",
            "lineNumber": 1158
          },
          {
            "text": "   - 実作業時間が所定労働時間を超えている場合、その超過分のうち法定労働時間（所定出勤日数 * 8:00）以内の部分",
            "lineNumber": 1159
          },
          {
            "text": "   - 計算方法: max(0, min(実作業時間 - 所定労働時間, (所定出勤日数 * 8:00) - 所定労働時間))",
            "lineNumber": 1160
          },
          {
            "text": "8. **法定時間外残業**: 法定労働時間（8h/日）を超えた残業時間（例: 0:00）",
            "lineNumber": 1161
          },
          {
            "text": "   - 実作業時間が法定労働時間（所定出勤日数 * 8:00）を超えた部分",
            "lineNumber": 1162
          },
          {
            "text": "   - 計算方法: max(0, 実作業時間 - (所定出勤日数 * 8:00))",
            "lineNumber": 1163
          },
          {
            "lineNumber": 1164
          },
          {
            "text": "### 欠勤・休暇の扱い",
            "lineNumber": 1165
          },
          {
            "lineNumber": 1166
          },
          {
            "text": "#### 欠勤",
            "lineNumber": 1167
          },
          {
            "text": "- 就業日に勤務をしない場合は欠勤とし、事前または事後速やかに届出が必要",
            "lineNumber": 1168
          },
          {
            "text": "- フレックスタイム制では、欠勤日は消滅時効の対象期間において確定労働時間数を計算した時に控除される",
            "lineNumber": 1169
          },
          {
            "text": "- 副業従事は定期休暇、子の看護休暇、介護休暇を取得した場合に管理される",
            "lineNumber": 1170
          },
          {
            "lineNumber": 1171
          },
          {
            "text": "#### 有給休暇",
            "lineNumber": 1172
          },
          {
            "text": "- 有給休暇の取得日は標準労働時間（7.5時間）を勤務したものとみなす",
            "lineNumber": 1173
          },
          {
            "text": "- 清算期間の所定労働時間に算入される",
            "lineNumber": 1174
          },
          {
            "lineNumber": 1175
          },
          {
            "text": "#### 振替休暇",
            "lineNumber": 1176
          },
          {
            "text": "- 振替休暇の取得日は標準労働時間（7.5時間）を勤務したものとみなす",
            "lineNumber": 1177
          },
          {
            "lineNumber": 1178
          },
          {
            "text": "### 打刻と手入力の区別",
            "lineNumber": 1179
          },
          {
            "lineNumber": 1180
          },
          {
            "text": "#### 背景色による区別",
            "lineNumber": 1181
          },
          {
            "text": "- **手入力（MANUAL）**: 黄色背景で表示",
            "lineNumber": 1182
          },
          {
            "text": "  - 従業員が手動で時刻を入力した場合",
            "lineNumber": 1183
          },
          {
            "text": "  - 打刻忘れなどで後から入力した場合",
            "lineNumber": 1184
          },
          {
            "text": "- **打刻（STAMP）または定時打刻（SCHEDULED）**: 白色背景で表示",
            "lineNumber": 1185
          },
          {
            "text": "  - 打刻ボタンで記録された場合（STAMP）",
            "lineNumber": 1186
          },
          {
            "text": "  - 定時出勤/定時退勤ボタンで記録された場合（SCHEDULED）",
            "lineNumber": 1187
          },
          {
            "lineNumber": 1188
          },
          {
            "text": "#### 出社・退社列の表示形式と押下動作",
            "lineNumber": 1189
          },
          {
            "lineNumber": 1190
          },
          {
            "text": "##### 表示形式（承認状態と曜日による切り替え）",
            "lineNumber": 1191
          },
          {
            "text": "| 曜日 | 承認状態 | 休日出勤申請 | 表示形式 | 編集可否 |",
            "lineNumber": 1192
          },
          {
            "text": "| --- | --- | --- | --- | --- |",
            "lineNumber": 1193
          },
          {
            "text": "| 土日祝 | すべて | 未申請または未承認 | テキストボックスなし（表示しない） | - |",
            "lineNumber": 1194
          }
        ]
      },
      "score": 0.37254050374031067
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\update_original_clock_time.sql",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 26
          }
        },
        "contents": "-- ====================================================================\n-- TeamSpirit勤怠管理システム\n-- ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEの既存データ移行スクリプト\n-- 作成日: 2025-12-09\n-- \n-- カラムが既に追加されている場合に、既存データを移行するためのスクリプト\n-- ====================================================================\n\nUSE teamspirit_db;\n\n-- 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）\n-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める\nUPDATE ATTENDANCE_RECORD \nSET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME \nWHERE ATTENDANCE_ID &gt; 0 \n  AND CLOCK_IN_TYPE = 'STAMP' \n  AND ORIGINAL_CLOCK_IN_TIME IS NULL;\n\n-- 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）\n-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める\nUPDATE ATTENDANCE_RECORD \nSET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME \nWHERE ATTENDANCE_ID &gt; 0 \n  AND CLOCK_OUT_TYPE = 'STAMP' \n  AND ORIGINAL_CLOCK_OUT_TIME IS NULL;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- ====================================================================",
            "lineNumber": 1
          },
          {
            "text": "-- TeamSpirit勤怠管理システム",
            "lineNumber": 2
          },
          {
            "text": "-- ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEの既存データ移行スクリプト",
            "lineNumber": 3
          },
          {
            "text": "-- 作成日: 2025-12-09",
            "lineNumber": 4
          },
          {
            "text": "-- ",
            "lineNumber": 5
          },
          {
            "text": "-- カラムが既に追加されている場合に、既存データを移行するためのスクリプト",
            "lineNumber": 6
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 7
          },
          {
            "lineNumber": 8
          },
          {
            "text": "USE teamspirit_db;",
            "lineNumber": 9
          },
          {
            "lineNumber": 10
          },
          {
            "text": "-- 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）",
            "lineNumber": 11
          },
          {
            "text": "-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める",
            "lineNumber": 12
          },
          {
            "text": "UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 13
          },
          {
            "text": "SET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME ",
            "lineNumber": 14
          },
          {
            "text": "WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 15
          },
          {
            "text": "  AND CLOCK_IN_TYPE = 'STAMP' ",
            "lineNumber": 16
          },
          {
            "text": "  AND ORIGINAL_CLOCK_IN_TIME IS NULL;",
            "lineNumber": 17
          },
          {
            "lineNumber": 18
          },
          {
            "text": "-- 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）",
            "lineNumber": 19
          },
          {
            "text": "-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める",
            "lineNumber": 20
          },
          {
            "text": "UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 21
          },
          {
            "text": "SET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME ",
            "lineNumber": 22
          },
          {
            "text": "WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 23
          },
          {
            "text": "  AND CLOCK_OUT_TYPE = 'STAMP' ",
            "lineNumber": 24
          },
          {
            "text": "  AND ORIGINAL_CLOCK_OUT_TIME IS NULL;",
            "lineNumber": 25
          }
        ]
      },
      "score": 0.367576003074646
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 93
          },
          "endPosition": {
            "line": 333,
            "column": 1
          }
        },
        "contents": "const updateAttendanceRecord = async \n\n    }\n    \n    // 退社時刻が手入力の場合、または既存レコードがない場合はMANUAL\n    let finalClockOutType;\n\n    if (isClockOutManual) {\n      finalClockOutType = 'MANUAL';\n    } else if (clockOutType &amp;&amp; clockOutType !== '') {\n      // clockOutTypeが指定されている場合（空文字列でない場合）\n      finalClockOutType = clockOutType;\n    } else if (existingAttendance &amp;&amp; existingAttendance.CLOCK_OUT_TYPE) {\n      // 既存レコードがある場合は既存の打刻種別を保持（退社時刻が変更されていない場合）\n      finalClockOutType = existingAttendance.CLOCK_OUT_TYPE;\n    } else {\n      // 新規レコードの場合はMANUAL\n      finalClockOutType = 'MANUAL';\n    }\n    \n    // 元の打刻時刻を保持（既存レコードがある場合は既存の値を保持、新規または打刻の場合は設定）\n    let originalClockInDateTime = null;\n    let originalClockOutDateTime = null;\n\n    if (existingAttendance) {\n      // 既存レコードがある場合\n      // ORIGINAL_CLOCK_IN_TIMEが既に存在する場合は保持\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 94,
                "column": 1
              },
              "endPosition": {
                "line": 94,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 94,
                "column": 7
              },
              "endPosition": {
                "line": 94,
                "column": 38
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const updateAttendanceRecord = async ",
            "lineNumber": 94
          },
          {
            "lineNumber": 152
          },
          {
            "text": "    }",
            "lineNumber": 153
          },
          {
            "text": "    ",
            "lineNumber": 154
          },
          {
            "text": "    // 退社時刻が手入力の場合、または既存レコードがない場合はMANUAL",
            "lineNumber": 155
          },
          {
            "text": "    let finalClockOutType;",
            "lineNumber": 156
          },
          {
            "lineNumber": 157
          },
          {
            "text": "    if (isClockOutManual) {",
            "lineNumber": 158
          },
          {
            "text": "      finalClockOutType = 'MANUAL';",
            "lineNumber": 159
          },
          {
            "text": "    } else if (clockOutType &amp;&amp; clockOutType !== '') {",
            "lineNumber": 160
          },
          {
            "text": "      // clockOutTypeが指定されている場合（空文字列でない場合）",
            "lineNumber": 161
          },
          {
            "text": "      finalClockOutType = clockOutType;",
            "lineNumber": 162
          },
          {
            "text": "    } else if (existingAttendance &amp;&amp; existingAttendance.CLOCK_OUT_TYPE) {",
            "lineNumber": 163
          },
          {
            "text": "      // 既存レコードがある場合は既存の打刻種別を保持（退社時刻が変更されていない場合）",
            "lineNumber": 164
          },
          {
            "text": "      finalClockOutType = existingAttendance.CLOCK_OUT_TYPE;",
            "lineNumber": 165
          },
          {
            "text": "    } else {",
            "lineNumber": 166
          },
          {
            "text": "      // 新規レコードの場合はMANUAL",
            "lineNumber": 167
          },
          {
            "text": "      finalClockOutType = 'MANUAL';",
            "lineNumber": 168
          },
          {
            "text": "    }",
            "lineNumber": 169
          },
          {
            "text": "    ",
            "lineNumber": 170
          },
          {
            "text": "    // 元の打刻時刻を保持（既存レコードがある場合は既存の値を保持、新規または打刻の場合は設定）",
            "lineNumber": 171
          },
          {
            "text": "    let originalClockInDateTime = null;",
            "lineNumber": 172
          },
          {
            "text": "    let originalClockOutDateTime = null;",
            "lineNumber": 173
          },
          {
            "lineNumber": 174
          },
          {
            "text": "    if (existingAttendance) {",
            "lineNumber": 175
          },
          {
            "text": "      // 既存レコードがある場合",
            "lineNumber": 176
          },
          {
            "text": "      // ORIGINAL_CLOCK_IN_TIMEが既に存在する場合は保持",
            "lineNumber": 177
          },
          {
            "text": ";",
            "lineNumber": 334
          }
        ]
      },
      "score": 0.36363521218299866
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {},
          "endPosition": {
            "line": 85,
            "column": 1
          }
        },
        "contents": "/**\n * 勤怠サービス\n */\nconst attendanceModel = require('../models/attendanceModel');\nconst breakTimeModel = require('../models/breakTimeModel');\nconst workHoursModel = require('../models/workHoursModel');\nconst applicationModel = require('../models/applicationModel');\nconst { \n  getTodayJST, \n  getNow, \n  toDateTime, \n  formatHours, \n  formatOverUnder,\n  getMonthRange,\n  getScheduledWorkDays,\n  normalizeDate,\n  calculateMinutes\n} = require('../utils/dateUtils');\nconst db = require('../config/database');\n\n/**\n * 日次勤怠記録を取得する。\n *\n * @param {string} employeeId 従業員ID\n * @param {string} workDate 勤務日（YYYY-MM-DD形式）\n * @returns {Promise&lt;Object|null&gt;} 勤怠記録\n */\nconst getDailyAttendance = async (employeeId, workDate) =&gt; {\n  const attendance = await attendanceModel.getAttendanceDetail(employeeId, workDate);\n  \n  if (!attendance) {\n    return null;\n  }\n  \n  const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);\n  const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);\n  \n  // 休憩時間と公用外出を統合\n  const combinedBreakTimes = [];\n  \n  for (const breakTime of breakTimes) {\n    combinedBreakTimes.push({\n      ...breakTime,\n      BREAK_TYPE: 'BREAK'\n    });\n  }\n  \n  for (const outing of officialOutings) {\n    combinedBreakTimes.push({\n      BREAK_ID: outing.OUTING_ID,\n      BREAK_SEQ: outing.OUTING_SEQ,\n      BREAK_START_TIME: outing.OUTING_START_TIME,\n      BREAK_END_TIME: outing.OUTING_END_TIME,\n      BREAK_DURATION_MINUTES: outing.OUTING_DURATION_MINUTES,\n      BREAK_TYPE: 'OFFICIAL_OUTING',\n      OUTING_PURPOSE: outing.OUTING_PURPOSE\n    });\n  }\n  \n  const isClockInManual = attendance.CLOCK_IN_TYPE === 'MANUAL';\n  const isClockOutManual = attendance.CLOCK_OUT_TYPE === 'MANUAL';\n\n  // ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEはデータベースから直接取得\n  // データベースに値が存在しない場合は、CLOCK_IN_TYPEがSTAMPの場合にCLOCK_IN_TIMEを使用\n  let originalClockInTime = attendance.ORIGINAL_CLOCK_IN_TIME;\n\n  if (!originalClockInTime &amp;&amp; attendance.CLOCK_IN_TYPE === 'STAMP')\n;",
        "signatures": {},
        "detailedLines": [
          {
            "text": "/**",
            "lineNumber": 1
          },
          {
            "text": " * 勤怠サービス",
            "lineNumber": 2
          },
          {
            "text": " */",
            "lineNumber": 3
          },
          {
            "text": "const attendanceModel = require('../models/attendanceModel');",
            "lineNumber": 4
          },
          {
            "text": "const breakTimeModel = require('../models/breakTimeModel');",
            "lineNumber": 5
          },
          {
            "text": "const workHoursModel = require('../models/workHoursModel');",
            "lineNumber": 6
          },
          {
            "text": "const applicationModel = require('../models/applicationModel');",
            "lineNumber": 7
          },
          {
            "text": "const { ",
            "lineNumber": 8
          },
          {
            "text": "  getTodayJST, ",
            "lineNumber": 9
          },
          {
            "text": "  getNow, ",
            "lineNumber": 10
          },
          {
            "text": "  toDateTime, ",
            "lineNumber": 11
          },
          {
            "text": "  formatHours, ",
            "lineNumber": 12
          },
          {
            "text": "  formatOverUnder,",
            "lineNumber": 13
          },
          {
            "text": "  getMonthRange,",
            "lineNumber": 14
          },
          {
            "text": "  getScheduledWorkDays,",
            "lineNumber": 15
          },
          {
            "text": "  normalizeDate,",
            "lineNumber": 16
          },
          {
            "text": "  calculateMinutes",
            "lineNumber": 17
          },
          {
            "text": "} = require('../utils/dateUtils');",
            "lineNumber": 18
          },
          {
            "text": "const db = require('../config/database');",
            "lineNumber": 19
          },
          {
            "lineNumber": 20
          },
          {
            "text": "/**",
            "lineNumber": 21
          },
          {
            "text": " * 日次勤怠記録を取得する。",
            "lineNumber": 22
          },
          {
            "text": " *",
            "lineNumber": 23
          },
          {
            "text": " * @param {string} employeeId 従業員ID",
            "lineNumber": 24
          },
          {
            "text": " * @param {string} workDate 勤務日（YYYY-MM-DD形式）",
            "lineNumber": 25
          },
          {
            "text": " * @returns {Promise&lt;Object|null&gt;} 勤怠記録",
            "lineNumber": 26
          },
          {
            "text": " */",
            "lineNumber": 27
          },
          {
            "text": "const getDailyAttendance = async (employeeId, workDate) =&gt; {",
            "lineNumber": 28
          },
          {
            "text": "  const attendance = await attendanceModel.getAttendanceDetail(employeeId, workDate);",
            "lineNumber": 29
          },
          {
            "text": "  ",
            "lineNumber": 30
          },
          {
            "text": "  if (!attendance) {",
            "lineNumber": 31
          },
          {
            "text": "    return null;",
            "lineNumber": 32
          },
          {
            "text": "  }",
            "lineNumber": 33
          },
          {
            "text": "  ",
            "lineNumber": 34
          },
          {
            "text": "  const breakTimes = await breakTimeModel.getBreakTimes(attendance.ATTENDANCE_ID);",
            "lineNumber": 35
          },
          {
            "text": "  const officialOutings = await breakTimeModel.getOfficialOutings(attendance.ATTENDANCE_ID);",
            "lineNumber": 36
          },
          {
            "text": "  ",
            "lineNumber": 37
          },
          {
            "text": "  // 休憩時間と公用外出を統合",
            "lineNumber": 38
          },
          {
            "text": "  const combinedBreakTimes = [];",
            "lineNumber": 39
          },
          {
            "text": "  ",
            "lineNumber": 40
          },
          {
            "text": "  for (const breakTime of breakTimes) {",
            "lineNumber": 41
          },
          {
            "text": "    combinedBreakTimes.push({",
            "lineNumber": 42
          },
          {
            "text": "      ...breakTime,",
            "lineNumber": 43
          },
          {
            "text": "      BREAK_TYPE: 'BREAK'",
            "lineNumber": 44
          },
          {
            "text": "    });",
            "lineNumber": 45
          },
          {
            "text": "  }",
            "lineNumber": 46
          },
          {
            "text": "  ",
            "lineNumber": 47
          },
          {
            "text": "  for (const outing of officialOutings) {",
            "lineNumber": 48
          },
          {
            "text": "    combinedBreakTimes.push({",
            "lineNumber": 49
          },
          {
            "text": "      BREAK_ID: outing.OUTING_ID,",
            "lineNumber": 50
          },
          {
            "text": "      BREAK_SEQ: outing.OUTING_SEQ,",
            "lineNumber": 51
          },
          {
            "text": "      BREAK_START_TIME: outing.OUTING_START_TIME,",
            "lineNumber": 52
          },
          {
            "text": "      BREAK_END_TIME: outing.OUTING_END_TIME,",
            "lineNumber": 53
          },
          {
            "text": "      BREAK_DURATION_MINUTES: outing.OUTING_DURATION_MINUTES,",
            "lineNumber": 54
          },
          {
            "text": "      BREAK_TYPE: 'OFFICIAL_OUTING',",
            "lineNumber": 55
          },
          {
            "text": "      OUTING_PURPOSE: outing.OUTING_PURPOSE",
            "lineNumber": 56
          },
          {
            "text": "    });",
            "lineNumber": 57
          },
          {
            "text": "  }",
            "lineNumber": 58
          },
          {
            "text": "  ",
            "lineNumber": 59
          },
          {
            "text": "  const isClockInManual = attendance.CLOCK_IN_TYPE === 'MANUAL';",
            "lineNumber": 60
          },
          {
            "text": "  const isClockOutManual = attendance.CLOCK_OUT_TYPE === 'MANUAL';",
            "lineNumber": 61
          },
          {
            "lineNumber": 62
          },
          {
            "text": "  // ORIGINAL_CLOCK_IN_TIMEとORIGINAL_CLOCK_OUT_TIMEはデータベースから直接取得",
            "lineNumber": 63
          },
          {
            "text": "  // データベースに値が存在しない場合は、CLOCK_IN_TYPEがSTAMPの場合にCLOCK_IN_TIMEを使用",
            "lineNumber": 64
          },
          {
            "text": "  let originalClockInTime = attendance.ORIGINAL_CLOCK_IN_TIME;",
            "lineNumber": 65
          },
          {
            "lineNumber": 66
          },
          {
            "text": "  if (!originalClockInTime &amp;&amp; attendance.CLOCK_IN_TYPE === 'STAMP')",
            "lineNumber": 67
          },
          {
            "text": ";",
            "lineNumber": 86
          }
        ]
      },
      "score": 0.3592655658721924
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\attendance-table-screen.md",
        "range": {
          "startPosition": {
            "line": 400
          },
          "endPosition": {
            "line": 434
          }
        },
        "contents": "2. 打刻時刻との比較\n   - 入力された時刻が打刻時刻（ORIGINAL_CLOCK_IN_TIME）と異なる場合:\n     - 出勤打刻種別をMANUALに設定（CLOCK_IN_TYPE = 'MANUAL'）\n     - 背景色を黄色（#FFFF00）に変更\n     - 勤務状況アイコンを警告アイコン（黄色の丸の中に「!」マーク）に変更\n   - 入力された時刻が打刻時刻（ORIGINAL_CLOCK_IN_TIME）と同じ場合:\n     - 出勤打刻種別をSTAMPまたはSCHEDULEDに設定（元の打刻種別に戻す）\n     - 背景色を白色に変更\n     - 勤務状況アイコンをNIKKORIアイコンに戻す\n\n3. 勤怠データ更新\n   - 入力された時刻をCLOCK_IN_TIMEとして保存\n   - 【API利用仕様 No.5（勤怠記録更新API）】を呼び出す\n\n4. 画面再描画\n   - 更新後のデータで画面を再表示\n\n#### 名称：出勤欄押下処理（テキストのみ）、英名：clickClockInText、処理タイミング：勤務表テーブル.出勤時刻（テキストのみ表示）.押下\n\n**前提条件**: 申請中（APPROVAL_STATUS = PENDING）または承認済み（APPROVED）の場合にテキストのみ表示される\n\n1. 日次勤怠データ取得\n   - API利用仕様に従い、選択した日付の勤怠データを取得する。\n   - 【API利用仕様 No.3（日次勤怠記録取得API）】\n\n2. 勤怠情報入力ダイアログ表示（閲覧モード）\n   - 勤怠情報入力ダイアログを表示する。\n   - 選択した日付と勤怠IDを渡す。\n   - 各項目（出社、退社、休憩1、休憩2、公用外出1、公用外出2、勤務場所）は編集不可（閲覧のみ）\n   - 「閉じる」リンクのみ表示（「登録」ボタン、「キャンセル」リンク、「リセット」リンク、「日次確定する」チェックボックスは非表示）\n\n#### 名称：退勤時刻テキストボックス押下処理、英名：clickClockOutTextbox、処理タイミング：勤務表テーブル.退勤時刻テキストボックス.押下\n\n**前提条件**: 平日かつ未申請（APPROVAL_STATUS = NOT_SUBMITTED）または却下（REJECTED）の場合にテキストボックスが表示される。土日祝の場合、休日出勤申請が承認されている（APPLICATION_HISTORY.APPLICATION_TYPE='HOLIDAY_WORK'かつAPPROVAL_STATUS='APPROVED'または'PENDING'）場合はテキストボックスが表示される。それ以外の土日祝の場合はテキストボックスは表示されない。",
        "signatures": {},
        "detailedLines": [
          {
            "text": "2. 打刻時刻との比較",
            "lineNumber": 401
          },
          {
            "text": "   - 入力された時刻が打刻時刻（ORIGINAL_CLOCK_IN_TIME）と異なる場合:",
            "lineNumber": 402
          },
          {
            "text": "     - 出勤打刻種別をMANUALに設定（CLOCK_IN_TYPE = 'MANUAL'）",
            "lineNumber": 403
          },
          {
            "text": "     - 背景色を黄色（#FFFF00）に変更",
            "lineNumber": 404
          },
          {
            "text": "     - 勤務状況アイコンを警告アイコン（黄色の丸の中に「!」マーク）に変更",
            "lineNumber": 405
          },
          {
            "text": "   - 入力された時刻が打刻時刻（ORIGINAL_CLOCK_IN_TIME）と同じ場合:",
            "lineNumber": 406
          },
          {
            "text": "     - 出勤打刻種別をSTAMPまたはSCHEDULEDに設定（元の打刻種別に戻す）",
            "lineNumber": 407
          },
          {
            "text": "     - 背景色を白色に変更",
            "lineNumber": 408
          },
          {
            "text": "     - 勤務状況アイコンをNIKKORIアイコンに戻す",
            "lineNumber": 409
          },
          {
            "lineNumber": 410
          },
          {
            "text": "3. 勤怠データ更新",
            "lineNumber": 411
          },
          {
            "text": "   - 入力された時刻をCLOCK_IN_TIMEとして保存",
            "lineNumber": 412
          },
          {
            "text": "   - 【API利用仕様 No.5（勤怠記録更新API）】を呼び出す",
            "lineNumber": 413
          },
          {
            "lineNumber": 414
          },
          {
            "text": "4. 画面再描画",
            "lineNumber": 415
          },
          {
            "text": "   - 更新後のデータで画面を再表示",
            "lineNumber": 416
          },
          {
            "lineNumber": 417
          },
          {
            "text": "#### 名称：出勤欄押下処理（テキストのみ）、英名：clickClockInText、処理タイミング：勤務表テーブル.出勤時刻（テキストのみ表示）.押下",
            "lineNumber": 418
          },
          {
            "lineNumber": 419
          },
          {
            "text": "**前提条件**: 申請中（APPROVAL_STATUS = PENDING）または承認済み（APPROVED）の場合にテキストのみ表示される",
            "lineNumber": 420
          },
          {
            "lineNumber": 421
          },
          {
            "text": "1. 日次勤怠データ取得",
            "lineNumber": 422
          },
          {
            "text": "   - API利用仕様に従い、選択した日付の勤怠データを取得する。",
            "lineNumber": 423
          },
          {
            "text": "   - 【API利用仕様 No.3（日次勤怠記録取得API）】",
            "lineNumber": 424
          },
          {
            "lineNumber": 425
          },
          {
            "text": "2. 勤怠情報入力ダイアログ表示（閲覧モード）",
            "lineNumber": 426
          },
          {
            "text": "   - 勤怠情報入力ダイアログを表示する。",
            "lineNumber": 427
          },
          {
            "text": "   - 選択した日付と勤怠IDを渡す。",
            "lineNumber": 428
          },
          {
            "text": "   - 各項目（出社、退社、休憩1、休憩2、公用外出1、公用外出2、勤務場所）は編集不可（閲覧のみ）",
            "lineNumber": 429
          },
          {
            "text": "   - 「閉じる」リンクのみ表示（「登録」ボタン、「キャンセル」リンク、「リセット」リンク、「日次確定する」チェックボックスは非表示）",
            "lineNumber": 430
          },
          {
            "lineNumber": 431
          },
          {
            "text": "#### 名称：退勤時刻テキストボックス押下処理、英名：clickClockOutTextbox、処理タイミング：勤務表テーブル.退勤時刻テキストボックス.押下",
            "lineNumber": 432
          },
          {
            "lineNumber": 433
          },
          {
            "text": "**前提条件**: 平日かつ未申請（APPROVAL_STATUS = NOT_SUBMITTED）または却下（REJECTED）の場合にテキストボックスが表示される。土日祝の場合、休日出勤申請が承認されている（APPLICATION_HISTORY.APPLICATION_TYPE='HOLIDAY_WORK'かつAPPROVAL_STATUS='APPROVED'または'PENDING'）場合はテキストボックスが表示される。それ以外の土日祝の場合はテキストボックスは表示されない。",
            "lineNumber": 434
          }
        ]
      },
      "score": 0.35321131348609924
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\entities\\mysql_table_design.sql",
        "range": {
          "startPosition": {
            "line": 727
          },
          "endPosition": {
            "line": 753
          }
        },
        "contents": "-- 注意: カラムが既に存在する場合はエラーになります。その場合は、以下のUPDATE文のみを実行してください。\n-- ALTER TABLE ATTENDANCE_RECORD \n-- ADD COLUMN ORIGINAL_CLOCK_IN_TIME DATETIME COMMENT '出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER CLOCK_OUT_TYPE,\n-- ADD COLUMN ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER ORIGINAL_CLOCK_IN_TIME;\n-- ====================================================================\n\n-- 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）\n-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める\nUPDATE ATTENDANCE_RECORD \nSET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME \nWHERE ATTENDANCE_ID &gt; 0 \n  AND CLOCK_IN_TYPE = 'STAMP' \n  AND (ORIGINAL_CLOCK_IN_TIME IS NULL OR ORIGINAL_CLOCK_IN_TIME = '0000-00-00 00:00:00');\n\n-- 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）\n-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める\nUPDATE ATTENDANCE_RECORD \nSET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME \nWHERE ATTENDANCE_ID &gt; 0 \n  AND CLOCK_OUT_TYPE = 'STAMP' \n  AND (ORIGINAL_CLOCK_OUT_TIME IS NULL OR ORIGINAL_CLOCK_OUT_TIME = '0000-00-00 00:00:00');\n\n-- ====================================================================\n-- スクリプト終了\n-- ====================================================================",
        "signatures": {},
        "detailedLines": [
          {
            "text": "-- 注意: カラムが既に存在する場合はエラーになります。その場合は、以下のUPDATE文のみを実行してください。",
            "lineNumber": 728
          },
          {
            "text": "-- ALTER TABLE ATTENDANCE_RECORD ",
            "lineNumber": 729
          },
          {
            "text": "-- ADD COLUMN ORIGINAL_CLOCK_IN_TIME DATETIME COMMENT '出勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER CLOCK_OUT_TYPE,",
            "lineNumber": 730
          },
          {
            "text": "-- ADD COLUMN ORIGINAL_CLOCK_OUT_TIME DATETIME COMMENT '退勤打刻時刻: 打刻機による元の時刻。手入力で変更されても保持される。形式YYYY-MM-DD HH:MM:SS' AFTER ORIGINAL_CLOCK_IN_TIME;",
            "lineNumber": 731
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 732
          },
          {
            "lineNumber": 733
          },
          {
            "text": "-- 既存データの移行（CLOCK_IN_TYPEがSTAMPの場合はCLOCK_IN_TIMEをORIGINAL_CLOCK_IN_TIMEに設定）",
            "lineNumber": 734
          },
          {
            "text": "-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める",
            "lineNumber": 735
          },
          {
            "text": "UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 736
          },
          {
            "text": "SET ORIGINAL_CLOCK_IN_TIME = CLOCK_IN_TIME ",
            "lineNumber": 737
          },
          {
            "text": "WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 738
          },
          {
            "text": "  AND CLOCK_IN_TYPE = 'STAMP' ",
            "lineNumber": 739
          },
          {
            "text": "  AND (ORIGINAL_CLOCK_IN_TIME IS NULL OR ORIGINAL_CLOCK_IN_TIME = '0000-00-00 00:00:00');",
            "lineNumber": 740
          },
          {
            "lineNumber": 741
          },
          {
            "text": "-- 既存データの移行（CLOCK_OUT_TYPEがSTAMPの場合はCLOCK_OUT_TIMEをORIGINAL_CLOCK_OUT_TIMEに設定）",
            "lineNumber": 742
          },
          {
            "text": "-- MySQLのsafe update modeに対応するため、WHERE句に主キー（ATTENDANCE_ID）を含める",
            "lineNumber": 743
          },
          {
            "text": "UPDATE ATTENDANCE_RECORD ",
            "lineNumber": 744
          },
          {
            "text": "SET ORIGINAL_CLOCK_OUT_TIME = CLOCK_OUT_TIME ",
            "lineNumber": 745
          },
          {
            "text": "WHERE ATTENDANCE_ID &gt; 0 ",
            "lineNumber": 746
          },
          {
            "text": "  AND CLOCK_OUT_TYPE = 'STAMP' ",
            "lineNumber": 747
          },
          {
            "text": "  AND (ORIGINAL_CLOCK_OUT_TIME IS NULL OR ORIGINAL_CLOCK_OUT_TIME = '0000-00-00 00:00:00');",
            "lineNumber": 748
          },
          {
            "lineNumber": 749
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 750
          },
          {
            "text": "-- スクリプト終了",
            "lineNumber": 751
          },
          {
            "text": "-- ====================================================================",
            "lineNumber": 752
          }
        ]
      },
      "score": 0.3515177369117737
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\docs\\detailed-design\\ui\\home-screen.md",
        "range": {
          "startPosition": {
            "line": 471
          },
          "endPosition": {
            "line": 500
          }
        },
        "contents": "1. **勤務場所の選択**\n   - 勤務場所は日ごとに「通勤」「在宅」「直行、直帰、直行直帰」「出張」のいずれか1つを選択可能\n   - 業務開始時（出勤打刻時）と業務終了時（退勤打刻時）にそれぞれ勤務場所を選択する必要がある\n   - **重要**: 当日の勤務場所は、業務終了時（退勤打刻時）に選択されていた勤務場所が確定値として保存される\n   - 同日内で通勤と在宅が混在した場合は「通勤」として入力する\n     - 通勤で始業し在宅で終業する場合、在宅で始業し通勤で終業する場合、いずれも「通勤」として入力する\n   - 「在宅」を選択すると通勤手当は支給されない\n\n2. **定時出勤・定時退勤ボタン**\n   - 定時出勤ボタンは9:00より前のみ活性化される。押下すると9:00出勤として記録\n   - 定時退勤ボタンは17:30以降のみ活性化される。押下すると17:30退勤として記録\n\n3. **中断・再開機能**\n   - 勤務を中断する際は「退勤」ボタンから打刻する。打刻した時刻が休憩時間の開始時刻となる\n   - 勤務を再開する際は「出勤」ボタンから打刻する。打刻した時刻が休憩時間の終了時刻となる\n   - 退勤打刻から出勤打刻までの時間は休憩時間として自動的に記録される\n\n4. **勤務場所の変更**\n   - 勤務場所の変更で発生する中抜け時間は、退勤ボタン→出勤ボタンで打刻する\n   - 中抜け時間は休憩時間として自動記録される\n\n5. **打刻の区別**\n   - 出退勤の打刻と手入力は背景色で区別される\n   - 打刻：CLOCK_IN_TYPE = 'STAMP' または CLOCK_OUT_TYPE = 'STAMP'\n   - 手入力：CLOCK_IN_TYPE = 'MANUAL' または CLOCK_OUT_TYPE = 'MANUAL'\n   - 定時：CLOCK_IN_TYPE = 'SCHEDULED' または CLOCK_OUT_TYPE = 'SCHEDULED'\n\n6. **休日出勤申請の制約**\n   - 土日祝に打刻する場合は、事前に休日出勤申請を行い、申請中（PENDING）または承認済み（APPROVED）である必要がある",
        "signatures": {},
        "detailedLines": [
          {
            "text": "1. **勤務場所の選択**",
            "lineNumber": 472
          },
          {
            "text": "   - 勤務場所は日ごとに「通勤」「在宅」「直行、直帰、直行直帰」「出張」のいずれか1つを選択可能",
            "lineNumber": 473
          },
          {
            "text": "   - 業務開始時（出勤打刻時）と業務終了時（退勤打刻時）にそれぞれ勤務場所を選択する必要がある",
            "lineNumber": 474
          },
          {
            "text": "   - **重要**: 当日の勤務場所は、業務終了時（退勤打刻時）に選択されていた勤務場所が確定値として保存される",
            "lineNumber": 475
          },
          {
            "text": "   - 同日内で通勤と在宅が混在した場合は「通勤」として入力する",
            "lineNumber": 476
          },
          {
            "text": "     - 通勤で始業し在宅で終業する場合、在宅で始業し通勤で終業する場合、いずれも「通勤」として入力する",
            "lineNumber": 477
          },
          {
            "text": "   - 「在宅」を選択すると通勤手当は支給されない",
            "lineNumber": 478
          },
          {
            "lineNumber": 479
          },
          {
            "text": "2. **定時出勤・定時退勤ボタン**",
            "lineNumber": 480
          },
          {
            "text": "   - 定時出勤ボタンは9:00より前のみ活性化される。押下すると9:00出勤として記録",
            "lineNumber": 481
          },
          {
            "text": "   - 定時退勤ボタンは17:30以降のみ活性化される。押下すると17:30退勤として記録",
            "lineNumber": 482
          },
          {
            "lineNumber": 483
          },
          {
            "text": "3. **中断・再開機能**",
            "lineNumber": 484
          },
          {
            "text": "   - 勤務を中断する際は「退勤」ボタンから打刻する。打刻した時刻が休憩時間の開始時刻となる",
            "lineNumber": 485
          },
          {
            "text": "   - 勤務を再開する際は「出勤」ボタンから打刻する。打刻した時刻が休憩時間の終了時刻となる",
            "lineNumber": 486
          },
          {
            "text": "   - 退勤打刻から出勤打刻までの時間は休憩時間として自動的に記録される",
            "lineNumber": 487
          },
          {
            "lineNumber": 488
          },
          {
            "text": "4. **勤務場所の変更**",
            "lineNumber": 489
          },
          {
            "text": "   - 勤務場所の変更で発生する中抜け時間は、退勤ボタン→出勤ボタンで打刻する",
            "lineNumber": 490
          },
          {
            "text": "   - 中抜け時間は休憩時間として自動記録される",
            "lineNumber": 491
          },
          {
            "lineNumber": 492
          },
          {
            "text": "5. **打刻の区別**",
            "lineNumber": 493
          },
          {
            "text": "   - 出退勤の打刻と手入力は背景色で区別される",
            "lineNumber": 494
          },
          {
            "text": "   - 打刻：CLOCK_IN_TYPE = 'STAMP' または CLOCK_OUT_TYPE = 'STAMP'",
            "lineNumber": 495
          },
          {
            "text": "   - 手入力：CLOCK_IN_TYPE = 'MANUAL' または CLOCK_OUT_TYPE = 'MANUAL'",
            "lineNumber": 496
          },
          {
            "text": "   - 定時：CLOCK_IN_TYPE = 'SCHEDULED' または CLOCK_OUT_TYPE = 'SCHEDULED'",
            "lineNumber": 497
          },
          {
            "lineNumber": 498
          },
          {
            "text": "6. **休日出勤申請の制約**",
            "lineNumber": 499
          },
          {
            "text": "   - 土日祝に打刻する場合は、事前に休日出勤申請を行い、申請中（PENDING）または承認済み（APPROVED）である必要がある",
            "lineNumber": 500
          }
        ]
      },
      "score": 0.3478747606277466
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 27
          },
          "endPosition": {
            "line": 92,
            "column": 3
          }
        },
        "contents": "const getDailyAttendance = async \n\n\n  if (!originalClockInTime &amp;&amp; attendance.CLOCK_IN_TYPE === 'STAMP') {\n    originalClockInTime = attendance.CLOCK_IN_TIME;\n  }\n\n  let originalClockOutTime = attendance.ORIGINAL_CLOCK_OUT_TIME;\n\n  if (!originalClockOutTime &amp;&amp; attendance.CLOCK_OUT_TYPE === 'STAMP') {\n    originalClockOutTime = attendance.CLOCK_OUT_TIME;\n  }\n  \n  return {\n    ...attendance,\n    IS_CLOCK_IN_MANUAL: isClockInManual,\n    IS_CLOCK_OUT_MANUAL: isClockOutManual,\n    ORIGINAL_CLOCK_IN_TIME: originalClockInTime,\n    ORIGINAL_CLOCK_OUT_TIME: originalClockOutTime,\n    breakTimes: combinedBreakTimes,\n    officialOutings\n  };\n};\n\n/**\n * 勤怠記録を更新する。\n *\n * @param {Object} updateData 更新データ\n * @returns {Promise&lt;Object&gt;} 更新後の勤怠記録\n */",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 28,
                "column": 1
              },
              "endPosition": {
                "line": 28,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 28,
                "column": 7
              },
              "endPosition": {
                "line": 28,
                "column": 34
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const getDailyAttendance = async ",
            "lineNumber": 28
          },
          {
            "lineNumber": 65
          },
          {
            "lineNumber": 66
          },
          {
            "text": "  if (!originalClockInTime &amp;&amp; attendance.CLOCK_IN_TYPE === 'STAMP') {",
            "lineNumber": 67
          },
          {
            "text": "    originalClockInTime = attendance.CLOCK_IN_TIME;",
            "lineNumber": 68
          },
          {
            "text": "  }",
            "lineNumber": 69
          },
          {
            "lineNumber": 70
          },
          {
            "text": "  let originalClockOutTime = attendance.ORIGINAL_CLOCK_OUT_TIME;",
            "lineNumber": 71
          },
          {
            "lineNumber": 72
          },
          {
            "text": "  if (!originalClockOutTime &amp;&amp; attendance.CLOCK_OUT_TYPE === 'STAMP') {",
            "lineNumber": 73
          },
          {
            "text": "    originalClockOutTime = attendance.CLOCK_OUT_TIME;",
            "lineNumber": 74
          },
          {
            "text": "  }",
            "lineNumber": 75
          },
          {
            "text": "  ",
            "lineNumber": 76
          },
          {
            "text": "  return {",
            "lineNumber": 77
          },
          {
            "text": "    ...attendance,",
            "lineNumber": 78
          },
          {
            "text": "    IS_CLOCK_IN_MANUAL: isClockInManual,",
            "lineNumber": 79
          },
          {
            "text": "    IS_CLOCK_OUT_MANUAL: isClockOutManual,",
            "lineNumber": 80
          },
          {
            "text": "    ORIGINAL_CLOCK_IN_TIME: originalClockInTime,",
            "lineNumber": 81
          },
          {
            "text": "    ORIGINAL_CLOCK_OUT_TIME: originalClockOutTime,",
            "lineNumber": 82
          },
          {
            "text": "    breakTimes: combinedBreakTimes,",
            "lineNumber": 83
          },
          {
            "text": "    officialOutings",
            "lineNumber": 84
          },
          {
            "text": "  };",
            "lineNumber": 85
          },
          {
            "text": "};",
            "lineNumber": 86
          },
          {
            "lineNumber": 87
          },
          {
            "text": "/**",
            "lineNumber": 88
          },
          {
            "text": " * 勤怠記録を更新する。",
            "lineNumber": 89
          },
          {
            "text": " *",
            "lineNumber": 90
          },
          {
            "text": " * @param {Object} updateData 更新データ",
            "lineNumber": 91
          },
          {
            "text": " * @returns {Promise&lt;Object&gt;} 更新後の勤怠記録",
            "lineNumber": 92
          },
          {
            "text": " */",
            "lineNumber": 93
          }
        ]
      },
      "score": 0.33499929308891296
    },
    {
      "codeBlock": {
        "relativeWorkspacePath": ".\\backend\\services\\attendanceService.js",
        "range": {
          "startPosition": {
            "line": 93
          },
          "endPosition": {
            "line": 333,
            "column": 1
          }
        },
        "contents": "const updateAttendanceRecord = async \n\n\n    if (existingAttendance) {\n      // 既存レコードがある場合\n      // ORIGINAL_CLOCK_IN_TIMEが既に存在する場合は保持\n      if (existingAttendance.ORIGINAL_CLOCK_IN_TIME) {\n        originalClockInDateTime = existingAttendance.ORIGINAL_CLOCK_IN_TIME;\n      } else if (finalClockInType === 'STAMP' &amp;&amp; clockInDateTime) {\n        // ORIGINAL_CLOCK_IN_TIMEが存在せず、打刻の場合はCLOCK_IN_TIMEを設定\n        originalClockInDateTime = clockInDateTime;\n      }\n      \n      // ORIGINAL_CLOCK_OUT_TIMEが既に存在する場合は保持\n      if (existingAttendance.ORIGINAL_CLOCK_OUT_TIME) {\n        originalClockOutDateTime = existingAttendance.ORIGINAL_CLOCK_OUT_TIME;\n      } else if (finalClockOutType === 'STAMP' &amp;&amp; clockOutDateTime) {\n        // ORIGINAL_CLOCK_OUT_TIMEが存在せず、打刻の場合はCLOCK_OUT_TIMEを設定\n        originalClockOutDateTime = clockOutDateTime;\n      }\n    } else {\n      // 新規レコードの場合\n      if (finalClockInType === 'STAMP' &amp;&amp; clockInDateTime) {\n        originalClockInDateTime = clockInDateTime;\n      }\n\n      if (finalClockOutType === 'STAMP' &amp;&amp; clockOutDateTime) {\n        originalClockOutDateTime = clockOutDateTime;\n      }\n    }\n    \n    let currentAttendanceId = attendanceId;\n\n    if (!currentAttendanceId &amp;&amp; existingAttendance) {\n      currentAttendanceId = existingAttendance.ATTENDANCE_ID;\n    }\n    \n    if (currentAttendanceId) {\n      // 既存レコードを更新（部分更新対応：指定されていないフィールドは既存値を保持）\n;",
        "signatures": {
          "ranges": [
            {
              "startPosition": {
                "line": 94,
                "column": 1
              },
              "endPosition": {
                "line": 94,
                "column": 7
              }
            },
            {
              "startPosition": {
                "line": 94,
                "column": 7
              },
              "endPosition": {
                "line": 94,
                "column": 38
              }
            }
          ]
        },
        "detailedLines": [
          {
            "text": "const updateAttendanceRecord = async ",
            "lineNumber": 94
          },
          {
            "lineNumber": 173
          },
          {
            "lineNumber": 174
          },
          {
            "text": "    if (existingAttendance) {",
            "lineNumber": 175
          },
          {
            "text": "      // 既存レコードがある場合",
            "lineNumber": 176
          },
          {
            "text": "      // ORIGINAL_CLOCK_IN_TIMEが既に存在する場合は保持",
            "lineNumber": 177
          },
          {
            "text": "      if (existingAttendance.ORIGINAL_CLOCK_IN_TIME) {",
            "lineNumber": 178
          },
          {
            "text": "        originalClockInDateTime = existingAttendance.ORIGINAL_CLOCK_IN_TIME;",
            "lineNumber": 179
          },
          {
            "text": "      } else if (finalClockInType === 'STAMP' &amp;&amp; clockInDateTime) {",
            "lineNumber": 180
          },
          {
            "text": "        // ORIGINAL_CLOCK_IN_TIMEが存在せず、打刻の場合はCLOCK_IN_TIMEを設定",
            "lineNumber": 181
          },
          {
            "text": "        originalClockInDateTime = clockInDateTime;",
            "lineNumber": 182
          },
          {
            "text": "      }",
            "lineNumber": 183
          },
          {
            "text": "      ",
            "lineNumber": 184
          },
          {
            "text": "      // ORIGINAL_CLOCK_OUT_TIMEが既に存在する場合は保持",
            "lineNumber": 185
          },
          {
            "text": "      if (existingAttendance.ORIGINAL_CLOCK_OUT_TIME) {",
            "lineNumber": 186
          },
          {
            "text": "        originalClockOutDateTime = existingAttendance.ORIGINAL_CLOCK_OUT_TIME;",
            "lineNumber": 187
          },
          {
            "text": "      } else if (finalClockOutType === 'STAMP' &amp;&amp; clockOutDateTime) {",
            "lineNumber": 188
          },
          {
            "text": "        // ORIGINAL_CLOCK_OUT_TIMEが存在せず、打刻の場合はCLOCK_OUT_TIMEを設定",
            "lineNumber": 189
          },
          {
            "text": "        originalClockOutDateTime = clockOutDateTime;",
            "lineNumber": 190
          },
          {
            "text": "      }",
            "lineNumber": 191
          },
          {
            "text": "    } else {",
            "lineNumber": 192
          },
          {
            "text": "      // 新規レコードの場合",
            "lineNumber": 193
          },
          {
            "text": "      if (finalClockInType === 'STAMP' &amp;&amp; clockInDateTime) {",
            "lineNumber": 194
          },
          {
            "text": "        originalClockInDateTime = clockInDateTime;",
            "lineNumber": 195
          },
          {
            "text": "      }",
            "lineNumber": 196
          },
          {
            "lineNumber": 197
          },
          {
            "text": "      if (finalClockOutType === 'STAMP' &amp;&amp; clockOutDateTime) {",
            "lineNumber": 198
          },
          {
            "text": "        originalClockOutDateTime = clockOutDateTime;",
            "lineNumber": 199
          },
          {
            "text": "      }",
            "lineNumber": 200
          },
          {
            "text": "    }",
            "lineNumber": 201
          },
          {
            "text": "    ",
            "lineNumber": 202
          },
          {
            "text": "    let currentAttendanceId = attendanceId;",
            "lineNumber": 203
          },
          {
            "lineNumber": 204
          },
          {
            "text": "    if (!currentAttendanceId &amp;&amp; existingAttendance) {",
            "lineNumber": 205
          },
          {
            "text": "      currentAttendanceId = existingAttendance.ATTENDANCE_ID;",
            "lineNumber": 206
          },
          {
            "text": "    }",
            "lineNumber": 207
          },
          {
            "text": "    ",
            "lineNumber": 208
          },
          {
            "text": "    if (currentAttendanceId) {",
            "lineNumber": 209
          },
          {
            "text": "      // 既存レコードを更新（部分更新対応：指定されていないフィールドは既存値を保持）",
            "lineNumber": 210
          },
          {
            "text": ";",
            "lineNumber": 334
          }
        ]
      },
      "score": 0.33240795135498047
    }
  ]
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: frontend/src/views/MonthlySummaryScreen.vue</summary>

</details>
</tool-use>

---



---


打刻なしの判定ロジックを修正します。手入力で入力された場合（打刻種別がMANUALで元の打刻時刻がない）に表示されるようにします。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "f1360970-f1fc-47ea-babc-3e39e1942c92"
}
```
Status: **completed**


</details>
</tool-use>

---



---


修正を反映しました。打刻なしの表示ロジックを更新しました。

## 修正内容

**`frontend/src/views/MonthlySummaryScreen.vue`の`getRemarkText`メソッド**

### 変更前
```javascript
const hasClockInMissing = (day.clockInType === 'MANUAL' && !day.originalClockInTime) || 
                         (day.clockInType === 'MANUAL' && !day.clockInTime && day.clockOutTime)
const hasClockOutMissing = (day.clockOutType === 'MANUAL' && !day.originalClockOutTime) || 
                          (day.clockOutType === 'MANUAL' && !day.clockOutTime && day.clockInTime)
```

### 変更後
```javascript
// 打刻漏れの判定（打刻のし忘れなどで手入力で入力した場合）
// 打刻種別がMANUALで、かつ元の打刻時刻（ORIGINAL_CLOCK_IN_TIME/ORIGINAL_CLOCK_OUT_TIME）がない場合
// これは打刻のし忘れなどで手入力で入力したことを示す
const hasClockInMissing = day.clockInType === 'MANUAL' && !day.originalClockInTime && day.clockInTime
const hasClockOutMissing = day.clockOutType === 'MANUAL' && !day.originalClockOutTime && day.clockOutTime
```

## 修正のポイント

1. 打刻種別が`MANUAL`（手入力）
2. 元の打刻時刻（`ORIGINAL_CLOCK_IN_TIME`/`ORIGINAL_CLOCK_OUT_TIME`）がない
3. 手入力で時刻が入力されている（`CLOCK_IN_TIME`/`CLOCK_OUT_TIME`が存在）

この条件を満たす場合に「(出社打刻なし)」や「(退社打刻なし)」が紫色（#7955D5）で表示されます。

これで、打刻のし忘れで手入力した場合に正しく表示されます。

---

_**User**_

ではその内容で設計書を修正してください。

---

_**Agent (model composer-1, mode Agent)**_



---


設計書の該当箇所を確認し、修正内容を反映します。


---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---



---


設計書の該当箇所を修正します。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "9da9f8bf-27db-4300-8bf7-5fc28e80904a"
}
```
Status: **completed**


</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file_v2">
<details><summary>Tool use: **read_file_v2** • Read file: docs/detailed-design/ui/monthly-summary-screen.md</summary>

</details>
</tool-use>

---



---


変更履歴に今回の修正を追加します。


---

<tool-use data-tool-type="unknown" data-tool-name="edit_file_v2">
<details>
<summary>Tool use: **edit_file_v2**</summary>

Additional data:

```json
{
  "codeblockId": "0139b600-28dc-4156-ad08-baf04fc81e77"
}
```
Status: **completed**


</details>
</tool-use>

---



---


設計書の修正を完了しました。

## 修正内容

### 1. 備考欄の表示形式について（532-538行目）

**変更前:**
- 判定条件: 打刻種別がMANUALで、かつ元の打刻時刻（ORIGINAL_CLOCK_IN_TIME/ORIGINAL_CLOCK_OUT_TIME）がない場合

**変更後:**
- 判定条件: 打刻種別がMANUALで、かつ元の打刻時刻（ORIGINAL_CLOCK_IN_TIME/ORIGINAL_CLOCK_OUT_TIME）がなく、かつ手入力で時刻（CLOCK_IN_TIME/CLOCK_OUT_TIME）が入力されている場合

### 2. 説明文の改善

- 「打刻漏れの情報（勤務表画面の背景色が黄色の場合）」→「打刻漏れの情報（打刻のし忘れなどで手入力で入力した場合）」に変更

### 3. 変更履歴の追加

- 2025-12-15の変更履歴に今回の修正を追加

設計書は実装と一致しています。打刻のし忘れで手入力した場合に「(出社打刻なし)」「(退社打刻なし)」「(出退打刻なし)」が表示される仕様を反映しました。

---

_**User**_

勤務表画面の備考の黄色の背景色のところも同様です。設計書と実装を修正してください。

---

