<!-- Generated by SpecStory, Markdown v2.1.0 -->

<!-- cursor Session c02bb659-d774-4577-a5f0-72d4ffbe1a91 (2025-12-11 07:35Z) -->

# 勤務表ダイアログのソースと表示タイミング修正 (2025-12-11 07:35Z)

_**User (2025-12-11 01:02Z)**_

このメッセージはおかしいですよね？そもそもlocalhostからではなくて、ダイアログ画面にしてほしいのと、よく
@docs/detailed-design/ui/attendance-table-screen.md を読んでください。
工数実績がまだ入力されていないのに、始めにメッセージはおかしいです。

---

_**Agent (model composer-1, mode Agent)**_



---


指摘の通りです。問題点:
1. ダイアログタイトルが「localhost:5173 の内容」になっている
2. 工数未入力なのに確認ダイアログが表示されている（エラーチェックが先に必要）

ドキュメントに従い、日次確定申請時は先にチェックを行い、エラーがあればエラーダイアログを表示する必要があります。実装を確認して修正します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/HomeScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">
<details>
                <summary>Tool use: **codebase_search** • Searched codebase "日次確定申請 確認ダイアログ 工数チェック" • **15** results</summary>
            
| File | Lines |
|------|-------|
| `frontend/src/views/TimesheetScreen.vue` | L1423-1482 |
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L775-819 |
| `frontend/src/views/TimesheetScreen.vue` | L519-565 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L802-849 |
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L511-561 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L538-606 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L698-743 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L91-134 |
| `frontend/src/components/dialog/WorkHoursInputDialog.vue` | L43 |
| `frontend/src/components/dialog/WorkHoursInputDialog.vue` | L462-537 |
| `frontend/src/views/TimesheetScreen.vue` | L212-236 |
| `frontend/src/views/TimesheetScreen.vue` | L729-776 |
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L671-701 |
| `frontend/src/components/dialog/WorkHoursInputDialog.vue` | L251-301 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L473-546 |

</details>
</tool-use>

---



---


`confirmDaily`でブラウザの`confirm()`を使用しており、タイトルが「localhost:5173 の内容」になっています。また、事前チェックが行われていません。ドキュメントに従い、事前チェックを追加し、エラー時はエラーダイアログ、通過時のみ確認ダイアログを表示するように修正します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/components/dialog/AttendanceApplicationDialog.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "日次確定|dailyConfirmation|confirmDaily" in "frontend/src" • 54 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `frontend/src\views\TimesheetScreen.vue` | `<!-- 日次確定ボタン（+アイコン） -->` | L222 |
| `frontend/src\views\TimesheetScreen.vue` | `<button v-if="day.approvalStatus === 'NOT_SUBMITTED' && !(day.isHoliday \|\| day.dayOfWeekNum === 0 \|\| day.dayOfWeekNum === 6)" class="daily-confirm-button" @click="confirmDaily(day)">` | L223 |
| `frontend/src\views\TimesheetScreen.vue` | `:initial-application-type="'dailyConfirmation'"` | L528 |
| `frontend/src\views\TimesheetScreen.vue` | `// 日次確定ボタン押下（日付欄の+アイコン用 - 将来使用）` | L1445 |
| `frontend/src\views\TimesheetScreen.vue` | `async confirmDaily(day) \{` | L1446 |
| `frontend/src\views\TimesheetScreen.vue` | `alert('日次確定申請が完了しました')` | L1456 |
| `frontend/src\views\TimesheetScreen.vue` | `console.error('日次確定エラー:', error)` | L1463 |
| `frontend/src\views\TimesheetScreen.vue` | `alert(error.message \|\| '日次確定申請に失敗しました')` | L1469 |
| `frontend/src\components\dialog\AttendanceInputDialog.vue` | `<!-- 日次確定チェックボックス（編集可能時） -->` | L134 |
| `frontend/src\components\dialog\AttendanceInputDialog.vue` | `日次確定する` | L141 |
| `frontend/src\components\dialog\AttendanceInputDialog.vue` | `// 日次確定エリアの位置` | L305 |
| `frontend/src\components\dialog\AttendanceInputDialog.vue` | `// 工数実績取得（日次確定チェック用）` | L528 |
| `frontend/src\components\dialog\AttendanceInputDialog.vue` | `// 日次確定チェック（チェックボックスがONの場合）` | L636 |
| `frontend/src\components\dialog\AttendanceInputDialog.vue` | `// 日次確定処理` | L674 |
| `frontend/src\components\dialog\AttendanceInputDialog.vue` | `throw new Error(confirmResponse.message \|\| '日次確定申請に失敗しました')` | L678 |
| `frontend/src\components\dialog\AttendanceInputDialog.vue` | `// 日次確定の事前チェック` | L776 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `@click="openApplicationTab('dailyConfirmation')"` | L34 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<!-- 日次確定申請フォーム -->` | L82 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<div v-if="currentTab === 'dailyConfirmation'" class="content-area">` | L83 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<span class="tab-title">\{{ getTabName('dailyConfirmation') \}}</span>` | L90 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<div class="daily-confirmation-value">\{{ dailyConfirmationForm.clockInOut \}}</div>` | L100 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<div class="daily-confirmation-value">\{{ dailyConfirmationForm.breakTime \}}</div>` | L105 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<div class="daily-confirmation-value">\{{ dailyConfirmationForm.totalWorkHours \}}</div>` | L110 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<div class="daily-confirmation-value">\{{ dailyConfirmationForm.actualWorkHours \}}</div>` | L115 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `v-model="dailyConfirmationForm.remark"` | L121 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<div v-if="dailyConfirmationError" class="form-row">` | L129 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `<div class="daily-confirmation-error-message">\{{ dailyConfirmationError \}}</div>` | L130 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `// 日次確定申請フォーム` | L494 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `dailyConfirmationForm: \{` | L495 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `// 日次確定申請のエラーメッセージ` | L502 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `dailyConfirmationError: '',` | L503 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `// 日次確定ボタンが非活性かどうか` | L580 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `// 日次確定申請フォームの初期化` | L636 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationForm = \{` | L637 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationError = ''` | L645 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationForm.clockInOut = `$\{clockIn\}-$\{clockOut\}`` | L716 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationForm.breakTime = attendance.breakTimes` | L720 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationForm.breakTime = '---:---'` | L724 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationForm.totalWorkHours = this.formatHoursMinutes(totalMinutes)` | L732 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationForm.totalWorkHours = '0:00'` | L734 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationForm.actualWorkHours = this.formatHoursMinutes(Math.floor((attendance.ACTUAL_WORK_HOURS \|\| 0) * 60))` | L738 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationForm.remark = attendance.REMARK_TEXT \|\| ''` | L741 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `// 日次確定タブを開いた場合は勤怠データを取得` | L768 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `if (applicationType === 'dailyConfirmation') \{` | L769 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `dailyConfirmation: '日次確定',` | L790 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationError = ''` | L809 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `if (this.dailyConfirmationForm.remark) \{` | L812 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `alert('日次確定申請が完了しました')` | L832 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationError = data.message \|\| '日次確定申請に失敗しました'` | L837 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `console.error('日次確定申請エラー:', error)` | L840 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `this.dailyConfirmationError = '日次確定申請中にエラーが発生しました'` | L842 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `remarkText: this.dailyConfirmationForm.remark` | L858 |
| `frontend/src\components\dialog\AttendanceApplicationDialog.vue` | `/* 日次確定フォーム専用スタイル */` | L1451 |
| `frontend/src\services\api.js` | `* 日次確定申請API` | L80 |


</details>
</tool-use>

---



---


日次確定申請の処理を修正中。事前チェックを追加し、エラー時はエラーダイアログ、通過時のみ確認ダイアログを表示するように変更します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/services/api.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="codebase_search">
<details>
                <summary>Tool use: **codebase_search** • Searched codebase "エラーダイアログ 確認ダイアログ コンポーネント" • **15** results</summary>
            
| File | Lines |
|------|-------|
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L1340-1467 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L430-481 |
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L147-203 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L1648-1709 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L802-849 |
| `frontend/src/components/dialog/WorkHoursInputDialog.vue` | L43 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L91-134 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L27 |
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L671-701 |
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L101-152 |
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L299-354 |
| `frontend/src/components/dialog/WorkHoursInputDialog.vue` | L131-226 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L473-546 |
| `frontend/src/components/dialog/AttendanceInputDialog.vue` | L893-969 |
| `frontend/src/components/dialog/AttendanceApplicationDialog.vue` | L1066-1140 |

</details>
</tool-use>

---



---


`confirmDaily`を修正し、事前チェックを追加。エラー時はエラーダイアログ、通過時のみ確認ダイアログを表示するように変更します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "getDailyAttendance|getWorkHours" in "frontend/src/views/TimesheetScreen.vue" • 0 matches</summary>

Output mode: content


_No matches found_

</details>
</tool-use>

---



---


`confirmDaily`を修正し、事前チェックを追加。エラー時はエラーダイアログ、通過時のみ確認ダイアログを表示するように変更します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/services/api.js</summary>

</details>
</tool-use>

---



---


`confirmDaily`を修正し、事前チェックを追加。エラーダイアログと確認ダイアログを追加します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/services/api.js</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: frontend/src/views/TimesheetScreen.vue</summary>

**Chunk 1**
Lines added: 31, lines removed: undefined

```diff
@@ -596,4 +596,35 @@
      &lt;/div&gt;
    &lt;/div&gt;
+   
+   &lt;!-- 確認ダイアログ（日次確定申請用） --&gt;
+   &lt;div v-if="showConfirmDialog" class="confirm-dialog-overlay" @click.self="closeConfirmDialog"&gt;
+     &lt;div class="confirm-dialog-container"&gt;
+       &lt;div class="confirm-dialog-header"&gt;
+         &lt;span class="confirm-dialog-title"&gt;確認&lt;/span&gt;
+       &lt;/div&gt;
+       &lt;div class="confirm-dialog-body"&gt;
+         &lt;p class="confirm-dialog-message"&gt;{{ confirmDialogMessage }}&lt;/p&gt;
+       &lt;/div&gt;
+       &lt;div class="confirm-dialog-footer"&gt;
+         &lt;button class="confirm-dialog-ok-button" @click="handleConfirmDialogOk"&gt;OK&lt;/button&gt;
+         &lt;button class="confirm-dialog-cancel-button" @click="closeConfirmDialog"&gt;キャンセル&lt;/button&gt;
+       &lt;/div&gt;
+     &lt;/div&gt;
+   &lt;/div&gt;
+   
+   &lt;!-- エラーダイアログ（日次確定申請チェック用） --&gt;
+   &lt;div v-if="showErrorCheckDialog" class="error-check-dialog-overlay" @click.self="closeErrorCheckDialog"&gt;
+     &lt;div class="error-check-dialog-container"&gt;
+       &lt;div class="error-check-dialog-header"&gt;
+         &lt;span class="error-check-dialog-title"&gt;確認&lt;/span&gt;
+       &lt;/div&gt;
+       &lt;div class="error-check-dialog-body"&gt;
+         &lt;p class="error-check-dialog-message"&gt;{{ errorCheckDialogMessage }}&lt;/p&gt;
+       &lt;/div&gt;
+       &lt;div class="error-check-dialog-footer"&gt;
+         &lt;button class="error-check-dialog-ok-button" @click="closeErrorCheckDialog"&gt;OK&lt;/button&gt;
+       &lt;/div&gt;
+     &lt;/div&gt;
+   &lt;/div&gt;
    
    &lt;!-- 備考ダイアログ（モーダル） --&gt;
```

</details>

</tool-use>

---



---


`confirmDaily`を修正し、事前チェックを追加。エラーダイアログと確認ダイアログを表示するように変更します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "import.*from.*api|getDailyAttendance|getWorkHours|submitDailyConfirmation" in "frontend/src/views/TimesheetScreen.vue" • 2 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `frontend/src/views/TimesheetScreen.vue` | `import \{ getMonthlyAttendance, getEmployeeInfo, submitDailyConfirmation, updateAttendanceRecord \} from '@/services/api'` | L764 |
| `frontend/src/views/TimesheetScreen.vue` | `const response = await submitDailyConfirmation(this.employeeId, day.date)` | L1484 |


</details>
</tool-use>

---



---


`confirmDaily`を修正し、事前チェックを追加。必要なインポートも追加します。


---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: frontend/src/views/TimesheetScreen.vue</summary>

**Chunk 1**
Lines added: 1, lines removed: 1

```diff
@@ -762,5 +762,5 @@
  import WorkHoursInputDialog from '@/components/dialog/WorkHoursInputDialog.vue'
  import HolidayJp from '@holiday-jp/holiday_jp'
- import { getMonthlyAttendance, getEmployeeInfo, submitDailyConfirmation, updateAttendanceRecord } from '@/services/api'
+ import { getMonthlyAttendance, getEmployeeInfo, submitDailyConfirmation, updateAttendanceRecord, getDailyAttendance, getWorkHours } from '@/services/api'
  
  export default {
```

</details>

</tool-use>

---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---



---


dataに確認ダイアログとエラーチェックダイアログの状態を追加し、`confirmDaily`を修正します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: frontend/src/views/TimesheetScreen.vue</summary>

**Chunk 1**
Lines added: 7, lines removed: undefined

```diff
@@ -798,4 +798,11 @@
        inputDialogFocus: 'clockIn',
        // 工数実績入力ダイアログ関連
+       // 確認ダイアログ関連（日次確定申請用）
+       showConfirmDialog: false,
+       confirmDialogMessage: '',
+       pendingDailyConfirmation: null, // 確認ダイアログでOKが押された場合の処理用
+       // エラーチェックダイアログ関連（日次確定申請チェック用）
+       showErrorCheckDialog: false,
+       errorCheckDialogMessage: '',
        showWorkHoursDialog: false,
        selectedDayForWorkHours: null,
```

</details>

</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: frontend/src/views/TimesheetScreen.vue</summary>

**Chunk 1**
Lines added: 101, lines removed: 4

```diff
@@ -1481,16 +1481,113 @@
        },
        
-       // 日次確定ボタン押下（日付欄の+アイコン用 - 将来使用）
+       // 日次確定ボタン押下（日付欄の+アイコン用）
        async confirmDaily(day) {
-         if (!confirm(&#96;${day.dateNumber}${day.dateDayOfWeek}の勤務を確定申請しますか？&#96;)) {
+         // 1. 日次確定チェック
+         const checkResult = await this.checkDailyConfirmation(day)
+         
+         if (!checkResult.isValid) {
+           // エラーがある場合はエラーダイアログを表示
+           this.errorCheckDialogMessage = checkResult.errorMessage
+           this.showErrorCheckDialog = true
            return
          }
-   
+         
+         // 2. チェックが正常に通過した場合のみ確認ダイアログを表示
+         this.confirmDialogMessage = &#96;${day.dateNumber}${day.dateDayOfWeek}の勤務を確定申請しますか?&#96;
+         this.pendingDailyConfirmation = day
+         this.showConfirmDialog = true
+       },
+       
+       // 日次確定の事前チェック
+       async checkDailyConfirmation(day) {
+         try {
+           // 日次勤務データ取得
+           const attendanceResponse = await getDailyAttendance(this.employeeId, day.date)
+           
+           if (!attendanceResponse.success || !attendanceResponse.attendance) {
+             return {
+               isValid: false,
+               errorMessage: '勤怠データの取得に失敗しました。'
+             }
+           }
+           
+           const attendance = attendanceResponse.attendance
+           
+           // 1. 出退社時刻チェック
+           if (!attendance.CLOCK_IN_TIME || !attendance.CLOCK_OUT_TIME) {
+             return {
+               isValid: false,
+               errorMessage: '出退社時刻が未入力のため、日次確定できません。'
+             }
+           }
+           
+           // 2. 勤務場所チェック
+           if (!attendance.WORK_LOCATION_CODE) {
+             return {
+               isValid: false,
+               errorMessage: '勤務場所を選択してください'
+             }
+           }
+           
+           // 3. 工数実績取得
+           const workHoursResponse = await getWorkHours(this.employeeId, day.date)
+           let workHoursTotal = 0
+           
+           if (workHoursResponse.success &amp;&amp; workHoursResponse.workHours) {
+             workHoursTotal = workHoursResponse.workHours.reduce(
+               (sum, wh) =&gt; sum + (parseFloat(wh.WORK_HOURS_VALUE) || 0),
+               0
+             )
+           }
+           
+           // 4. 工数合計と実労働時間の一致チェック
+           const actualWorkHours = parseFloat(attendance.ACTUAL_WORK_HOURS) || 0
+           if (actualWorkHours &gt; 0 &amp;&amp; Math.abs(actualWorkHours - workHoursTotal) &gt; 0.01) {
+             return {
+               isValid: false,
+               errorMessage: '工数の合計と実労働時間が合いません'
+             }
+           }
+           
+           // 5. 手入力の場合は備考チェック
+           if ((attendance.CLOCK_IN_TYPE === 'MANUAL' || attendance.CLOCK_OUT_TYPE === 'MANUAL') &amp;&amp; !attendance.REMARK_TEXT) {
+             return {
+               isValid: false,
+               errorMessage: '手入力の場合は備考に理由を入力してください'
+             }
+           }
+           
+           return { isValid: true }
+         } catch (error) {
+           console.error('日次確定チェックエラー:', error)
+           // 認証エラー（401）の場合は認証エラーダイアログを表示
+           if (error.status === 401 || error.message?.includes('認証') || error.message?.includes('ログイン')) {
+             this.showAuthErrorDialogFunc()
+             return { isValid: false, errorMessage: '' }
+           }
+           return {
+             isValid: false,
+             errorMessage: 'チェック処理中にエラーが発生しました。'
+           }
+         }
+       },
+       
+       // 確認ダイアログのOKボタン押下処理
+       async handleConfirmDialogOk() {
+         if (!this.pendingDailyConfirmation) {
+           this.closeConfirmDialog()
+           return
+         }
+         
+         const day = this.pendingDailyConfirmation
+         this.closeConfirmDialog()
+         
+         // ローディング表示開始
          this.loading = true
+         
          try {
            const response = await submitDailyConfirmation(this.employeeId, day.date)
            
            if (response.success) {
-             alert('日次確定申請が完了しました')
              // データを再読み込み
              await this.loadAttendanceData()
```

**Chunk 2**
Lines added: 16, lines removed: 1

```diff
@@ -1505,9 +1602,24 @@
              return
            }
-           alert(error.message || '日次確定申請に失敗しました')
+           // エラーダイアログを表示
+           this.errorCheckDialogMessage = error.message || '日次確定申請に失敗しました'
+           this.showErrorCheckDialog = true
          } finally {
            this.loading = false
          }
        },
+       
+       // 確認ダイアログを閉じる
+       closeConfirmDialog() {
+         this.showConfirmDialog = false
+         this.confirmDialogMessage = ''
+         this.pendingDailyConfirmation = null
+       },
+       
+       // エラーチェックダイアログを閉じる
+       closeErrorCheckDialog() {
+         this.showErrorCheckDialog = false
+         this.errorCheckDialogMessage = ''
+       },
      
      // 工数実績入力画面を開く
```

</details>

</tool-use>

---



---


確認ダイアログとエラーチェックダイアログのCSSスタイルを追加します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="search" data-tool-name="grep">
<details>
<summary>Tool use: **grep** • Grep for "\.auth-error-dialog|\.loading-overlay" in "frontend/src/views/TimesheetScreen.vue" • 11 matches</summary>

Output mode: content


| File | Content | Line |
|------|------|------|
| `frontend/src/views/TimesheetScreen.vue` | `.loading-overlay \{` | L2204 |
| `frontend/src/views/TimesheetScreen.vue` | `.loading-overlay p \{` | L2232 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-overlay \{` | L3133 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-container \{` | L3146 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-border \{` | L3153 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-header-bg \{` | L3162 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-title \{` | L3171 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-message \{` | L3188 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-ok-bg \{` | L3204 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-ok-bg:hover \{` | L3217 |
| `frontend/src/views/TimesheetScreen.vue` | `.auth-error-dialog-ok-text \{` | L3221 |


</details>
</tool-use>

---



---


確認ダイアログとエラーチェックダイアログのCSSスタイルを追加します。


---

<tool-use data-tool-type="read" data-tool-name="read_file">
<details><summary>Tool use: **read_file** • Read file: frontend/src/views/TimesheetScreen.vue</summary>

</details>
</tool-use>

---

<tool-use data-tool-type="write" data-tool-name="search_replace">

<details><summary>Tool use: **search_replace** • Edit file: frontend/src/views/TimesheetScreen.vue</summary>

**Chunk 1**
Lines added: 154, lines removed: undefined

```diff
@@ -3218,4 +3218,158 @@
    background-color: rgb(20, 160, 220);
  }
+ 
+ /* 確認ダイアログ（日次確定申請用） */
+ .confirm-dialog-overlay {
+   position: fixed;
+   top: 0;
+   left: 0;
+   width: 100%;
+   height: 100%;
+   background-color: rgba(0, 0, 0, 0.5);
+   display: flex;
+   justify-content: center;
+   align-items: center;
+   z-index: 10000;
+ }
+ 
+ .confirm-dialog-container {
+   background-color: white;
+   border-radius: 8px;
+   box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
+   min-width: 400px;
+   max-width: 500px;
+   overflow: hidden;
+ }
+ 
+ .confirm-dialog-header {
+   background-color: #D7EBFF;
+   padding: 15px 20px;
+   border-radius: 8px 8px 0 0;
+ }
+ 
+ .confirm-dialog-title {
+   font-size: 18px;
+   font-weight: bold;
+   color: #333;
+ }
+ 
+ .confirm-dialog-body {
+   padding: 30px 20px;
+ }
+ 
+ .confirm-dialog-message {
+   font-size: 14px;
+   color: #333;
+   text-align: center;
+   line-height: 1.6;
+   margin: 0;
+ }
+ 
+ .confirm-dialog-footer {
+   padding: 12px 20px 20px;
+   display: flex;
+   justify-content: center;
+   gap: 12px;
+ }
+ 
+ .confirm-dialog-ok-button {
+   padding: 10px 24px;
+   background-color: rgb(37, 100, 153);
+   color: white;
+   border: none;
+   border-radius: 4px;
+   font-size: 14px;
+   font-weight: bold;
+   cursor: pointer;
+   min-width: 80px;
+ }
+ 
+ .confirm-dialog-ok-button:hover {
+   background-color: rgb(25, 80, 133);
+ }
+ 
+ .confirm-dialog-cancel-button {
+   padding: 10px 24px;
+   background-color: rgb(100, 100, 100);
+   color: white;
+   border: none;
+   border-radius: 4px;
+   font-size: 14px;
+   font-weight: bold;
+   cursor: pointer;
+   min-width: 80px;
+ }
+ 
+ .confirm-dialog-cancel-button:hover {
+   background-color: rgb(80, 80, 80);
+ }
+ 
+ /* エラーチェックダイアログ（日次確定申請チェック用） */
+ .error-check-dialog-overlay {
+   position: fixed;
+   top: 0;
+   left: 0;
+   width: 100%;
+   height: 100%;
+   background-color: rgba(0, 0, 0, 0.5);
+   display: flex;
+   justify-content: center;
+   align-items: center;
+   z-index: 10000;
+ }
+ 
+ .error-check-dialog-container {
+   background-color: white;
+   border-radius: 8px;
+   box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
+   min-width: 400px;
+   max-width: 500px;
+   overflow: hidden;
+ }
+ 
+ .error-check-dialog-header {
+   background-color: #D7EBFF;
+   padding: 15px 20px;
+   border-radius: 8px 8px 0 0;
+ }
+ 
+ .error-check-dialog-title {
+   font-size: 18px;
+   font-weight: bold;
+   color: #333;
+ }
+ 
+ .error-check-dialog-body {
+   padding: 30px 20px;
+ }
+ 
+ .error-check-dialog-message {
+   font-size: 14px;
+   color: #333;
+   text-align: center;
+   line-height: 1.6;
+   margin: 0;
+ }
+ 
+ .error-check-dialog-footer {
+   padding: 12px 20px 20px;
+   text-align: center;
+ }
+ 
+ .error-check-dialog-ok-button {
+   padding: 10px 24px;
+   background-color: rgb(37, 100, 153);
+   color: white;
+   border: none;
+   border-radius: 4px;
+   font-size: 14px;
+   font-weight: bold;
+   cursor: pointer;
+   min-width: 80px;
+ }
+ 
+ .error-check-dialog-ok-button:hover {
+   background-color: rgb(25, 80, 133);
+ }
  
  .auth-error-dialog-ok-text {
```

</details>

</tool-use>

---

<tool-use data-tool-type="generic" data-tool-name="read_lints">
<details>
          <summary>Tool use: **read_lints** • Read lints for 1 file</summary>
      
Lint paths:

- `frontend/src/views/TimesheetScreen.vue`

Lint results


**No lint errors found**
</details>
</tool-use>

---



---


修正完了。変更点:

1. **確認ダイアログとエラーチェックダイアログを追加**
   - ブラウザの`confirm()`を削除し、カスタムダイアログに置き換え
   - タイトルは「確認」に統一

2. **事前チェックを追加**
   - `checkDailyConfirmation`で以下をチェック:
     - 出退社時刻の入力
     - 勤務場所の選択
     - 工数合計と実労働時間の一致
     - 手入力時の備考入力

3. **処理フローを修正**
   - エラー時: エラーチェックダイアログを表示（確認ダイアログは表示しない）
   - チェック通過時のみ: 確認ダイアログを表示し、OKで日次確定申請を実行

これにより、工数実績が未入力の場合はエラーダイアログが表示され、確認ダイアログは表示されません。ダイアログのタイトルも「localhost:5173 の内容」ではなく「確認」になります。

---

